<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v2.3 20070202//EN" "journalpublishing.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">HPC</journal-id>
<journal-id journal-id-type="hwp">sphpc</journal-id>
<journal-title>The International Journal of High Performance Computing Applications</journal-title>
<issn pub-type="ppub">1094-3420</issn>
<issn pub-type="epub">1741-2846</issn>
<publisher>
<publisher-name>SAGE Publications</publisher-name>
<publisher-loc>Sage UK: London, England</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1177/1094342012464253</article-id>
<article-id pub-id-type="publisher-id">10.1177_1094342012464253</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Regular Articles</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Designing a pattern recognition system on GPU for discriminating between patients with micro-ischaemic and multiple sclerosis lesions, using MRI images</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Solomou</surname>
<given-names>Ekaterini</given-names>
</name>
<xref ref-type="aff" rid="aff1-1094342012464253">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Kostopoulos</surname>
<given-names>Spiros</given-names>
</name>
<xref ref-type="aff" rid="aff2-1094342012464253">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Sidiropoulos</surname>
<given-names>Konstantinos</given-names>
</name>
<xref ref-type="aff" rid="aff3-1094342012464253">3</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Athanasiadis</surname>
<given-names>Emmanouil</given-names>
</name>
<xref ref-type="aff" rid="aff2-1094342012464253">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Lavdas</surname>
<given-names>Eleftherios</given-names>
</name>
<xref ref-type="aff" rid="aff4-1094342012464253">4</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Glotsos</surname>
<given-names>Dimitris</given-names>
</name>
<xref ref-type="aff" rid="aff2-1094342012464253">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Sakellaropoulos</surname>
<given-names>George</given-names>
</name>
<xref ref-type="aff" rid="aff5-1094342012464253">5</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Zampakis</surname>
<given-names>Petros</given-names>
</name>
<xref ref-type="aff" rid="aff1-1094342012464253">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Stonham</surname>
<given-names>John</given-names>
</name>
<xref ref-type="aff" rid="aff3-1094342012464253">3</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Cavouras</surname>
<given-names>Dionisis</given-names>
</name>
<xref ref-type="aff" rid="aff2-1094342012464253">2</xref>
<xref ref-type="corresp" rid="corresp1-1094342012464253"/>
</contrib>
<bio>
<title>Author biographies</title>
<p>
<italic>Ekaterini Solomou</italic> received her MD and PhD degrees from the University of Patras, Greece in 1989 and 1995, respectively. After working as a Radiologist in the University Hospital of Patras, she is currently Assistant Professor at the Department of Radiology, School of Medicine, University of Patras where she teaches radiology at the graduate and postgraduate level. Since 2010 she has been the person responsible for the Magnetic Resonance Imaging Department of the University Hospital of Patras. Her research interests lie in the field of magnetic resonance imaging in central nervous system and liver.</p>
<p>
<italic>Spiros Kostopoulos </italic>received his BSc degree in Biomedical Engineering from the Department of Medical Instruments Technology of the Technological Educational Institute of Athens, Greece, in 2000, and the MSc degree in Medical Physics from the University of Surrey, UK, in 2004. He received his PhD in Medical Physics in 2009 from the University of Patras, Greece. His main research activities lie in the field of medical image processing, image analysis and pattern recognition, medical informatics and bioinformatics. He worked as a post-doctoral researcher in bioinformatics, awarded a grant from the National State Scholarship Foundation of Greece. Since 2009, he is an Adjunct laboratory instructor at the Department of Medical Instruments Technology, Technological Educational Institute of Athens, Greece.</p>
<p>
<italic>Konstantinos Sidiropoulos </italic>was born in Kozani, Greece, in 1980. He received the BSc degree in medical instruments technology from the Technological Institution of Athens, Athens, Greece, in 2004, and the MSc degree in data communication systems from the Brunel University, West London, UK, in 2007. Since September 2007, he is a PhD candidate in the School of Engineering and Design of the Brunel University, West London, UK, fully funded by the Greek State Scholarships (IKY) Foundation. His research interests include medical image processing, image analysis, telemedical applications, and GPU programming.</p>
<p>
<italic>Emmanouil Athanasiadis</italic> received his BSc in Biomedical Engineering from the Department of Medical Instruments Technology of the Technological Educational Institute of Athens, Greece, in 2004. He received his MSc and PhD in Medical Physics in 2006 and 2010, respectively, from the University of Patras, Greece. His MSc and PhD studies were both funded by the National State Scholarship Foundation of Greece. He has already participated in a ‘Marie Curie’ proposal as associate researcher (postdoctorate) at University Colleague London (UCL) from June to October 2010. Since 2010, he is an Adjunct laboratory instructor (lecturer level) at the Department of Medical Instruments Technology, Technological Educational Institute of Athens, Greece. Since 2011, he has also been working as associate researcher (postdoctorate) at the Biomedical Research Foundation of the Academy of Athens in a FP7 ‘cooperation’ project.</p>
<p>
<italic>Eleftherios Lavdas</italic> received his BSc degree from the Department of Medical Radiology of the Technological Educational Institute of Athens, Greece, in 1989, and his MSc degree in Medical Physics from the University of Patras, Greece in 2005 and his PhD in Computed Tomography, at the University of Thessaly, Greece, in 2008.  He is currently Lecturer at the department of Medical Radiology, Technological Educational Institute of Athens, Greece. His research interests lie in the fields of skeletal, abdominal, and central nervous system MRI.</p>
<p>
<italic>Dimitris Glotsos </italic>received his BSc degree in Biomedical Engineering from the Department of Medical Instruments Technology of the Technological Educational Institute of Athens, Greece, in 2000, and the MSc and PhD degrees in Medical Physics from the University of Patras, Greece, in 2002 and 2006, respectively. Currently, he holds the position of Lecturer (Professor of Applications) at the Department of Medical Instruments Technology at the Technological Educational Institute of Athens, Greece. His research interests include pattern recognition, medical image processing and analysis, bioinformatics and microscopy.</p>
<p>
<italic>George Sakellaropoulos</italic> received his Diploma in Physics in 1993 from the University of Athens, Greece and MSc and PhD degrees from the University of Patras, Greece in 1995 and 2001, respectively. He is currently Assistant Professor at the Medical Physics Department, School of Medicine, University of Patras where he teaches biostatistics, medical informatics and medical physics. His research interests lie in various aspects of the management of biomedical information originating from physical and biological processes, i.e. biomedical informatics, statistical learning, medical decision support systems and biomedical statistics.</p>
<p>
<italic>Petros Zampakis</italic> received his MD and PhD degrees from the University of Patras, Greece in 1995 and 2005, respectively. After working as a Radiologist in the University Hospital of Patras, he is currently Lecturer at the Department of Radiology, School of Medicine, University of Patras where he teaches radiology. His research interests lie in the fields of interventional neuroradiology and vascular radiology.</p>
<p>
<italic>John Stonham </italic>is Professor of Neural Systems Engineering in the Department of Electrical Engineering and Electronics at Brunel University, West London, UK. He received his BSc degree in Electronics (1970) MSc in Hybrid Computing (1972) and PhD in Pattern Recognition (1974) from Kent University, UK. His research interests are the theory and applications of neural networks, pattern recognition, image processing and image database management.</p>
<p>
<italic>Dionisis Cavouras</italic> received his BSc (1974) in Electronic Engineering, and MSc (1976) and PhD (1981) in Systems Engineering from the City University, London, England. He is currently full professor of medical imaging processing at the Department of Medical Instrumentation Technology, TEI-Athens, and director of the Laboratory of Medical Image and Signal Processing. His research interests include medical image processing, image analysis, pattern recognition, medical statistics and medical physics. He has published numerous technical and medical papers as well as conference proceedings.</p>
</bio>
</contrib-group>
<aff id="aff1-1094342012464253">
<label>1</label>Department of Radiology, University Hospital of Patras, Rio, Greece</aff>
<aff id="aff2-1094342012464253">
<label>2</label>Medical Image and Signal Processing Laboratory, Department of Medical Instruments Technology, Technological Educational Institute of Athens, Egaleo, Athens, Greece</aff>
<aff id="aff3-1094342012464253">
<label>3</label>School of Engineering and Design, Brunel University West London, Uxbridge, Middlesex, UK</aff>
<aff id="aff4-1094342012464253">
<label>4</label>Department of Radiologic Technologists, Technological Educational Institute of Athens, Egaleo, Athens, Greece</aff>
<aff id="aff5-1094342012464253">
<label>5</label>Department of Medical Physics, School of Medicine, University of Patras, Rio, Patras, Greece</aff>
<author-notes>
<corresp id="corresp1-1094342012464253">Dionisis Cavouras, PhD, Medical Image and Signal Processing Laboratory, Department of Medical Instruments Technology, Technological Educational Institute of Athens, Ag. Spyridonos Street, Egaleo, Athens 122 10, Greece. Email: <email>cavouras@teiath.gr</email>
</corresp>
</author-notes>
<pub-date pub-type="epub-ppub">
<month>8</month>
<year>2013</year>
</pub-date>
<volume>27</volume>
<issue>3</issue>
<issue-title>Special Issue section on CCDSC 2012 Workshop</issue-title>
<fpage>348</fpage>
<lpage>359</lpage>
<permissions>
<copyright-statement>© The Author(s) 2012</copyright-statement>
<copyright-year>2012</copyright-year>
<copyright-holder content-type="sage">SAGE Publications</copyright-holder>
</permissions>
<abstract>
<p>The aim of this study was to employ state-of-art graphics processing unit (GPU) technology and CUDA parallel programming to design and implement a stand-alone pattern recognition (PR) system to discriminate between patients with micro-ischaemic (mIS) and multiple sclerosis (MS) lesions. The dataset comprised MRI image series of 32 patients with mIS and 19 with MS lesions. The probabilistic neural network classifier and 40 textural features, calculated from lesions in the magnetic resonance imaging (MRI) images, were used to design the PR system. The highest classification accuracy was 90.2%, employing six textural features. It took about 135 minutes to design the PR system on a desktop CPU (Intel Core 2 Quad Q9550), using sequential programming, against 250 seconds on the Nvidia 8800GT GPU card, using parallel programming. The proposed PR system may be redesigned on site, when new verified data are incorporated in its depository, and it may serve as a second opinion tool in a clinical environment. </p>
</abstract>
<kwd-group>
<kwd>graphics processor unit</kwd>
<kwd>parallel processing</kwd>
<kwd>pattern recognition</kwd>
<kwd>magnetic resonance imaging</kwd>
<kwd>multiple sclerosis</kwd>
<kwd>ischaemic lesions</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="section1-1094342012464253">
<title>1. Introduction</title>
<p>With the advent of MRI technology, the detection and characterization of abnormal brain structures has become feasible. However, differential diagnosis may sometimes be a difficult task, as is the case of brain parenchymal unknown bright objects, revealed by magnetic resonance imaging (MRI) T2-weighted (T2W) sequences (<xref ref-type="bibr" rid="bibr7-1094342012464253">Hoque et al., 2007</xref>; <xref ref-type="bibr" rid="bibr10-1094342012464253">Lou et al., 2009</xref>). Although micro-ischaemic (mIS) lesions are the most common cause for these hyperintensities, even in younger patients, a major diagnostic challenge regards exclusion or verification of demyelinated plaques in multiple sclerosis (MS) (<xref ref-type="bibr" rid="bibr4-1094342012464253">Charil et al., 2006</xref>). Even though definite diagnosis of MS is clinical, early radiologic confirmation is very important in patient management and, therefore, imaging criteria need continuous updating (<xref ref-type="bibr" rid="bibr12-1094342012464253">Montalban et al., 2010</xref>).</p>
<p>MRI brain images obtained from patients with MS may depict lesions that resemble brain lesions from other diseases such as inflammatory disorders or cerebrospinal disease (<xref ref-type="bibr" rid="bibr3-1094342012464253">Bot et al., 2002</xref>; <xref ref-type="bibr" rid="bibr10-1094342012464253">Lou et al., 2009</xref>; <xref ref-type="bibr" rid="bibr17-1094342012464253">Trojano, 2011</xref>; <xref ref-type="bibr" rid="bibr19-1094342012464253">Zhang, 2012</xref>). In a number of previous studies, attempts have been made to differentiate between MS and other diseases affecting the central nervous system by employing MRI and quantitative methods of image analysis. In one study (<xref ref-type="bibr" rid="bibr11-1094342012464253">Mathias et al., 1999</xref>), the authors have employed texture analysis methods to discriminate between MS lesions and normal brain structures and have indicated textural parameters that displayed statistically significant differences between the two categories. In another study (<xref ref-type="bibr" rid="bibr18-1094342012464253">Yu et al., 1999</xref>), a classification algorithm has been employed to discriminate between active and non-active MS lesions, based on textural features computed from MRI images. <xref ref-type="bibr" rid="bibr7-1094342012464253">Hoque et al. (2007</xref>) have analysed two quantitative MRI indices, the apparent diffusion coefficients and the T2R relaxation times, and they have found statistically significant differences between patients with MS and ischaemic lesions. In a previous study by our group (<xref ref-type="bibr" rid="bibr15-1094342012464253">Theocharakis et al., 2009</xref>), a pattern recognition system has been developed for discriminating between MS and cerebral microangiopathy lesions, using textural features from MRI images and the probabilistic neural network (PNN) classifier. That study had focused on the characterization of lesions that had been collected from 11 patients with MS and 18 patients with cerebral microangiopathy lesions. </p>
<p>The present study is an extension of our previous work (<xref ref-type="bibr" rid="bibr15-1094342012464253">Theocharakis et al., 2009</xref>) to a new and larger dataset of patients with MS or mIS lesions, examined at a different MRI unit. We have now focused our interest on characterizing patients, having either singular or multiple brain lesions (MS or mIS), rather than discriminating between brain lesions in patients with either singular MS or mIS lesions. Our group has now cooperated with the MRI examination centre of a university hospital, and we have undertaken the differential diagnosis task of discriminating between patients with MS or mIS lesions, using image analysis and pattern recognition methods on MRI images. The differentiation between MS and mIS patients is not a trivial task, since lesion characteristics in both cases often appear with similar intensity properties, of similar sizes, and usually at the same location, as the white matter in brain. Our task was twofold, first, to identify, on routine taken fluid attenuated inversion recovery (FLAIR) coronal MRI images, meaningful textural features of high discriminatory power that would differentiate between the two classes of patients (MS and mIS), at a statistically significant level, so that those features could be considered as possible surrogate markers, and, second, to design and implement a pattern recognition (PR) system that would differentiate between patients with MS or mIS lesions with high reliability. The system is to be used as a second opinion tool at the clinical environment of an MRI examination centre. For this, a classification scheme was developed, employing the PNN classifier and applying parallel processing programming on the processors of a graphics processing unit (GPU), which was attached to a host computer. The involvement of GPU technology and parallel processing methods was necessary in order to deal with the high dimensionality of the problem at hand and to obtain an optimal design of the proposed system. Thus, the contributions of the present study are (a) to provide a computer-based diagnostic tool, to deal with the particular differential diagnosis problem of discriminating between patients with MS and mIS; and (b) to exploit GPU technology and parallel processing programming techniques, to design an optimum and reliable PR system that is capable of being redesigned on site when additional verified data are added to its depository. </p>
</sec>
<sec id="section2-1094342012464253">
<title>2. Material and methods</title>
<sec id="section3-1094342012464253">
<title>2.1. Clinical material</title>
<p>The dataset consisted of the brain MRI series of 51 patients, retrospectively examined during 2006–2011. Nineteen patients were clinically verified, with MS, while 32 patients had ischaemic lesions, diagnosed by their MRI evaluation and clinical history. The mean age of the MS patients was 36 years old (mean age: 36.47, standard deviation: 12.4; range: 19–75 years) and the mean age of the ischaemic patients was 70 years old (mean age: 70.23, standard deviation: 9.4; range: 46–91 years). All patients were scanned at the MRI unit of the Department of Radiology, University Hospital of Patras, by means of a Philips Medical Systems 1T MRI scanner. The protocol that was followed for the acquisition of the MRI series was the routinely adopted clinical protocol of a FLAIR sequence with repetition time 6000 ms, echo time 110 ms, inverse time 2000 ms, acquisition matrix 256 × 256 and slice thickness of 5 mm, in axial and coronal planes. Only the routinely taken coronal slices of the examination were used for the purposes of the present study.  </p>
</sec>
<sec id="section4-1094342012464253">
<title>2.2. Feature extraction</title>
<p>One senior experienced radiologist (ES) and a neuroradiologist (PZ) as well as a radiographer (EL) delineated by consensus the outline of each MS and mIS lesion on the MRI images by means of a custom-made program developed by our team (see <xref ref-type="fig" rid="fig1-1094342012464253">Figure 1</xref>). In segmenting lesions, the following rules were followed:  each lesion was selected from the MRI slice through the lesion with the largest lesion diameter, only singular lesions were selected, and very small lesions, of less than five pixels in diameter, were excluded. All lesions selected from each patient were, thus, retained for further processing. From each lesion, 40 textural features that quantify textural image information were generated, as described by <xref ref-type="bibr" rid="bibr6-1094342012464253">Haralick et al. (1973</xref>) and <xref ref-type="bibr" rid="bibr5-1094342012464253">Galloway (1975</xref>): four features from the lesion’s histogram, 26 features from the lesion’s co-occurrence matrices, and 10 features from the lesion’s run-length matrices. Thus, patients having only one lesion were represented by a 40-feature vector and patients with more than one lesion were represented by a 40-features mean vector, the mean feature values of all the lesions of the patient. Next, to avoid feature-value bias, all features were normalized to zero mean and unit standard deviation, according to<disp-formula id="disp-formula1-1094342012464253">
<label>1</label>
<mml:math id="mml-disp1-1094342012464253">
<mml:mi>y</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>i</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo stretchy="false">=</mml:mo>
<mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:mi>x</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>i</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo stretchy="false">−</mml:mo>
<mml:mover accent="true">
<mml:mi>x</mml:mi>
<mml:mo accent="true" stretchy="false">ˉ</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mi>s</mml:mi>
</mml:mfrac>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula1-1094342012464253" xlink:href="10.1177_1094342012464253-eq1.tif"/>
</disp-formula>
</p>
<p>where <italic>y(i)</italic> is the normalized version of feature <italic>x(i)</italic>, <inline-formula id="inline-formula1-1094342012464253">
<mml:math id="mml-inline1-1094342012464253">
<mml:mover accent="true">
<mml:mi>x</mml:mi>
<mml:mo accent="true" stretchy="false">ˉ</mml:mo>
</mml:mover>
</mml:math>
</inline-formula> and <italic>s</italic> are the mean and standard deviations of feature <italic>x</italic>, both calculated over all patterns of both classes. The discriminatory power of the features was tested by the non-parametric Wilcoxon statistical test. Accordingly, textural features that displayed statistically significant differences between the two classes (MS and mIS) at the 0.001 statistical level were identified and differences in texture between the two types of lesions were assessed. </p>
<fig id="fig1-1094342012464253" position="float">
<label>Figure 1.</label>
<caption>
<p>Custom-made software for extracting lesions.</p>
</caption>
<graphic xlink:href="10.1177_1094342012464253-fig1.tif"/>
</fig>
</sec>
<sec id="section5-1094342012464253">
<title>2.3. System design</title>
<p>For the design of the PR system, the PNN classification algorithm (<xref ref-type="bibr" rid="bibr14-1094342012464253">Specht, 1990</xref>), using Gaussian kernel, was chosen for the task of discriminating MS from mIS cases. The discriminant function <italic>g</italic>
<sub>j</sub>(x) of the PNN is given as<disp-formula id="disp-formula2-1094342012464253">
<label>2</label>
<mml:math id="mml-disp2-1094342012464253">
<mml:msub>
<mml:mi>g</mml:mi>
<mml:mi>j</mml:mi>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo stretchy="false">=</mml:mo>
<mml:mrow>
<mml:mfrac>
<mml:mn>1</mml:mn>
<mml:mrow>
<mml:mo stretchy="false">(</mml:mo>
<mml:mn>2</mml:mn>
<mml:mi mathvariant="italic">π</mml:mi>
<mml:mrow>
<mml:msup>
<mml:mo stretchy="false">)</mml:mo>
<mml:mrow>
<mml:mi>f</mml:mi>
<mml:mrow>
<mml:mo>/</mml:mo>
</mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msup>
</mml:mrow>
<mml:mtext> </mml:mtext>
<mml:msup>
<mml:mi mathvariant="italic">σ</mml:mi>
<mml:mrow>
<mml:mi>f</mml:mi>
</mml:mrow>
</mml:msup>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mi>j</mml:mi>
</mml:msub>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
<mml:mo stretchy="false">∑</mml:mo>
<mml:mrow>
<mml:mo form="prefix" movablelimits="false">exp</mml:mo>
<mml:mfenced close="]" open="[">
<mml:mrow>
<mml:mo stretchy="false">−</mml:mo>
<mml:mtext> </mml:mtext>
<mml:mrow>
<mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo stretchy="false">−</mml:mo>
<mml:msub>
<mml:mi>x</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
<mml:mrow>
<mml:msup>
<mml:mo stretchy="false">)</mml:mo>
<mml:mrow>
<mml:mrow>
<mml:mi mathvariant="normal">T</mml:mi>
</mml:mrow>
</mml:mrow>
</mml:msup>
</mml:mrow>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo stretchy="false">−</mml:mo>
<mml:msub>
<mml:mi>x</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
<mml:msup>
<mml:mi mathvariant="italic">σ</mml:mi>
<mml:mn>2</mml:mn>
</mml:msup>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:mrow>
</mml:mrow>
</mml:mfenced>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula2-1094342012464253" xlink:href="10.1177_1094342012464253-eq2.tif"/>
</disp-formula>
</p>
<p>where <italic>x </italic>is the input vector to be classified to one of two classes (MS or mIS), <italic>x<sub>i</sub>
</italic> is the <italic>i</italic>th training pattern vector, <italic>N<sub>j</sub>
</italic> is the number of patterns in class <italic>j</italic>, <italic>σ</italic> is a smoothing parameter, and <italic>f</italic> is the number of features employed in the feature vector. The PNN classifies the input vector <italic>x</italic> to class <italic>j</italic> with the higher discriminant value.</p>
<p>To complete the design of the PR system, parameters <italic>f</italic> and <italic>σ</italic> had to be determined so that a high-precision design would result. This task is, however, quite challenging since (a) amongst the 40 features, an information rich subset with <italic>f</italic> features has to be determined, which will discriminate MS from mIS cases with the highest possible discrimination accuracy; (b) the value of <italic>σ</italic> must be determined by multiple experimentations for the highest system precision; and (c) system evaluation methods have to be implemented so as to reveal the optimum design (see (a) and (b)), given the limited amount of available data, which is mostly the case in medical data. Those prerequisites, however, render the dimensionality problem enormous. </p>
<p>Considering (a), the choice of a high discriminatory power feature combination to design the PNN may be attempted either by following suboptimal search methods, hoping that one is fortunate enough to find a high-performance feature combination, or by employing optimal search methods. One suboptimal method consists of forming a features ranking criterion (rank-features) by combining the Wilcoxon statistical test and the correlation amongst the features (<xref ref-type="bibr" rid="bibr16-1094342012464253">Theodoridis and Koutroumbas, 2003</xref>). After features are ranked in descending order, the first <italic>N</italic> features are chosen and all possible combinations (i.e. combinations of 1, 2, 3, …, <italic>N </italic>features) are formed for evaluating the PNN design. In the present study, the first 10 top-ranked features were used for the design by the ‘rank-features’ suboptimal method (equal contributions by the Wilcoxon test and correlation coefficient in the formation of the ranking criterion were considered). Another suboptimal method seeks for the best features combination by means of the sequential backward selection (SBS) method (<xref ref-type="bibr" rid="bibr16-1094342012464253">Theodoridis and Koutroumbas, 2003</xref>). If none of the suboptimal methods converges to a high-precision design, then one has to resort to optimal search techniques, such as the exhaustive search technique (<xref ref-type="bibr" rid="bibr16-1094342012464253">Theodoridis and Koutroumbas, 2003</xref>), i.e. forming all possible features combinations and testing the precision of PNN design, finally retaining that with the fewest features that achieves the highest classification accuracy. However, the computational burden becomes enormous, if one considers all possible feature combinations.  </p>
<p>Regarding (b), the value of <italic>σ</italic> has to be determined by trial and error for values between 0 and 1, each time redesigning the PR system, which may increase the time processing requirements. </p>
<p>Considering (c), the leave-one-out (LOO) method may be employed for system evaluation, according to which the system is designed by all but one case and the left out case is then classified by the system. This cycle is repeated as many times as is the number of cases in both classes, resulting in a truth table that displays the partial and overall system accuracies. This means that the computational requirements of the design of the PR system may increase by <italic>N</italic>-fold, where <italic>N</italic> is the number of cases in both classes. Furthermore, to get a realistic assessment of the PR system’s performance to new ‘unseen’ by the system data, the 10-fold external cross-validation (ECV) method (<xref ref-type="bibr" rid="bibr2-1094342012464253">Ambroise and McLachlan, 2002</xref>) has to be employed. Data from both classes are split into two non-overlapping subsets, one subset (70% of the data) is used to optimally design the system, using the exhaustive search and LOO methods, and then the system, thus designed, is used to classify the other subset (30% of the data). This procedure may then be repeated 10 times and the average ECV accuracy be calculated, as an assessment of the system’s classification precision to new unseen data. It is obvious that the computational burden is further magnified, rendering the problem of optimally designing the PR system practically not realizable even on a powerful desktop computer.  </p>
<p>To deal with the high-dimensionality problem of the PR design, most of the system design was transferred onto the processors of an Nvidia 8800GT GPU, attached to the computer, by adopting parallel processing programming using the CUDA (Compute Unified Device Architecture) toolkit v4.0 and the C/C++ programming language (<xref ref-type="bibr" rid="bibr9-1094342012464253">Kirk and Hwu, 2010</xref>; <xref ref-type="bibr" rid="bibr13-1094342012464253">Sidiropoulos et al., 2012</xref>). Accordingly, the task of sequentially designing the PNN, by each feature combination and evaluating its performance by the LOO method on the host computer’s CPU, it was now transferred onto the GPU on a separate thread and it was executed in parallel with all of the other feature combinations on the GPU’s processors. This process is demonstrated in <xref ref-type="fig" rid="fig2-1094342012464253">Figure 2</xref>. The process of designing the implemented PR system consists of a sequential part, which is executed by a single CPU thread, and a parallel part executed exclusively by the GPU, and depicted as the ‘fork’ section in <xref ref-type="fig" rid="fig2-1094342012464253">Figure 2</xref>. Specifically, the tasks responsible for loading of the dataset, division of dataset in training and validation subsets, and memory copies/transfers from host PC to GPU memory and vice versa are all executed in sequence by the CPU. The lower diagram of <xref ref-type="fig" rid="fig2-1094342012464253">Figure 2</xref> illustrates in detail the parallel part and the tasks assigned to each ‘fork branch’ by the kernel running in all GPU cores concurrently. Each GPU thread is fed with a single feature combination as input and is assigned with the task to train the PNN classifier with this unique feature combination and evaluate its classification accuracy by means of the LOO method. It should be noted that feature combinations were sequentially transferred from the host PC memory onto the GPU’s global memory in batches of 80,000 feature combinations, right before each GPU kernel launch; ‘kernel’ refers to the function that runs in each GPU thread. For example, the first batch transfer would contain combinations of one, two, three, etc. features until the batch size of 80,000 combinations was filled. Regarding thread configuration, block and grid sizes were experimentally set to [128 × 1] and [625 × 1 × 1], respectively. The batch size (80,000 feature combinations) was selected so as to be a multiple of the block size (128 threads). Upon completion of all threads, results were transferred back to the host PC memory and the kernel was launched for the next batch of 80,000 feature combinations.</p>
<fig id="fig2-1094342012464253" position="float">
<label>Figure 2.</label>
<caption>
<p>Flow diagram of parallel processing performed on the graphics processing unit.</p>
</caption>
<graphic xlink:href="10.1177_1094342012464253-fig2.tif"/>
</fig>
</sec>
</sec>
<sec id="section6-1094342012464253">
<title>3. Results</title>
<p>
<xref ref-type="table" rid="table1-1094342012464253">Table 1</xref> shows the classification accuracies achieved following the two suboptimal and the optimal methods, adopted for determining the best design of the PR system. The first two columns of results indicate the precision of the PR system in classifying mIS from MS cases, the third column shows the overall system accuracies, and the fourth column shows the best feature combinations found for the design of the PNN. As may be observed from <xref ref-type="table" rid="table1-1094342012464253">Table 1</xref>, highest partial and overall classification accuracies were achieved by the optimal features selection method (90.6%, 89.5%, 90.2%), using the PNN classifier, the exhaustive search, for testing all possible features combinations, and the LOO evaluation method on the 16 processors of the GPU Nvidia graphics card.  Examining the mIS cases column, the precisions with which mIS cases were characterized were 78.1% for the first suboptimal method, classifying correctly 25 out of 32 mIS cases, similarly 78.1% for the second suboptimal method, and 90.6% for the optimal method identifying correctly 29 out of 32 mIS cases. Similar findings may be seen in the MS column; 68.4%, 73.7%, and 89.5% accuracies were achieved in correctly characterizing MS cases, classifying correctly 13, 14 and 17 out of 19 MS cases, respectively. </p>
<table-wrap id="table1-1094342012464253" position="float">
<label>Table 1.</label>
<caption>
<p>Classification accuracies achieved, employing the PNN, suboptimal and optimal features-selection methods, and the LOO evaluation method.</p>
</caption>
<graphic alternate-form-of="table1-1094342012464253" xlink:href="10.1177_1094342012464253-table1.tif"/>
<table>
<thead>
<tr>
<th>
</th>
<th colspan="3">Accuracy (%)</th>
<th>
</th>
</tr>
<tr>
<th>
</th>
<th>mIS cases</th>
<th>MS cases</th>
<th>Overall</th>
<th>best feature combination</th>
</tr>
</thead>
<tbody>
<tr>
<td>1<sup>st</sup> suboptimal: rank-features and LOO</td>
<td>78.1 (25/32)</td>
<td>68.4 (13/19)</td>
<td>74.5 (38/51)</td>
<td>ENTR<sup>a</sup>, SENTR<sup>r</sup>, CONTR<sup>r</sup>, RLNU</td>
</tr>
<tr>
<td>2<sup>nd</sup> suboptimal: SBS</td>
<td>78.1 (25/32)</td>
<td>73.7 (14/19)</td>
<td>76.5 (39/51)</td>
<td>ASM<sup>r</sup>, IDF<sup>a</sup>, SENTR<sup>r</sup>
</td>
</tr>
<tr>
<td>Optimal: exhaustive search and LOO on GPU</td>
<td>90.6 (29/32)</td>
<td>89.5 (17/19)</td>
<td>90.2 (46/51)</td>
<td>ASM<sup>a</sup>, ASM<sup>r</sup>, SENTR<sup>a</sup>, SENTR<sup>r</sup>, RP<sup>r</sup>, VAR<sup>r</sup>
</td>
</tr>
</tbody>
</table>
<table-wrap-foot>
<fn id="table-fn1a-1094342012464253">
<p>a, average; ASM, angular second moment; CONTR, contrast; ENTR, entropy; GPU, graphics processing unit; IDF, inverse difference moment; LOO, leave one out; mIS, micro-ischaemic; MS, multiple sclerosis; RP, run percentage; VAR, variance;  r, range; RLNU, run length non-uniformity; SBS, sequential backward selection; SENTR, sum of entropy.</p>
</fn>
</table-wrap-foot>
</table-wrap>
<p>
<xref ref-type="table" rid="table2-1094342012464253">Table 2</xref> is a truth table showing details of the precision achieved in designing the PR system by the optimal method. The best PR system design was achieved by a six-feature combination (see <xref ref-type="table" rid="table1-1094342012464253">Table 1</xref>). As can be observed, five cases were misclassified, three mIS cases were wrongly classified as MS and two MS cases were mistaken for mIS. </p>
<table-wrap id="table2-1094342012464253" position="float">
<label>Table 2.</label>
<caption>
<p>Truth table for discriminating mIS from MS cases.</p>
</caption>
<graphic alternate-form-of="table2-1094342012464253" xlink:href="10.1177_1094342012464253-table2.tif"/>
<table>
<thead>
<tr>
<th>
</th>
<th>Classified mIS</th>
<th>Classified MS</th>
<th>Accuracy (%)</th>
</tr>
</thead>
<tbody>
<tr>
<td>mIS</td>
<td>29</td>
<td>3</td>
<td>90.6</td>
</tr>
<tr>
<td>MS</td>
<td>2</td>
<td>17</td>
<td>89.5</td>
</tr>
<tr>
<td>
</td>
<td>
</td>
<td>
</td>
<td>90.2</td>
</tr>
</tbody>
</table>
<table-wrap-foot>
<fn id="table-fn1-1094342012464253">
<p>mIS, micro-ischaemic; MS, multiple sclerosis.</p>
</fn>
</table-wrap-foot>
</table-wrap>
<p>
<xref ref-type="fig" rid="fig3-1094342012464253">Figure 3</xref> shows boxplot diagrams of the six features that were combined to design the best classifier that achieved the highest classification accuracy. Horizontal lines inside the boxes corresponded to the median of the feature values. Of the six features, only two, the angular second moment (ASM) (average) and the variance (range) were found to display statistical significant differences (<italic>p</italic> &lt; 0.001) between the two classes, of ischaemic and MS cases. In fact, the ASM (average) and the variance (average and range) were the only features, of the 40 features evaluated in the present study, that displayed statistically significant differences between the two classes at the 0.001 statistical level. In addition, of the six features that formed the best combination in the optimal PNN design, only one, the sum of entropy (average), was included in the top-10 ranked features that were used to design the first suboptimal system design method. </p>
<fig id="fig3-1094342012464253" position="float">
<label>Figure 3.</label>
<caption>
<p>Box-plots of the six textural features that formed the best feature combination in the optimal probabilistic neural network design.</p>
</caption>
<graphic xlink:href="10.1177_1094342012464253-fig3.tif"/>
</fig>
<p>
<xref ref-type="fig" rid="fig4-1094342012464253">Figure 4</xref>(a), (b), and (c) demonstrate transformed scatter diagrams (by quadratic least-squares [QLS] rule), where the multi-dimensional textural features spaces were transformed into two-dimensional spaces (dimensionality is equal to the number of classes) by the QLS mapping process (<xref ref-type="bibr" rid="bibr1-1094342012464253">Ahmed and Rao, 1975</xref>). Circles and stars correspond to mIS and MS cases, respectively.</p>
<fig id="fig4-1094342012464253" position="float">
<label>Figure 4.</label>
<caption>
<p>Least-squares mappings of the multiple sclerosis (MS) and micro-ischaemic (mIS) cases, using (a) the first suboptimal method (rank-features) and best four-features combination (b) the second suboptimal method (sequential backward selection) and best three-features combination, and (c) the optimal method (exhaustive search) and best six-feature combination.</p>
</caption>
<graphic xlink:href="10.1177_1094342012464253-fig4.tif"/>
</fig>
<p>To estimate the time improvement factor for executing the same processing task sequentially on the CPU (Intel Core 2 Quad Q9550 at 2.83 GHz) of the computer or in parallel on the 14 multiprocessors of the GPU, the following task was chosen: (a) in designing the system, an exhaustive search was used to form all possible features combinations of up to 6 features within the 40 features; and (b) the LOO method was employed, for evaluating the PNN’s performance at each feature combination. Considering that there were 40 features available and 51 cases (patterns), it took 250 seconds (or about 4.2 minutes) on the GPU to process the task against 135 minutes (or about 2.2 hours) on the CPU. This essentially represents a time improvement of about a factor of 32. In addition, in order to exploit the full processing potential of the CPU, the OpenMP framework version 2.0 was utilized and the time required for the same processing task employing all four CPU cores was evaluated. The CPU’s multi-core time performance for the aforementioned training task was 34.5 minutes.</p>
<p>
<xref ref-type="table" rid="table3-1094342012464253">Table 3</xref> shows the classification results obtained when the PR system was tested by the 10-fold ECV method. The latter provides an assessment of the performance of the optimally designed system to new, ‘unseen’ by the system, data. At each 1 of the 10 trials, the accuracies achieved for the mIS and MS cases and the overall accuracies are presented. The last row of <xref ref-type="table" rid="table3-1094342012464253">Table 3</xref> shows the means and standard deviations of the accuracies achieved for the mIS (80 ± 13.3%) and MS cases (80 ± 7.03 %) and the overall accuracy (80 ± 9.7%). </p>
<table-wrap id="table3-1094342012464253" position="float">
<label>Table 3.</label>
<caption>
<p>Classification accuracies achieved employing the 10-fold external cross-validation method (optimal system design) on GPU.</p>
</caption>
<graphic alternate-form-of="table3-1094342012464253" xlink:href="10.1177_1094342012464253-table3.tif"/>
<table>
<thead>
<tr>
<th>
</th>
<th colspan="3">Accuracy (%)</th>
<th>
</th>
</tr>
<tr>
<th>Trials</th>
<th>mIS cases</th>
<th>MS cases</th>
<th>Overall</th>
<th>Number of features</th>
</tr>
</thead>
<tbody>
<tr>
<td> 1</td>
<td>60.0</td>
<td>66.7</td>
<td>62.5</td>
<td>2</td>
</tr>
<tr>
<td> 2</td>
<td>100.0</td>
<td>83.3</td>
<td>93.8</td>
<td>5</td>
</tr>
<tr>
<td> 3</td>
<td>90.0</td>
<td>83.3</td>
<td>87.5</td>
<td>6</td>
</tr>
<tr>
<td> 4</td>
<td>80.0</td>
<td>66.7</td>
<td>75.0</td>
<td>4</td>
</tr>
<tr>
<td> 5</td>
<td>80.0</td>
<td>83.3</td>
<td>81.3</td>
<td>4</td>
</tr>
<tr>
<td> 6</td>
<td>60.0</td>
<td>83.3</td>
<td>68.8</td>
<td>3</td>
</tr>
<tr>
<td> 7</td>
<td>90.0</td>
<td>83.3</td>
<td>87.5</td>
<td>6</td>
</tr>
<tr>
<td> 8</td>
<td>90.0</td>
<td>83.3</td>
<td>87.5</td>
<td>4</td>
</tr>
<tr>
<td> 9</td>
<td>70.0</td>
<td>83.3</td>
<td>75.0</td>
<td>5</td>
</tr>
<tr>
<td>10</td>
<td>80.0</td>
<td>83.3</td>
<td>81.3</td>
<td>5</td>
</tr>
<tr>
<td>Mean ± SD</td>
<td>80±13.3</td>
<td>80±7.03</td>
<td>80±9.7</td>
<td>
</td>
</tr>
</tbody>
</table>
<table-wrap-foot>
<fn id="table-fn2-1094342012464253">
<p>mIS, micro-ischaemic; MS, multiple sclerosis; SD, standard deviation.</p>
</fn>
</table-wrap-foot>
</table-wrap>
<p>As proof to the superiority of the optimal method to the two suboptimal methods, the ECV was repeated for the two suboptimal methods, in order to alleviate any doubts that a suboptimal method could have been equally employed instead in the design of the PR system. <xref ref-type="table" rid="table4-1094342012464253">Tables 4</xref> and <xref ref-type="table" rid="table5-1094342012464253">5</xref> present the ECV results employing the rank-features and the SBS methods, respectively; the suboptimal methods were used in the internal design stage of the ECV process, using the 70% of the data. Evidently, the mean accuracies achieved by the system, using suboptimal methods, were inferior (66.9% and 77.4% for the rank-features and SBS, respectively) to those obtained by designing the system employing the optimal method (80%).</p>
<table-wrap id="table4-1094342012464253" position="float">
<label>Table 4.</label>
<caption>
<p>Classification accuracies achieved employing the 10-fold external cross-validation method (rank-features suboptimal design) on GPU.</p>
</caption>
<graphic alternate-form-of="table4-1094342012464253" xlink:href="10.1177_1094342012464253-table4.tif"/>
<table>
<thead>
<tr>
<th>
</th>
<th colspan="3">Accuracy (%)</th>
<th>
</th>
</tr>
<tr>
<th>Trials</th>
<th>mIS cases</th>
<th>MS cases</th>
<th>Overall</th>
<th>Number of features</th>
</tr>
</thead>
<tbody>
<tr>
<td> 1</td>
<td>80</td>
<td>33.3</td>
<td>62.5</td>
<td>3</td>
</tr>
<tr>
<td> 2</td>
<td>80</td>
<td>50.0</td>
<td>68.8</td>
<td>3</td>
</tr>
<tr>
<td> 3</td>
<td>70</td>
<td>83.3</td>
<td>75.0</td>
<td>1</td>
</tr>
<tr>
<td> 4</td>
<td>90</td>
<td>16.7</td>
<td>62.5</td>
<td>2</td>
</tr>
<tr>
<td> 5</td>
<td>70</td>
<td>66.7</td>
<td>68.8</td>
<td>1</td>
</tr>
<tr>
<td> 6</td>
<td>50</td>
<td>83.3</td>
<td>62.5</td>
<td>4</td>
</tr>
<tr>
<td> 7</td>
<td>80</td>
<td>33.3</td>
<td>62.5</td>
<td>3</td>
</tr>
<tr>
<td> 8</td>
<td>90</td>
<td>50.0</td>
<td>75.0</td>
<td>3</td>
</tr>
<tr>
<td> 9</td>
<td>70</td>
<td>50.0</td>
<td>62.5</td>
<td>3</td>
</tr>
<tr>
<td>10</td>
<td>60</td>
<td>83.3</td>
<td>68.8</td>
<td>3</td>
</tr>
<tr>
<td>Mean ± SD</td>
<td>74±12.7</td>
<td>55±23.6</td>
<td>66.9±5.1</td>
<td>
</td>
</tr>
</tbody>
</table>
<table-wrap-foot>
<fn id="table-fn3-1094342012464253">
<p>mIS, micro-ischaemic; MS, multiple sclerosis; SD, standard deviation.</p>
</fn>
</table-wrap-foot>
</table-wrap>
<table-wrap id="table5-1094342012464253" position="float">
<label>Table 5.</label>
<caption>
<p>Classification accuracies achieved employing the 10-fold external cross-validation method (sequential backward selection suboptimal design) on GPU.</p>
</caption>
<graphic alternate-form-of="table5-1094342012464253" xlink:href="10.1177_1094342012464253-table5.tif"/>
<table>
<thead>
<tr>
<th>
</th>
<th colspan="3">Accuracy (%)</th>
<th>
</th>
</tr>
<tr>
<th>Trials</th>
<th>mIS cases</th>
<th>MS cases</th>
<th>Overall</th>
<th>Number of features</th>
</tr>
</thead>
<tbody>
<tr>
<td> 1</td>
<td>60</td>
<td>83.3</td>
<td>68.8</td>
<td>2</td>
</tr>
<tr>
<td> 2</td>
<td>90</td>
<td>33.3</td>
<td>68.8</td>
<td>4</td>
</tr>
<tr>
<td> 3</td>
<td>70</td>
<td>83.3</td>
<td>75.0</td>
<td>3</td>
</tr>
<tr>
<td> 4</td>
<td>50</td>
<td>83.3</td>
<td>62.5</td>
<td>4</td>
</tr>
<tr>
<td> 5</td>
<td>90</td>
<td>66.7</td>
<td>81.3</td>
<td>5</td>
</tr>
<tr>
<td> 6</td>
<td>80</td>
<td>50.0</td>
<td>68.8</td>
<td>6</td>
</tr>
<tr>
<td> 7</td>
<td>90</td>
<td>16.7</td>
<td>62.5</td>
<td>1</td>
</tr>
<tr>
<td> 8</td>
<td>70</td>
<td>50.0</td>
<td>62.5</td>
<td>5</td>
</tr>
<tr>
<td> 9</td>
<td>90</td>
<td>50.0</td>
<td>75.0</td>
<td>6</td>
</tr>
<tr>
<td>10</td>
<td>70</td>
<td>66.7</td>
<td>68.8</td>
<td>2</td>
</tr>
<tr>
<td>Mean ± SD</td>
<td>76±14.3</td>
<td>58.3±22.6</td>
<td>77.4±7.5</td>
<td>
</td>
</tr>
</tbody>
</table>
<table-wrap-foot>
<fn id="table-fn4-1094342012464253">
<p>mIS, micro-ischaemic; MS, multiple sclerosis; SD, standard deviation.</p>
</fn>
</table-wrap-foot>
</table-wrap>
</sec>
<sec id="section7-1094342012464253">
<title>4. Discussion</title>
<p>Designing an efficient and high-performing PR system to deal with a medical problem of differential diagnosis is a challenging task. It requires sophisticated programming skills in order to deal with the dimensionality of the problem, to discover the accuracy limits of the system, and to reveal the confidence with which the system can be trusted by the physicians as a second opinion tool. The dimensionality of the problem was influenced by the 40 textural features, employed in investigating the textural structure of MS and mIS lesions, the features selection search technique, for discovering feature combinations with high discriminatory power for designing the classifier, the type of classifier, where a decision had to be made as to the choice of the best performing classifier for the particular problem, and the evaluation method to test the accuracy of the design and the system reliability to new data in a clinical environment. Accordingly, in the first stage of the design process, two suboptimal methods were tested, the rank-features and the SBS methods. The purpose was to investigate whether these two methods could locate a best combination of textural features that would lead to a PR system design for distinguishing MS from mIS cases with high accuracy. Results showed (<xref ref-type="table" rid="table1-1094342012464253">Table 1</xref>) that partial and overall accuracies were too low to be trusted for the design. The first suboptimal method scored 78.1%, 68.4%, 74.5% in classifying correctly mIS cases, MS cases, and in distinguishing between the two classes, respectively. This implies that 7 ischaemic cases were misclassified as MS, 6 MS cases were assigned to the mIS cases category, leading to a total of 13 cases misdiagnosed by the system. Similar findings were also realized in the case of the second suboptimal method, reaching an overall accuracy of 76.5% by assigning 12 cases to the wrong class. It was therefore unavoidable to resort to optimal feature search techniques. <xref ref-type="fig" rid="fig4-1094342012464253">Figure 4</xref>(a) and (b) are transformed feature-based scatter diagrams, to a least-squares quadratic rule, class-based decision space. This was necessary in order to visually assess the class separability power of feature combinations with more than three features. The overlapping of the members of the two classes (<xref ref-type="fig" rid="fig4-1094342012464253">Figure 4</xref>(a) and (b)), is indicative of the poor results achieved by the two suboptimal methods.</p>
<p>The optimal search technique, for locating an optimal combination of features that would provide the highest possible classification accuracy, was realized by, first, forming all possible combinations within the total number of available features. However, there is the risk of overfitting, i.e. using a large number of features to design the classifier that would provide unrealistic high classification accuracies. That would hold only for the particular set of data and the system would probably perform poorly when presented with new ‘unseen’ data. So, a rule of thumb was adopted (<xref ref-type="bibr" rid="bibr16-1094342012464253">Theodoridis and Koutroumbas, 2003</xref>), that of allowing for feature combinations, in the design of the classifier, to form up to about a third of the data in the smallest of the two classes. Since the MS class was the smallest with 19 members, feature combinations of up to 6 features were allowed. The total number of combinations, thus resulting, may be estimated using the formula <inline-formula id="inline-formula2-1094342012464253">
<mml:math id="mml-inline2-1094342012464253">
<mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:mi>n</mml:mi>
<mml:mo stretchy="false">!</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>n</mml:mi>
<mml:mo stretchy="false">−</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo stretchy="false">!</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">!</mml:mo>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
</inline-formula>, where <italic>n</italic> is the number of features (<italic>n</italic> = 40) and<italic> k</italic> is the number of features combined (<italic>k</italic> = 1,2,…,6).  This is an enormous number of combinations (<italic>N</italic> = 4,598,478) and one has to consider that, for each combination, the classifier’s performance has to be evaluated by the LOO method, which requires that the classifier is redesigned as many times as is the number of data in both classes. The time required for such a task was about 2.2 hours on a desktop computer’s CPU, employing sequential processing programming. Such time requirements render cumbersome, if not unrealizable, various experimentation tasks for optimal PR system design, such as the right choice of classification algorithm and fine-tuning of classifier parameters. To speed up and, thus, render feasible the PR system’s design, most processing was transferred onto the desktop computer’s graphics card, and in particular onto the Nvidia’s GPU 14 multi-processors, adopting parallel processing methodology, i.e. breaking down the workload into subtasks, which were executed in parallel on the GPU’s processors. Such an undertaking reduced the total processing time down to about 4 minutes and rendered possible the optimal design of the PR system. </p>
<p>All time measurements concern the training part of the PR system. In this context, the time required to design the classifier and evaluate its accuracy for every given feature combination by the CPU is compared against the respective time required by the GPU. The latter also included the time required for all necessary GPU memory initializations as well as non-overlapping transfers between host and GPU memory. Nevertheless, in both cases, the extra time required for other activities, i.e. loading and splitting the dataset, initializing variables and pointer arrays, saving or printing the results, is not measured since it is infinitesimal compared with the computationally demanding and therefore time-consuming training task. In the particular task of exhaustively searching all possible feature combinations of up to 6 from a pool of 40 features, the entire application, running on a single CPU core, took 8098.6 seconds, of which 8098.1 seconds was the time required for the training task alone (i.e. more than 99.99% of the total execution time). That constituted the parallelizable region. Thus, the time (0.5 seconds) required for other activities running in sequence was considered insignificant. Consequently, when the same task was executed on the GPU, 99.99% of the application benefitted from the parallel execution resulting in 250 seconds for training (including 0.7 seconds for memory operations between the host and GPU device) and 0.5 seconds required for all other activities running in sequence by the CPU. </p>
<p>However, in a more demanding future scenario, where the number of our patients has tripled (153 cases) and the training task of searching exhaustively for combinations of up to 20 features is plausible, without overfitting issues, the proposed GPU-based system may be migrated, without further code optimization, to a later GPU architecture such as the FERMI (GEFORCE 580GTX), achieving 265 times speed-up, mainly benefiting from the L1/L2 caching mechanism. Specifically, this task takes only 99 seconds on a 580GTX while it requires 7.3 hours on a single core of our CPU and 1.9 hours employing all four CPU cores. <xref ref-type="fig" rid="fig5-1094342012464253">Figure 5</xref> illustrates training times achieved by the host CPU (single and multi-core) and the GPUs (8800GT and 580GTX) against the number of patterns included in the dataset.</p>
<fig id="fig5-1094342012464253" position="float">
<label>Figure 5.</label>
<caption>
<p>Comparative assessment of CPU (single and multi-core) and GPUs (8800GT and 580GTX) against the number of patterns in the dataset, for the task of classifier training with up to 20 feature combinations from a pool of 20 features.</p>
</caption>
<graphic xlink:href="10.1177_1094342012464253-fig5.tif"/>
</fig>
<p>Having such a technology at our disposal, a number of experimentations were made plausible. Regarding the choice of the classifier, a number of classification algorithms were considered as to (a) their robustness, i.e. operational consistency when presented to different data, (b) simplicity in the design, (c) speed of training and (d) classification accuracy achieved. The PNN displayed an overall best behaviour amongst the ‘textbook’ commonly available algorithms <italic>k</italic>-nearest neighbour, linear discriminant analysis, and nonlinear Bayesian and the more sophisticated support vector machine (SVM) (<xref ref-type="bibr" rid="bibr8-1094342012464253">Kecman, 2001</xref>). The GPU technology adopted also made the fine tuning of the PNN’s parameters possible, such as the parameter <italic>σ</italic> in relation (2), which was varied between values 0.1 and 0.9, each time checking the overall system accuracy, and finally fixing its value to <italic>σ</italic> = 0.2, as it provided the highest overall PR system accuracy. </p>
<p>
<xref ref-type="table" rid="table2-1094342012464253">Table 2</xref> shows the highest accuracy of the PR system in discriminating mIS from MS cases. This result was achieved by designing the PNN classifier with six textural features (see <xref ref-type="table" rid="table1-1094342012464253">Table 1</xref>). Features were the ASM (average (ASM<sup>a</sup>) and range (ASM<sup>r</sup>) ), which measures image homogeneity, sum of entropy (average and range), which indicates lack of order in pixel intensities, run percentage (range) from the run length matrices, related to precedence of pixels that have the same grey tone and the variance (range) associated with spread of pixel intensities. The ASM<sup>a</sup> and VAR<sup>r</sup> were also found to have significant statistical differences between the two classes. By considering the box-plots of <xref ref-type="fig" rid="fig3-1094342012464253">Figure 3</xref>, it may be concluded that the MS lesions, as compared with the mIS lesions, were smoother (higher ASM<sup>a</sup> values, or more homogeneous) in textural composition. This is also in accordance with the lower values attained by the sum entropy feature for the MS, which indicates that the degree of randomness in MS lesions is lower. However, when considering the VAR<sup>r</sup> textural feature, the MS grey-level structure varied more (higher VAR<sup>r</sup> values), from MS lesion to MS lesion as compared with the mIS lesions. So, in conclusion, the MS lesions appeared smoother than the mIS lesions but with greater variation in the textural composition from lesion to lesion. The latter may be attributed to processes such as the degree of demyelination and inflammation in MS that affects the MR signal (<xref ref-type="bibr" rid="bibr11-1094342012464253">Mathias et al., 1999</xref>; <xref ref-type="bibr" rid="bibr15-1094342012464253">Theocharakis et al., 2009</xref>). <xref ref-type="fig" rid="fig4-1094342012464253">Figure 4</xref>(c) shows the least-squares transformed diagram of the members of the two classes. As it can be observed (from the lack of significant class overlap), the feature combination that provided the highest classification accuracy has achieved a good class separation. These results were only plausible by the employment of the parallel processing capabilities of the GPU processors. As compared with our previous study (<xref ref-type="bibr" rid="bibr15-1094342012464253">Theocharakis et al., 2009</xref>), the partial and overall accuracies achieved are now elevated, mostly due to the capabilities offered by the GPU technology employed; more textural features could be searched (40 features in the present against 23 in our previous study) by examining in realistic processing times all possible (up to 6) features combinations exhaustively. In addition, due to the speed of execution, classifier design parameters could be easily modified and tested on our data, thus assisting in the optimal system design, and the ECV method could now be evaluated in bearable processing times.</p>
<p>To get a realistic estimation of the PR system’s precision on ‘unseen’ data, the ECV method was employed. It has been claimed (<xref ref-type="bibr" rid="bibr2-1094342012464253">Ambroise and McLachlan, 2002</xref>) that the optimal design method, using the LOO evaluation method, provides an ‘optimistically’ biased estimate. On the other hand, the ECV gives a generalization of the PR system as to how it would perform if designed and placed at a clinical environment to be used as a secondary opinion tool. However, the computational burden was multiplied, since the training and evaluation cycle had to be performed repeatedly. This, however, could be realized only under the GPU technology adopted, requiring about 42 minutes for the 10-fold ECV process to be completed. As may be concluded from the results shown in <xref ref-type="table" rid="table3-1094342012464253">Table 3</xref>, partial and overall mean accuracies were well balanced at about 80%. Judging from the results obtained, it is not unreasonable to state that the proposed system may provide a useful second opinion diagnostic tool, that it can be trusted with an 80% confidence in discriminating new cases either with MS or mIS lesions. </p>
<p>Another virtue of speeding up the design of the PR system by the GPU technology adopted is that the PR system can be re-designed on site, when new verified data, either MS or mIS  cases, are added in its depository. In this manner, the system’s accuracy and reliability may be improved, since a larger set of variants of the specific diseases would be incorporated in its design. However, on-site re-training requires that reasonable numbers of verified data have been properly collected and documented, which is a relatively lengthy process. Thus, re-training should not have to be performed frequently, so as to present an annoying disturbance in the routine of a clinical laboratory. </p>
<p>In conclusion, a pattern recognition system has been designed to discriminate with reasonable accuracy MS from mIS cases based on the PNN classifier and on textural features from regions of interest of brain MRI images. Our findings revealed differences in imaged textural structures between MS and mIS lesions.  Successful system design could only be achieved by exploiting the high processing speed and parallel processing capabilities of a commercial GPU. The proposed system can be employed in a clinical environment, as a second opinion tool with 80% confidence to new ‘unseen’ data, and its performance may be continuously improved by redesigning it, on site, with additional verified data.  </p>
</sec>
</body>
<back>
<fn-group>
<fn fn-type="financial-disclosure" id="fn1-1094342012464253">
<label>Funding</label>
<p>This research received no specific grant from any funding agency in the public, commercial, or not-for-profit sectors. </p>
</fn>
</fn-group>
<ref-list>
<title>References</title>
<ref id="bibr1-1094342012464253">
<citation citation-type="book">
<person-group person-group-type="author">
<name>
<surname>Ahmed</surname>
<given-names>N</given-names>
</name>
<name>
<surname>Rao</surname>
<given-names>KR</given-names>
</name>
</person-group> (<year>1975</year>) <source>Orthogonal Transforms for Digital Signal Processing</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>Springer-Verlag</publisher-name>.</citation>
</ref>
<ref id="bibr2-1094342012464253">
<citation citation-type="journal">
<person-group person-group-type="author">
<name>
<surname>Ambroise</surname>
<given-names>C</given-names>
</name>
<name>
<surname>McLachlan</surname>
<given-names>GJ</given-names>
</name>
</person-group> (<year>2002</year>) <article-title>Selection bias in gene extraction on the basis of microarray gene-expression data</article-title>. <source>Proceedings of the National Academy of Sciences of the U S A</source> <volume>99</volume>: <fpage>6562</fpage>–<lpage>6566</lpage>.</citation>
</ref>
<ref id="bibr3-1094342012464253">
<citation citation-type="journal">
<person-group person-group-type="author">
<name>
<surname>Bot</surname>
<given-names>JC</given-names>
</name>
<name>
<surname>Barkhof</surname>
<given-names>F</given-names>
</name>
<name>
<surname>Lycklama a Nijeholt</surname>
<given-names>G</given-names>
</name>
<etal/>
</person-group>. (<year>2002</year>) <article-title>Differentiation of multiple sclerosis from other inflammatory disorders and cerebrovascular disease: value of spinal MR imaging</article-title>. <source>Radiology</source> <volume>223</volume>: <fpage>46</fpage>–<lpage>56</lpage>.</citation>
</ref>
<ref id="bibr4-1094342012464253">
<citation citation-type="journal">
<person-group person-group-type="author">
<name>
<surname>Charil</surname>
<given-names>A</given-names>
</name>
<name>
<surname>Yousry</surname>
<given-names>TA</given-names>
</name>
<name>
<surname>Rovaris</surname>
<given-names>M</given-names>
</name>
<etal/>
</person-group>. (<year>2006</year>) <article-title>MRI and the diagnosis of multiple sclerosis: expanding the concept of “no better explanation”</article-title>. <source>The Lancet Neurology</source> <volume>5</volume>: <fpage>841</fpage>–<lpage>852</lpage>.</citation>
</ref>
<ref id="bibr5-1094342012464253">
<citation citation-type="journal">
<person-group person-group-type="author">
<name>
<surname>Galloway</surname>
<given-names>MM</given-names>
</name>
</person-group> (<year>1975</year>) <article-title>Texture analysis using gray-level run lengths</article-title>. <source>Computer Graphics and Image Processing</source> <volume>4</volume>: <fpage>172</fpage>–<lpage>179</lpage>.</citation>
</ref>
<ref id="bibr6-1094342012464253">
<citation citation-type="journal">
<person-group person-group-type="author">
<name>
<surname>Haralick</surname>
<given-names>RM</given-names>
</name>
<name>
<surname>Shanmugam</surname>
<given-names>K</given-names>
</name>
<name>
<surname>Dinstein</surname>
<given-names>IH</given-names>
</name>
</person-group> (<year>1973</year>) <article-title>Textural Features for Image Classification</article-title>. <source>IEEE Transactions on Systems, Man, and Cybernetics</source> <volume>3</volume>: <fpage>610</fpage>–<lpage>621</lpage>.</citation>
</ref>
<ref id="bibr7-1094342012464253">
<citation citation-type="journal">
<person-group person-group-type="author">
<name>
<surname>Hoque</surname>
<given-names>R</given-names>
</name>
<name>
<surname>Ledbetter</surname>
<given-names>C</given-names>
</name>
<name>
<surname>Gonzalez-Toledo</surname>
<given-names>E</given-names>
</name>
<etal/>
</person-group>. (<year>2007</year>) <article-title>The role of quantitative neuroimaging indices in the differentiation of ischemia from demyelination: an analytical study with case presentation</article-title>. <source>International Review of Neurobiology</source> <volume>79</volume>: <fpage>491</fpage>–<lpage>519</lpage>.</citation>
</ref>
<ref id="bibr8-1094342012464253">
<citation citation-type="book">
<person-group person-group-type="author">
<name>
<surname>Kecman</surname>
<given-names>V</given-names>
</name>
</person-group> (<year>2001</year>) <source>Learning and soft computing: support vector machines, neural networks, and fuzzy logic models</source>. <publisher-loc>Cambridge, MA</publisher-loc>: <publisher-name>The MIT Press</publisher-name>.</citation>
</ref>
<ref id="bibr9-1094342012464253">
<citation citation-type="book">
<person-group person-group-type="author">
<name>
<surname>Kirk</surname>
<given-names>DB</given-names>
</name>
<name>
<surname>Hwu</surname>
<given-names>W-mW</given-names>
</name>
</person-group> (<year>2010</year>) <source>Programming Massively Parallel Processors A Hands-on Approach</source>. <publisher-loc>Amsterdam</publisher-loc>: <publisher-name>Morgan Kaufmann</publisher-name>.</citation>
</ref>
<ref id="bibr10-1094342012464253">
<citation citation-type="journal">
<person-group person-group-type="author">
<name>
<surname>Lou</surname>
<given-names>X</given-names>
</name>
<name>
<surname>Jiang</surname>
<given-names>W</given-names>
</name>
<name>
<surname>Ma</surname>
<given-names>L</given-names>
</name>
<etal/>
</person-group>. (<year>2009</year>) <article-title>Lower fractional anisotropy at the anterior body of the normal-appearing corpus callosum in multiple sclerosis versus symptomatic carotid occlusion</article-title>. <source>Neuroradiology</source> <volume>51</volume>: <fpage>557</fpage>–<lpage>561</lpage>.</citation>
</ref>
<ref id="bibr11-1094342012464253">
<citation citation-type="journal">
<person-group person-group-type="author">
<name>
<surname>Mathias</surname>
<given-names>JM</given-names>
</name>
<name>
<surname>Tofts</surname>
<given-names>PS</given-names>
</name>
<name>
<surname>Losseff</surname>
<given-names>NA</given-names>
</name>
</person-group> (<year>1999</year>) <article-title>Texture analysis of spinal cord pathology in multiple sclerosis</article-title>. <source>Magnetic Resonance in Medicine</source> <volume>42</volume>: <fpage>929</fpage>–<lpage>935</lpage>.</citation>
</ref>
<ref id="bibr12-1094342012464253">
<citation citation-type="journal">
<person-group person-group-type="author">
<name>
<surname>Montalban</surname>
<given-names>X</given-names>
</name>
<name>
<surname>Tintore</surname>
<given-names>M</given-names>
</name>
<name>
<surname>Swanton</surname>
<given-names>J</given-names>
</name>
<etal/>
</person-group>. (<year>2010</year>) <article-title>MRI criteria for MS in patients with clinically isolated syndromes</article-title>. <source>Neurology</source> <volume>74</volume>: <fpage>427</fpage>–<lpage>434</lpage>.</citation>
</ref>
<ref id="bibr13-1094342012464253">
<citation citation-type="journal">
<person-group person-group-type="author">
<name>
<surname>Sidiropoulos</surname>
<given-names>K</given-names>
</name>
<name>
<surname>Glotsos</surname>
<given-names>D</given-names>
</name>
<name>
<surname>Kostopoulos</surname>
<given-names>S</given-names>
</name>
<etal/>
</person-group>. (<year>2012</year>) <article-title>Real time decision support system for diagnosis of rare cancers, trained in parallel, on a graphics processing unit</article-title>. <source>Computers in Biology and Medicine</source> <volume>42</volume>: <fpage>376</fpage>–<lpage>386</lpage>.</citation>
</ref>
<ref id="bibr14-1094342012464253">
<citation citation-type="journal">
<person-group person-group-type="author">
<name>
<surname>Specht</surname>
<given-names>DF</given-names>
</name>
</person-group> (<year>1990</year>) <article-title>Probabilistic neural networks</article-title>. <source>Neural Networks</source> <volume>3</volume>: <fpage>109</fpage>–<lpage>118</lpage>.</citation>
</ref>
<ref id="bibr15-1094342012464253">
<citation citation-type="journal">
<person-group person-group-type="author">
<name>
<surname>Theocharakis</surname>
<given-names>P</given-names>
</name>
<name>
<surname>Glotsos</surname>
<given-names>D</given-names>
</name>
<name>
<surname>Kalatzis</surname>
<given-names>I</given-names>
</name>
<etal/>
</person-group>. (<year>2009</year>) <article-title>Pattern recognition system for the discrimination of multiple sclerosis from cerebral microangiopathy lesions based on texture analysis of magnetic resonance images</article-title>. <source>Magnetic Resonance Imaging</source> <volume>27</volume>: <fpage>417</fpage>–<lpage>422</lpage>.</citation>
</ref>
<ref id="bibr16-1094342012464253">
<citation citation-type="book">
<person-group person-group-type="author">
<name>
<surname>Theodoridis</surname>
<given-names>S</given-names>
</name>
<name>
<surname>Koutroumbas</surname>
<given-names>K</given-names>
</name>
</person-group> (<year>2003</year>) <source>Pattern Recognition</source>. <publisher-loc>San Diego, CA</publisher-loc>: <publisher-name>Elsevier</publisher-name>.</citation>
</ref>
<ref id="bibr17-1094342012464253">
<citation citation-type="journal">
<person-group person-group-type="author">
<name>
<surname>Trojano</surname>
<given-names>M</given-names>
</name>
</person-group> (<year>2011</year>) <article-title>Multiple sclerosis: the evolving diagnostic criteria for multiple sclerosis</article-title>. <source>Nature Reviews Neurology</source> <volume>7</volume>: <fpage>251</fpage>–<lpage>252</lpage>.</citation>
</ref>
<ref id="bibr18-1094342012464253">
<citation citation-type="journal">
<person-group person-group-type="author">
<name>
<surname>Yu</surname>
<given-names>O</given-names>
</name>
<name>
<surname>Mauss</surname>
<given-names>Y</given-names>
</name>
<name>
<surname>Zollner</surname>
<given-names>G</given-names>
</name>
<etal/>
</person-group>. (<year>1999</year>) <article-title>Distinct patterns of active and non-active plaques using texture analysis on brain NMR images in multiple sclerosis patients: preliminary results</article-title>. <source>Magnetic Resonance Imaging</source> <volume>17</volume>: <fpage>1261</fpage>–<lpage>1267</lpage>.</citation>
</ref>
<ref id="bibr19-1094342012464253">
<citation citation-type="journal">
<person-group person-group-type="author">
<name>
<surname>Zhang</surname>
<given-names>Y</given-names>
</name>
</person-group> (<year>2012</year>) <article-title>MRI texture analysis in multiple sclerosis</article-title>. <source>International Journal of Biomedical Imaging</source>, <year>in press</year>.</citation>
</ref>
</ref-list>
</back>
</article>