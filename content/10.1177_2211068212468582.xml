<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v2.3 20070202//EN" "journalpublishing.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">JLA</journal-id>
<journal-id journal-id-type="hwp">spjla</journal-id>
<journal-title>Journal of Laboratory Automation</journal-title>
<issn pub-type="ppub">2211-0682</issn>
<issn pub-type="epub">1540-2452</issn>
<publisher>
<publisher-name>SAGE Publications</publisher-name>
<publisher-loc>Sage CA: Los Angeles, CA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1177/2211068212468582</article-id>
<article-id pub-id-type="publisher-id">10.1177_2211068212468582</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Original Reports</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Automated Rotation Rate Tracking of Pigmented Cells by a Customized Block-Matching Algorithm</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<name><surname>Zhang</surname><given-names>Guanglie</given-names></name>
<xref ref-type="aff" rid="aff1-2211068212468582">1</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Ouyang</surname><given-names>Mengxing</given-names></name>
<xref ref-type="aff" rid="aff2-2211068212468582">2</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Mai</surname><given-names>John</given-names></name>
<xref ref-type="aff" rid="aff1-2211068212468582">1</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name><surname>Li</surname><given-names>Wen Jung</given-names></name>
<xref ref-type="aff" rid="aff1-2211068212468582">1</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Liu</surname><given-names>Wing Keung</given-names></name>
<xref ref-type="aff" rid="aff2-2211068212468582">2</xref>
</contrib>
</contrib-group>
<aff id="aff1-2211068212468582"><label>1</label>City University of Hong Kong</aff>
<aff id="aff2-2211068212468582"><label>2</label>The Chinese University of Hong Kong</aff>
<author-notes>
<corresp id="corresp1-2211068212468582">Guanglie Zhang, City University of Hong Kong, Dept. MBE, Kowloon Tong, Hong Kong (for vision-based cell rotation tracking algorithms) Email: <email>gl.zhang@cityu.edu.hk</email></corresp>
<corresp id="corresp2-2211068212468582">Wen J. Li, City University of Hong Kong, Dept. MBE, Kowloon Tong, Hong Kong (for electrokinetics-based cell manipulation and identification). Email: <email>wenjli@cityu.edu.hk</email></corresp>
</author-notes>
<pub-date pub-type="epub-ppub">
<month>4</month>
<year>2013</year>
</pub-date>
<volume>18</volume>
<issue>2</issue>
<fpage>161</fpage>
<lpage>170</lpage>
<history>
<date date-type="received">
<day>16</day>
<month>7</month>
<year>2012</year>
</date>
</history>
<permissions>
<copyright-statement>© 2012 Society for Laboratory Automation and Screening</copyright-statement>
<copyright-year>2012</copyright-year>
<copyright-holder content-type="society">Society for Laboratory Automation and Screening</copyright-holder>
</permissions>
<abstract>
<p>This article describes an automated rotation rate tracking algorithm for pigmented cells that undergo rotation in a dielectrophoretic (DEP) force field. In a completely automated process, we preprocess each frame of a video sequence, then analyze the sequence frame by frame using a rotating-circle template with a block-matching algorithm, and finally estimate the rotation rate of the pigmented cells using a pixel-patch correlation. The algorithm has been demonstrated to accurately calculate the DEP-induced rotation rate of the cell up to 250 rpm. Cell rotation rates in various DEP force fields (i.e., by varying the applied voltages, frequencies, and waveforms to induce different force fields) were analyzed using this automated algorithm and reported in this article. Most importantly, the algorithm is accurate even when the cells have simultaneous translational and rotational motions across the video image sequence. Also, the algorithm is capable of tracking changes in rotation speed over a long period of time (90 s) by stably analyzing a massive data set of video image frames.</p>
</abstract>
<kwd-group>
<kwd>informatics and software</kwd>
<kwd>automated biology</kwd>
<kwd>data analysis</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<p>Cell manipulation is a fundamental process in many areas of biology and biotechnology,<sup><xref ref-type="bibr" rid="bibr1-2211068212468582">1</xref></sup> such as cell-based screenings for basic science, surface immunophenotyping for diagnosis, studies of how cell morphology affects differentiation, and detecting pathogenic bacteria in food supplies.</p>
<p>Cell-sorting techniques are used to separate cells according to their properties. There are many cell-sorting techniques, including panning, fluorescence-activated cell sorting, magnetic cell sorting, and recent developments based on dielectrophoresis (DEP) to move cells in microfluidic devices.<sup><xref ref-type="bibr" rid="bibr2-2211068212468582">2</xref>,<xref ref-type="bibr" rid="bibr3-2211068212468582">3</xref></sup> In this article, we present an automated method to track and quantify the rotation of pigmented cells with a diameter on the order of 10 µm. Accurate analysis of cell rotation can be potentially used as a sorting criterion for cell identification and separation, based on our group’s recent discovery of the self-induced rotational motion of pigmented biological cells in a dielectrophoretic force field.<sup><xref ref-type="bibr" rid="bibr4-2211068212468582">4</xref></sup></p>
<p>The generation of a DEP force from a nonuniform electric field is a well-known phenomenon and is briefly described below. When a polarized object is exposed to a nonuniform electric field, a dipole moment is induced, and the object will move toward the maxima or the minima of the electric field depending on its relative polarizability with respect to the medium.<sup><xref ref-type="bibr" rid="bibr5-2211068212468582">5</xref></sup> According to the theory of electromagnetism, the DEP force acting on a cell suspended in a fluid is given by <xref ref-type="disp-formula" rid="disp-formula1-2211068212468582">equation 1</xref>:</p>
<p><disp-formula id="disp-formula1-2211068212468582">
<mml:math display="block" id="math1-2211068212468582">
<mml:mrow>
<mml:msub>
<mml:mover accent="true">
<mml:mi>F</mml:mi>
<mml:mo>→</mml:mo>
</mml:mover>
<mml:mrow>
<mml:mi>D</mml:mi>
<mml:mi>E</mml:mi>
<mml:mi>P</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mn>2</mml:mn>
<mml:mi>π</mml:mi>
<mml:msup>
<mml:mi>R</mml:mi>
<mml:mn>3</mml:mn>
</mml:msup>
<mml:msub>
<mml:mi>ε</mml:mi>
<mml:mi>m</mml:mi>
</mml:msub>
<mml:mi>K</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>ω</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mover accent="true">
<mml:mo>∇</mml:mo>
<mml:mo>→</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:msubsup>
<mml:mi>E</mml:mi>
<mml:mrow>
<mml:mi>r</mml:mi>
<mml:mi>m</mml:mi>
<mml:mi>s</mml:mi>
</mml:mrow>
<mml:mn>2</mml:mn>
</mml:msubsup>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>,</mml:mo>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula1-2211068212468582" xlink:href="10.1177_2211068212468582-eq1.tif"/>
</disp-formula></p>
<p>where <italic>R</italic> is the radius of the cell, <italic>E<sub>rms</sub></italic> is the root mean square (rms) value of the electric field, and <italic>K</italic>(ω) is the real part of the Clausius-Mosotti (CM) factor. The CM factor is related to the particle dielectric constant and indicates the relative magnitude and direction of the force experienced by the particle and is given by <xref ref-type="disp-formula" rid="disp-formula2-2211068212468582">equation 2</xref>:</p>
<p><disp-formula id="disp-formula2-2211068212468582">
<mml:math display="block" id="math2-2211068212468582">
<mml:mrow>
<mml:msub>
<mml:mi>f</mml:mi>
<mml:mrow>
<mml:mi>C</mml:mi>
<mml:mi>M</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:msubsup>
<mml:mi>ε</mml:mi>
<mml:mi>p</mml:mi>
<mml:mo>*</mml:mo>
</mml:msubsup>
<mml:mo>−</mml:mo>
<mml:msubsup>
<mml:mi>ε</mml:mi>
<mml:mi>m</mml:mi>
<mml:mo>*</mml:mo>
</mml:msubsup>
</mml:mrow>
<mml:mrow>
<mml:msubsup>
<mml:mi>ε</mml:mi>
<mml:mi>p</mml:mi>
<mml:mo>*</mml:mo>
</mml:msubsup>
<mml:mo>+</mml:mo>
<mml:mn>2</mml:mn>
<mml:msubsup>
<mml:mi>ε</mml:mi>
<mml:mi>m</mml:mi>
<mml:mo>*</mml:mo>
</mml:msubsup>
</mml:mrow>
</mml:mfrac>
<mml:mo>,</mml:mo>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula2-2211068212468582" xlink:href="10.1177_2211068212468582-eq2.tif"/>
</disp-formula></p>
<p>where ϵ<sub><italic>p</italic></sub>* and ϵ<sub><italic>m</italic></sub>* are the complex permittivities of the cell and the medium. ϵ* is defined as in <xref ref-type="disp-formula" rid="disp-formula3-2211068212468582">equation 3</xref>:</p>
<p><disp-formula id="disp-formula3-2211068212468582">
<mml:math display="block" id="math3-2211068212468582">
<mml:mrow>
<mml:msup>
<mml:mi>ε</mml:mi>
<mml:mo>*</mml:mo>
</mml:msup>
<mml:mo>=</mml:mo>
<mml:mi>ε</mml:mi>
<mml:mo>−</mml:mo>
<mml:mi>j</mml:mi>
<mml:mfrac>
<mml:mi>σ</mml:mi>
<mml:mi>ω</mml:mi>
</mml:mfrac>
<mml:mo>,</mml:mo>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula3-2211068212468582" xlink:href="10.1177_2211068212468582-eq3.tif"/>
</disp-formula></p>
<p>where ϵ and σ refer to the permittivity and the conductivity, respectively.</p>
<p>In practice, during biological experiments, cells may not be treated as isolated, single particles. Usually, there are large numbers of cells in a given sequence of microscopic video frames that are captured and stored for cell-motion analyses. Any manual method used to ascertain the cell rotation speed for cell sorting would be slow, difficult, and inaccurate. Therefore, we have developed an automated procedure to analyze microscopic image sequences using algorithms to estimate cell rotation speed. We envision that this procedure will eventually enable the development of a fully automated system for identification, manipulation, and sorting of cells based on the self-induced rotation phenomenon of specific cells. The fabrication process for the microfluidic chips and the DEP experimental setup are detailed in an earlier article.<sup><xref ref-type="bibr" rid="bibr4-2211068212468582">4</xref></sup> This article will present the DEP-based cell rotation experiments along with details of the rotation speed estimation algorithm with translation motion compensation.</p>
<sec id="section1-2211068212468582">
<title>Cell Rotation Experiments</title>
<sec id="section2-2211068212468582">
<title>Cell Behavior in a DEP Field</title>
<p>Cells, similar to other micro- and nano-scale entities such as carbon nanotubes, carbon nanoparticles, Au nanoparticles, and microbeads, mainly experience two types of forces in an appropriately applied AC electric field: a positive DEP force (p-DEP), that is, an attractive force, and a negative DEP force (n-DEP), that is, a repelling force. Based on the distinctive electrical phenotypes of different cells, it is possible that by applying the same DEP field, one type of cell would experience a n-DEP whereas the other type of cells experiences a p-DEP force. The factors that would affect the cell response in the DEP field include (1) the physical properties of the cells such as shape, size, and mass distribution of the cells; (2) the dielectric property of the cells; and (3) the dielectric property of the medium.</p>
<p><xref ref-type="fig" rid="fig1-2211068212468582"><bold>Figure 1</bold></xref> shows the response of typical cells (B16 cells) under a DEP force in a microchannel. In <xref ref-type="fig" rid="fig1-2211068212468582"><bold>Figure 1a</bold></xref>, the cells are experiencing a p-DEP force and are attracted to the microelectrodes. Pearl chains are formed between the tips of electrodes. In <xref ref-type="fig" rid="fig1-2211068212468582"><bold>Figure 1b</bold></xref>, the cells are experiencing an n-DEP force and are repelled from the electrodes. The DEP parameters applied during the experiment are 16 V voltage and 22 MHz frequency. Under these conditions, the cells typically experienced a p-DEP force and are attracted to the electrodes. Then, when the voltage is fixed and the frequency is gradually decreased, the cells become disconnected with the Au electrodes.</p>
<fig id="fig1-2211068212468582" position="float">
<label>Figure 1.</label>
<caption>
<p>Cell reaction in the presence of dielectrophoresis forces: (<bold>A</bold>) positive DEP force, (B) negative DEP force.</p>
</caption>
<graphic xlink:href="10.1177_2211068212468582-fig1.tif"/></fig>
<sec id="section3-2211068212468582">
<title>DEP parameters</title>
<p>Self-rotation is observed only when the cells are experiencing a p-DEP force, as is applied between the Au microelectrodes. A voltage larger than 5 V and a frequency higher than 10 M provide a sufficient DEP force for cell rotation.</p>
</sec>
<sec id="section4-2211068212468582">
<title>Geometry and dimensions of the micro-electrodes</title>
<p>Several patterns of electrodes have been used in attempts to induce rotation of cells, including a four-probe orthogonal electrode pattern (as shown in <xref ref-type="fig" rid="fig1-2211068212468582"><bold>Fig. 1</bold></xref>), circular, rectangular, and interdigitated. Results showed that even with the same DEP parameters, these patterns do not deliver the same results, as no self-rotation of the pigmented cells is observed in all tested patterns except for the four-probe orthogonal pattern. In addition, we also tried the same four-probe orthogonal electrode pattern with electrode widths of 150 µm, 40 µm, and 20 µm. Theoretically, the shrinkage in electrode size should provide a larger DEP force, which could potentially accelerate the self-rotation process. However, the experimental results failed to follow this expectation, as the self-rotation of the pigment cells does not exhibit any dramatic improvement in terms of either rotation speed or the total number of cells that undergo self-rotation motion. On the contrary, a probe electrode with a 150 µm width shows better results for the observation of this phenomenon. The probable reason is that when a sufficient DEP force is applied, the larger surface area of a larger electrode would attract a larger number of cells. This induces the possibility of self-rotation of more cells without compromising the rotation speed. In other words, because the diameter of the pigment cells was ~10 to 15 µm, therefore, for smaller electrodes, the electrode surface area may not have a sufficient force field to induce cell rotation. Also, for 40 µm and 20 µm electrodes, we observed only alignment of cells between the electrodes but rarely any rotation.</p>
<p>On the other hand, for nonpigmented cells, which are not as susceptible to the DEP force–induced self-rotation, the electrodes with smaller dimensions exhibit an improved response to the DEP force in terms of cell alignment and attraction. For instance, HaCaT cells (nonpigment cells) could not be attracted to the 150 µm microelectrodes during DEP manipulation (i.e., no apparent attraction of cells to the electrodes even when a maximum DEP force is applied). However, a cell chain of HaCaT cells could be formed using 40 µm microelectrodes. Therefore, for the cell rotation experiments reported in this article, the dimension of the microelectrodes is 150 µm in width, unless otherwise specified.</p>
</sec>
<sec id="section5-2211068212468582">
<title>Medium in the microchannel</title>
<p>Both the viscosity and the dielectric property of the solution are critical for cell manipulation. Ideally, the permittivity of the solution should be as small as possible in order to create a distinct difference between the cell itself and the surrounding solution. Also, the viscosity of the solution should be carefully controlled as the cell movement and rotation could slow down or even completely stop if the solution is too viscous. The solution used for our experiments was 0.2 M sucrose (i.e., 6.84% sucrose solution). Based on prior literature,<sup><xref ref-type="bibr" rid="bibr6-2211068212468582">6</xref></sup> this solution’s estimated conductivity is ~1 mS/m, and the kinematic viscosity at 20 °C is ~1.2 × 10<sup>−6</sup> m<sup>2</sup>/s.</p>
</sec>
</sec>
<sec id="section6-2211068212468582">
<title>Pigmented Cells versus Nonpigmented Cells</title>
<p>From our experiments, pigmented cells are more susceptible to the DEP force in terms of alignment and attraction to the electrodes; that is, pigmented cells are able to form a pearl chain of cells between the microelectrodes faster than the nonpigmented cells. Also, as aforementioned, stable and repeatable self-rotation is observed only in pigmented cells. For the other three types of nonpigmented cells, including two types of skin cells (keratinocyte and HaCaT) and one type of lung cancer cells (A549), the self-rotation phenomenon only occurs occasionally. For instance, self-rotation in a small number of A549 cells is observed. However, it lasts for only a few seconds and quickly stops after the cells reach a stable position. Also, the rotation speed is much slower when compared with the pigmented cells. From our observations, the self-rotation of nonpigmented cells may occur, but the duration is short and the rotation is unstable, unrepeatable, and highly susceptible to the flow rate compared with the rotation of pigmented cells.</p>
<p>Although we are still working on a solid theoretical explanation for this self-rotation phenomenon, we highly suspect that it is related to the semiconductive electrical properties of the melanin located inside the pigmented cells. Typically, cells in the fluids are modeled as a single or multishell sphere with an evenly distributed dielectric property on the cell surface. It is possible that the existence of the melanin would break this balance and create an unevenly distributed model, with the part containing melanin exhibiting a different electrical property than the rest of the cells. Therefore, this imbalance could lead to the self-rotation of the cells in an AC electrical field, as observed.</p>
</sec>
<sec id="section7-2211068212468582">
<title>Investigation of the Self-rotation Speed of Pigmented Cells</title>
<p>As reported in the previous section, pigmented cells exhibit the cell rotation phenomenon under a sufficient p-DEP force. <xref ref-type="fig" rid="fig2-2211068212468582"><bold>Figure 2</bold></xref> shows a sequence of photos of a single Melan-A cell self-rotating for one revolution, which takes 320 ms. Furthermore, we found that the rotation speed of the cells could be changed by adjusting the DEP parameters; that is, different applied frequencies and voltages result in variations in the rotation speed. Video records of cell rotation are examined frame by frame, and the rotation speeds under different conditions are calculated. The resulting changes in self-rotation speed under different frequencies while the voltage is kept constant at 16 V as well as the rotation speed of the same cell under different voltages while the frequency is kept constant at 22 MHz are shown in <xref ref-type="fig" rid="fig3-2211068212468582"><bold>Figure 3A</bold></xref> and <xref ref-type="fig" rid="fig3-2211068212468582"><bold>B</bold></xref>, respectively. The curves in the figure prove that a higher frequency or a higher voltage leads to a higher rotation speed of up to 150 rpm.</p>
<fig id="fig2-2211068212468582" position="float">
<label>Figure 2.</label>
<caption>
<p>(<bold>A</bold>) Cell reactions in the presence of dielectrophoretic forces. (<bold>B</bold>) Tracked (red rectangle) self-rotation of a Melan-A cell in blue rectangle in (<bold>A</bold>) with the counterclockwise direction for one revolution.</p>
</caption>
<graphic xlink:href="10.1177_2211068212468582-fig2.tif"/></fig>
<fig id="fig3-2211068212468582" position="float">
<label>Figure 3.</label>
<caption>
<p>Self-rotation speed of Melan-A cells using different dielectrophoretic parameters. (<bold>A</bold>) Frequency change. (<bold>B</bold>) Voltage change.</p>
</caption>
<graphic xlink:href="10.1177_2211068212468582-fig3.tif"/></fig>
<p>In addition, we also apply different waveforms (i.e., sine wave, square wave, and triangular wave) of the AC electrical field to the microfluidic chip and analyze the self-rotation speed of the pigmented cells. The results show that cells rotated much faster under a square waveform (~240 rpm) compared with a sine waveform (~130 rpm) or a triangle waveform (~110 rpm). This phenomenon could be explained by the fact that a square wave is composed of an infinite number of harmonics; that is, a fast Fourier transformation of a square wave can be expressed as an infinite series of sinusoidal waves. Comparing a sine wave and a square wave at the same frequency, the latter waveform contains higher-frequency components than the designated frequency of the wave.<sup><xref ref-type="bibr" rid="bibr7-2211068212468582">7</xref></sup> The quantified rotation speed is summarized in <xref ref-type="fig" rid="fig4-2211068212468582"><bold>Figure 4</bold></xref>. This plot also shows that this variation in rotation speed variation is both controllable and repeatable. Also, from our observation, the rotation direction of the cells was random; that is, we have no control of the clockwise or counterclockwise direction of the cell rotation relative to the surface plane (<italic>x-y</italic> plane).</p>
<fig id="fig4-2211068212468582" position="float">
<label>Figure 4.</label>
<caption>
<p>Self-rotation speed of a Melan-A cell under different waveforms.</p>
</caption>
<graphic xlink:href="10.1177_2211068212468582-fig4.tif"/></fig>
</sec>
</sec>
<sec id="section8-2211068212468582">
<title>Automatic Cell-Sorting Algorithm</title>
<p>In order to automatically estimate the cell self-rotation speed for rapid cell sorting, we have developed an algorithm based on the analysis of image sequences. The acquired image sequences are captured by a charge coupled device (CCD)–based microscope system. The cell rotation speed estimation method is divided into three stages, as described below. First, image preprocessing, including noise reduction and contrast adjustment, enhances the performance of the analysis. The noise filtering improves image quality, and a contrast adjustment is performed with histogram equalization enhancing the contrast between the cells and the background. A cell rotation estimation algorithm is used to analyze two basic motion patterns, namely, cell self-rotation about its yaw axes and the rotation with translational motion along the chip surface. In order to estimate the cell rotation speed about the yaw axis accurately, translation compensation is adopted in the algorithms. After this compensation, the cells’ rotation cycles can be counted through a pixel-patch correlation calculation. Summarizing, the cell rotation speed estimation method is split into three stages: image preprocessing, translational motion tracking, and a pixel-patch correlation-based calculation that yields the cell self-rotation speed. <xref ref-type="fig" rid="fig5-2211068212468582"><bold>Figure 5</bold></xref> shows a process flow diagram of the aforementioned algorithm.</p>
<fig id="fig5-2211068212468582" position="float">
<label>Figure 5.</label>
<caption>
<p>Block diagram illustrating the cell rotation estimation algorithm.</p>
</caption>
<graphic xlink:href="10.1177_2211068212468582-fig5.tif"/></fig>
<sec id="section9-2211068212468582">
<title>Image Preprocessing</title>
<p>The cell rotation image sequences are captured by a CCD microscope system. There are several sources of noise in microscope imaging: photon noise, thermal noise, readout noise, and quantization noise.<sup><xref ref-type="bibr" rid="bibr8-2211068212468582">8</xref></sup> Image preprocessing methods with noise reduction and contrast enhancement are the basic methods to improve the performance of later image sequence analysis. Noise reduction improves the fidelity of the original acquired image. After preliminary noise reduction, we then apply contrast enhancement to the image sequences. Image contrast enhancement is applied to images to improve the visibility of melanin in the cells.</p>
<sec id="section10-2211068212468582">
<title>Noise reduction</title>
<p>Noise reduction processing is a fundamental operation in biomedical image-processing applications. Any subsequent operation will benefit from noise reduction processing. The noise level can affect the performance of the image analysis algorithm, especially in separating objects from the background. In a microscope video sequence of a cell, light objects are on a dark background. We could, for example, look for the lowest intensity value in the object and separate the object from the background by searching for all pixels that have an intensity value higher than this threshold value. However, noise has changed the intensities in the background and in the object, so that there are some very high intensities within the background and some very low intensities in the object. Image preprocessing can reduce this noise distribution effect.</p>
<p>One type of noise arises from the camera sensors. In the camera, incoming photons are transformed into an electrical charge by a CCD. However, some electrons are created within the CCD randomly. This randomly distributed noise is added to the signal. Because the background noise should be homogeneous with a random distribution of intensities, a Gaussian low-pass filter can be used to remove readout noise. The Gaussian filter kernel function is described as follows:</p>
<p><disp-formula id="disp-formula4-2211068212468582">
<mml:math display="block" id="math4-2211068212468582">
<mml:mrow>
<mml:mi>f</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>y</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mn>1</mml:mn>
<mml:mrow>
<mml:mn>2</mml:mn>
<mml:mi>π</mml:mi>
<mml:msup>
<mml:mi>σ</mml:mi>
<mml:mn>2</mml:mn>
</mml:msup>
</mml:mrow>
</mml:mfrac>
<mml:mi>exp</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mo>−</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:msup>
<mml:mi>x</mml:mi>
<mml:mn>2</mml:mn>
</mml:msup>
<mml:mo>+</mml:mo>
<mml:msup>
<mml:mi>y</mml:mi>
<mml:mn>2</mml:mn>
</mml:msup>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
<mml:msup>
<mml:mi>σ</mml:mi>
<mml:mn>2</mml:mn>
</mml:msup>
</mml:mrow>
</mml:mfrac>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>.</mml:mo>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula4-2211068212468582" xlink:href="10.1177_2211068212468582-eq4.tif"/>
</disp-formula></p>
<p>The Gaussian filter can be applied using standard convolution methods with a suitable kernel function. The convolution method is performed to reduce the filtering computation time, because the 2D isotropic Gaussian equation can be separated into two orthogonal components. Therefore, the 2D convolution can be performed by two convoluting operations in two orthogonal directions.</p>
</sec>
<sec id="section11-2211068212468582">
<title>Contrast enhancement</title>
<p>The noise-reduced grayscale image in <xref ref-type="fig" rid="fig6-2211068212468582"><bold>Figure 6A</bold></xref> lacks details because the range of luminance is limited to a narrow band of gray levels, as shown by the image’s histogram in <xref ref-type="fig" rid="fig6-2211068212468582"><bold>Figure 6C</bold></xref>. The image histogram simply plots the frequency at which each gray level occurs from black to white. It shows that most of the gray levels in the image are grouped between about 90 and 240. Image contrast enhancement is required to produce a clear image through a redistribution of these brightness intensity values.</p>
<fig id="fig6-2211068212468582" position="float">
<label>Figure 6.</label>
<caption>
<p>Image preprocessing results. (<bold>A</bold>) Original image. (<bold>B</bold>) Image with contrast enhancement. (<bold>C</bold>) Histogram (frequency at each gray level) of the original image. (<bold>D</bold>) Histogram of the contrast-enhanced image.</p>
</caption>
<graphic xlink:href="10.1177_2211068212468582-fig6.tif"/></fig>
<p>In order to enhance the contrast between the cells and the background, a histogram equalization is applied to the image sequences, which enhances the contrast of the grayscale image.<sup><xref ref-type="bibr" rid="bibr9-2211068212468582">9</xref></sup> Histogram equalization is one the most well-known methods for contrast enhancement. This approach is generally useful for images with a poor intensity distribution. Histogram equalization expands the luminance within the image to fill the entire grayscale spectrum. To do this, the cumulative frequencies are calculated within the image. The cumulative frequency of a gray level is defined as the sum of the histogram data. So the equalized histogram keeps the profile of the original histogram, although it is now extended to the entire spectrum. The cumulative frequency graph makes the gray-level frequencies distribute evenly within the image.</p>
<p>Histogram equalization is applied in the following manner. A given grayscale image {<italic>x</italic>} is composed of <italic>L</italic> discrete gray levels, denoted as {<italic>X<sub>i</sub></italic>}, and the probability density function is defined as</p>
<p><disp-formula id="disp-formula5-2211068212468582">
<mml:math display="block" id="math5-2211068212468582">
<mml:mrow>
<mml:mi>p</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>X</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mi>n</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
</mml:mrow>
<mml:mi>n</mml:mi>
</mml:mfrac>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula5-2211068212468582" xlink:href="10.1177_2211068212468582-eq5.tif"/>
</disp-formula></p>
<p>for <italic>i =</italic> 0, 1, . . ., L-1, where <italic>n<sub>i</sub></italic> is the number of times that the level <italic>X<sub>i</sub></italic> appears in the image {<italic>x</italic>}, and <italic>n</italic> is the total number of samples in the image. Based on the probability density function, a cumulative density function <italic>cdf</italic>(<italic>x</italic>) is defined as</p>
<p><disp-formula id="disp-formula6-2211068212468582">
<mml:math display="block" id="math6-2211068212468582">
<mml:mrow>
<mml:mi>c</mml:mi>
<mml:mi>d</mml:mi>
<mml:mi>f</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mstyle displaystyle="true">
<mml:munderover>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>j</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>0</mml:mn>
</mml:mrow>
<mml:mi>k</mml:mi>
</mml:munderover>
<mml:mi>p</mml:mi>
</mml:mstyle>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>X</mml:mi>
<mml:mi>j</mml:mi>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>,</mml:mo>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula6-2211068212468582" xlink:href="10.1177_2211068212468582-eq6.tif"/>
</disp-formula></p>
<p>where <italic>cdf</italic>(<italic>X<sub>L-1</sub></italic>) = 1 by definition. Thus, the corrected pixel value of the grayscale image transform function is based on the <italic>cdf</italic>(<italic>x</italic>) and is expressed as</p>
<p><disp-formula id="disp-formula7-2211068212468582">
<mml:math display="block" id="math7-2211068212468582">
<mml:mrow>
<mml:mi>f</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mi>X</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>X</mml:mi>
<mml:mrow>
<mml:mi>L</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mi>X</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mi>c</mml:mi>
<mml:mi>d</mml:mi>
<mml:mi>f</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula7-2211068212468582" xlink:href="10.1177_2211068212468582-eq7.tif"/></disp-formula></p>
<p>An image that is intensity corrected using a homogeneous histogram equalization has enhanced contrast between the cells and the background. The corrected image is much clearer, and details within the cells are much sharper. The equalized image with the histogram and cumulative frequency graphs is shown in <xref ref-type="fig" rid="fig6-2211068212468582"><bold>Figure 6D</bold></xref>. After noise reduction and contrast enhancement, image qualities are greatly improved and ready for subsequent algorithms, as seen in <xref ref-type="fig" rid="fig6-2211068212468582"><bold>Figure 6B</bold></xref>.</p>
</sec>
</sec>
<sec id="section12-2211068212468582">
<title>Rotation Estimation Algorithms</title>
<p>There are two basic observed motion patterns for a cell: one is self-rotation about its yaw axes, and the other is a translational motion along the chip surface. To estimate cell rotation, translation compensation needs be adopted in the algorithms. After this compensation, the number of cell rotation cycles is counted through a pixel-patch correlation calculation.</p>
<sec id="section13-2211068212468582">
<title>Translational motion tracking</title>
<p>The most popular translational motion compensation method is the block-matching algorithm, which is a block-based motion estimation method. The best matching block is found for a reference block within a search area, and then a motion vector is calculated as the displacement of the best matching block to the position of the current macro-block. This translational motion vector describes the location of the matching block from the previous frame with reference to the position of the target block in the current frame.</p>
<p>Although there is no zooming motion in the sequence of microscope images of the cells in our DEP experiment and the brightness and contrast of the sequences are nearly stable, self-rotation of cells could affect the matching accuracy due to nonoverlapping blocks needed for the general block-matching algorithm.</p>
<p>In order to improve accuracy, we propose using a rotating-circle matching template to replace the nonoverlapping matching block template. <xref ref-type="fig" rid="fig7-2211068212468582"><bold>Figure 7</bold></xref> depicts the rotating-circle matching template generation process. The process involves three stages: (1) converting the original image to a grayscale, (2) producing a binary image using an adaptive thresholding method,<sup><xref ref-type="bibr" rid="bibr10-2211068212468582">10</xref></sup> and (3) estimating the center and radius of the fitted-circle mask. For a rotation over an angle θ, a point <italic>X</italic>(<italic>x, y</italic>) in the original image is mapped onto the point <italic>X</italic>′(<italic>x</italic>′, <italic>y</italic>′) in the resultant image. The relation between the points is</p>
<p><disp-formula id="disp-formula8-2211068212468582">
<mml:math display="block" id="math8-2211068212468582">
<mml:mrow>
<mml:mrow>
<mml:msub>
<mml:msup>
<mml:mi>X</mml:mi>
<mml:mo>′</mml:mo>
</mml:msup>
<mml:mi>θ</mml:mi>
</mml:msub>
</mml:mrow>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo>′</mml:mo>
<mml:mo>,</mml:mo>
<mml:mi>y</mml:mi>
<mml:mo>′</mml:mo>
<mml:mo>,</mml:mo>
<mml:mi>θ</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mi>T</mml:mi>
<mml:mi>θ</mml:mi>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>X</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mi>A</mml:mi>
<mml:mo>⋅</mml:mo>
<mml:mi>X</mml:mi>
<mml:mo>=</mml:mo>
<mml:mi>A</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mtable>
<mml:mtr>
<mml:mtd>
<mml:mi>x</mml:mi>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd>
<mml:mi>y</mml:mi>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>,</mml:mo>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula8-2211068212468582" xlink:href="10.1177_2211068212468582-eq8.tif"/>
</disp-formula></p>
<fig id="fig7-2211068212468582" position="float">
<label>Figure 7.</label>
<caption>
<p>Image processing to generate a rotating-circle matching template. (<bold>A</bold>) Original image. (<bold>B</bold>) Grayscale image. (<bold>C</bold>) Binary. (<bold>D</bold>) Circle mask. (<bold>E</bold>) Rotated mask.</p>
</caption>
<graphic xlink:href="10.1177_2211068212468582-fig7.tif"/></fig>
<p>where <italic>T</italic><sub>θ</sub>(⋅) is a rotation operator and <inline-formula id="inline-formula1-2211068212468582">
<mml:math display="inline" id="math9-2211068212468582">
<mml:mrow>
<mml:mi>A</mml:mi>
<mml:mo>=</mml:mo>
<mml:mrow>
<mml:mo>[</mml:mo>
<mml:mrow>
<mml:mtable>
<mml:mtr>
<mml:mtd>
<mml:mrow>
<mml:mi>cos</mml:mi>
<mml:mi>θ</mml:mi>
</mml:mrow>
</mml:mtd>
<mml:mtd>
<mml:mrow>
<mml:mo>−</mml:mo>
<mml:mi>sin</mml:mi>
<mml:mi>θ</mml:mi>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd>
<mml:mrow>
<mml:mi>sin</mml:mi>
<mml:mi>θ</mml:mi>
</mml:mrow>
</mml:mtd>
<mml:mtd>
<mml:mrow>
<mml:mi>cos</mml:mi>
<mml:mi>θ</mml:mi>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:mrow>
<mml:mo>]</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
</inline-formula>.</p>
<p>To find the motion vector for a specific cell in the current frame, a best-matching image patch is searched within a predefined search window in the previous, reconstructed, reference frame, as shown in <xref ref-type="fig" rid="fig8-2211068212468582"><bold>Figure 8</bold></xref>.</p>
<fig id="fig8-2211068212468582" position="float">
<label>Figure 8.</label>
<caption>
<p>Translational motion tracking with a rotating-circle matching template.</p>
</caption>
<graphic xlink:href="10.1177_2211068212468582-fig8.tif"/></fig>
<p>There are many types of matching criteria for the block-matching algorithms, such as the sum of the absolute difference (SAD), the mean squared difference,<sup><xref ref-type="bibr" rid="bibr11-2211068212468582">11</xref></sup> the mean absolute difference,<sup><xref ref-type="bibr" rid="bibr12-2211068212468582">12</xref></sup> and so on. In this article, we estimate the motion vector based on the SAD with consideration for optimizing computational efficiency. The motion vector (<italic>MV<sub>x</sub>, MV<sub>y</sub></italic>) is defined in <xref ref-type="disp-formula" rid="disp-formula10-2211068212468582">equations 10</xref> and <xref ref-type="disp-formula" rid="disp-formula11-2211068212468582">11</xref>. The best matched patch in the search window of the current frame is found from the minimum value of the SAD with the rotating-circle matching patch in the reference frame and the target patch in the current frame.</p>
<p>The matching criterion is expressed as follows:</p>
<p><disp-formula id="disp-formula9-2211068212468582">
<mml:math display="block" id="math10-2211068212468582">
<mml:mrow>
<mml:mi>S</mml:mi>
<mml:mi>A</mml:mi>
<mml:mi>D</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>y</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>θ</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mstyle displaystyle="true">
<mml:munder>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>i</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>j</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>∈</mml:mo>
<mml:mi>M</mml:mi>
</mml:mrow>
</mml:munder>
<mml:mrow>
<mml:mrow>
<mml:mo>|</mml:mo>
<mml:mrow>
<mml:mi>R</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>X</mml:mi>
<mml:msub>
<mml:mo>′</mml:mo>
<mml:mi>θ</mml:mi>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>i</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>j</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>−</mml:mo>
<mml:mi>P</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo>+</mml:mo>
<mml:mi>i</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>y</mml:mi>
<mml:mo>+</mml:mo>
<mml:mi>j</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
<mml:mo>|</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:mstyle>
<mml:mo>,</mml:mo>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula9-2211068212468582" xlink:href="10.1177_2211068212468582-eq9.tif"/>
</disp-formula></p>
<p>where (<italic>x, y</italic>)∈S and (<italic>i, j</italic>)∈<italic>M, S</italic> is the search window and <italic>M</italic> is the defined image mask. The corresponding motion vector for the target window with the minimum SAD is then determined by</p>
<p><disp-formula id="disp-formula10-2211068212468582">
<mml:math display="block" id="math11-2211068212468582">
<mml:mrow>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>M</mml:mi>
<mml:msub>
<mml:mi>V</mml:mi>
<mml:mi>x</mml:mi>
</mml:msub>
<mml:mo>,</mml:mo>
<mml:mi>M</mml:mi>
<mml:msub>
<mml:mi>V</mml:mi>
<mml:mi>y</mml:mi>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mtable>
<mml:mtr>
<mml:mtd>
<mml:mrow>
<mml:mi>arg</mml:mi>
</mml:mrow>
</mml:mtd>
<mml:mtd>
<mml:mrow>
<mml:munder>
<mml:mrow>
<mml:mi>min</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>y</mml:mi>
<mml:mo>∈</mml:mo>
<mml:mi>S</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:munder>
</mml:mrow>
</mml:mtd>
<mml:mtd>
<mml:mrow>
<mml:mi>S</mml:mi>
<mml:mi>A</mml:mi>
<mml:msub>
<mml:mi>D</mml:mi>
<mml:mi>S</mml:mi>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>y</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>θ</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
<mml:mo>.</mml:mo>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula10-2211068212468582" xlink:href="10.1177_2211068212468582-eq10.tif"/>
</disp-formula></p>
<p>In a pseudo-code format, the SAD calculation is performed based on the rotating-circle matching template as</p>
<list id="list1-2211068212468582" list-type="simple">
<list-item><p>1. for (<italic>x,y</italic>) in search window <italic>S</italic></p></list-item>
<list-item><p>2. { for( θ <italic>= 0</italic> to <italic>2</italic>π)</p></list-item>
<list-item><p> 3. { calculate SAD(<italic>x, y</italic>, θ)</p></list-item>
<list-item><p> 4. increment θ by a step Δ</p></list-item>
<list-item><p> 5. }</p></list-item>
<list-item><p> 6. increment <italic>x,y</italic> by 1</p></list-item>
<list-item><p>7. }</p></list-item>
</list>
</sec>
<sec id="section14-2211068212468582">
<title>Image patch cross-correlation</title>
<p>After compensation for the translational motion in the images based on the motion vector, we then calculate the image patch cross-correlation to estimate the cell rotation speed. The correlation coefficient shows the similarity between the selected template patch from the subsequent image patches at the same location. For a grayscale image patch, the correlation coefficient γ is defined as</p>
<p><disp-formula id="disp-formula11-2211068212468582">
<mml:math display="block" id="math12-2211068212468582">
<mml:mrow>
<mml:mi>γ</mml:mi>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mstyle>
<mml:mo>∑</mml:mo>
</mml:mstyle>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mi>j</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mi>f</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mi>x</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>y</mml:mi>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>−</mml:mo>
<mml:mover accent="true">
<mml:mi>f</mml:mi>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>j</mml:mi>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mi>t</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mi>x</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>y</mml:mi>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>−</mml:mo>
<mml:mover accent="true">
<mml:mi>t</mml:mi>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>j</mml:mi>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
<mml:mrow>
<mml:msqrt>
<mml:mrow>
<mml:msub>
<mml:mstyle>
<mml:mo>∑</mml:mo>
</mml:mstyle>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mi>j</mml:mi>
</mml:mrow>
</mml:msub>
<mml:msup>
<mml:mrow>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mi>f</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mi>x</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>y</mml:mi>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>−</mml:mo>
<mml:mover accent="true">
<mml:mi>f</mml:mi>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>i</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>j</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
<mml:mn>2</mml:mn>
</mml:msup>
<mml:msub>
<mml:mstyle>
<mml:mo>∑</mml:mo>
</mml:mstyle>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mi>j</mml:mi>
</mml:mrow>
</mml:msub>
<mml:msup>
<mml:mrow>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mi>t</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mi>x</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>y</mml:mi>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>−</mml:mo>
<mml:mover accent="true">
<mml:mi>t</mml:mi>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>j</mml:mi>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
<mml:mn>2</mml:mn>
</mml:msup>
</mml:mrow>
</mml:msqrt>
</mml:mrow>
</mml:mfrac>
<mml:mo>,</mml:mo>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula11-2211068212468582" xlink:href="10.1177_2211068212468582-eq11.tif"/>
</disp-formula></p>
<p>where <italic>t</italic>(⋅) is the selected template patch and <italic>f</italic>(⋅) is the subsequent image patch; <inline-formula id="inline-formula2-2211068212468582">
<mml:math display="block" id="math13-2211068212468582">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>f</mml:mi>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mo>⋅</mml:mo>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math>
</inline-formula> and <inline-formula id="inline-formula3-2211068212468582">
<mml:math display="block" id="math14-2211068212468582">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>t</mml:mi>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mo>⋅</mml:mo>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math>
</inline-formula> are the mean of <italic>f</italic>(⋅) and <italic>t</italic>(⋅), respectively.</p>
<p>The correlation coefficient reflects the degree of linearity between two data sets. A larger value indicates a perfect positive linear relation between the two data sets, whereas a smaller value indicates a perfect negative linear relation. Therefore, we detect the local maxima values of the correlation coefficients to track the peak points, and the rotation cycle can be estimated through the index of the peak points.</p>
</sec>
</sec>
<sec id="section15-2211068212468582">
<title>Algorithm Performance</title>
<p>For verification of the proposed rotation estimation algorithm, image sequences at different cell rotation speeds are recorded. The cell self-rotation speed range is varied from 50 rpm to 250 rpm by adjusting the DEP parameters (i.e., frequency, voltage, and waveforms).</p>
<p>For quantitative verification of the performance of the translational motion compensation algorithm, the cell compensation estimation results are compared with the estimation without compensation, as shown in <xref ref-type="fig" rid="fig9-2211068212468582"><bold>Figure 9</bold></xref>. We selected an image sequence duration greater than 1.12 s (28 frames at 25 fps) for the test. The standard deviation of the motion compensation results is much less than the estimate without the motion compensation. That means that the proposed algorithm has performance stability in estimating the rotation rate of the cell.</p>
<fig id="fig9-2211068212468582" position="float">
<label>Figure 9.</label>
<caption>
<p>A comparison of the standard deviation of results with motion compensation (<bold>A</bold>) and without compensation (<bold>B</bold>) as estimated over 1.12 s in (<bold>C</bold>).</p>
</caption>
<graphic xlink:href="10.1177_2211068212468582-fig9.tif"/></fig>
<p>The position change for a Melan-A cell for ~90 s is recorded and is plotted in <xref ref-type="fig" rid="fig10-2211068212468582"><bold>Figure 10</bold></xref>, during which the voltage is first decreased from 16 V to 1.5 V gradually and then is increased back to 16 V. <xref ref-type="fig" rid="fig11-2211068212468582"><bold>Figure 11</bold></xref> shows a comparison between using this algorithm and a manual method (i.e., by visual identification using human eyes) to analyze the same video frame by frame, which demonstrates that the different methods provide matching results. Also, the algorithm is capable of tracking changes in the rotation speed for a certain period, which is almost impossible to estimate manually.</p>
<fig id="fig10-2211068212468582" position="float">
<label>Figure 10.</label>
<caption>
<p>Analysis of a cell’s rotation speed using the developed algorithm for (1) decreasing dielectrophoretic voltage, (2) resting voltage, and (3) increasing voltage.</p>
</caption>
<graphic xlink:href="10.1177_2211068212468582-fig10.tif"/></fig>
<fig id="fig11-2211068212468582" position="float">
<label>Figure 11.</label>
<caption>
<p>Comparison of a self-rotation speed analysis for a Melan-A cell using a manual method and the algorithm developed for this work.</p>
</caption>
<graphic xlink:href="10.1177_2211068212468582-fig11.tif"/></fig>
</sec>
</sec>
<sec id="section16-2211068212468582">
<title>Conclusions</title>
<p>Cell manipulation using a DEP technique is conducted in a transparent microfluidic chip with embedded Au microelectrodes fabricated using microelectromechanical systems technology. Self-rotation of pigment cells is observed when a specific electrical potential is applied between the microelectrodes to generate a DEP force field. We have developed a novel computer vision algorithm to estimate the cell rotation speed automatically. This algorithm analyzes each frame of a video sequence taken from a CCD-based microscope using a rotating-circle template with a block-matching method and a pixel-patch correlation. Compared with the manual estimation process, the algorithm can more accurately calculate the DEP-induced rotation rate of the cells at various applied voltages, frequencies, and waveforms and also reduce data-processing time by at least 100 times. Most importantly, the algorithm is accurate even when the cell has a simultaneous translational motion across the video image sequence. Also, the algorithm is capable of tracking changes in rotation speed over a long period of time by stably analyzing a massive data set of video image frames. Therefore, we envision that our automatic cell rotation analysis method can be used with DEP technology as an efficient procedure for automated cell sorting in the future.</p>
</sec>
</body>
<back>
<ack>
<p>The authors would like to thank Ms. Florence W. K. Cheung and Ms. Jia Guo of the School of Biomedical Sciences, The Chinese University of Hong Kong, for their help in culturing and preparing the cells for our experiments.</p>
</ack>
<fn-group>
<fn fn-type="conflict">
<label>Declaration of Conflicting Interests</label>
<p>The authors declared no potential conflicts of interest with respect to the research, authorship, and/or publication of this article.</p>
</fn>
<fn fn-type="financial-disclosure">
<label>Funding</label>
<p>The authors disclosed receipt of the following financial support for the research, authorship, and/or publication of this article: The work described in this article was supported by a grant from City University of Hong Kong (project No. 7200298) and a grant from the Croucher Foundation (project No. 9500011).</p>
</fn>
</fn-group>
<ref-list>
<title>References</title>
<ref id="bibr1-2211068212468582">
<label>1.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Voldman</surname><given-names>J.</given-names></name>
</person-group> <article-title>Electrical Forces for Microscale Cell Manipulation</article-title>. <source>Annu. Rev. Biomed. Eng</source>. <year>2006</year>, <volume>6</volume>, <fpage>425</fpage>–<lpage>454</lpage>.</citation>
</ref>
<ref id="bibr2-2211068212468582">
<label>2.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Mattanovich</surname><given-names>D.</given-names></name>
<name><surname>Borth</surname><given-names>N.</given-names></name>
</person-group> <article-title>Applications of Cell Sorting in Biotechnology</article-title>. <source>Microb. Cell Fact</source>. <year>2006</year>, <volume>5</volume>, <fpage>12</fpage>.</citation>
</ref>
<ref id="bibr3-2211068212468582">
<label>3.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Pohl</surname><given-names>H.</given-names></name>
</person-group> <article-title>The Motion and Precipitation of Suspensoids in Divergent Electric Fields</article-title>. <source>J. Appl. Phys</source>. <year>1951</year>, <volume>22</volume>, <fpage>869</fpage>–<lpage>871</lpage>.</citation>
</ref>
<ref id="bibr4-2211068212468582">
<label>4.</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Ouyang</surname><given-names>M.</given-names></name>
<name><surname>Zhang</surname><given-names>G.</given-names></name>
<name><surname>Li</surname><given-names>W. J.</given-names></name>
<name><surname>Liu</surname><given-names>W.</given-names></name>
</person-group> <article-title>Self-induced Rotation of Pigmented Cells by Dielectrophoretic Force Field</article-title>. <conf-name>IEEE International Conference on Robotics and Biomimetics (ROBIO 2011)</conf-name>, <year>2011</year>.</citation>
</ref>
<ref id="bibr5-2211068212468582">
<label>5.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Wei</surname><given-names>C.</given-names></name>
<name><surname>Wei</surname><given-names>T.</given-names></name>
<name><surname>Liang</surname><given-names>C.</given-names></name>
<name><surname>Tai</surname><given-names>F.</given-names></name>
</person-group> <article-title>The Separation of Different Conducting Multi-walled Carbon Nanotubes by AC Dielectrophoresis</article-title>. <source>Diamond Relat. Mater</source>. <year>2009</year>, <volume>18</volume>, <fpage>332</fpage>–<lpage>336</lpage>.</citation>
</ref>
<ref id="bibr6-2211068212468582">
<label>6.</label>
<citation citation-type="web">
<person-group person-group-type="author">
<name><surname>Lane</surname><given-names>L.</given-names></name>
</person-group> <article-title>Table: sucrose solutions, composition, viscosity, density</article-title>. <ext-link ext-link-type="uri" xlink:href="http://lclane.net/text/sucrose.html">http://lclane.net/text/sucrose.html</ext-link>.</citation>
</ref>
<ref id="bibr7-2211068212468582">
<label>7.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Shim</surname><given-names>H. C.</given-names></name>
<name><surname>Kwak</surname><given-names>Y. K.</given-names></name>
<name><surname>Han</surname><given-names>C. S.</given-names></name>
<name><surname>Kim</surname><given-names>S.</given-names></name>
</person-group> <article-title>Effect of a Square Wave on an Assembly of Multi-walled Carbon Nanotubes Using AC Dielectrophoresis</article-title>. <source>Physica E</source>. <year>2009</year>, <volume>41</volume>, <fpage>1137</fpage>–<lpage>1142</lpage>.</citation>
</ref>
<ref id="bibr8-2211068212468582">
<label>8.</label>
<citation citation-type="book">
<person-group person-group-type="author">
<name><surname>van Vliet</surname><given-names>L. J.</given-names></name>
<name><surname>Boddeke</surname><given-names>F. R.</given-names></name>
<name><surname>Sudar</surname><given-names>D.</given-names></name>
<name><surname>Young</surname><given-names>I. T.</given-names></name>
</person-group> <article-title>Image Detectors for Digital Image Microscopy</article-title>. In <source>Digital Image Analysis of Microbes: Imaging, Morphometry, Fluorometry, and Applications, Modern Microbiological Methods</source>. <publisher-loc>John Wiley &amp; Sons</publisher-loc>: <publisher-name>Chichester, UK</publisher-name>, <year>1998</year>; pp <fpage>37</fpage>–<lpage>64</lpage>.</citation>
</ref>
<ref id="bibr9-2211068212468582">
<label>9.</label>
<citation citation-type="book">
<person-group person-group-type="author">
<name><surname>Gonzalez</surname><given-names>R.</given-names></name>
<name><surname>Woods</surname><given-names>R.</given-names></name>
</person-group> <source>Digital Image Processing</source>, <edition>3rd ed.</edition>; <publisher-name>Prentice Hall</publisher-name>, <publisher-loc>New York</publisher-loc>, <year>2008</year>.</citation>
</ref>
<ref id="bibr10-2211068212468582">
<label>10.</label>
<citation citation-type="book">
<person-group person-group-type="author">
<name><surname>Wellner</surname><given-names>P. D.</given-names></name>
</person-group> <article-title>Adaptive Thresholding for the Digital Desk</article-title>. <source>Technical Report EPC-93-110</source>. <publisher-name>Rank Xerox Research Centre</publisher-name>, <publisher-loc>Cambridge, UK</publisher-loc>, <year>1993</year>.</citation>
</ref>
<ref id="bibr11-2211068212468582">
<label>11.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Jain</surname><given-names>J. R.</given-names></name>
<name><surname>Jain</surname><given-names>A. K.</given-names></name>
</person-group> <article-title>Displacement Measurement and Its Application in Interframe Image Coding</article-title>. <source>IEEE Trans. Commun</source>. <year>1981</year>, <volume>29</volume>, <fpage>1799</fpage>–<lpage>1806</lpage>.</citation>
</ref>
<ref id="bibr12-2211068212468582">
<label>12.</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Koga</surname><given-names>T.</given-names></name>
<name><surname>Linuma</surname><given-names>K.</given-names></name>
<name><surname>Hirano</surname><given-names>A.</given-names></name>
<name><surname>Iijima</surname><given-names>Y.</given-names></name>
<name><surname>Ishiguro</surname><given-names>T.</given-names></name>
</person-group> <article-title>Motioncompensated Interframe Coding for Video Conferencing</article-title>. <conf-name>Proc. Nat. Telecomm. Conf</conf-name>., <conf-loc>New Orleans, LA</conf-loc>, <year>1981</year>, pp. <fpage>G5.3.1</fpage>–<lpage>G5.3.5</lpage>.</citation>
</ref>
</ref-list>
</back>
</article>