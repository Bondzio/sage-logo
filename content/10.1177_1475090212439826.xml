<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v2.3 20070202//EN" "journalpublishing.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">PIM</journal-id>
<journal-id journal-id-type="hwp">sppim</journal-id>
<journal-title>Proceedings of the Institution of Mechanical Engineers, Part M: Journal of Engineering for the Maritime Environment</journal-title>
<issn pub-type="ppub">1475-0902</issn>
<issn pub-type="epub">2041-3084</issn>
<publisher>
<publisher-name>SAGE Publications</publisher-name>
<publisher-loc>Sage UK: London, England</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1177/1475090212439826</article-id>
<article-id pub-id-type="publisher-id">10.1177_1475090212439826</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Original Articles</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Phase averaging of the velocity fields in an oscillating water column using splines</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<name><surname>Fleming</surname><given-names>Alan</given-names></name>
<xref ref-type="aff" rid="aff1-1475090212439826">1</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Penesis</surname><given-names>Irene</given-names></name>
<xref ref-type="aff" rid="aff1-1475090212439826">1</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Macfarlane</surname><given-names>Gregor</given-names></name>
<xref ref-type="aff" rid="aff1-1475090212439826">1</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Bose</surname><given-names>Neil</given-names></name>
<xref ref-type="aff" rid="aff1-1475090212439826">1</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Hunter</surname><given-names>Scott</given-names></name>
<xref ref-type="aff" rid="aff2-1475090212439826">2</xref>
</contrib>
</contrib-group>
<aff id="aff1-1475090212439826"><label>1</label>National Centre for Maritime Engineering and Hydrodynamics, University of Tasmania, Launceston, Tasmania, Australia</aff>
<aff id="aff2-1475090212439826"><label>2</label>Oceanlinx, Macquarie Park, NSW, Australia</aff>
<author-notes>
<corresp id="corresp1-1475090212439826">Alan Fleming, National Centre for Maritime Engineering and Hydrodynamics, University of Tasmania, Newnham Drive, Launceston, Tasmania 7248, Australia. Email: <email>alanf@amc.edu.au</email></corresp>
</author-notes>
<pub-date pub-type="epub-ppub">
<month>11</month>
<year>2012</year>
</pub-date>
<volume>226</volume>
<issue>4</issue>
<fpage>335</fpage>
<lpage>345</lpage>
<history>
<date date-type="received">
<day>25</day>
<month>8</month>
<year>2011</year>
</date>
<date date-type="accepted">
<day>31</day>
<month>1</month>
<year>2012</year>
</date>
</history>
<permissions>
<copyright-statement>© IMechE 2012</copyright-statement>
<copyright-year>2012</copyright-year>
<copyright-holder content-type="society">Institution of Mechanical Engineers</copyright-holder>
</permissions>
<abstract>
<p>The principal objective of this paper is to present a phase averaging method by curve fitting using B-splines. The method was designed specifically to process phase-clumped and discontinuous periodic data. Phase averaging by ensemble averaging of data clumped in phase will cause phase bias error if the mean phase of the clumped data does not equal the desired phase. The curve-fitting method presented here avoids phase bias error. The performance of the curve-fitting method was compared favourably with the ensemble averaging method when processing phase-clumped experimental data. Generally, the curve-fitting method exceeded the performance of the ensemble averaging method when the data were clumped in phase and matched the performance of the ensemble averaging method when the data were randomly distributed in phase. Experimentally obtained phase-clumped two-dimensional velocity fields at the centre-line of a forward-facing bent-duct oscillating water column were processed using the curve-fitting method. The phase-averaged velocity fields were combined for visualization purposes in the form of animated graphics interchange format (GIF) images to show the velocity fields over a wave cycle. The GIF images correspond to the four separate monochromatic wave frequencies tested and accompany the online version of this paper. The GIF images reveal the two-dimensional phase-averaged flow characteristics at the centre-line of the model with phenomena including oscillating flow, water column heave and slosh, front-wall swash and down wash, an outflow jet and vortices. It was concluded that phase averaging using splines finds a niche for the phase averaging of data which are dispersed (or clumped) in phase.</p>
</abstract>
<kwd-group>
<kwd>Phase averaging</kwd>
<kwd>oscillating water column</kwd>
<kwd>particle-imaging velocimetry</kwd>
<kwd>spline</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="section1-1475090212439826" sec-type="intro">
<title>Introduction</title>
<p>The oscillating water column (OWC) is a wave energy conversion device which at its simplest consists of a wall which penetrates the sea surface to form a chamber. Air enclosed by the chamber and the free surface is connected to the atmosphere via a bi-directional turbine (commonly a Wells turbine<sup><xref ref-type="bibr" rid="bibr1-1475090212439826">1</xref></sup>). The water inside the chamber oscillates owing to external wave action, which in turn causes the air to flow in and out of the chamber via the turbine.</p>
<p>There exist (at least) two distinct methods to phase average periodic data. The first is where ‘like’ data are simply averaged in a discrete manner by assuming that each data point in the collection is captured at the same phase. The second method recognizes that the data are continuous and a curve is fitted to the data. The first method, often described as <italic>ensemble averaging</italic>, is best suited to highly repeatable and predictable events, namely rotary motion where an encoder can be utilized to initiate the capture of data with excellent precision. The <italic>curve-fitting</italic> method is employed in phase-averaged analysis of events which have some variability in time and are not completely repeatable, e.g. waves propagating in a wave tank. Both methods will eventually have a discrete number of phases. The number of phases for ensemble averaging is set during experimental design and is generally fixed, while the curve-fitting method has no limit to the number of phases and is decided at the discretion of the researcher during data analysis.</p>
<p>Ensemble averaging of particle-imaging velocimetry (PIV)<sup><xref ref-type="bibr" rid="bibr2-1475090212439826">2</xref>,<xref ref-type="bibr" rid="bibr3-1475090212439826">3</xref></sup> data has been applied extensively in wave tanks and circulating water channels including the study of a ship and propeller wake analysis in which the phase signal was recorded by an encoder tracking the propeller shaft angle,<sup><xref ref-type="bibr" rid="bibr4-1475090212439826">4</xref>,<xref ref-type="bibr" rid="bibr5-1475090212439826">5</xref></sup> breaking waves,<sup><xref ref-type="bibr" rid="bibr6-1475090212439826">6</xref><xref ref-type="bibr" rid="bibr7-1475090212439826"/>–<xref ref-type="bibr" rid="bibr8-1475090212439826">8</xref></sup> wave–structure interaction<sup><xref ref-type="bibr" rid="bibr9-1475090212439826">9</xref></sup> and velocity fields in an OWC.<sup><xref ref-type="bibr" rid="bibr10-1475090212439826">10</xref></sup></p>
<p>Longo et al.<sup><xref ref-type="bibr" rid="bibr11-1475090212439826">11</xref></sup> applied curve-fitting phase averaging to the wake analysis of a ship in regular seas, fitting data points with a fifth-order polynomial least-squares reduction technique (following some data conditioning). Harmonic components were then extracted with fast Fourier transform (FFT) analysis up to the tenth harmonic.</p>
<p>Four of the present authors and co-workers<sup><xref ref-type="bibr" rid="bibr10-1475090212439826">10</xref></sup> presented an ensemble phase-averaged analysis of a two-dimensional flow field at the centre-line plane inside a scale model of a forward-facing bent-duct OWC. The model was exposed to monochromatic waves for wave conditions of height 0.07 m and frequency 0.44 Hz based on a mosaic of seven separate fields of view which provided the entire velocity field inside the OWC at the centre-line plane. Experimental data were also obtained for additional wave frequencies corresponding to a wave height of 0.07 m for 0.50 Hz, 0.57 Hz and 0.77 Hz, but it was found that clumping of data (in the phase domain) for some of the experimental positions prevented the calculation of the ensemble average for some of the position–phase combinations. A curve-fitting method using B-splines was developed specifically to handle the clumped data and is described in detail in this paper. The method was applied to two-dimensional velocity fields but is equally applicable to three or more dimensions.</p>
<p>Two separate types of result are presented in this paper. First, the performance of curve-fitting phase averaging compared with ensemble phase averaging is applied to clumped data. Second, the curve-fitting phase-averaged velocity fields over a wave cycle by curve fitting for the 0.07 m, 0.77 Hz wave are presented. The velocity fields were incomplete when using the ensemble averaging method and also possess the greatest differences from the velocity fields presented previously<sup><xref ref-type="bibr" rid="bibr10-1475090212439826">10</xref></sup> which were for the 0.07 m, 0.77 Hz wave. Accompanying the online version of this paper are four animated graphics interchange format (GIF) images which visualize the flow inside and around the OWC at its centre-line for the wave conditions tested.</p>
</sec>
<sec id="section2-1475090212439826" sec-type="methods">
<title>Methods</title>
<sec id="section3-1475090212439826">
<title>Experimental set-up</title>
<p>Experiments were conducted in the Australian Maritime College Towing Tank<sup><xref ref-type="bibr" rid="bibr12-1475090212439826">12</xref></sup> which had a length of 100 m, a width of 3.55 m and a depth of 1.5 m. A scale model of a generic forward-facing bent-duct OWC wave energy extraction device (the profile is outlined in <xref ref-type="fig" rid="fig1-1475090212439826">Figure 1</xref>) was tested in monochromatic seas for the conditions listed in <xref ref-type="table" rid="table1-1475090212439826">Table 1</xref>. The model was 500 mm wide and was fitted with an orifice of 58 mm diameter. The model was positioned in the middle of the towing tank crosswise in front of a viewing window approximately midway lengthwise between the wave maker and the beach. Image pairs were obtained at seven separate positions (<xref ref-type="fig" rid="fig1-1475090212439826">Figure 1</xref>) using standard PIV equipment at a resolution of 1376 × 1024 pixels to create a mosaic of the area of interest. Image acquisition was synchronized to commence at the following wave crest as monitored by a resistance wave probe mounted adjacent to the front face of the OWC model; image pairs were acquired at a frequency of 8<italic>f</italic> for the wave frequencies 0.44 Hz, 0.50 Hz and 0.57 Hz and 6<italic>f</italic> for the 0.77 Hz wave, where <italic>f</italic> is the wave frequency. Experiments were run for a maximum duration of 100 s to minimize wave reflection interference from the beach end of the towing tank. Experiments were repeated to increase the number of image pairs. Further details of the experimental set-up have been given previously.<sup><xref ref-type="bibr" rid="bibr10-1475090212439826">10</xref></sup></p>
<table-wrap id="table1-1475090212439826" position="float">
<label>Table 1.</label>
<caption>
<p>Test matrix.</p>
</caption>
<graphic alternate-form-of="table1-1475090212439826" xlink:href="10.1177_1475090212439826-table1.tif"/>
<table>
<colgroup>
<col align="left"/>
<col align="char" char="."/>
<col align="char" char="."/>
</colgroup>
<thead>
<tr>
<th align="left">Position</th>
<th align="left">Wave height (m)</th>
<th align="left">Wave frequency (Hz)</th>
</tr>
</thead>
<tbody>
<tr>
<td>A, B, C, D, E, F, G</td>
<td>0.07</td>
<td>0.44 (<italic>λ</italic> = 7.1 m; slope = 0.031)</td>
</tr>
<tr>
<td/>
<td/>
<td>0.50 (<italic>λ = </italic>5.8 m; slope = 0.038)</td>
</tr>
<tr>
<td/>
<td/>
<td>0.57 (<italic>λ = </italic>4.7 m; slope = 0.047)</td>
</tr>
<tr>
<td/>
<td/>
<td>0.77 (<italic>λ = </italic>2.6 m; slope = 0.084)</td>
</tr>
</tbody>
</table>
</table-wrap>
<fig id="fig1-1475090212439826" position="float">
<label>Figure 1.</label>
<caption>
<p>Field of view for the experimental data. The OWC geometry is outlined in black; the, sample locations are numbered 1, 2 and 3.</p>
</caption>
<graphic xlink:href="10.1177_1475090212439826-fig1.tif"/>
</fig>
<p>An unfortunate (although initially intended) side effect of setting the PIV image acquisition rate equal to an integer fraction of the wave frequency meant that data clumped around six or eight central phases, a function of the acquisition rate, which resulted in a variable bias error in phase for ensemble-averaged data (see <xref ref-type="fig" rid="fig6-1475090212439826">Figures 6</xref> and <xref ref-type="fig" rid="fig7-1475090212439826">7</xref> later).</p>
<p>Velocity fields were calculated from the image pairs using DaVis 7.2.<sup><xref ref-type="bibr" rid="bibr13-1475090212439826">13</xref></sup> The processing sequence is outlined in <xref ref-type="table" rid="table2-1475090212439826">Table 2</xref>. The axis system used in the PIV data is a standard Cartesian coordinate system, with the datum being located at the intersection of the front face of the OWC and the waterline. A pixel corresponds to a position in space and is interchangeable between images and velocity fields, with a corresponding reduction in the pixel resolution of the velocity field depending on the final multiple-pass mode. For these velocity fields, the reduction (known as Vector Grid in DaVis) is 32 – 32 × 25%=24.</p>
<table-wrap id="table2-1475090212439826" position="float">
<label>Table 2.</label>
<caption>
<p>PIV post-processing sequence (using DaVis 7.2<sup><xref ref-type="bibr" rid="bibr13-1475090212439826">13</xref></sup>).</p>
</caption>
<graphic alternate-form-of="table2-1475090212439826" xlink:href="10.1177_1475090212439826-table2.tif"/>
<table>
<colgroup>
<col align="left"/>
<col align="left"/>
</colgroup>
<thead>
<tr>
<th align="left">Operation</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Mask from text (position C only)</td>
<td>Custom function (for masking above the free surface)</td>
</tr>
<tr>
<td>Manual masking (position F only)</td>
<td>Manually masked sorted images (16 bins)</td>
</tr>
<tr>
<td>Image correction</td>
<td>Third-order polynomial mapping</td>
</tr>
<tr>
<td>Image pre-processing</td>
<td>High pass (64) +  subtract (10)</td>
</tr>
<tr>
<td>Correlation mode</td>
<td>Cross-correlation</td>
</tr>
<tr>
<td>Multiple- pass mode</td>
<td>1 × (64 × 64, 50%), 2 ×  (32 × 32, 25%)</td>
</tr>
<tr>
<td>Vector post-processing</td>
<td>Median filter (5)</td>
</tr>
<tr>
<td/>
<td>Fill missing</td>
</tr>
<tr>
<td/>
<td>Smoothing</td>
</tr>
</tbody>
</table>
</table-wrap>
</sec>
<sec id="section4-1475090212439826">
<title>Data reduction</title>
<p>Velocity field data were phase averaged in two steps: in the first step, each velocity field, which corresponds to an experimentally obtained image pair, was assigned a phase; the second step was to sort the data into ascending phase (technically not essential) and to average through data for the same phase bin either by curve fitting or by ensemble averaging.</p>
<p>A resistance wave probe positioned adjacent to the front face of the OWC was used as the synchronization signal and is referred to as the ‘phase wave probe’. Each velocity field was assigned a phase using the phase expression</p>
<p>
<disp-formula id="disp-formula1-1475090212439826">
<label>(1)</label>
<mml:math display="block" id="math1-1475090212439826">
<mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:mfrac>
<mml:mo>=</mml:mo>
<mml:mtext>modulo</mml:mtext>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>γ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>FH</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
<mml:mi>π</mml:mi>
</mml:mrow>
</mml:mfrac>
<mml:mo>+</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>image</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>zero</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>zero</mml:mi>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>zero</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mo>,</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula1-1475090212439826" xlink:href="10.1177_1475090212439826-eq1.tif"/>
</disp-formula>
</p>
<p>where <inline-formula id="inline-formula1-1475090212439826"><mml:math display="inline" id="math2-1475090212439826"><mml:mrow><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>FH</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the phase shift of the first harmonic using Fourier series analysis of the immediate wave, <inline-formula id="inline-formula2-1475090212439826"><mml:math display="inline" id="math3-1475090212439826"><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>image</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the image acquisition time, <inline-formula id="inline-formula3-1475090212439826"><mml:math display="inline" id="math4-1475090212439826"><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>zero</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the time of the preceding zero up crossing, <inline-formula id="inline-formula4-1475090212439826"><mml:math display="inline" id="math5-1475090212439826"><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>zero</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the time of the following zero crossing and modulo is the remainder after division by the second argument, which is unity in this case.</p>
<p><xref ref-type="disp-formula" rid="disp-formula1-1475090212439826">Equation (1)</xref> is the same as presented previously<sup><xref ref-type="bibr" rid="bibr10-1475090212439826">10</xref></sup> with an additional phase correction term <italic>γ<sub>FH</sub></italic>/2π, the phase correction term previously employed by Longo et al.<sup><xref ref-type="bibr" rid="bibr11-1475090212439826">11</xref></sup> The phase correction causes a left or right phase shift equal to the FFT first-harmonic phase angle of the immediate wave profile, affecting a more even distribution of uncertainty across the wave profile. <xref ref-type="fig" rid="fig2-1475090212439826">Figure 2</xref> shows an example of phase-sorted data without phase correction and with phase correction respectively. The standard deviation is shown as columns with the magnitude shown on the right vertical axis. The standard deviation can be seen to be more constant when phase correction is used (the right-hand side) and is also generally the case. The phase correction was found to reduce the standard deviation of the ensemble-averaged phase wave probe amplitude for the current data set by an average of 7.8%, a minimum of −1.5% and a maximum of 18.1% over the periodic cycle (<italic>t</italic>/<italic>T</italic> = 0.1) for all the experimental data used.</p>
<fig id="fig2-1475090212439826" position="float">
<label>Figure 2.</label>
<caption>
<p>Demonstration of the effect of the phase correction term applied to the phase wave probe data. The curves represent the instantaneous profiles, and the bars represent the standard deviation (12.4% reduction in the mean standard deviation of the amplitude for this example by using phase correction).</p>
</caption>
<graphic xlink:href="10.1177_1475090212439826-fig2.tif"/>
</fig>
</sec>
<sec id="section5-1475090212439826">
<title>Ensemble phase averaging</title>
<p>Ensemble phase averaging was performed using DaVis 7.2<sup><xref ref-type="bibr" rid="bibr13-1475090212439826">13</xref></sup> for 16 non-overlapping windows of equal width in the phase range 0≤<italic>t</italic>/<italic>T</italic>&lt;1. The central phase is taken as the centre of the window and is likewise between zero and unity (0.032, 0.094, …, 0.97). The average and r.m.s. velocity fields are<sup><xref ref-type="bibr" rid="bibr13-1475090212439826">13</xref></sup></p>
<p>
<disp-formula id="disp-formula2-1475090212439826">
<label>(2)</label>
<mml:math display="block" id="math6-1475090212439826">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>V</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>avg</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:munderover>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>n</mml:mi>
</mml:mrow>
</mml:munderover>
<mml:msub>
<mml:mrow>
<mml:mi>V</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>i</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:mi>n</mml:mi>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula2-1475090212439826" xlink:href="10.1177_1475090212439826-eq2.tif"/>
</disp-formula>
</p>
<p>
<disp-formula id="disp-formula3-1475090212439826">
<label>(3)</label>
<mml:math display="block" id="math7-1475090212439826">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>V</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>r</mml:mi>
<mml:mo>.</mml:mo>
<mml:mi>m</mml:mi>
<mml:mo>.</mml:mo>
<mml:mi>s</mml:mi>
<mml:mo>.</mml:mo>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>n</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:mfrac>
<mml:munderover>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>n</mml:mi>
</mml:mrow>
</mml:munderover>
<mml:msup>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>V</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>i</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>V</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>avg</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msup>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula3-1475090212439826" xlink:href="10.1177_1475090212439826-eq3.tif"/>
</disp-formula>
</p>
<p>where <inline-formula id="inline-formula5-1475090212439826"><mml:math display="inline" id="math8-1475090212439826"><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the velocity component and <inline-formula id="inline-formula6-1475090212439826"><mml:math display="inline" id="math9-1475090212439826"><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> is the number of source vectors. Two additional processing options were used: the first was to accept only those vectors in the range <inline-formula id="inline-formula7-1475090212439826"><mml:math display="inline" id="math10-1475090212439826"><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>avg</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>.</mml:mo><mml:mi>m</mml:mi><mml:mo>.</mml:mo><mml:mi>s</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mn>2</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>avg</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>.</mml:mo><mml:mi>m</mml:mi><mml:mo>.</mml:mo><mml:mi>s</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> which required a second iteration for calculation; the second was to perform the averaging only if five or more valid vectors exist.</p>
</sec>
<sec id="section6-1475090212439826">
<title>Curve-fitting phase averaging</title>
<p><italic>N</italic>-dimensional B-splines provide the flexibility necessary to handle clumped, periodic and discontinuous data through the following features.</p>
<list id="list1-1475090212439826" list-type="order">
<list-item><p><italic>Periodic and non-periodic modes</italic>. The periodic mode ensures that the curves overlap at the start and finish and is used when data are continuous. The non-periodic mode is used when the data are discontinuous and it is not possible to ensure an overlap. An example of discontinuous data is when the water level drops below the pixel position; over that duration the vectors are not defined.</p></list-item>
<list-item><p><italic>Control over smoothing</italic>. When based on the immediate standard deviation of nearby data, smoothing is necessary to isolate unwanted noise from the signal.</p></list-item>
<list-item><p><italic>N-dimensional</italic> (<italic>x, y</italic>, …). The curve is in <italic>n</italic>-dimensional space for which the components are solved simultaneously.</p></list-item>
</list>
<p>Curve-fitting calculations were performed with the programming language Python 2.7.<sup><xref ref-type="bibr" rid="bibr14-1475090212439826">14</xref>,<xref ref-type="bibr" rid="bibr15-1475090212439826">15</xref></sup> Velocity field data were fitted using third-order B-spline curves in two dimensions. The phase averaging process described here was performed on a pixel-by-pixel basis and has two distinct steps: the first step prepared mean and weighting values for processing with the spline function for which the <italic>x</italic> and <italic>y</italic> components are obtained independently; the second step fitted mean and weighting values simultaneously with the spline function. If data were found to be discontinuous, the spline was fitted for each valid segment of data.</p>
<p>The method for preparation of the mean and weighting values is now described in detail. All velocity fields from a single position with matching wave conditions (height and frequency) were sorted in ascending phase using <xref ref-type="disp-formula" rid="disp-formula1-1475090212439826">equation (1)</xref>. The vectors were then duplicated at each end using</p>
<p>
<disp-formula id="disp-formula4-1475090212439826">
<label>(4)</label>
<mml:math display="block" id="math11-1475090212439826">
<mml:mrow>
<mml:mtable align="left">
<mml:mtr>
<mml:mtd columnalign="left">
<mml:mrow>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>5</mml:mn>
<mml:mspace width="0.25em"/>
<mml:mo>≥</mml:mo>
<mml:mspace width="0.25em"/>
<mml:mfrac>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:mfrac>
<mml:mspace width="0.25em"/>
<mml:mo>&gt;</mml:mo>
<mml:mspace width="0.25em"/>
<mml:mn>1</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>,</mml:mo>
<mml:mspace width="0.25em"/>
<mml:mfrac>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:mfrac>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="left">
<mml:mrow>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>0</mml:mn>
<mml:mspace width="0.25em"/>
<mml:mo>≥</mml:mo>
<mml:mspace width="0.25em"/>
<mml:mfrac>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:mfrac>
<mml:mspace width="0.25em"/>
<mml:mo>&gt;</mml:mo>
<mml:mspace width="0.25em"/>
<mml:mn>1</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>,</mml:mo>
<mml:mspace width="0.25em"/>
<mml:mfrac>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="left">
<mml:mrow>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>0</mml:mn>
<mml:mspace width="0.25em"/>
<mml:mo>&gt;</mml:mo>
<mml:mspace width="0.25em"/>
<mml:mfrac>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:mfrac>
<mml:mspace width="0.25em"/>
<mml:mo>≥</mml:mo>
<mml:mspace width="0.25em"/>
<mml:mn>1</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>,</mml:mo>
<mml:mspace width="0.25em"/>
<mml:mfrac>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:mfrac>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula4-1475090212439826" xlink:href="10.1177_1475090212439826-eq4.tif"/>
</disp-formula>
</p>
<p>which extends the phase range to −0.5&lt;<italic>t</italic>/<italic>T</italic>&lt;1.5 and is analogous to having two identical periodic cycles starting at <italic>t</italic>/<italic>T</italic>=−0.5 with the purpose being to provide the same amount of data for polynomial fitting.</p>
<p>The average and weighting values were determined for 201 equal sized non-overlapping windows in the range 0≤<italic>t</italic>/<italic>T</italic>&lt;1, with a window width of 0.005 (equivalent to 1.8°) by 41 iterations at 41 equally spaced central phases (0, 0.025, …, 1) (<xref ref-type="fig" rid="fig3-1475090212439826">Figure 3</xref>) with four adjacent phases (two above and two below the central phase). There were four adjacent phases outside the range 0≤<italic>t</italic>/<italic>T</italic>&lt;1 (i.e. −0.01, −0.005, 1.005 and 1.01) which were calculated but discarded.</p>
<fig id="fig3-1475090212439826" position="float">
<label>Figure 3.</label>
<caption>
<p>Layers of subdivision of phases.</p>
</caption>
<graphic xlink:href="10.1177_1475090212439826-fig3.tif"/>
</fig>
<p>Iterating over the 41 central phases, an adaptive sliding window was used to select data points which match the following criteria.</p>
<list id="list2-1475090212439826" list-type="order">
<list-item><p>At least the nearest <italic>n</italic> data points of the total number of data points were employed (set at a constant 8.4% for the results presented here).</p></list-item>
<list-item><p>All data points were within±half the spacing between central phases (shown as d<italic>x</italic> in <xref ref-type="fig" rid="fig3-1475090212439826">Figure 3</xref>).</p></list-item>
<list-item><p>For each window, only those data points within two standard deviations of the mean amplitude of the same window were used.</p></list-item>
</list>
<p>From the selected data the mean value for the central phase and four adjacent phases were determined. A quadratic fit was used provided that at least four out of five windows were occupied with data; otherwise a linear fit was used. <xref ref-type="fig" rid="fig4-1475090212439826">Figures 4</xref> and <xref ref-type="fig" rid="fig5-1475090212439826">5</xref> demonstrate the selection of data and polynomial fits; only data indicated by encircled crosses were used for curve fitting. The central phase is indicated by a vertical dashed line, the fit of the central phase and four adjacent phases are shown as full squares, and solid vertical lines separate the windows. The logic behind this is as follows: the quadratic fit was used where possible to minimize the flattening of peaks; the linear fit was used only when insufficient information was available to make conclusions on the trends of the data other than the slope. <xref ref-type="fig" rid="fig4-1475090212439826">Figure 4</xref> shows a linear fit which was used to interpolate across a region of sparse data; weighting conditioners (detailed in the following paragraphs) were used to diminish the contribution of fits where data were missing. <xref ref-type="fig" rid="fig5-1475090212439826">Figure 5</xref> shows a fit when the conditions stated earlier was satisfied to use a quadratic fit.</p>
<fig id="fig4-1475090212439826" position="float">
<label>Figure 4.</label>
<caption>
<p>First-order polynomial fit applied to selected data (encircled crosses).</p>
</caption>
<graphic xlink:href="10.1177_1475090212439826-fig4.tif"/>
</fig>
<fig id="fig5-1475090212439826" position="float">
<label>Figure 5.</label>
<caption>
<p>Second-order polynomial fit applied to selected data (encircled crosses).</p>
</caption>
<graphic xlink:href="10.1177_1475090212439826-fig5.tif"/>
</fig>
<p>The weighting for each phase (201 in total) was calculated from</p>
<p>
<disp-formula id="disp-formula5-1475090212439826">
<label>(5)</label>
<mml:math display="block" id="math12-1475090212439826">
<mml:mrow>
<mml:mi>w</mml:mi>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>5</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>σ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>201</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula5-1475090212439826" xlink:href="10.1177_1475090212439826-eq5.tif"/>
</disp-formula>
</p>
<p>where the value for <inline-formula id="inline-formula8-1475090212439826"><mml:math display="inline" id="math13-1475090212439826"><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>201</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> was the standard deviation of valid data in the window provided that at least two valid data points existed. If there were fewer than two valid data points in the window, a quarter of the standard deviation of all data points was used.</p>
<p>Two weighting conditioners were developed to reduce or enhance further the weightings based on the distribution of the data to respond to the clumping of data in phase. The weighting conditioners were applied to the weighting using the equation</p>
<p>
<disp-formula id="disp-formula6-1475090212439826">
<label>(6)</label>
<mml:math display="block" id="math14-1475090212439826">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>w</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mi>w</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mi>C</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>distribution</mml:mi>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mrow>
<mml:mi>C</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>balance</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula6-1475090212439826" xlink:href="10.1177_1475090212439826-eq6.tif"/>
</disp-formula>
</p>
<p>to give a conditioned weighting <italic>w<sub>c</sub></italic>. Each array of conditioners had a mean of unity (<inline-formula id="inline-formula9-1475090212439826"><mml:math display="inline" id="math15-1475090212439826"><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>201</mml:mn></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>201</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, where <inline-formula id="inline-formula10-1475090212439826"><mml:math display="inline" id="math16-1475090212439826"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the conditioner). When data are randomly distributed in phase (and not clumped), each element of either conditioner approaches unity (<italic>w<sub>i</sub></italic>→1), nullifying the effect of the conditioner.</p>
<p>The global distribution weighting conditioner <inline-formula id="inline-formula11-1475090212439826"><mml:math display="inline" id="math17-1475090212439826"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>distribution</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> considered the distribution of data across the wave cycle and the calculation performed was a normalized histogram with 41 non-overlapping windows of equal widths between −0.0125 and 1.0125 (bin width d<italic>x</italic>). The result of the histogram corresponds to the central phases of the 41 windows; the value for each central phase was used for their four adjacent phases, providing an array of 201 conditioners.</p>
<p>The balance weighting conditioner <inline-formula id="inline-formula12-1475090212439826"><mml:math display="inline" id="math18-1475090212439826"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>balance</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> considered the offset of the data selection window about the central phase, the premise being that, the closer the data, the better the estimate. A linear fit was used to evaluate the balance weighting conditioner over 41 iterations of the central phase (calculated at the same time as the means) and is given by</p>
<p>
<disp-formula id="disp-formula7-1475090212439826">
<mml:math display="block" id="math19-1475090212439826">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>C</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>balance</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mi>Mx</mml:mi>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
<mml:mspace width="0.25em"/>
<mml:mtext>for</mml:mtext>
<mml:mspace width="0.25em"/>
<mml:mi>x</mml:mi>
<mml:mo>=</mml:mo>
<mml:mo stretchy="false">(</mml:mo>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>,</mml:mo>
<mml:mo>−</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>5</mml:mn>
<mml:mo>,</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>,</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>5</mml:mn>
<mml:mo>,</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula7-1475090212439826" xlink:href="10.1177_1475090212439826-eq7.tif"/>
</disp-formula>
</p>
<p>
<disp-formula id="disp-formula8-1475090212439826">
<label>(7)</label>
<mml:math display="block" id="math20-1475090212439826">
<mml:mrow>
<mml:mi>M</mml:mi>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mtext>d</mml:mtext>
<mml:mi>x</mml:mi>
</mml:mrow>
</mml:mfrac>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mn>2</mml:mn>
<mml:msub>
<mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
<mml:mrow>
<mml:mi>central</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
<mml:mrow>
<mml:mi>lower</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
<mml:mrow>
<mml:mi>upper</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula8-1475090212439826" xlink:href="10.1177_1475090212439826-eq8.tif"/>
</disp-formula>
</p>
<p>where d<italic>x</italic>=5×0.005=0.025, <italic>t</italic>/<italic>T<sub>lower</sub></italic> is the lower extent of the data selection window, <italic>t</italic>/<italic>T<sub>upper</sub></italic> is the upper extent of the data selection window and <italic>x</italic> maps to the current adjacent phases and central phase. The central phase maps <inline-formula id="inline-formula13-1475090212439826"><mml:math display="inline" id="math21-1475090212439826"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and so the corresponding <inline-formula id="inline-formula14-1475090212439826"><mml:math display="inline" id="math22-1475090212439826"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>balance</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> will always equal unity. An equally balanced window has the same difference between the lower phase limit and the central phase as between the upper phase limit and the central phase; the slope <italic>M</italic> is zero, making <inline-formula id="inline-formula15-1475090212439826"><mml:math display="inline" id="math23-1475090212439826"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>balance</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> equal to unity for the four adjacent phases in addition to the central phase.</p>
<p>The mean and weighting preparation process yields five arrays (<italic>t</italic>/<italic>T, V<sub>x</sub>, w<sub>x</sub>, V<sub>y</sub></italic> and <italic>w<sub>y</sub></italic>) with 201 values each when applied to each velocity component. The second step of curve fitting was to process the prepared data with the spline fitting function. The B-spline functions were accessed from a Python wrapped version of the FORTRAN subroutines written by Dierckx<sup><xref ref-type="bibr" rid="bibr16-1475090212439826">16</xref></sup> which are smoothing splines with automatic knot selection (Fortran code<sup><xref ref-type="bibr" rid="bibr17-1475090212439826">17</xref></sup>). The Python wrapped version was accessed using the SciPy package FITPACK<sup><xref ref-type="bibr" rid="bibr18-1475090212439826">18</xref></sup>). Two functions from FITPACK were used: <italic>splprep</italic> and <italic>splev.</italic> First, the function <italic>splprep</italic> was used to calculate the knot points and coefficients (curve fitting) for both velocity components simultaneously (more dimensions are permitted). Second, the function <italic>splev</italic> was used to evaluate the knot points and coefficients to obtain the fitted velocity components for the specified phases.</p>
<p>Without smoothing, spline fitting forces a curve through each data point, the consequence being that point-to-point fluctuations (noise) will be exaggerated, which causes curve-fitting instability. The smoothing parameter <inline-formula id="inline-formula16-1475090212439826"><mml:math display="inline" id="math24-1475090212439826"><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:math></inline-formula> is used to trade off between the closeness and smoothness of fit; the amount of smoothing is determined by satisfying the condition <inline-formula id="inline-formula17-1475090212439826"><mml:math display="inline" id="math25-1475090212439826"><mml:mrow><mml:mo>∑</mml:mo><mml:mi>w</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>≤</mml:mo><mml:mspace width="0.25em"/><mml:mi>s</mml:mi></mml:mrow></mml:math></inline-formula>, where <inline-formula id="inline-formula18-1475090212439826"><mml:math display="inline" id="math26-1475090212439826"><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:math></inline-formula> is the weighting, <inline-formula id="inline-formula19-1475090212439826"><mml:math display="inline" id="math27-1475090212439826"><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:math></inline-formula> is the magnitude component of the data point and <inline-formula id="inline-formula20-1475090212439826"><mml:math display="inline" id="math28-1475090212439826"><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the smoothed interpolation of <inline-formula id="inline-formula21-1475090212439826"><mml:math display="inline" id="math29-1475090212439826"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula><sup><xref ref-type="bibr" rid="bibr19-1475090212439826">19</xref></sup> When weightings are based on the inverse of the standard deviation, good values of <inline-formula id="inline-formula22-1475090212439826"><mml:math display="inline" id="math30-1475090212439826"><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:math></inline-formula> can be found in the range <inline-formula id="inline-formula23-1475090212439826"><mml:math display="inline" id="math31-1475090212439826"><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>m</mml:mi></mml:mrow></mml:msqrt><mml:mo>&lt;</mml:mo><mml:mi>s</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>m</mml:mi></mml:mrow></mml:msqrt><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula><sup><xref ref-type="bibr" rid="bibr19-1475090212439826">19</xref></sup> The smoothing parameter used for curve fitting was left as the default according to</p>
<p>
<disp-formula id="disp-formula9-1475090212439826">
<label>(8)</label>
<mml:math display="block" id="math32-1475090212439826">
<mml:mrow>
<mml:mi>s</mml:mi>
<mml:mo>=</mml:mo>
<mml:mi>m</mml:mi>
<mml:mo>−</mml:mo>
<mml:msqrt>
<mml:mrow>
<mml:mn>2</mml:mn>
<mml:mi>m</mml:mi>
</mml:mrow>
</mml:msqrt>
<mml:mo>=</mml:mo>
<mml:mn>201</mml:mn>
<mml:mo>−</mml:mo>
<mml:msqrt>
<mml:mrow>
<mml:mn>2</mml:mn>
<mml:mo>×</mml:mo>
<mml:mn>201</mml:mn>
</mml:mrow>
</mml:msqrt>
<mml:mo>≈</mml:mo>
<mml:mn>181</mml:mn>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula9-1475090212439826" xlink:href="10.1177_1475090212439826-eq9.tif"/>
</disp-formula>
</p>
<p>where <inline-formula id="inline-formula24-1475090212439826"><mml:math display="inline" id="math33-1475090212439826"><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> is the number of elements in the array.</p>
<p>Non-continuous data were identified by the following method. The phase-sorted data were divided into 41 equally spaced windows between zero and unity; the data were considered to be non-continuous if more than half of the data in any window were invalid. Contiguous regions in non-continuous data were defined as being regions where there were at least two adjacent regions of valid data, which ensured a minimum of ten data points, corresponding to two central phases and eight adjacent phases, for spline evaluation.</p>
<p>When the data were continuous, the knot points and coefficients were calculated using the function <italic>splprep</italic> with the periodic switch enabled. The knot points and coefficients were then stored for the phase range 0≤ <italic>t</italic>/<italic>T</italic>&lt;1. When the data were non-continuous, the knot points and coefficients were evaluated for each region of validity in an iterative manner using <italic>splprep</italic> with the periodic switch disabled and passing data corresponding to the range of validity. The region of validity, the knot points and the coefficients were stored. Storing the region of validity, the knot points and the coefficients meant that the splines could be quickly evaluated for any phase in the range of validity at a later time.</p>
</sec>
<sec id="section7-1475090212439826">
<title>Uncertainty</title>
<p>The uncertainty of the phase-averaged (monochromatic) data exists in two dimensions: both phase and magnitude. The variance in magnitude is a function of the experimental methods including PIV uncertainty which has been characterized as approximately a tenth of a pixel<sup><xref ref-type="bibr" rid="bibr20-1475090212439826">20</xref></sup> and experimental phenomena including the differences from wave to wave and the presence of turbulence. The variance in phase is also a function of data acquisition. Ensemble averaging of randomly acquired data will produce variance that is a constant function of the bin width and will approach a constant standard deviation of d<italic>x</italic>/2<italic>c</italic>, where d<italic>x</italic> is the bin width and <italic>c</italic>=2 for the 95th percentile with an uncertainty of <inline-formula id="inline-formula25-1475090212439826"><mml:math display="inline" id="math34-1475090212439826"><mml:mrow><mml:mo>±</mml:mo><mml:mn>2</mml:mn><mml:mi>σ</mml:mi></mml:mrow></mml:math></inline-formula>. Clumped data in phase may produce a standard deviation in phase either better or worse than this depending on the precision of the synchronization system and the associated experimental variance. The uncertainty in phase is not a function of the number of data points and when using the spline-averaging method is reduced to the experimental uncertainty alone.</p>
</sec>
<sec id="section8-1475090212439826">
<title>Velocity field mosaic</title>
<p>Velocity fields with the same wave parameters and phases were merged to create a mosaic covering union of all positions by the following process. The resulting velocity field extent (see <xref ref-type="fig" rid="fig9-1475090212439826">Figures 9</xref> and <xref ref-type="fig" rid="fig10-1475090212439826">10</xref> later) was the smallest rectangle which encloses all positions. The vector spacing was taken as the vector spacing for the velocity field of position A. Each velocity field was resized using two-dimensional cubic spline interpolation to the shape and spacing of the resulting velocity field. The resulting velocity field was populated by taking the weighted average of the interpolated positions; the weighting for each position was a two-dimensional Gaussian distribution with a width of one standard deviation centred on the centre of the position of the source velocity field in both directions.</p>
</sec>
</sec>
<sec id="section9-1475090212439826" sec-type="results|discussion">
<title>Results and discussion</title>
<sec id="section10-1475090212439826">
<title>Curve-fitting performance</title>
<p>Depending on the grid location (the position in space), the instantaneous two-dimensional flow fields <inline-formula id="inline-formula26-1475090212439826"><mml:math display="inline" id="math35-1475090212439826"><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> displayed significant variations in both the profile and the distribution over a wave cycle associated with the localized phenomena including vortices, turbulence and water column slosh. Three separate examples are presented to demonstrate the performance differences between the ensemble averaging method and the curve-fitting method.</p>
<p>Details of the samples are provided in <xref ref-type="table" rid="table3-1475090212439826">Table 3</xref>; the physical locations are shown as the numbered patches in <xref ref-type="fig" rid="fig1-1475090212439826">Figure 1</xref>. The symbols used for the fits for the samples are shown in <xref ref-type="fig" rid="fig6-1475090212439826">Figures 6</xref>, <xref ref-type="fig" rid="fig7-1475090212439826">7</xref> and <xref ref-type="fig" rid="fig8-1475090212439826">8</xref> and are explained as follows.</p>
<table-wrap id="table3-1475090212439826" position="float">
<label>Table 3.</label>
<caption>
<p>Sample information.</p>
</caption>
<graphic alternate-form-of="table3-1475090212439826" xlink:href="10.1177_1475090212439826-table3.tif"/>
<table>
<colgroup>
<col align="left"/>
<col align="char" char="."/>
<col align="char" char="."/>
<col align="char" char="."/>
<col align="char" char="."/>
<col align="left"/>
<col align="char" char="."/>
<col align="char" char="."/>
</colgroup>
<thead>
<tr>
<th align="left">Sample</th>
<th align="left">Patch number (<xref ref-type="fig" rid="fig1-1475090212439826">Figure 1</xref>)</th>
<th align="left">Wave height (m)</th>
<th align="left">Wave frequency (Hz)</th>
<th align="left">Position (field of view)</th>
<th align="left">(<italic>x, y</italic>) coordinates (mm)</th>
<th align="left">Data points</th>
<th align="left">Figure</th>
</tr>
</thead>
<tbody>
<tr>
<td>Vortex transit</td>
<td>1</td>
<td>0.07</td>
<td>0.57</td>
<td>A</td>
<td>(9, −135)</td>
<td>230</td>
<td>6</td>
</tr>
<tr>
<td>Discontinuous</td>
<td>2</td>
<td>0.07</td>
<td>0.50</td>
<td>F</td>
<td>(223, −27)</td>
<td>501</td>
<td>7</td>
</tr>
<tr>
<td>Sloshing</td>
<td>3</td>
<td>0.07</td>
<td>0.77</td>
<td>C</td>
<td>(–307, −40)</td>
<td>915</td>
<td>8</td>
</tr>
</tbody>
</table>
</table-wrap>
<fig id="fig6-1475090212439826" position="float">
<label>Figure 6.</label>
<caption>
<p>Vortex transit (sample 1): spline-averaged and ensemble-averaged fit (horizontal component).</p>
</caption>
<graphic xlink:href="10.1177_1475090212439826-fig6.tif"/>
</fig>
<fig id="fig7-1475090212439826" position="float">
<label>Figure 7.</label>
<caption>
<p>Discontinuous data (sample 2): spline-averaged and ensemble-averaged fit (vertical component).</p>
</caption>
<graphic xlink:href="10.1177_1475090212439826-fig7.tif"/>
</fig>
<fig id="fig8-1475090212439826" position="float">
<label>Figure 8.</label>
<caption>
<p>Water column slosh (sample 3): spline-averaged and ensemble-averaged fit (horizontal component).</p>
</caption>
<graphic xlink:href="10.1177_1475090212439826-fig8.tif"/>
</fig>
<list id="list3-1475090212439826" list-type="order">
<list-item><p>The points represent the instantaneous data.</p></list-item>
<list-item><p>The grey solid curve with peaks extending from the bottom of each figure is the normalized weighting (the absolute magnitude is not important here) <inline-formula id="inline-formula27-1475090212439826"><mml:math display="inline" id="math36-1475090212439826"><mml:mrow><mml:mi>w</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mover><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula></p></list-item>
<list-item><p>The grey curve with very small open squares shows the 201 means which were calculated using the polynomial fit.</p></list-item>
<list-item><p>The open squares show the ensemble-averaged fit.</p></list-item>
<list-item><p>The dashed curve traces the spline average.</p></list-item>
</list>
<p>The vortex transit sample (<xref ref-type="fig" rid="fig6-1475090212439826">Figure 6</xref>) was taken from below the upper lip of the OWC (sample location 1 in <xref ref-type="fig" rid="fig1-1475090212439826">Figure 1</xref>). The scatter in magnitude of the data points for both velocity components is greater for the phase range 0.6&lt;<italic>t</italic>/<italic>T</italic>&lt;0.8 (only shown for the horizontal component), which is explained by the turbulence associated with separation of the flow from the sharp corner between the front wall of the chamber and the upper lip. Because of the clumping of the data in phase, the ensemble phase average is missing every second data point. The spline-averaged curve is continuous, showing that missing regions have been interpolated. The effect of the smoothing can be seen for the spline fit around <italic>t</italic>/<italic>T</italic>=0.66 where the spline-averaged curve maintains a good trend while the 201 means curve had a rapid change in magnitude, an artifice introduced by the algorithm. The peaks of the weightings (grey-shaded peaks) correspond to the presence of data and are further amplified by the distribution conditioner. The slopes of the weightings (making peaks) are caused by a combination of the standard deviations and balance weighting conditioner. Overall, both methods are in close agreement over the wave cycle. Where an ensemble-averaged result exists (half is missing), the phase bias error is low since the average of the phase for the data averaged is close to the phase used. The periodic switch of the spline fitting function has ensured alignment at the beginning and the end of the spline, and the use of weightings and smoothing provides appropriate interpolation over the wave cycle.</p>
<p>The discontinuous region sample (<xref ref-type="fig" rid="fig7-1475090212439826">Figure 7</xref>) was taken from outside and above the upper lip of the OWC and is below the still water level (sample location 2 on <xref ref-type="fig" rid="fig1-1475090212439826">Figure 1</xref>). The free surface drops below the pixel position for the phase range 0.45&lt;<italic>t</italic>/<italic>T</italic>&lt;0.98, which is illustrated by the absence of data. Since the data are discontinuous, the spline fit was performed iteratively in non-periodic mode. The trend of the data was quite simple to follow and presented little problem to the spline; however, there was some small instability but the performance is still better than by ensemble averaging. Furthermore the spline curve is only present in the regions of valid data. Clumping of the data in phase caused significant bias error of ensemble-averaged data for this particular data set, which is most obvious for the third, fifth and seventh open squares from the left. The error can be seen as the horizontal difference between the ensemble-averaged point and the concentration of data nearby, which was used to calculate the ensemble average. The bias error was due to clumping of the data at one end of the averaging window which, as previously mentioned, was a direct result of the fact that the data acquisition frequency was an integer fraction of the wave frequency.</p>
<p>The water column slosh sample (<xref ref-type="fig" rid="fig8-1475090212439826">Figure 8</xref>) was taken from inside the OWC chamber below the still water level (sample location 3 in <xref ref-type="fig" rid="fig1-1475090212439826">Figure 1</xref>). The effect of sloshing can be seen as multiple flow reversals in both velocity components (only the horizontal component is shown). The spline fit follows the data trends well; importantly the spline is able to cope with multiple reversals over a cycle (which had been problematic for higher-order polynomials) and is periodic, ensuring that the ends meet. The ensemble-averaged fit is reasonable but suffers from phase bias error due to the uneven distribution of the data in phase which is not as visually apparent as in <xref ref-type="fig" rid="fig7-1475090212439826">Figure 7</xref> but does deviate from the 201 means curve, implying phase bias error.</p>
</sec>
<sec id="section11-1475090212439826">
<title>Velocity fields</title>
<p>As mentioned in the introduction, it was not possible to obtain reliable phase-averaged velocity fields at the higher-frequency waves (0.50 Hz, 0.57Hz and 0.77Hz) by ensemble averaging because of clumping of the data in phase. The curve-fitting method was successful at ensemble averaging for all frequencies (with the same data). The phase-averaged velocity fields for the 0.07m, 0.77Hz wave are presented in <xref ref-type="fig" rid="fig9-1475090212439826">Figures 9</xref> and <xref ref-type="fig" rid="fig1-1475090212439826">10</xref> over one wave cycle, which had the most contrast compared with those of the 0.07m, 0.44Hz wave (ensemble averaged) that has been reported previously.<sup><xref ref-type="bibr" rid="bibr10-1475090212439826">10</xref></sup> The main differences are as follows.</p>
<fig id="fig9-1475090212439826" position="float">
<label>Figure 9.</label>
<caption>
<p>Velocity and vorticity field inside and outside the OWC device for the first half of a cycle with three-quarters of vectors hidden for clarity (<italic>H</italic> = 0.07 m and <italic>f</italic> = 0.77 Hz).</p>
</caption>
<graphic xlink:href="10.1177_1475090212439826-fig9.tif"/>
</fig>
<fig id="fig10-1475090212439826" position="float">
<label>Figure 10.</label>
<caption>
<p>Velocity and vorticity field inside and outside the OWC device for the second half of a cycle with three-quarters of vectors hidden for clarity (<italic>H</italic> = 0.07 m and <italic>f</italic> = 0.77 Hz).</p>
</caption>
<graphic xlink:href="10.1177_1475090212439826-fig10.tif"/>
</fig>
<list id="list4-1475090212439826" list-type="order">
<list-item><p>Water column slosh is significant and obvious for the 0.07 m, 0.77Hz wave.</p></list-item>
<list-item><p>The vortices at the lower lip are smaller and of lower intensity for the 0.07 m, 0.77Hz wave.</p></list-item>
<list-item><p>For the 0.07m, 0.77Hz wave, flow at the upper lip is more pronounced and energetic; specifically referring to flow above the upper lip, for <italic>t</italic>/<italic>T</italic> = 0.03, flow appears to be forming a plunging breaker while, at <italic>t</italic>/<italic>T</italic>=0.06, the water impacts the front face.</p></list-item>
</list>
<p>Absolute two-dimensional vorticity <inline-formula id="inline-formula28-1475090212439826"><mml:math display="inline" id="math37-1475090212439826"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mo>∂</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mo>∂</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mo>∂</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mo>∂</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula><sup><xref ref-type="bibr" rid="bibr21-1475090212439826">21</xref></sup> is included in the background of each velocity field to highlight the presence of vortices. For visualization purposes the images are best viewed in sequence.</p>
<p>Accompanying the online version of this paper are four animated GIF images corresponding to the wave conditions tested. The GIF images show a looped sequence of the velocity vectors and vorticity similar to those shown in <xref ref-type="fig" rid="fig9-1475090212439826">Figure 9</xref> and <xref ref-type="fig" rid="fig10-1475090212439826">10</xref> over a wave cycle. The GIF images were configured to playback at real-time speeds corresponding to the wave frequency and clearly show the average two-dimensional flow-field phenomena occurring at the centre-line of the OWC including oscillating flow, water column heave and slosh, front-wall swash and down wash, an outflow jet and vortices.</p>
</sec>
</sec>
<sec id="section12-1475090212439826" sec-type="conclusions">
<title>Conclusions</title>
<p>Phase-averaged analysis by curve fitting with B-splines offers the following advantages over ensemble averaging when processing the data that are clumped in phase:</p>
<list id="list5-1475090212439826" list-type="alpha-lower">
<list-item><p>a reduced uncertainty in phase;</p></list-item>
<list-item><p>removal of the phase bias error;</p></list-item>
<list-item><p>automatic interpolation and smoothing;</p></list-item>
<list-item><p>a consistent method for handling discontinuous data.</p></list-item>
</list>
<p>Generally, the curve-fitting method is more suitable than the ensemble averaging method for phase averaging of randomly acquired data whose acquisition cannot be easily synchronized with the phasing signal (not encoded), where the data acquisition rate is relatively slow or the data storage requirements are high such that increasing the number of phase bins becomes inhibitive, namely PIV velocity fields. The curve-fitting method does this by using trends in the data (the slope of the curves) to eliminate the phase bias error. This is at the expense of a longer processing time and an algorithm which may require some fine tuning. A key point to highlight is that the curve-fitting method presented here has permitted the use of data which otherwise would have been unusable, or at the very least of a lower quality via ensemble averaging.</p>
<p>The curve-fitting method presented was used to obtain two-dimensional phase-averaged velocity fields at the centre-line plane of the OWC for different incident wave frequencies over a monochromatic wave cycle. The velocity fields were used for qualitative (visualization) purposes but can also be used for quantitative purposes; of particular interest is the total kinetic energy calculated from the velocity fields which can be used in an energy analysis.</p>
<p>Phase-averaged analysis of OWCs and wave energy converters promises to be of immediate use in terms of geometry design and optimization but is limited to monochromatic waves. The phase averaging method may be extended to the analysis of periodic pseudo-irregular seas but is reliant on the repeatability of experimental conditions and the determination of the phase signal.</p>
</sec>
</body>
<back>
<app-group>
<app id="app1-1475090212439826">
<title>Appendix 1</title>
<sec id="section13-1475090212439826">
<title>Notation</title>
<p>
<inline-formula id="inline-formula29-1475090212439826">
<mml:math display="inline" id="math38-1475090212439826">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>C</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>balance</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> balance-type conditioner</p>
<p>
<inline-formula id="inline-formula30-1475090212439826">
<mml:math display="inline" id="math39-1475090212439826">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>C</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>distribution</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> distribution-type conditioner</p>
<p>
<inline-formula id="inline-formula31-1475090212439826">
<mml:math display="inline" id="math40-1475090212439826">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>C</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>i</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> conditioner, an array with a mean of unity</p>
<p>d<italic>x</italic> phase interval (s)</p>
<p>
<inline-formula id="inline-formula32-1475090212439826">
<mml:math display="inline" id="math41-1475090212439826">
<mml:mrow>
<mml:mi>f</mml:mi>
</mml:mrow>
</mml:math>
</inline-formula> wave frequency (Hz)</p>
<p><italic>M</italic> slope</p>
<p>
<inline-formula id="inline-formula33-1475090212439826">
<mml:math display="inline" id="math42-1475090212439826">
<mml:mrow>
<mml:mi>n</mml:mi>
</mml:mrow>
</mml:math>
</inline-formula> number of elements in the array</p>
<p>
<inline-formula id="inline-formula34-1475090212439826">
<mml:math display="inline" id="math43-1475090212439826">
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
</mml:math>
</inline-formula> time (s)</p>
<p>
<inline-formula id="inline-formula35-1475090212439826">
<mml:math display="inline" id="math44-1475090212439826">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>image</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> time that the image is recorded</p>
<p>
<inline-formula id="inline-formula36-1475090212439826">
<mml:math display="inline" id="math45-1475090212439826">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>zero</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> time of zero crossing of the immediate wave</p>
<p>
<inline-formula id="inline-formula37-1475090212439826">
<mml:math display="inline" id="math46-1475090212439826">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>zero</mml:mi>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> time of zero crossing of the end of the immediate wave</p>
<p>
<inline-formula id="inline-formula38-1475090212439826">
<mml:math display="inline" id="math47-1475090212439826">
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:math>
</inline-formula> wave period<inline-formula id="inline-formula39-1475090212439826"><mml:math display="inline" id="math48-1475090212439826"><mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:math></inline-formula> (s)</p>
<p>
<inline-formula id="inline-formula40-1475090212439826">
<mml:math display="inline" id="math49-1475090212439826">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>V</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>avg</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> average velocity of a set of velocities (m/s)</p>
<p>
<inline-formula id="inline-formula41-1475090212439826">
<mml:math display="inline" id="math50-1475090212439826">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>V</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>r</mml:mi>
<mml:mo>.</mml:mo>
<mml:mi>m</mml:mi>
<mml:mo>.</mml:mo>
<mml:mi>s</mml:mi>
<mml:mo>.</mml:mo>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> standard deviation velocity of a set of velocities (m/s)</p>
<p>
<inline-formula id="inline-formula42-1475090212439826">
<mml:math display="inline" id="math51-1475090212439826">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>V</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> horizontal velocity component (m/s)</p>
<p>
<inline-formula id="inline-formula43-1475090212439826">
<mml:math display="inline" id="math52-1475090212439826">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>V</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>i</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> horizontal velocity component at the pixel position <inline-formula id="inline-formula44-1475090212439826"><mml:math display="inline" id="math53-1475090212439826"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula> (m/s)</p>
<p>
<inline-formula id="inline-formula45-1475090212439826">
<mml:math display="inline" id="math54-1475090212439826">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>V</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>y</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> vertical velocity component (m/s)</p>
<p>
<inline-formula id="inline-formula46-1475090212439826">
<mml:math display="inline" id="math55-1475090212439826">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>V</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>y</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>i</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> vertical velocity component at the pixel position <inline-formula id="inline-formula47-1475090212439826"><mml:math display="inline" id="math56-1475090212439826"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula> (m/s)</p>
<p>
<inline-formula id="inline-formula48-1475090212439826">
<mml:math display="inline" id="math57-1475090212439826">
<mml:mrow>
<mml:mi>w</mml:mi>
</mml:mrow>
</mml:math>
</inline-formula> weighting array</p>
<p>
<inline-formula id="inline-formula49-1475090212439826">
<mml:math display="inline" id="math58-1475090212439826">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>w</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> weighting array with conditioners applied</p>
<p>
<inline-formula id="inline-formula50-1475090212439826">
<mml:math display="inline" id="math59-1475090212439826">
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
</mml:math>
</inline-formula> horizontal component</p>
<p>
<inline-formula id="inline-formula51-1475090212439826">
<mml:math display="inline" id="math60-1475090212439826">
<mml:mrow>
<mml:mi>y</mml:mi>
</mml:mrow>
</mml:math>
</inline-formula> magnitude component</p>
<p>
<inline-formula id="inline-formula52-1475090212439826">
<mml:math display="inline" id="math61-1475090212439826">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>γ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>FH</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> first-harmonic phase shift</p>
<p>
<inline-formula id="inline-formula53-1475090212439826">
<mml:math display="inline" id="math62-1475090212439826">
<mml:mrow>
<mml:mi>λ</mml:mi>
</mml:mrow>
</mml:math>
</inline-formula> wavelength (m)</p>
</sec>
</app>
</app-group>
<ack>
<p>The authors thank Laurie Goldsworthy for assistance with PIV data collection and post-processing.</p>
</ack>
<fn-group>
<fn fn-type="financial-disclosure">
<label>Funding</label>
<p>This work was supported by the Australian Research Council and Oceanlinx (grant no. LP110200129).</p>
</fn>
</fn-group>
<ref-list>
<title>References</title>
<ref id="bibr1-1475090212439826">
<label>1.</label>
<citation citation-type="book">
<person-group person-group-type="editor">
<name><surname>Brooke</surname><given-names>J</given-names></name>
</person-group> (ed). <source>Wave energy conversion</source>. <edition>1st edition</edition>. <publisher-loc>Amsterdam</publisher-loc>: <publisher-name>Elsevier</publisher-name>, <year>2003</year>.</citation>
</ref>
<ref id="bibr2-1475090212439826">
<label>2.</label>
<citation citation-type="book">
<person-group person-group-type="author">
<name><surname>Raffel</surname><given-names>M</given-names></name>
<name><surname>Wereley</surname><given-names>S</given-names></name>
<name><surname>Willert</surname><given-names>C</given-names></name>
<name><surname>Kompenhans</surname><given-names>J</given-names></name>
</person-group>. <source>Particle image velocimetry: a practical guide</source>. <edition>2nd edition</edition>. <publisher-loc>Berlin</publisher-loc>: <publisher-name>Springer</publisher-name>, <year>2007</year>.</citation>
</ref>
<ref id="bibr3-1475090212439826">
<label>3.</label>
<citation citation-type="book">
<person-group person-group-type="editor">
<name><surname>Grue</surname><given-names>J</given-names></name>
<name><surname>Liu</surname><given-names>PLF</given-names></name>
<name><surname>Pedersen</surname><given-names>GK</given-names></name>
</person-group> (eds). <source>PIV and water waves</source>. <publisher-loc>Singapore</publisher-loc>: <publisher-name>World Scientific</publisher-name>, <year>2004</year>.</citation>
</ref>
<ref id="bibr4-1475090212439826">
<label>4.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Felli</surname><given-names>M</given-names></name>
<name><surname>Falchi</surname><given-names>M</given-names></name>
<name><surname>Pereira</surname><given-names>F</given-names></name>
</person-group>. <article-title>Distance effect on the behavior of an impinging swirling jet by PIV and flow visualizations</article-title>. <source>Exp Fluids</source> <year>2010</year>; <volume>48</volume>(<issue>2</issue>): <fpage>197</fpage>–<lpage>209</lpage>.</citation>
</ref>
<ref id="bibr5-1475090212439826">
<label>5.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Felli</surname><given-names>M</given-names></name>
<name><surname>Roberto</surname><given-names>C</given-names></name>
<name><surname>Guj</surname><given-names>G</given-names></name>
</person-group>. <article-title>Experimental analysis of the flow field around a propeller–rudder configuration</article-title>. <source>Exp Fluids</source> <year>2009</year>; <volume>46</volume>(<issue>1</issue>): <fpage>147</fpage>–<lpage>164</lpage>.</citation>
</ref>
<ref id="bibr6-1475090212439826">
<label>6.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Huang</surname><given-names>Z-C</given-names></name>
<name><surname>Hsiao</surname><given-names>S-C</given-names></name>
<name><surname>Hwung</surname><given-names>H-H</given-names></name>
<name><surname>Chang</surname><given-names>K-A</given-names></name>
</person-group>. <article-title>Turbulence and energy dissipations of surf-zone spilling breakers</article-title>. <source>Coastal Engng</source> <year>2009</year>; <volume>56</volume>(<issue>7</issue>): <fpage>733</fpage>–<lpage>746</lpage>.</citation>
</ref>
<ref id="bibr7-1475090212439826">
<label>7.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Ryu</surname><given-names>Y</given-names></name>
<name><surname>Chang</surname><given-names>K-A</given-names></name>
<name><surname>Mercier</surname><given-names>R</given-names></name>
</person-group>. <article-title>Runup and green water velocities due to breaking wave impinging and overtopping</article-title>. <source>Exp Fluids</source> <year>2007</year>; <volume>43</volume>(<issue>4</issue>): <fpage>555</fpage>–<lpage>567</lpage>.</citation>
</ref>
<ref id="bibr8-1475090212439826">
<label>8.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Kimmoun</surname><given-names>O</given-names></name>
<name><surname>Branger</surname><given-names>H</given-names></name>
</person-group>. <article-title>A particle image velocimetry investigation on laboratory surf-zone breaking waves over a sloping beach</article-title>. <source>J Fluid Mech</source> <year>2007</year>; <volume>588</volume>: <fpage>353</fpage>–<lpage>397</lpage>.</citation>
</ref>
<ref id="bibr9-1475090212439826">
<label>9.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Jung</surname><given-names>K</given-names></name>
<name><surname>Chang</surname><given-names>K</given-names></name>
<name><surname>Huang</surname><given-names>E</given-names></name>
</person-group>. <article-title>Two-dimensional flow characteristics of wave interactions with a free-rolling rectangular structure</article-title>. <source>Ocean Engng</source> <year>2005</year>; <volume>32</volume>(<issue>1</issue>): <fpage>1</fpage>–<lpage>20</lpage>.</citation>
</ref>
<ref id="bibr10-1475090212439826">
<label>10.</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Fleming</surname><given-names>A</given-names></name>
<name><surname>Penesis</surname><given-names>I</given-names></name>
<name><surname>Goldsworthy</surname><given-names>L</given-names></name><etal/>
</person-group>. <article-title>Phase averaged flow analysis in an oscillating water column wave energy converter</article-title>. In: <conf-name>ASME 2011 30th international conference on ocean, offshore and Arctic engineering</conf-name>, <conf-loc>Rotterdam, The Netherlands</conf-loc>, <conf-date>19–24 June</conf-date> <year>2011</year>, paper OMAE2011-49426. <publisher-loc>New York</publisher-loc>: <publisher-name>ASME</publisher-name>.</citation>
</ref>
<ref id="bibr11-1475090212439826">
<label>11.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Longo</surname><given-names>J</given-names></name>
<name><surname>Shao</surname><given-names>J</given-names></name>
<name><surname>Irvine</surname><given-names>M</given-names></name>
<name><surname>Stern</surname><given-names>F</given-names></name>
</person-group>. <article-title>Phase-averaged PIV for the nominal wake of a surface ship in regular head waves</article-title>. <source>J Fluids Engng</source> <year>2007</year>; <volume>129</volume>(<issue>5</issue>): <fpage>524</fpage>–<lpage>540</lpage>.</citation>
</ref>
<ref id="bibr12-1475090212439826">
<label>12.</label>
<citation citation-type="web">
<collab>AMC Australian Maritime College</collab>. <article-title>Towing tank</article-title>, <ext-link ext-link-type="uri" xlink:href="http://www.amc.edu.au/maritime-engineering/towing-tank">http://www.amc.edu.au/maritime-engineering/towing-tank</ext-link> (<year>2011</year>).</citation>
</ref>
<ref id="bibr13-1475090212439826">
<label>13.</label>
<citation citation-type="book">
<collab>LaVision GmbH</collab>. <source>Product manual for DaVis 7.2</source>. <publisher-loc>Göttingen</publisher-loc>: <publisher-name>LaVision GmbH</publisher-name>, <year>2009</year>.</citation>
</ref>
<ref id="bibr14-1475090212439826">
<label>14.</label>
<citation citation-type="book">
<person-group person-group-type="editor">
<name><surname>Van Rossum</surname><given-names>G</given-names></name>
<name><surname>Drake</surname><given-names>FL</given-names></name>
</person-group> (eds). <source>Python reference manual</source>. <publisher-loc>Falls Church, VA</publisher-loc>: <publisher-name>PythonLabs</publisher-name>, <year>1995</year>.</citation>
</ref>
<ref id="bibr15-1475090212439826">
<label>15.</label>
<citation citation-type="web">
<collab>Python</collab>. <article-title>Python programming language – official website</article-title>, <ext-link ext-link-type="uri" xlink:href="http://www.python.org">www.python.org</ext-link> (<year>2011</year>).</citation>
</ref>
<ref id="bibr16-1475090212439826">
<label>16.</label>
<citation citation-type="book">
<person-group person-group-type="author">
<name><surname>Dierckx</surname><given-names>P</given-names></name>
</person-group>. <source>Curve and surface fitting with splines</source>. <publisher-loc>Oxford</publisher-loc>: <publisher-name>Oxford University Press</publisher-name>, <year>1993</year>.</citation>
</ref>
<ref id="bibr17-1475090212439826">
<label>17.</label>
<citation citation-type="web">
<collab>DIERCX</collab>, <ext-link ext-link-type="uri" xlink:href="http://www.netlib.org/dierckx/">http://www.netlib.org/dierckx/</ext-link> (<year>2011</year>).</citation>
</ref>
<ref id="bibr18-1475090212439826">
<label>18.</label>
<citation citation-type="web">
<collab>SciPy</collab>. <article-title>Scientific tools for Python</article-title>, <ext-link ext-link-type="uri" xlink:href="http://www.scipy.org">http://www.scipy.org</ext-link> (<year>2011</year>).</citation>
</ref>
<ref id="bibr19-1475090212439826">
<label>19.</label>
<citation citation-type="web">
<person-group person-group-type="author">
<name><surname>Jones</surname><given-names>E</given-names></name>
<name><surname>Oliphant</surname><given-names>T</given-names></name>
<name><surname>Peterson</surname><given-names>P</given-names></name><etal/>
</person-group>. <article-title>SciPy: open source scientific tools for Python</article-title>, <ext-link ext-link-type="uri" xlink:href="http://www.scipy.org">http://www.scipy.org</ext-link> (<year>2001</year>).</citation>
</ref>
<ref id="bibr20-1475090212439826">
<label>20.</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Felli</surname><given-names>M</given-names></name>
<name><surname>Pereira</surname><given-names>F</given-names></name>
<name><surname>Calcagno</surname><given-names>G</given-names></name>
<name><surname>Di Felice</surname><given-names>F</given-names></name>
</person-group>. <article-title>Application of stereo-PIV: propeller wake analysis in a large circulating water channel</article-title>. In: <conf-name>11th international symposium on applications of laser techniques to fluid mechanics</conf-name>, <conf-loc>Lisbon, Portugal</conf-loc>, <conf-date>8–11 July</conf-date> <year>2002</year>, paper-26-4. <publisher-loc>Lisbon</publisher-loc>: <publisher-name>Centro de Estudios em Inovação, Tecnologia e Políticas de Desenvolvimento (IN+), Instituto Superior Técnico, Universidade Técnica de Lisboa</publisher-name>.</citation>
</ref>
<ref id="bibr21-1475090212439826">
<label>21.</label>
<citation citation-type="other">
<person-group person-group-type="author">
<name><surname>Graw</surname><given-names>KU</given-names></name>
<name><surname>Schimmels</surname><given-names>S</given-names></name>
<name><surname>Lengricht</surname><given-names>J</given-names></name>
</person-group>. <article-title>Quantifying losses around the lip of an OWC by use of particle image velocimetry (PIV)</article-title>. LACER-Leipzig Annual Civil Engineering Report, Aalborg, Denmark, <year>2000</year>.</citation>
</ref>
</ref-list>
</back>
</article>