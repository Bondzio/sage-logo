<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v2.3 20070202//EN" "journalpublishing.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">PII</journal-id>
<journal-id journal-id-type="hwp">sppii</journal-id>
<journal-title>Proceedings of the Institution of Mechanical Engineers, Part I: Journal of Systems and Control Engineering</journal-title>
<issn pub-type="ppub">0959-6518</issn>
<issn pub-type="epub">2041-3041</issn>
<publisher>
<publisher-name>SAGE Publications</publisher-name>
<publisher-loc>Sage UK: London, England</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1177/0959651811433121</article-id>
<article-id pub-id-type="publisher-id">10.1177_0959651811433121</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Original Articles</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>In-process surface profile assessment of rotary machined timber using a dynamic photometric stereo technique</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<name><surname>Ogun</surname><given-names>Philips S</given-names></name>
</contrib>
<contrib contrib-type="author">
<name><surname>Jackson</surname><given-names>Michael R</given-names></name>
</contrib>
<contrib contrib-type="author">
<name><surname>Parkin</surname><given-names>Robert M</given-names></name>
</contrib>
<aff id="aff1-0959651811433121">Mechatronics Research Centre, Loughborough University, UK</aff>
</contrib-group>
<author-notes>
<corresp id="corresp1-0959651811433121">Philips S Ogun, Mechatronics Research Centre, Wolfson School of Mechanical and Manufacturing Engineering, Loughborough University, Holywell Building, Loughborough LE11 3UZ, UK. Email: <email>p.s.ogun@lboro.ac.uk</email></corresp>
</author-notes>
<pub-date pub-type="epub-ppub">
<month>7</month>
<year>2012</year>
</pub-date>
<volume>226</volume>
<issue>6</issue>
<fpage>823</fpage>
<lpage>830</lpage>
<history>
<date date-type="received">
<day>20</day>
<month>8</month>
<year>2011</year>
</date>
<date date-type="accepted">
<day>23</day>
<month>11</month>
<year>2011</year>
</date>
</history>
<permissions>
<copyright-statement>© IMechE 2012</copyright-statement>
<copyright-year>2012</copyright-year>
<copyright-holder content-type="society">Institution of Mechanical Engineers</copyright-holder>
</permissions>
<abstract>
<p>Machining operations have advanced in speed and there is an increasing demand for higher quality surface finish. It is therefore necessary to develop real-time surface inspection techniques which will provide sensory information for controlling the machining processes. This paper describes a practical method for real-time analysis of planed wood using the photometric stereo technique. Earlier research has shown that the technique is very effective in assessing surface waviness on static wood samples. In this paper, the photometric stereo method is extended to real industrial applications where samples are subjected to rapid movements. Surface profiles extracted from the dynamic photometric stereo method are compared with those from the static measurements and the results show that there is a high correlation between the two methods.</p>
</abstract>
<kwd-group>
<kwd>Wood machining</kwd>
<kwd>surface waviness</kwd>
<kwd>surface inspection</kwd>
<kwd>dynamic photometric stereo</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="section1-0959651811433121" sec-type="intro">
<title>Introduction</title>
<p>Rotary machining of timber is similar to the milling of metals. During the process, the timber workpiece is fed into a revolving cutterhead. The cutters remove wood chips from the surface of the workpiece, thereby creating series of waves known as cuttermarks on the workpiece.<sup><xref ref-type="bibr" rid="bibr1-0959651811433121">1</xref></sup> The sizes and uniformity of the cuttermarks are used to determine the quality of the surface finish. As quality control demands increase, there is the need to perform in-process assessment of the cuttermarks so that necessary control actions can be made when the surface quality deviates from the desired.</p>
<p>Research into surface profile inspection has received lesser attention in the woodworking industry compared to the metalworking industry. The popular contact-based measurement using a Stylus profilometer has been found to be unsuitable for in-process surface profile assessment because of its limited speed.<sup><xref ref-type="bibr" rid="bibr2-0959651811433121">2</xref></sup> Some of the currently developed non-contact wood surface profile measurement techniques based on machine vision have been analysed elsewhere.<sup><xref ref-type="bibr" rid="bibr3-0959651811433121">3</xref></sup></p>
<p>An image processing system was developed by Hesselbach et al.<sup><xref ref-type="bibr" rid="bibr4-0959651811433121">4</xref></sup> for measuring the cuttermarks on a planed wood. The processing algorithm is based on finding the average intensity values in each row of the images. The method is suitable for assessing moving wood samples at high feed rate because of its simplicity. However, it is unable to reveal any information about the heights of the cuttermarks. The light sectioning method<sup><xref ref-type="bibr" rid="bibr2-0959651811433121">2</xref></sup> and the photometric stereo (PS) technique<sup><xref ref-type="bibr" rid="bibr5-0959651811433121">5</xref>,<xref ref-type="bibr" rid="bibr6-0959651811433121">6</xref></sup> have also been used to assess the surface waviness on static wood samples.</p>
<p>In principle, the conventional photometric stereo (CPS) technique is only suitable for analysing static surfaces because it requires that the position of the object remains fixed with respect to the camera during the acquisition of the images. The so-called correspondence problem now arises if the sample is subjected to some movements during the acquisition of the successive image pairs. The main aim of the present paper is to improve on the work reported earlier<sup><xref ref-type="bibr" rid="bibr5-0959651811433121">5</xref>,<xref ref-type="bibr" rid="bibr6-0959651811433121">6</xref></sup> by extending the PS method to the assessment of cuttermarks on dynamic wood samples.</p>
<p>Some existing applications have already applied the PS technique to moving surface analysis.<sup><xref ref-type="bibr" rid="bibr7-0959651811433121">7</xref><xref ref-type="bibr" rid="bibr8-0959651811433121"/>–<xref ref-type="bibr" rid="bibr9-0959651811433121">9</xref></sup> This is termed as dynamic photometric stereo (DPS). A case study on the online inspection of ceramic tiles is presented by Farooq et al.<sup><xref ref-type="bibr" rid="bibr8-0959651811433121">8</xref></sup> A method known as spatial multiplexing is used to achieve a synchronised capture of multiple images. The registration of the images is achieved through pre-calibration of the sample speed. The limitation of this method is that it can only work for a predetermined speed and the image capture synchronisation must be fixed. As such, the relative movement between the imaging system and the object needs to be precisely controlled. There are other applications of the DPS where single coloured images are utilised instead of multiple grey-level images.<sup><xref ref-type="bibr" rid="bibr10-0959651811433121">10</xref></sup></p>
</sec>
<sec id="section2-0959651811433121">
<title>Theory of photometric stereo</title>
<p>Although the detailed idea behind the use of the PS technique to extract cuttermarks from planed wood has been reported previously,<sup><xref ref-type="bibr" rid="bibr5-0959651811433121">5</xref>,<xref ref-type="bibr" rid="bibr6-0959651811433121">6</xref></sup> the basic theory is still presented here for completeness. The PS technique is used to estimate local gradient of a surface from multiple images captured in a fixed spatial location but under different illumination directions.<sup><xref ref-type="bibr" rid="bibr11-0959651811433121">11</xref><xref ref-type="bibr" rid="bibr12-0959651811433121"/>–<xref ref-type="bibr" rid="bibr13-0959651811433121">13</xref></sup> The fundamental theory that underpins the application of the PS technique to wood surfaces is the assumption that wood exhibits Lambertian (diffuse) reflectance. Although total reflection from polished wood usually comprises both specular and diffuse reflection, unpolished wood exhibits nearly diffuse reflectance.<sup><xref ref-type="bibr" rid="bibr14-0959651811433121">14</xref></sup> The geometry of the Lambertian surface imaging system is shown in <xref ref-type="fig" rid="fig1-0959651811433121">Figure 1</xref>, where:</p>
<list id="list1-0959651811433121" list-type="bullet">
<list-item>
<p>the <italic>XY</italic> plane is coincident with the object surface and the <italic>Z</italic> axis is perpendicular to the object surface;</p>
</list-item>
<list-item>
<p>the <italic>Z</italic> axis is aligned with the viewing direction;</p>
</list-item>
<list-item>
<p>τ, known as the azimuth or tilt angle of the light source, is the angle between the <italic>X</italic> axis and the light path measured in the <italic>XY</italic> plane;</p>
</list-item>
<list-item>
<p>σ, known as the zenith or slant angle of the light source, is the angle between the light path and the camera direction.</p>
</list-item>
</list>
<fig id="fig1-0959651811433121" position="float">
<label>Figure 1.</label>
<caption>
<p>Geometry of the Lambertian surface imaging system.<sup><xref ref-type="bibr" rid="bibr5-0959651811433121">5</xref></sup></p>
</caption>
<graphic xlink:href="10.1177_0959651811433121-fig1.tif"/>
</fig>
<p>According to Lambert’s law, the reflection from a point (<italic>x, y</italic>) on a Lambertian surface is given by<sup><xref ref-type="bibr" rid="bibr14-0959651811433121">14</xref></sup></p>
<p>
<disp-formula id="disp-formula1-0959651811433121">
<label>(1)</label>
<mml:math display="block" id="math1-0959651811433121">
<mml:mrow>
<mml:mi>I</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>y</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>I</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>o</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mi>ρ</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>y</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mi>p</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>y</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mi>cos</mml:mi>
<mml:mi>τ</mml:mi>
<mml:mi>sin</mml:mi>
<mml:mi>σ</mml:mi>
<mml:mo>−</mml:mo>
<mml:mi>q</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>y</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mi>sin</mml:mi>
<mml:mi>τ</mml:mi>
<mml:mi>sin</mml:mi>
<mml:mi>σ</mml:mi>
<mml:mo>+</mml:mo>
<mml:mi>cos</mml:mi>
<mml:mi>σ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:msqrt>
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mi>p</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msup>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>y</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>+</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>q</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msup>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>y</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msqrt>
</mml:mrow>
</mml:mfrac>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula1-0959651811433121" xlink:href="10.1177_0959651811433121-eq1.tif"/>
</disp-formula>
</p>
<p>where:</p>
<list id="list2-0959651811433121" list-type="bullet">
<list-item>
<p>
<italic>I</italic>(<italic>x, y</italic>) is the intensity reflected at the point (<italic>x</italic>, y);</p>
</list-item>
<list-item>
<p>
<italic>I<sub>o</sub></italic> is the intensity of the incident light;</p>
</list-item>
<list-item>
<p>ρ(<italic>x, y</italic>) is the point albedo, the fraction of incident light that is being reflected from the point (<italic>x, y</italic>);</p>
</list-item>
<list-item>
<p>
<italic>p</italic> and <italic>q</italic> define the gradient of the surface at any local point in the <italic>x</italic> and <italic>y</italic> directions respectively.</p>
</list-item>
</list>
<sec id="section3-0959651811433121">
<title>Surface profile recovery using photometric stereo</title>
<p>Ideally, a rotary planed wood surface does not have height variation of the cuttermarks along the <italic>Y</italic> axis, i.e. <inline-formula id="inline-formula1-0959651811433121">
<mml:math display="inline" id="math2-0959651811433121">
<mml:mrow>
<mml:mi>q</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>y</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>≅</mml:mo>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:math></inline-formula>. For this reason, the three-dimensional (3D) surface topography can be represented by a two-dimensional (2D) surface profile.<sup><xref ref-type="bibr" rid="bibr5-0959651811433121">5</xref>,<xref ref-type="bibr" rid="bibr6-0959651811433121">6</xref></sup> Equation (1) then reduces to</p>
<p>
<disp-formula id="disp-formula2-0959651811433121">
<label>(2)</label>
<mml:math display="block" id="math3-0959651811433121">
<mml:mrow>
<mml:mi>I</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>I</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>o</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mi>ρ</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mo>−</mml:mo>
<mml:mi>p</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mi>cos</mml:mi>
<mml:mi>τ</mml:mi>
<mml:mi>sin</mml:mi>
<mml:mi>σ</mml:mi>
<mml:mo>+</mml:mo>
<mml:mi>cos</mml:mi>
<mml:mi>σ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:msqrt>
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mi>p</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msup>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msqrt>
</mml:mrow>
</mml:mfrac>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula2-0959651811433121" xlink:href="10.1177_0959651811433121-eq2.tif"/>
</disp-formula>
</p>
<p>If an object is illuminated from two distinct locations, the surface reflectance will be the same but the reflectance map will be different.<sup><xref ref-type="bibr" rid="bibr15-0959651811433121">15</xref>,<xref ref-type="bibr" rid="bibr16-0959651811433121">16</xref></sup> Suppose that two lights having approximately equal intensities <italic>I<sub>o</sub></italic> are located at the same zenith angle σ, but at different azimuth angles τ<sub>1</sub> = 0° and τ<sub>2</sub> = 180° as shown in <xref ref-type="fig" rid="fig2-0959651811433121">Figure 2</xref>, then the following simultaneous equations can be obtained from equation (2)</p>
<p>
<disp-formula id="disp-formula3-0959651811433121">
<label>(3a)</label>
<mml:math display="block" id="math4-0959651811433121">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>I</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>I</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>o</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mi>ρ</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mo>−</mml:mo>
<mml:mi>p</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mi>sin</mml:mi>
<mml:mi>σ</mml:mi>
<mml:mo>+</mml:mo>
<mml:mi>cos</mml:mi>
<mml:mi>σ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:msqrt>
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mi>p</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msup>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msqrt>
</mml:mrow>
</mml:mfrac>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula3-0959651811433121" xlink:href="10.1177_0959651811433121-eq3.tif"/>
</disp-formula>
</p>
<fig id="fig2-0959651811433121" position="float">
<label>Figure 2.</label>
<caption>
<p>Schematic of the two-image photometric stereo setup.</p>
</caption>
<graphic xlink:href="10.1177_0959651811433121-fig2.tif"/>
</fig>
<p>and</p>
<p>
<disp-formula id="disp-formula4-0959651811433121">
<label>(3b)</label>
<mml:math display="block" id="math5-0959651811433121">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>I</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>I</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>o</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mi>ρ</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mo>−</mml:mo>
<mml:mi>p</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mi>cos</mml:mi>
<mml:mi>τ</mml:mi>
<mml:mi>sin</mml:mi>
<mml:mi>σ</mml:mi>
<mml:mo>+</mml:mo>
<mml:mi>cos</mml:mi>
<mml:mi>σ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:msqrt>
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mi>p</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msup>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msqrt>
</mml:mrow>
</mml:mfrac>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula4-0959651811433121" xlink:href="10.1177_0959651811433121-eq4.tif"/>
</disp-formula>
</p>
<p>Dividing equation (3a) by equation (3b) gives</p>
<p>
<disp-formula id="disp-formula5-0959651811433121">
<label>(4)</label>
<mml:math display="block" id="math6-0959651811433121">
<mml:mrow>
<mml:mi>p</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>I</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>I</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>I</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mi>cos</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mi>τ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>I</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mi>cos</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mi>τ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mo>·</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>tan</mml:mi>
<mml:mi>σ</mml:mi>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula5-0959651811433121" xlink:href="10.1177_0959651811433121-eq5.tif"/>
</disp-formula>
</p>
<p>Consequently, only two images are required to compute the gradient of the surface. The images are first converted into intensity profiles using the column-wise averaging technique described previously.<sup><xref ref-type="bibr" rid="bibr5-0959651811433121">5</xref>,<xref ref-type="bibr" rid="bibr6-0959651811433121">6</xref></sup> The intensity profiles for the two images are then substituted for <italic>I</italic><sub>1</sub>(<italic>x</italic>) and <italic>I</italic><sub>2</sub>(<italic>x</italic>) in equation (4) to calculate <italic>p</italic>(<italic>x</italic>). A frequency domain integration method described by Frankot and Chellappa<sup><xref ref-type="bibr" rid="bibr17-0959651811433121">17</xref></sup> is used to extract the surface profile from the gradient data.</p>
</sec>
</sec>
<sec id="section4-0959651811433121">
<title>Dynamic photometric stereo</title>
<p>The easiest way to marginally overcome the image correspondence problem in dynamic samples has been to capture the image pairs in quick succession, within a very short acquisition time frame. The method is known as temporal multiplexing.<sup><xref ref-type="bibr" rid="bibr7-0959651811433121">7</xref></sup> In this method, each light source is projected on to the scene at different times, and the image capture is synchronised with the activation of each light in sequence. The drawback of the conventional temporal multiplexing method is that it is applicable only to very slow moving objects. The temporal multiplexing method is adopted in this research but a suitable method is used to match the images before applying the PS technique. The method proposed in this paper is to determine the pixel correspondence between the successive image pairs through the use of an incremental encoder. This makes it suitable for relatively fast moving samples. The pixel displacement between successive image pairs is calculated as follows.</p>
<p>Suppose that the first and second images are triggered when the surface is at position <italic>p</italic><sub>1</sub> and <italic>p</italic><sub>2</sub> respectively, the linear displacement between image pairs is given as</p>
<p>
<disp-formula id="disp-formula6-0959651811433121">
<label>(5)</label>
<mml:math display="block" id="math7-0959651811433121">
<mml:mrow>
<mml:mi>p</mml:mi>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>p</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>p</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula6-0959651811433121" xlink:href="10.1177_0959651811433121-eq6.tif"/>
</disp-formula>
</p>
<p>The displacement in pixels can then be calculated as</p>
<p>
<disp-formula id="disp-formula7-0959651811433121">
<label>(6)</label>
<mml:math display="block" id="math8-0959651811433121">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>d</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>pixel</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mi>SR</mml:mi>
<mml:mo>×</mml:mo>
<mml:mi>p</mml:mi>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula7-0959651811433121" xlink:href="10.1177_0959651811433121-eq7.tif"/>
</disp-formula>
</p>
<p>where <italic>SR</italic> is the spatial resolution of the image in pixel per millimetre and <italic>p</italic> is the linear displacement of the surface in millimetres. A sensor is required to measure the position of the workpiece at the time when the acquisition of each image is triggered.</p>
</sec>
<sec id="section5-0959651811433121">
<title>Experimental work</title>
<p>The success of most machine vision techniques depends on the setup of the illumination sources. In theory, the PS technique requires that the illumination sources should be distant point light sources, so that uniform illumination over the surface area of the object can be obtained.<sup><xref ref-type="bibr" rid="bibr15-0959651811433121">15</xref></sup> This requirement cannot be met in practice due to space restrictions and the desire for compact designs. Therefore, collimated light emitting diodes (LEDs) have been used. Although rays from collimated lights spread out gradually as they propagate, the divergence is usually minimal.</p>
<sec id="section6-0959651811433121">
<title>Optimum light source positions</title>
<p>The optimum zenith angle is found to be within the range 80–85°. If the angle of incidence is too close to 90°, the illumination will produce shadowy surfaces. Meanwhile, Lambert’s law does not apply to shadowy surfaces. Small angles of incidence (0–30°) also reduce the contrast of the images, thereby reducing the amount of information about the cuttermarks that can be revealed.<sup><xref ref-type="bibr" rid="bibr6-0959651811433121">6</xref></sup> Generally, the only requirement for the locations of the light sources in terms of the azimuth angle is that the lights should not be coplanar. However, it has been observed that only the projections where the light rays are directly perpendicular to the cuttermarks (0° and 180°) contribute greatly to the performance of the PS method.</p>
<p>Images of a wood surface, captured with light sources positioned at azimuth angles of 0° and 90°, are shown in <xref ref-type="fig" rid="fig3-0959651811433121">Figure 3</xref>. The cuttermarks’ ridges are more easily visible in <xref ref-type="fig" rid="fig3-0959651811433121">Figure 3(a)</xref> than in <xref ref-type="fig" rid="fig3-0959651811433121">Figure 3(b)</xref>. This indicates that the further the light sources are positioned away from 90° or 270°, the better the illumination. Hence, the lights are positioned at angles τ<sub>1</sub> = 0° and τ<sub>2</sub> = 180° as shown in <xref ref-type="fig" rid="fig2-0959651811433121">Figure 2</xref>.</p>
<fig id="fig3-0959651811433121" position="float">
<label>Figure 3.</label>
<caption>
<p>Images of wood obtained from different lighting directions.</p>
</caption>
<graphic xlink:href="10.1177_0959651811433121-fig3.tif"/>
</fig>
</sec>
<sec id="section7-0959651811433121">
<title>Camera calibration</title>
<p>Camera lenses are not perfectly manufactured in practice. The shape of the lenses can lead to radial (barrel or pincushion) distortions of the pixel locations in the images. The effect of this distortion is that a perfectly straight line in the object coordinate appears bent in the images. Tangential distortions can also arise due to the lenses being imperfectly aligned with the image plane during the assembling process.<sup><xref ref-type="bibr" rid="bibr18-0959651811433121">18</xref></sup></p>
<p>Significant lens distortions will definitely affect the results of the column-by-column averaging of the image intensity data. It is very critical that the variation of the cuttermarks across the feed direction should be maintained in the images. Otherwise the averaging algorithm cannot be used to accurately convert the 3D profile to a 2D profile. In order to eliminate the effect of lens distortions, the images have to be corrected before applying the averaging technique. The radial distortions are corrected using a reduced version of Brown’s model<sup><xref ref-type="bibr" rid="bibr19-0959651811433121">19</xref></sup> as given by the equations</p>
<p>
<disp-formula id="disp-formula8-0959651811433121">
<label>(7a)</label>
<mml:math display="block" id="math9-0959651811433121">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>u</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>d</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:msub>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:msup>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msup>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula8-0959651811433121" xlink:href="10.1177_0959651811433121-eq8.tif"/>
</disp-formula>
</p>
<p>and</p>
<p>
<disp-formula id="disp-formula9-0959651811433121">
<label>(7b)</label>
<mml:math display="block" id="math10-0959651811433121">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>y</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>u</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>y</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>d</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi>y</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:msub>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:msup>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msup>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula9-0959651811433121" xlink:href="10.1177_0959651811433121-eq9.tif"/>
</disp-formula>
</p>
<p>in which</p>
<p>
<disp-formula id="disp-formula10-0959651811433121">
<mml:math display="block" id="math11-0959651811433121">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>d</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>o</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>,</mml:mo>
<mml:mspace width="0.25em"/>
<mml:mspace width="0.25em"/>
<mml:mover>
<mml:mrow>
<mml:mi>y</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>y</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>d</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>y</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>o</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula10-0959651811433121" xlink:href="10.1177_0959651811433121-eq10.tif"/>
</disp-formula>
</p>
<p>
<disp-formula id="disp-formula11-0959651811433121">
<mml:math display="block" id="math12-0959651811433121">
<mml:mrow>
<mml:mi>r</mml:mi>
<mml:mo>=</mml:mo>
<mml:msqrt>
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>d</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>o</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msup>
<mml:mo>+</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>y</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>d</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>y</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>o</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msup>
</mml:mrow>
</mml:msqrt>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula11-0959651811433121" xlink:href="10.1177_0959651811433121-eq11.tif"/>
</disp-formula>
</p>
<p>where:</p>
<list id="list3-0959651811433121" list-type="bullet">
<list-item>
<p>(<italic>x<sub>d</sub>, y<sub>d</sub></italic>) is the original location of the distorted point;</p>
</list-item>
<list-item>
<p>(<italic>x<sub>u</sub>, y<sub>u</sub></italic>) is the new location of the corrected point;</p>
</list-item>
<list-item>
<p>(<italic>x<sub>o</sub>, y<sub>o</sub></italic>) is the principal point of the image, assumed to be located at the centre of the image;</p>
</list-item>
<list-item>
<p>
<italic>k</italic>
<sub>1</sub> is the coefficient of the second order radial distortion.</p>
</list-item>
</list>
<p>It should be mentioned that the tangential component of distortion has been justifiably neglected in order to arrive at equations (7) because most currently manufactured lenses do not have imperfection in centring. Also, only the second order radial distortion component is considered as recommended for expensive lenses or for lenses with narrow field of view (FOV).<sup><xref ref-type="bibr" rid="bibr20-0959651811433121">20</xref></sup></p>
<p>A camera calibration procedure is required to estimate the intrinsic parameter, <italic>k</italic><sub>1</sub>. The method used in this research for the calibration is to target the camera on a 9-by-10 checkerboard pattern of alternating black and white squares. The size of each square is 65 mm by 2.65 mm. Such a small cell size has been chosen because the FOV of the camera is just 52 mm by 40 mm. The required intrinsic parameter of the camera is then computed from multiple images (30 images) of the calibration pattern, acquired under different orientations. MATLAB camera calibration toolbox developed by the Computational Vision Group in California Institute of Technology is used for the calibration. The toolbox is based on the calibration procedure developed by Heikkila and Silvan.<sup><xref ref-type="bibr" rid="bibr21-0959651811433121">21</xref></sup> The computed second order radial distortion coefficient is then used to correct for the effects of distortion according to equations (7).</p>
</sec>
<sec id="section8-0959651811433121">
<title>Test rig setup</title>
<p>A variable-speed conveyor system has been constructed to simulate a real machining environment for the in-process wood surface assessments (<xref ref-type="fig" rid="fig4-0959651811433121">Figure 4</xref>). The test rig is capable of measuring moving samples up to the speed of 200 mm/s. The conveyor belt is equipped with an encoder to measure the distance over which the sample has moved between successive image shots. A 659 pixel × 493 pixel digital camera, which has an IEEE 1394 FireWire interface, is connected to a personal computer (PC) so as to capture the images of the moving surface in real time. The camera has been carefully aligned perpendicularly to the conveyor belt surface. The illumination sources are red collimated LEDs.</p>
<fig id="fig4-0959651811433121" position="float">
<label>Figure 4.</label>
<caption><p>Dynamic photometric stereo test rig.</p></caption>
<graphic xlink:href="10.1177_0959651811433121-fig4.tif"/></fig>
<p>A proximity sensor is used to detect the moving sample when it is within the camera view. The camera is then hardware triggered with each of the two lights on and the other light off. The PC is set up to wait for the two image frames from the camera via the FireWire interface using MATLAB Image Acquisition Toolbox. The interconnections between the various components of the system are shown in <xref ref-type="fig" rid="fig5-0959651811433121">Figure 5</xref>. The corresponding positions of the belt (in counts) when the image capture are triggered are also recorded and transmitted to the PC through RS232 serial communication protocol. This tight synchronisation, including the camera triggering, is achieved using a PIC18F458 microcontroller. Since the camera triggering is hardware based, the image acquisition is immediate and the camera latency is deterministic.</p>
<fig id="fig5-0959651811433121" position="float">
<label>Figure 5.</label>
<caption>
<p>Interconnections between the components of the test rig.</p>
</caption>
<graphic xlink:href="10.1177_0959651811433121-fig5.tif"/>
</fig>
<p>The displacement between the image frames is calculated according to equation (6) in order to establish pixel correspondence. The conversion factor from counts to pixel has been estimated through experimentation (0.2425 pixel/count). A small black cross was printed on a white paper and then pasted on a wood sample. The displacements of the cross centre between successive image frames in pixels and encoder counts were then used to determine the conversion factor.</p>
</sec>
<sec id="section9-0959651811433121">
<title>Challenges with dynamic photometric stereo</title>
<p>There are a number of difficulties that are potentially associated with the application of the proposed technique to moving samples; the major ones being skewing and motion blur within the image frames. Commercial cameras have two types of shutters, namely rolling shutters and global shutters. In the rolling shutter, portions of the objects are exposed to light at different moments in time by scanning horizontally or vertically across the frame. If the wood sample is moving in the horizontal direction during the exposure and the shutter is rolling in the vertical direction, the cuttermarks might become skewed in the final image. Similarly to the radial distortion problem introduced by camera lenses, the averaging of the 3D profile in order to generate a 2D profile will not give the correct results if the skewness is significant. In that sense, a camera with a global shutter is a better choice for the cuttermarks’ measurement.</p>
<p>As opposed to the rolling shutter, the global shutter exposes the entire frame to light at the same time. It eliminates the problem of image skewness, but any motion of the sample during the frame capture would now result in image blurring. Blur will occur if the exposure time is long enough so that the sample can move during one shutter cycle. The problem of motion blur has placed a major constraint on the speed at which the wood sample can be measured. The problem can be somewhat minimised by using a short exposure time (increase shutter speed) as any motion will be frozen in time, resulting in images with less blur. However, enough light might not reach the image sensor if the exposure time is too short, thereby causing the images to be dark. Blurred images could be restored by applying Wiener deconvolution.<sup><xref ref-type="bibr" rid="bibr22-0959651811433121">22</xref></sup></p>
</sec>
<sec id="section10-0959651811433121" sec-type="results|discussion">
<title>Results and discussion</title>
<p>Some wood samples were measured using the test rig. The samples were machined using the smart planing machine shown in <xref ref-type="fig" rid="fig6-0959651811433121">Figure 6</xref>. The machine, which is instrumented with piezoelectric actuators, eddy current sensor and an encoder, is specially designed in order to carry out preliminary investigations into alternative ways of improving the performance of industrial wood planing machines. The longer-term aim is to integrate the dynamic surface profile measurement system with the wood planing machine.</p>
<fig id="fig6-0959651811433121" position="float">
<label>Figure 6.</label>
<caption>
<p>The smart wood planing machine.</p>
</caption>
<graphic xlink:href="10.1177_0959651811433121-fig6.tif"/>
</fig>
<p>The dynamic surface measurement was done for wood samples moving at the speed of 50 mm/s. Measurements at faster speeds could not be achieved on the current test rig because of motion blur and jerky movement of the conveyor belt, although the problem of motion blur can be minimised by using a higher quality camera and better illumination.</p>
<p>In order to assess the accuracy of the dynamic surface profile measurement, results obtained are compared with those of the static PS. The static PS measurement is used as the baseline reference since its effectiveness has been established<sup><xref ref-type="bibr" rid="bibr5-0959651811433121">5</xref>,<xref ref-type="bibr" rid="bibr6-0959651811433121">6</xref></sup> by comparing the surface profiles obtained to those from a laser profilometer. The comparisons between the static and the dynamic profiles are shown in <xref ref-type="fig" rid="fig7-0959651811433121">Figures 7</xref> and <xref ref-type="fig" rid="fig8-0959651811433121">8</xref> for beech and oak samples respectively. The beech sample is a single-knife finish while the oak sample is a two-knife finish with one proud knife. The vision-based system does not provide absolute height information so the heights have been normalised. The correlation coefficients between the surface profiles obtained using the static and the dynamic PS techniques are given in <xref ref-type="table" rid="table1-0959651811433121">Table 1</xref>. The results show that the dynamic PS surface profiles compare well with those of the static PS. The coefficients were computed using the <italic>corr2</italic> function in MATLAB according to the following equation</p>
<p>
<disp-formula id="disp-formula12-0959651811433121">
<label>(8)</label>
<mml:math display="block" id="math13-0959651811433121">
<mml:mrow>
<mml:mi>r</mml:mi>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:munder>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
</mml:munder>
<mml:munder>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>n</mml:mi>
</mml:mrow>
</mml:munder>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>A</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>mn</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi>A</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>B</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>mn</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi>B</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:msqrt>
<mml:mrow>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:munder>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
</mml:munder>
<mml:munder>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>n</mml:mi>
</mml:mrow>
</mml:munder>
<mml:msup>
<mml:mrow>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>A</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>mn</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi>A</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msup>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:munder>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
</mml:munder>
<mml:munder>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>n</mml:mi>
</mml:mrow>
</mml:munder>
<mml:msup>
<mml:mrow>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>B</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>mn</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi>B</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msup>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:msqrt>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula12-0959651811433121" xlink:href="10.1177_0959651811433121-eq12.tif"/>
</disp-formula>
</p>
<p>where:</p>
<list id="list4-0959651811433121" list-type="bullet">
<list-item>
<p>
<italic>A</italic> and <italic>B</italic> are vectors representing the static and dynamic profiles respectively;</p>
</list-item>
<list-item>
<p>
<inline-formula id="inline-formula2-0959651811433121">
<mml:math display="inline" id="math14-0959651811433121">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>A</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
</mml:mrow>
</mml:math>
</inline-formula> and <inline-formula id="inline-formula3-0959651811433121">
<mml:math display="inline" id="math15-0959651811433121">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>B</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
</mml:mrow>
</mml:math></inline-formula> are the mean values of the elements in <italic>A</italic> and <italic>B</italic> respectively.</p>
</list-item>
</list>
<fig id="fig7-0959651811433121" position="float">
<label>Figure 7.</label>
<caption>
<p>Comparison of static PS profile versus dynamic PS profile for the beech sample.</p>
</caption>
<graphic xlink:href="10.1177_0959651811433121-fig7.tif"/>
</fig>
<fig id="fig8-0959651811433121" position="float">
<label>Figure 8.</label>
<caption>
<p>Comparison of static PS profile versus dynamic PS profile for the oak sample.</p>
</caption>
<graphic xlink:href="10.1177_0959651811433121-fig8.tif"/>
</fig>
<table-wrap id="table1-0959651811433121" position="float">
<label>Table 1.</label>
<caption>
<p>Percentage correlation between static and dynamic surface profile measurements for some selected wood samples.</p>
</caption>
<graphic alternate-form-of="table1-0959651811433121" xlink:href="10.1177_0959651811433121-table1.tif"/>
<table>
<colgroup>
<col align="left"/>
<col align="left"/>
<col align="char" char="."/>
<col align="char" char="."/>
</colgroup>
<thead>
<tr>
<th align="left">Sample</th>
<th align="left">Wood species</th>
<th align="left">Cuttermarks width (mm)</th>
<th align="left">Correlation (%)</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Beech</td>
<td>2.0</td>
<td>96</td>
</tr>
<tr>
<td>2</td>
<td>Oak</td>
<td>2.0</td>
<td>94</td>
</tr>
<tr>
<td>3</td>
<td>Ramin</td>
<td>2.5</td>
<td>93</td>
</tr>
<tr>
<td>4</td>
<td>Spruce</td>
<td>1.5</td>
<td>87</td>
</tr>
<tr>
<td>5</td>
<td>Beech</td>
<td>2.5</td>
<td>96</td>
</tr>
<tr>
<td>6</td>
<td>Meranti</td>
<td>2.5</td>
<td>91</td>
</tr>
</tbody>
</table>
</table-wrap>
<p>Apart from motion blur and image skewness, the conveyor belt slippage is another potential source of errors in matching the photometric image pair. Under this situation, the actual wood sample movement will be different from the rotary sensor readings. The belt slippage problem will not occur when the vision system is finally integrated with the wood planing machine since the feed table is being driven by a lead screw.</p>
<p>Considering the fact that any matching method employed will be subject to some errors, it is necessary to investigate the robustness of the DPS technique to marginal image mismatches. This is done by computing the correlation between the surface profile extracted from perfectly matched images and the profile extracted from manually mismatched images. Comparisons between the profiles obtained from the perfectly matched images and those of 8 pixels and 15 pixels mismatched images are shown in <xref ref-type="fig" rid="fig9-0959651811433121">Figures 9</xref> and <xref ref-type="fig" rid="fig10-0959651811433121">10</xref> respectively.</p>
<fig id="fig9-0959651811433121" position="float">
<label>Figure 9.</label>
<caption>
<p>Comparison between perfectly matched and 8 pixels mismatched profiles.</p>
</caption>
<graphic xlink:href="10.1177_0959651811433121-fig9.tif"/>
</fig>
<fig id="fig10-0959651811433121" position="float">
<label>Figure 10.</label>
<caption>
<p>Comparison between perfectly matched and 15 pixels mismatched profiles.</p>
</caption>
<graphic xlink:href="10.1177_0959651811433121-fig10.tif"/>
</fig>
<p>The correlation between the perfectly matched surface profile and the 8 pixels mismatched profile is about 87%. There is only about 56% correlation between the perfectly matched profile and the 15 pixels mismatched profile. Based on these values, a mismatch up to about eight pixels could still produce acceptable results. This means that the DPS approach is robust to minimal matching errors. The tolerance limit will actually depend on the sizes of the cuttermarks and the spatial resolution of the images.</p>
</sec>
</sec>
<sec id="section11-0959651811433121" sec-type="conclusions">
<title>Conclusions</title>
<p>An adaptation of the PS technique to the assessment of moving wood samples is presented in this paper. The CPS technique has been used earlier to assess surface waviness on static samples. The strict requirement of the CPS is that the view position must remain fixed with respect to the camera during the acquisition of the photometric images. While this requirement is readily satisfied by static samples, it is found to be the most restrictive for moving samples. The major challenge in the application of the CPS technique to moving samples is how to determine the pixel correspondence between the photometric image pairs.</p>
<p>A method known as temporal multiplexing is used to control the acquisition of the image pairs under different lighting directions. An encoder is then used to determine the displacements of the sample between successive image pairs in order to establish pixel correspondence. Experiments performed on a test rig designed to simulate a real machining environment show that the approach is suitable for in-process surface quality inspection of moving samples. Future work will be focused on increasing the speed at which the samples can be measured and also utilising the information extracted from the measurements to provide outer loop control of the wood machining process in order to produce higher quality surface finish.</p>
</sec>
</body>
<back>
<fn-group>
<fn fn-type="financial-disclosure">
<label>Funding</label>
<p>This work was supported by the Engineering and Physical Science Research Council’s Innovative Manufacturing and Construction Research Centre at Loughborough University, UK.</p>
</fn>
</fn-group>
<ref-list>
<title>References</title>
<ref id="bibr1-0959651811433121">
<label>1.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Jackson</surname><given-names>MR</given-names></name>
<name><surname>Parkin</surname><given-names>RM</given-names></name>
<name><surname>Brown</surname><given-names>N</given-names></name>
</person-group>. <article-title>Waves on wood</article-title>. <source>Proc IMechE, Part B: J Engineering Manufacture</source> <year>2002</year>; <volume>216</volume>(<issue>4</issue>): <fpage>475</fpage>–<lpage>497</lpage>.</citation>
</ref>
<ref id="bibr2-0959651811433121">
<label>2.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Yang</surname><given-names>D</given-names></name>
<name><surname>Jackson</surname><given-names>MR</given-names></name>
<name><surname>Parkin</surname><given-names>RM</given-names></name>
</person-group>. <article-title>Inspection of wood surface waviness defects using the light sectioning method</article-title>. <source>Proc IMechE, Part I: J Systems Control and Engineering</source> <year>2006</year>; <volume>220</volume>(<issue>7</issue>): <fpage>617</fpage>–<lpage>626</lpage>.</citation>
</ref>
<ref id="bibr3-0959651811433121">
<label>3.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Elmas</surname><given-names>S</given-names></name>
<name><surname>Islam</surname><given-names>N</given-names></name>
<name><surname>Jackson</surname><given-names>MR</given-names></name><etal/>
</person-group>. <article-title>Analysis of profile measurement techniques employed to surfaces planed by an active machining system</article-title>. <source>Measurement</source> <year>2011</year>; <volume>44</volume>(<issue>2</issue>): <fpage>365</fpage>–<lpage>377</lpage>.</citation>
</ref>
<ref id="bibr4-0959651811433121">
<label>4.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Hesselbach</surname><given-names>J</given-names></name>
<name><surname>Hoffmeister</surname><given-names>HW</given-names></name>
<name><surname>Loohb</surname><given-names>T</given-names></name>
</person-group>. <article-title>Process-integrated quality assurance in wood machining centres with the help of image processing</article-title>. <source>J Prod Eng Res Dev</source> <year>2007</year>; <volume>1</volume>(<issue>1</issue>): <fpage>97</fpage>–<lpage>101</lpage>.</citation>
</ref>
<ref id="bibr5-0959651811433121">
<label>5.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Jackson</surname><given-names>M</given-names></name>
<name><surname>Yang</surname><given-names>D</given-names></name>
<name><surname>Parkin</surname><given-names>R</given-names></name>
</person-group>. <article-title>Analysis of wood surface waviness with a two-image photometric stereo method</article-title>. <source>Proc IMechE, Part I: J Systems and Control Engineering</source> <year>2007</year>; <volume>222</volume>(<issue>8</issue>): <fpage>1091</fpage>–<lpage>1099</lpage>.</citation>
</ref>
<ref id="bibr6-0959651811433121">
<label>6.</label>
<citation citation-type="thesis">
<person-group person-group-type="author">
<name><surname>Yang</surname><given-names>D</given-names></name>
</person-group>. <source>Measurement of cutter marks on planed wood surfaces with machine vision methods</source>. <comment>PhD Thesis</comment>, <publisher-name>Loughborough University</publisher-name>, <publisher-loc>UK</publisher-loc>, <year>2006</year>.</citation>
</ref>
<ref id="bibr7-0959651811433121">
<label>7.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Smith</surname><given-names>ML</given-names></name>
<name><surname>Smith</surname><given-names>LN</given-names></name>
</person-group> <article-title>Dynamic photometric stereo – a new technique for moving surface analysis</article-title>. <source>Image Vis Comput</source> <year>2005</year>; <volume>23</volume>(<issue>9</issue>): <fpage>841</fpage>–<lpage>852</lpage>.</citation>
</ref>
<ref id="bibr8-0959651811433121">
<label>8.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Farooq</surname><given-names>AR</given-names></name>
<name><surname>Smith</surname><given-names>ML</given-names></name>
<name><surname>Smith</surname><given-names>LN</given-names></name><etal/>
</person-group>. <article-title>Dynamic photometric stereo for online quality control of ceramic tiles</article-title>. <source>Comput Ind</source> <year>2005</year>; <volume>56</volume>(<issue>8–9</issue>): <fpage>918</fpage>–<lpage>934</lpage>.</citation>
</ref>
<ref id="bibr9-0959651811433121">
<label>9.</label>
<citation citation-type="thesis">
<person-group person-group-type="author">
<name><surname>Farooq</surname><given-names>AR</given-names></name>
</person-group>. <source>Dynamic photometric stereo for complex surface analysis</source>. <comment>PhD Thesis</comment>, <publisher-name>University of the West England</publisher-name>, <publisher-loc>UK</publisher-loc>, <year>2004</year>.</citation>
</ref>
<ref id="bibr10-0959651811433121">
<label>10.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Bringier</surname><given-names>B</given-names></name>
<name><surname>Helbert</surname><given-names>D</given-names></name>
<name><surname>Khoudeir</surname><given-names>M</given-names></name>
</person-group>. <article-title>The photometric reconstruction of a dynamic textured surface from just one color image acquisition</article-title>. <source>J Opt Soc Am</source> <year>2008</year>; <volume>25</volume>(<issue>3</issue>): <fpage>566</fpage>–<lpage>574</lpage>.</citation>
</ref>
<ref id="bibr11-0959651811433121">
<label>11.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Smith</surname><given-names>ML</given-names></name>
<name><surname>Smith</surname><given-names>G</given-names></name>
<name><surname>Hill</surname><given-names>T</given-names></name>
</person-group>. <article-title>Gradient space analysis of surface defects using photometric stereo derived bump map</article-title>. <source>Image Vis Comput</source> <year>1999</year>; <volume>17</volume>(<issue>3–4</issue>): <fpage>321</fpage>–<lpage>332</lpage>.</citation>
</ref>
<ref id="bibr12-0959651811433121">
<label>12.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Smith</surname><given-names>ML</given-names></name>
</person-group>. <article-title>The analysis of surface texture using photometric stereo acquisition and gradient space domain mapping</article-title>. <source>Image Vis Comput</source> <year>1999</year>; <volume>17</volume>(<issue>14</issue>): <fpage>1009</fpage>–<lpage>1019</lpage>.</citation>
</ref>
<ref id="bibr13-0959651811433121">
<label>13.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Tagare</surname><given-names>HD</given-names></name>
<name><surname>Defigueiredo</surname><given-names>RJ</given-names></name>
</person-group>. <article-title>Simultaneous estimation of shape and reflectance map from photometric stereo</article-title>. <source>CVGIP: Image Understanding</source> <year>1992</year>; <volume>55</volume>(<issue>3</issue>): <fpage>275</fpage>–<lpage>286</lpage>.</citation>
</ref>
<ref id="bibr14-0959651811433121">
<label>14.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Maristany</surname><given-names>AG</given-names></name>
<name><surname>Lebow</surname><given-names>PK</given-names></name>
<name><surname>Brunner</surname><given-names>CC</given-names></name><etal/>
</person-group>. <article-title>Classifying wood surface features using dichromatic reflection</article-title>. <source>Proc SPIE – Int Soc Opt Eng</source> <year>1992</year>; <volume>1836</volume>(<issue>56</issue>): <fpage>56</fpage>–<lpage>64</lpage>.</citation>
</ref>
<ref id="bibr15-0959651811433121">
<label>15.</label>
<citation citation-type="book">
<person-group person-group-type="author">
<name><surname>Jain</surname><given-names>RC</given-names></name>
<name><surname>Kasturi</surname><given-names>R</given-names></name>
<name><surname>Schunk</surname><given-names>BG</given-names></name>
</person-group>. <source>Machine vision</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>McGraw-Hill Inc</publisher-name>., <year>1995</year>.</citation>
</ref>
<ref id="bibr16-0959651811433121">
<label>16.</label>
<citation citation-type="book">
<person-group person-group-type="author">
<name><surname>Smith</surname><given-names>ML</given-names></name>
</person-group>. <source>Surface inspection techniques using the integration of innovative machine vision and graphical modelling techniques</source>. <publisher-loc>London</publisher-loc>: <publisher-name>Professional Engineering Publishing Limited</publisher-name>, <year>2001</year>.</citation>
</ref>
<ref id="bibr17-0959651811433121">
<label>17.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Frankot</surname><given-names>RT</given-names></name>
<name><surname>Chellappa</surname><given-names>R</given-names></name>
</person-group>. <article-title>A method for enforcing integrability in shape from shading algorithms</article-title>. <source>IEEE Trans Pattern Anal Machine Intell</source> <year>1988</year>; <volume>10</volume>(<issue>4</issue>): <fpage>439</fpage>–<lpage>451</lpage>.</citation>
</ref>
<ref id="bibr18-0959651811433121">
<label>18.</label>
<citation citation-type="book">
<person-group person-group-type="author">
<name><surname>Bradski</surname><given-names>G</given-names></name>
<name><surname>Kaehler</surname><given-names>A</given-names></name>
</person-group>. <source>Learning OpenCV: Computer vision with the OpenCV library</source>. <publisher-loc>Sebastopol, CA</publisher-loc>: <publisher-name>O’really Media Inc.</publisher-name>, <year>2008</year>.</citation>
</ref>
<ref id="bibr19-0959651811433121">
<label>19.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Brown</surname><given-names>DC</given-names></name>
</person-group>. <article-title>Close-range camera calibration</article-title>. <source>Photogramm Eng</source> <year>1971</year>; <volume>37</volume>(<issue>8</issue>): <fpage>855</fpage>–<lpage>866</lpage>.</citation>
</ref>
<ref id="bibr20-0959651811433121">
<label>20.</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Zhang</surname><given-names>Z</given-names></name>
</person-group>. <article-title>Flexible camera calibration by viewing a plane from unknown orientations</article-title>. In: <conf-name>Proceedings of the 7th IEEE international conference on computer vision</conf-name>, <conf-loc>Kerkyra, Greece</conf-loc>, <conf-date>20–27 September 1999</conf-date>, pp.<fpage>666</fpage>–<lpage>673</lpage>.</citation>
</ref>
<ref id="bibr21-0959651811433121">
<label>21.</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Heikkila</surname><given-names>J</given-names></name>
<name><surname>Silvan</surname><given-names>O</given-names></name>
</person-group>. <article-title>A four-step camera calibration procedure with implicit image correction</article-title>. In: <conf-name>Proceedings of the 1997 IEEE Computer Society conference on computer vision and pattern recognition</conf-name>, <conf-loc>San Juan, Puerto Rico</conf-loc>, <conf-date>17–19 June 1997</conf-date>, pp.<fpage>1106</fpage>–<lpage>1112</lpage>.</citation>
</ref>
<ref id="bibr22-0959651811433121">
<label>22.</label>
<citation citation-type="book">
<person-group person-group-type="author">
<name><surname>Wu</surname><given-names>Q</given-names></name>
<name><surname>Merchant</surname><given-names>FA</given-names></name>
<name><surname>Castleman</surname><given-names>KR</given-names></name>
</person-group>. <source>Microscope image processing</source>. <publisher-loc>London</publisher-loc>: <publisher-name>Academic Press</publisher-name>, <year>2008</year>.</citation>
</ref>
</ref-list>
</back>
</article>