<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v2.3 20070202//EN" "journalpublishing.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">JIM</journal-id>
<journal-id journal-id-type="hwp">spjim</journal-id>
<journal-title>Journal of Intelligent Material Systems and Structures</journal-title>
<issn pub-type="ppub">1045-389X</issn>
<issn pub-type="epub">1530-8138</issn>
<publisher>
<publisher-name>SAGE Publications</publisher-name>
<publisher-loc>Sage UK: London, England</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1177/1045389X12463464</article-id>
<article-id pub-id-type="publisher-id">10.1177_1045389X12463464</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Articles</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Power management for sub-mW energy harvester with adaptive hybrid energy storage</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<name><surname>Wang</surname><given-names>Wensi</given-names></name>
</contrib>
<contrib contrib-type="author">
<name><surname>Wang</surname><given-names>Ningning</given-names></name>
</contrib>
<contrib contrib-type="author">
<name><surname>Hayes</surname><given-names>Mike</given-names></name>
</contrib>
<contrib contrib-type="author">
<name><surname>O’Flynn</surname><given-names>Brendan</given-names>
</name>
</contrib>
<contrib contrib-type="author">
<name><surname>O’Mathuna</surname><given-names>Cian</given-names>
</name>
</contrib>
<aff id="aff1-1045389X12463464">Microsystems Centre, Tyndall National Institute, Dyke Parade, Cork, Ireland</aff>
</contrib-group>
<author-notes>
<corresp id="corresp1-1045389X12463464">Wensi Wang, TMicrosystems Centre, Tyndall National Institute, Dyke Parade, Cork, Ireland. Email: <email>wensi.wang@tyndall.ie</email></corresp>
</author-notes>
<pub-date pub-type="epub-ppub">
<month>7</month>
<year>2013</year>
</pub-date>
<volume>24</volume>
<issue>11</issue>
<issue-title>Special Issue – 6th Annual Energy Harvesting Workshop (EHW), The Hotel Roanoke and Conference Center, Roanoke, Virginia, August 7 – 11, 2011</issue-title>
<fpage>1365</fpage>
<lpage>1379</lpage>
<permissions>
<copyright-statement>© The Author(s) 2012</copyright-statement>
<copyright-year>2012</copyright-year>
<copyright-holder content-type="sage">SAGE Publications</copyright-holder>
</permissions>
<abstract>
<p>Energy harvesting with its ubiquitous availability is intensively investigated to extend the wireless sensor nodes lifetime. While the harvested power is often less than 1 mW, the commercial-off-the-shelf power management circuits designed for conventional battery applications operate in much higher power. A designated power management module for sub-mW energy harvester is proposed in this article to increase the energy conversion efficiency and extend the energy storage lifetime for small input power. The proposed module consists of discrete component–based pulse-width modulation (PWM) controlled synchronous boost converter structured impedance matching circuit and supercapacitor/micro-battery hybrid energy storage. The synchronous boost converter-based power management circuit achieves 79% conversion efficiency at the input power of 0.5 mW. The power loss during the energy conversion is significantly reduced and thus allows wireless sensor nodes to be powered from a minimum of 120 Lux fluorescent light with a photovoltaic cell smaller than a credit card. The supercapacitor/micro-battery energy storage provides lifetime of more than 73 h when no external energy is available. The experimental results with 25 energy harvester–powered wireless sensor nodes demonstrate that the practical ultra-low–power design makes sub-1-mW energy harvester power management applicable.</p>
</abstract>
<kwd-group>
<kwd>Sensor</kwd>
<kwd>energy harvesting</kwd>
<kwd>embedded intelligence</kwd>
<kwd>control</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="section1-1045389X12463464" sec-type="intro">
<title>Introduction</title>
<p>In the decade after the concept of wireless sensor networks (WSNs) emerged, a wide variety of applications have been discovered for the intelligent, miniature and wireless-connected sensing modules. But further studies also unveiled many technological obstacles. Among them, the difficulty to achieve long-term deployment is one of the most important issues in practice (<xref ref-type="bibr" rid="bibr20-1045389X12463464">Paradiso and Starner, 2005</xref>). To prolong deployment lifetime when WSN is battery powered, many approaches are considered to either reduce the power consumption of the wireless sensor node (mote) or increase the capacity of the battery. However, due to the finite energy capacity, limited lifetime and number of recharge cycles, the commercial off-the-shelf (COTS) battery constraints the deployment lifetime of WSN. The resultant battery replacements increase the maintenance cost considerably in long-term deployment, and the frequent power failures may compromise the system reliability (Wang et al., 2008).</p>
<p>Another approach utilizing the environmental energy harvesting (EH) techniques to prolong WSN deployment lifetime or achieve ‘power autonomy’ is becoming very popular. The shift from battery power supply to EH power supply has seen as an effective mean to overcome the current lifetime constraints. Several types of environmental energy sources are considered to achieve such objective, including light (indoor light or solar), heat, vibration and wind. Among these energy sources, the light energy is, undisputed, the most ubiquitous type of energy in most of the WSN deployment scenarios (<xref ref-type="bibr" rid="bibr19-1045389X12463464">O’Donnell and Wang, 2009</xref>).</p>
<p>The performance of EH highly relies on the target deployment conditions, one proven design in certain scenario may fail in another. The focus of this work is on building energy management (BEM), one of the WSN applications that already presented great potentials. By monitoring environmental parameters and building energy consumption data, smart energy operation of buildings can reduce the energy usage and CO<sub>2</sub> emission by 15%–30% (<xref ref-type="bibr" rid="bibr25-1045389X12463464">Wen and Agogino, 2011</xref>). Approximately, 40% of the global energy usage is related to the operation of residential and commercial buildings (<xref ref-type="bibr" rid="bibr8-1045389X12463464">Grigg and Slater, 2004</xref>). The potential energy saving benefit by using wireless sensor smart control is enormous.</p>
<p>In practice, integration of indoor light EH capability into this type of WSN is very challenging. The availability of environmental energy sources is limited from energy density prospective. In contrast to the frequently addressed large-scale outdoor solar EH, the low energy density of the indoor light (0–800 Lux) combined with small form factor requirement of mote leads to a very low available power level, often less than 1 mW. In addition to the limited available energy, similar to the large-scale photovoltaic (PV) harvester, the sub-mW power is impracticable to be efficiently harvested without maximum power point tracking (MPPT). The situation is even worse when electric double-layer capacitor (supercapacitor) is adopted as the main energy storage. The several-farad supercapacitor draws the small PV cell voltage to capacitor voltage. In this case, the charging voltage of PV cell drifts away from the maximum power point (MPP) and leads to low conversion efficiency. Without effective MPPT, only a 20%–50% of the MPP efficiency can be obtained in such condition (<xref ref-type="bibr" rid="bibr11-1045389X12463464">Jiang et al., 2005</xref>).</p>
<p>The high-accuracy MPPT for large-scale PV cells often consumes over 100 mW power, several orders of magnitude higher than the harvested power in the small PV cell, is obviously not suitable for this application (<xref ref-type="bibr" rid="bibr13-1045389X12463464">Koutroulis et al., 2001</xref>). Several methods have been proposed to perform low-power MPPT. <xref ref-type="bibr" rid="bibr22-1045389X12463464">Simjee and Chou (2008)</xref> proposed a pulse frequency modulation (PFM) controller-based fractional open-circuit voltage (FVOC) MPPT method utilizing a buck converter structure. This MPPT operates above 80% at a solar power of 20 mW (<xref ref-type="bibr" rid="bibr22-1045389X12463464">Simjee and Chou, 2008</xref>). <xref ref-type="bibr" rid="bibr6-1045389X12463464">Dondi et al. (2008)</xref> introduced a PWM controller-based FVOC MPPT with a similar buck converter structure and achieved up to 85% efficiency when PV cell generates 50 mW. <xref ref-type="bibr" rid="bibr3-1045389X12463464">Brunelli et al. (2009)</xref> suggest that it is possible to obtain MPPT power consumption around 1 mW with the FVOC MPPT method with optimized frequency and components selection. These works, although significantly enhance the MPPT performance in lower power conditions, still excess the sub-mW PV cell output power. <xref ref-type="bibr" rid="bibr2-1045389X12463464">Brunelli and Benini (2009)</xref> suggest that due to the power consumption in the MPPT, small solar cell is impractical to use the MPPT to improve conversion efficiency, and alternative method should be adopted. <xref ref-type="bibr" rid="bibr23-1045389X12463464">Tan and Panda (2011)</xref> proposed an MPPT solution for wind EH using boost-converter structure to perform impedance matching through resistance emulator method. This method shows the potentials to further reduce the power consumption of MPPT theoretically into sub-mW scale by adopting a low-duty cycle ultra-low–power microcontroller but was not verified by Tan and Panda due to difference in applications. <xref ref-type="bibr" rid="bibr22-1045389X12463464">Simjee and Chou (2008)</xref> and <xref ref-type="bibr" rid="bibr23-1045389X12463464">Tan and Panda (2011)</xref> need a microcontroller to generate MPPT control signal, which obviously increase the system cost and complexity. <xref ref-type="bibr" rid="bibr5-1045389X12463464">Chini and Rovati (2010)</xref> introduced a PFM controlled boost converter similar to the design shown in this work with components selection for ultra-low–power level, however, without synchronous rectification MPPT. <xref ref-type="table" rid="table1-1045389X12463464">Table 1</xref> shows the comparison of efficiency among various MPPT circuits against their power levels.</p>
<table-wrap id="table1-1045389X12463464" position="float">
<label>Table 1.</label>
<caption>
<p>Comparison of MPPT efficiency in lowest useable power level.</p>
</caption>
<graphic alternate-form-of="table1-1045389X12463464" xlink:href="10.1177_1045389X12463464-table1.tif"/>
<table>
<colgroup>
<col align="left"/>
<col align="left"/>
<col align="left"/>
<col align="left"/>
<col align="left"/>
<col align="left"/>
</colgroup>
<thead>
<tr>
<th/>
<th align="left"><xref ref-type="bibr" rid="bibr5-1045389X12463464">Chini and Rovati (2010)</xref></th>
<th align="left"><xref ref-type="bibr" rid="bibr22-1045389X12463464">Simjee and Chou (2008)</xref></th>
<th align="left"><xref ref-type="bibr" rid="bibr23-1045389X12463464">Tan and Panda (2011)</xref></th>
<th align="left"><xref ref-type="bibr" rid="bibr21-1045389X12463464">Simjee andChou (2006)</xref></th>
<th align="left"><xref ref-type="bibr" rid="bibr6-1045389X12463464">Dondiet al. (2008)</xref></th>
</tr>
</thead>
<tbody>
<tr>
<td>Converter</td>
<td>Boost</td>
<td>Buck</td>
<td>Boost</td>
<td>Buck</td>
<td>Buck</td>
</tr>
<tr>
<td>Control logic</td>
<td>PFM control</td>
<td>PFM control</td>
<td>PWM control</td>
<td>PFM control</td>
<td>PWM control</td>
</tr>
<tr>
<td>Input power (mW)</td>
<td>1.6</td>
<td>5</td>
<td>9.36</td>
<td>10</td>
<td>50</td>
</tr>
<tr>
<td>Efficiency (%)</td>
<td>30</td>
<td>47</td>
<td>84</td>
<td>45</td>
<td>85</td>
</tr>
</tbody>
</table>
<table-wrap-foot>
<fn id="table-fn1-1045389X12463464">
<p>MPPT: maximum power point tracking.</p>
</fn>
</table-wrap-foot>
</table-wrap>
<p>In this article, a DSP-free PWM controller-based synchronous boost converter is proposed to further reduce the power consumption of MPPT while maintain PV cell operates near the optimal point. The proposed MPPT method with considerations in power loss analysis only consumes 0.109 mW in typical 500 Lux indoor lighting. The power loss is even smaller in lower light intensity. The minimum operative light intensity is only 120–130 Lux for a 30-cm<sup>2</sup> commercial available silicon PV cell. The synchronous boost converter-based MPPT method achieves 79% conversion efficiency at the input power of 0.5 mW, significantly increased the efficiency from previous designs. Different from previous works, the efficiency calculation in this work included self-discharge of energy storage. Thus, the efficiency calculation standard is stricter and closer to the real deployment conditions.</p>
<p>In addition to the ultra-low–power MPPT, another challenging issue addressed in this article is the design of optimized energy storage units (ESU). While supercapacitor is commonly used as the primary ESU for many EH applications, the associated high self-discharge rate excesses the sleep-mode power consumption of wireless sensor nodes and contributes to a considerable portion of the power dissipation in the WSN (<xref ref-type="bibr" rid="bibr17-1045389X12463464">Maxwell Technologies, 2008</xref>; <xref ref-type="bibr" rid="bibr18-1045389X12463464">Mutoh and Inoue, 2007</xref>). Due to the limited energy density of the supercapacitor, higher capacitance leads to large dimension of supercapacitor that is impossible to be integrated in the small mote. To further increase the energy storage capacity of ESU, a lithium polymer micro-energy module (IPS MEC101; <xref ref-type="bibr" rid="bibr10-1045389X12463464">Infinite Power Solutions, 2012</xref>) is included in this design and formed a hybrid energy storage with supercapacitor. The charging and discharging of the proposed ESU are managed by using a mechanism similar to the MPPT control. The ESU combined with output voltage regulation is optimized to supply power in the active mode of WSN (90 mW power consumption) by reducing the equivalent series resistance (ESR) and the self-discharge rate by including a smaller supercapacitor when WSN is running in the sleep mode (30 µW power consumption). The relevant power levels are shown in <xref ref-type="fig" rid="fig1-1045389X12463464">Figure 1</xref>.</p>
<fig id="fig1-1045389X12463464" position="float">
<label>Figure 1.</label>
<caption>
<p>Power levels of energy harvesting and energy consumptions.</p>
<p>PV: photovoltaic; EH: energy harvesting; MPPT: maximum power point tracking; WSN: wireless sensor network.</p>
</caption>
<graphic xlink:href="10.1177_1045389X12463464-fig1.tif"/>
</fig>
<p>Based on the aforementioned MPPT and hybrid ESU technologies, a complete EH-powered wireless sensor node is built within a form factor similar to a credit card (50 cm<sup>2</sup>). Combined with the low power consumption of WSN, this device achieves power autonomous operation with only harvested indoor light in most typical residential and commercial buildings. The proposed device and method show great potentials to be used in a wide range of applications while all components have a longer than 10 years of lifetime expectancy. The device enables a deploy-and-forget capability to low-power WSN, while the low-cost system has a considerable advantage over the battery replacement costs, especially when the WSNs are deployed in larger numbers and for longer period of time.</p>
<p>The rest of the article is organized as follows: the ‘Energy harvester system architecture’ section introduces the detailed architecture of the ultra-low–power EH system. The ‘Ultra-low–power MPPT design’ section investigates the issues related to the MPPT design and implementation. The ‘Hybrid energy storage for EH-powered WSN’ section discusses the hybrid ESU design. The ‘Sub-mW PV energy harvester implementation and experimental results’ section shows the experimental results of the energy harvester and various trial tests with WSN. The ‘Conclusion’ section reports the conclusions.</p>
</sec>
<sec id="section2-1045389X12463464">
<title>Energy harvester system architecture</title>
<p>The system architecture of the indoor PV cell-powered WSN is presented in <xref ref-type="fig" rid="fig2-1045389X12463464">Figure 2</xref>. This proposed power autonomous system consists of five building blocks: (a) PV cells, (b) MPPT tracker, (c) ESU, (d) output stage voltage regulator, and (e) wireless sensor node. By adopting this system architecture, both the input power and output power are optimized to ensure delivering maximum amount of useable energy to the wireless sensor node. The multiple stages regulation reduces the energy conversion efficiency, a trade-off exists in the power losses and power gains in the power regulations. The main power losses in the system are illustrated in <xref ref-type="fig" rid="fig3-1045389X12463464">Figure 3</xref>. The power (voltage) level of the ESU is monitored by the wireless sensor node in order to update the network about the remaining energy in each module. The power monitoring readings and power management simulations can provide an effective mean to predict the system operation.</p>
<fig id="fig2-1045389X12463464" position="float">
<label>Figure 2.</label>
<caption>
<p>Indoor light energy harvesting wireless sensor node.</p>
<p>PV: photovoltaic; MPPT: maximum power point tracking; ESU: energy storage units; RF: radio frequency; WSN: wireless sensor network; ADC: analog-to-digital converter; MCU: micro-controller unit.</p>
</caption>
<graphic xlink:href="10.1177_1045389X12463464-fig2.tif"/>
</fig>
<fig id="fig3-1045389X12463464" position="float">
<label>Figure 3.</label>
<caption>
<p>Efficiency losses and power consumptions in the proposed energy harvester.</p>
<p>PV: photovoltaic; MPPT: maximum power point tracking; ESU: energy storage units.</p>
</caption>
<graphic xlink:href="10.1177_1045389X12463464-fig3.tif"/>
</fig>
<p>The indoor light power <italic>P<sub>Light</sub></italic> is harvested by the COTS amorphous silicon PV cell with a conversion efficiency at <italic>η<sub>PV</sub></italic>. The MPPT circuits adjust the control signal frequency based on lighting intensity to approach a near optimal voltage on the PV cell, thus approaching the ideal maximum power of PV cell <italic>P<sub>PV_MPP</sub></italic>. Certain amount of power is lost due to the imprecision of MPPT, and the efficiency loss due to the MPPT error is <italic>η<sub>ME</sub></italic> as shown in <xref ref-type="fig" rid="fig3-1045389X12463464">Figure 3</xref>. The inevitable efficiency loss in the MPPT procedure and the power consumption of the MPPT control circuits are expressed as <italic>η<sub>ML</sub></italic> and <italic>P<sub>M_Ctrl</sub></italic>. The output power of MPPT is expressed as <italic>P<sub>MPPT</sub></italic>. Based on the input voltage and remaining energy in the ESU, the ESU control circuits choose to charge/discharge the hybrid energy storage. In both charging and discharge processes, a self-discharge power loss exists as P<sub>D</sub>. Similar to the MPPT control circuits power consumption, the ESU control circuit also has a power consumption <italic>P<sub>E_Ctrl</sub></italic>. The power transferred from ESU <italic>P<sub>STORE</sub></italic> is further optimized in the output voltage regulator, with an efficiency <italic>η<sub>out</sub></italic>, before connecting to the wireless sensor node. The boost converter–based output voltage regulator can be automatically started up by the ESU control circuits in case of power failure and subsequent need to restart system.</p>
</sec>
<sec id="section3-1045389X12463464">
<title>Ultra-low–power MPPT design</title>
<sec id="section4-1045389X12463464">
<title>MPPT methods</title>
<p>The PV cells have I–V (current–voltage) characteristics similar to voltage controlled current source (<xref ref-type="bibr" rid="bibr9-1045389X12463464">Hussein et al., 1995</xref>). This I–V characteristic, shown in <xref ref-type="fig" rid="fig4-1045389X12463464">Figure 4</xref>, leads to the fact that the maximum power can only be harvested when the PV cell voltage is at the MPP. Many methods are used to perform MPPT. Although the Perturb and Observe method (P&amp;O) is the most common type utilized in many applications, the need of complicated digital signal processing (DSP) unit makes it less power efficient and cost-effective for this application. Similar to the concept introduced in <xref ref-type="bibr" rid="bibr14-1045389X12463464">Lee et al. (2003)</xref>, the FVOC method is adopted in this design. This method is based on the near linear correlation between the MPP voltage V<sub>MPP</sub> and the open-circuit voltage V<sub>OC</sub>. K<sub>FVOC</sub> is the voltage factor in the FVOC MPPT approaches. It is based on the measured average value between 100 and 800 Lux light intensity for amorphous silicon PV cells.</p>
<p><disp-formula id="disp-formula1-1045389X12463464">
<label>(1)</label>
<mml:math display="block" id="math1-1045389X12463464">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>V</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>MPP</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>k</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>FVOC</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>·</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>V</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>OC</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula1-1045389X12463464" xlink:href="10.1177_1045389X12463464-eq1.tif"/>
</disp-formula></p>
<fig id="fig4-1045389X12463464" position="float">
<label>Figure 4.</label>
<caption>
<p>Measured PV cell I–V characteristics (100–500 Lux LED light) with 10% MPPT error shown in shadow area.</p>
<p>PV: photovoltaic; MPPT: maximum power point tracking.</p>
</caption>
<graphic xlink:href="10.1177_1045389X12463464-fig4.tif"/>
</fig>
<p>This method often disconnects the PV cell to monitor the V<sub>OC</sub> momentarily, followed by adjusting the operative voltage to V<sub>MPP</sub>. The simple computation and low power consumption make this MPPT method suitable for a small-scale PV device. Benini suggests that a pilot PV cell made from the same technology of the main PV cell can be used as the voltage reference in <xref ref-type="bibr" rid="bibr15-1045389X12463464">Magno et al. (2008)</xref>. Instead of disconnecting the PV cell to measure the V<sub>OC</sub>, the low-cost pilot PV cell provides a reference V<sub>OC</sub> that is proportional to the open-circuit voltage of the main PV cell. This method further reduces the complexity and power consumption of the MPPT controller. The indoor lighting condition over a week’s period is shown in <xref ref-type="fig" rid="fig5-1045389X12463464">Figure 5</xref>. Compared to the fast-changing outdoor lighting condition, the indoor lighting condition and the small-scale PV cell have a very low open-circuit voltage change rate. Although the PV cell power may vary considerably, the voltage variation is less than 7% on a certain load.</p>
<fig id="fig5-1045389X12463464" position="float">
<label>Figure 5.</label>
<caption>
<p>Measured 7-day PV cell open-circuit voltage in an office environment (sensor placed on partially enclosed cubicle desk, north-facing window 5 m away with no direct sunlight).</p>
<p>PV: photovoltaic.</p>
</caption>
<graphic xlink:href="10.1177_1045389X12463464-fig5.tif"/>
</fig>
<p>The open-circuit voltage V<sub>OC</sub> is near constant when deployed in the targeted office environment during the office hours. The I–V characteristics of the PV cell in indoor condition also illustrate that a 10% MPPT inaccuracy has only &lt;5% of the negative impact on the output power.</p>
<p>Although the FVOC MPPT method has inferior dynamic tracking capability when compared to other methods, for low light intensity conditions, such parameters are less important. For the MPPT accuracy issue, as shown in <xref ref-type="fig" rid="fig4-1045389X12463464">Figure 4</xref>, the same MPPT voltage window leads to smaller MPPT errors on the more flat P–V characteristics. Thus, the impact of MPPT voltage error is less significant in low light intensity. Reducing power consumption in the FVOC MPPT is the design priority for this small PV energy harvester.</p>
</sec>
<sec id="section5-1045389X12463464">
<title>Synchronous boost converter–based MPPT</title>
<p>The schematic diagram of the synchronous boost converter–based MPPT is shown in <xref ref-type="fig" rid="fig6-1045389X12463464">Figure 6</xref>. The MPPT consists of two main building blocks: (a) comparator-based MPPT controller and (b) synchronous boost converter. The boost converter is controlled by PWM signals generated from the ultra-low–power comparators. A secondary PV cell is used to obtain a reference open-circuit voltage to set the theoretical V<sub>MPP</sub>. Made from the same PV technology of the main PV cell, the pilot PV cell obtains open-circuit voltage Voc_ref proportional to the main PV cell open-circuit voltage.</p>
<fig id="fig6-1045389X12463464" position="float">
<label>Figure 6.</label>
<caption>
<p>Conceptual schematic diagram of the maximum power point tracking.</p>
<p>PV: photovoltaic; ESU: energy storage units.</p>
</caption>
<graphic xlink:href="10.1177_1045389X12463464-fig6.tif"/>
</fig>
<p>Hysteresis is adopted in the design to switch on transistor SW1 when input capacitor voltage (PV cell voltage) is higher than V<sub>MPP</sub>+ V<sub>hyst1</sub>. The input capacitor is then discharged while the inductor L is charged with a variable current i<sub>L</sub>(t). Once the capacitor voltage drops to V<sub>MPP</sub>− V<sub>hyst1</sub>, the SW1 is turned off due to the hysteresis and the ‘ON’ state time is t<sub>0</sub>–t<sub>1</sub> as shown in <xref ref-type="fig" rid="fig7-1045389X12463464">Figure 7</xref>. It is worth noting that the charging process shown in <xref ref-type="fig" rid="fig7-1045389X12463464">Figure 7</xref> adopts small input and output capacitors in order to accelerate the charging speed and better illustrate the results. In actual cases, the time between t<sub>2</sub> and t<sub>3</sub> is 1–2 orders of magnitude longer. The SW2 is switched on when PV cell voltage is within V<sub>MPP</sub>+ V<sub>hyst</sub> and V<sub>MPP</sub>− V<sub>hyst</sub>. The total hysteresis voltage V<sub>hyst</sub> is larger than the hysteresis for SW1 V<sub>hyst1</sub>. The On-state time of SW2 t<sub>0</sub>–t<sub>2</sub> is also longer than that of SW1. The SW3 is controlled with a voltage comparator without hysteresis and is only switched on when PV cell voltage drops to V<sub>MPP</sub>– V<sub>hyst1</sub>– V<sub>dead time</sub>. The additional voltage difference V<sub>dead time</sub> ensures SW3 only switches on after the SW2 is completely switched off. Thus, in a short period t<sub>dead time</sub> (known as dead time), both SW1 and SW3 are switched off to avoid shorting the output supercapacitor reversely through SW1. After SW3 is turned on, the energy stored in L is discharged into the capacitor in this phase. The hysteresis can be easily adjusted by scaling the resistors in the voltage divider to amend the MPPT accuracy and frequency. The adoption of the two switches SW2 and SW3 in series provides a mean to better control the on/off time and dead time with simple and low-power comparator logics. The SW2/3 and SW1 perform a synchronous rectification without output switch drive. Similar to the hysteresis adjustment, the dead time can then be changed with the resistance of comparator voltage divider. In this implementation, at time t<sub>1</sub>, SW1 is switched off when PV cell voltage (divided by resistive voltage divider for sampling purpose, proportional to V<sub>PV</sub>) drops below 2.35 V on the falling edge. The switch SW3 is only switched on at t<sub>1</sub>+ t<sub>dead time.</sub> It is activated only when PV cell voltage further drops to 2.30 V. With a 50-mV voltage gap in between, a dead time of 5 µs is created. The resistance selections are based on the hysteresis comparator double-threshold calculations (<xref ref-type="bibr" rid="bibr7-1045389X12463464">Gregorian, 1999</xref>). By adjusting the voltage threshold, the three switches SW1, SW2 and SW3 will not be switched on simultaneously. The power loss on the diode forward voltage drop is entirely eliminated in the design. The power conversion efficiency is improved.</p>
<fig id="fig7-1045389X12463464" position="float">
<label>Figure 7.</label>
<caption>
<p>Converter simulation and control signals of SW1, SW2 and SW3.</p>
<p>PV: photovoltaic.</p>
</caption>
<graphic xlink:href="10.1177_1045389X12463464-fig7.tif"/>
</fig>
<p>In order to assess the concept and optimize the MPPT design, a simulation program with integrated circuit emphasis (SPICE) simulation model is created with its power loss analysis schematic diagrams shown in <xref ref-type="fig" rid="fig8-1045389X12463464">Figure 8</xref>. The power loss model describes the three phases of the energy conversion. The converter ‘on-state’ when SW1 is switched on between t<sub>0</sub> and t<sub>1</sub> is shown in <xref ref-type="fig" rid="fig8-1045389X12463464">Figure 8(a)</xref>. The converter ‘off-state’ where SW1 is off, SW2 and SW3 are ‘on’ between t<sub>1</sub> and t<sub>2</sub> is shown in <xref ref-type="fig" rid="fig8-1045389X12463464">Figure 8(b)</xref>. The ‘idle-state’ when all transistors are switched off, while the input capacitor is charged from PV cell between t<sub>2</sub> and t<sub>3</sub>, is also shown in <xref ref-type="fig" rid="fig8-1045389X12463464">Figure 8(b)</xref>.</p>
<fig id="fig8-1045389X12463464" position="float">
<label>Figure 8.</label>
<caption>
<p>(a) On-state (t<sub>0</sub>–t<sub>1</sub>) equivalent circuit, (b) off-state (t<sub>1</sub>–t<sub>2</sub>) equivalent circuit and idle-state (t<sub>2</sub>–t<sub>3</sub>) equivalent circuit.</p>
</caption>
<graphic xlink:href="10.1177_1045389X12463464-fig8.tif"/>
</fig>
</sec>
<sec id="section6-1045389X12463464">
<title>Power loss analysis</title>
<p>To understand and minimize the power loss in the MPPT circuits, a power loss model is created based on the schematic diagrams of MPPT shown in <xref ref-type="fig" rid="fig8-1045389X12463464">Figure 8</xref>, and the simulation results are shown in <xref ref-type="fig" rid="fig7-1045389X12463464">Figure 7</xref>. The power loss in the MPPT circuits consists of conduction loss, control integrated circuit (IC) power consumption and switching loss. The &lt;1 mW low input PV cell power can only charge the 140-µF input capacitor at a relatively low speed, when the cycle time T is on the magnitude of millisecond and the boost converter operating in a frequency is less than 1 kHz. Due to the low frequency and the low current nature of the circuits, the switching loss is negligible. The main power losses are due to conduction loss, MPPT error and control IC power consumption.</p>
<p><disp-formula id="disp-formula2-1045389X12463464">
<label>(2)</label>
<mml:math display="block" id="math2-1045389X12463464">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>E</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>loss</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>E</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>Cond</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>E</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>Error</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>E</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>Ctrl</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula2-1045389X12463464" xlink:href="10.1177_1045389X12463464-eq2.tif"/>
</disp-formula></p>
<p>The power consumption of control IC is near constant and mainly relies on the COTS comparator IC. The main variable in the power analysis is the conduction loss in the inductor, on-resistance of transistors and internal resistance of capacitors. As illustrated in <xref ref-type="fig" rid="fig7-1045389X12463464">Figure 7</xref>, the boost converter operates in a discontinuous conduction mode (DCM). The power loss analysis is then divided into three stages: on-stage, off-stage and idle-stage.</p>
<sec id="section7-1045389X12463464">
<title>On-stage</title>
<p>At time t<sub>0</sub>, the input capacitor voltage, also the PV cell voltage, V<sub>PV</sub> reaches the upper voltage limit of the preset MPPT hysteresis V<sub>MPP</sub>+ V<sub>hyst</sub>. The SW1 is then switched on, the input capacitor transfers the stored energy into the inductor and the PV cell also charges the inductor in this stage. By applying Kirchhoff’s voltage and current laws to the circuit, the voltage behaviour is shown in the following equation</p>
<p><disp-formula id="disp-formula3-1045389X12463464">
<label>(3)</label>
<mml:math display="block" id="math3-1045389X12463464">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>V</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>L</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mtext>t</mml:mtext>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>=</mml:mo>
<mml:mtext>L</mml:mtext>
<mml:mfrac>
<mml:mrow>
<mml:mtext>d</mml:mtext>
<mml:msub>
<mml:mrow>
<mml:mtext>i</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>L</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mtext>t</mml:mtext>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
<mml:mrow>
<mml:mtext>dt</mml:mtext>
</mml:mrow>
</mml:mfrac>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>V</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>PV</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mtext>t</mml:mtext>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>−</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>R</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>L</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>R</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>DS</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>ON</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>·</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>i</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>L</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mtext>t</mml:mtext>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula3-1045389X12463464" xlink:href="10.1177_1045389X12463464-eq3.tif"/>
</disp-formula></p>
<p>The inductor current, the main impact factor of the power loss, is shown in this equation. The inductor current increases until time t<sub>1</sub> and dissipates power on inductor internal resistance and on resistance of the transistor.</p>
<p><disp-formula id="disp-formula4-1045389X12463464">
<label>(4)</label>
<mml:math display="block" id="math4-1045389X12463464">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>i</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>L</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>on</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mtext>t</mml:mtext>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mtext>L</mml:mtext>
</mml:mrow>
</mml:mfrac>
<mml:munderover>
<mml:mo>∫</mml:mo>
<mml:mrow>
<mml:mtext>t</mml:mtext>
<mml:mn>0</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mtext>t</mml:mtext>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:munderover>
<mml:mo stretchy="false">[</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>V</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>PV</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>R</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>L</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>R</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>SW</mml:mtext>
<mml:mn>1</mml:mn>
<mml:mspace width="0.25em"/>
<mml:mtext>DS</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>ON</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mspace width="0.25em"/>
<mml:mo>·</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>i</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>PV</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>C</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>IN</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mfrac>
<mml:mrow>
<mml:mtext>d</mml:mtext>
<mml:msub>
<mml:mrow>
<mml:mtext>V</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>PV</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mtext>t</mml:mtext>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mtext>dt</mml:mtext>
</mml:mrow>
</mml:mfrac>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo stretchy="false">]</mml:mo>
<mml:mtext>dt</mml:mtext>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula4-1045389X12463464" xlink:href="10.1177_1045389X12463464-eq4.tif"/>
</disp-formula></p>
<p>The on-stage time t<sub>1</sub>–t<sub>0</sub> is determined by the hysteresis, input capacitor and inductor current. Due to the near linear increases of the inductor current, the on-time can be approximated by the following equation</p>
<p><disp-formula id="disp-formula5-1045389X12463464">
<label>(5)</label>
<mml:math display="block" id="math5-1045389X12463464">
<mml:mrow>
<mml:msub>
<mml:mtext>t</mml:mtext>
<mml:mrow>
<mml:mtext>on</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>2</mml:mn>
<mml:msub>
<mml:mtext>V</mml:mtext>
<mml:mrow>
<mml:mtext>Hyst</mml:mtext>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>⋅</mml:mo>
<mml:msub>
<mml:mtext>C</mml:mtext>
<mml:mrow>
<mml:mtext>in</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:mrow>
<mml:mrow>
<mml:mstyle displaystyle="true">
<mml:mrow>
<mml:munderover>
<mml:mo>∫</mml:mo>
<mml:mrow>
<mml:mtext>t</mml:mtext>
<mml:mn>0</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mtext>t</mml:mtext>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:munderover>
<mml:mrow>
<mml:mo stretchy="false">[</mml:mo>
<mml:msub>
<mml:mtext>i</mml:mtext>
<mml:mrow>
<mml:mtext>L</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>on</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mtext>t</mml:mtext>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mtext>i</mml:mtext>
<mml:mrow>
<mml:mtext>PV</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">]</mml:mo>
<mml:mtext>dt</mml:mtext>
</mml:mrow>
</mml:mrow>
</mml:mstyle>
</mml:mrow>
<mml:mo>/</mml:mo>
<mml:mrow>
<mml:msub>
<mml:mtext>t</mml:mtext>
<mml:mrow>
<mml:mtext>on</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mrow>
</mml:mrow>
</mml:mfrac>
<mml:mo>≈</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>2</mml:mn>
<mml:msub>
<mml:mtext>V</mml:mtext>
<mml:mrow>
<mml:mtext>Hyst</mml:mtext>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>⋅</mml:mo>
<mml:msub>
<mml:mtext>C</mml:mtext>
<mml:mrow>
<mml:mtext>in</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mtext>i</mml:mtext>
<mml:mrow>
<mml:mtext>L</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>on Avg</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mtext>i</mml:mtext>
<mml:mrow>
<mml:mtext>PV</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula5-1045389X12463464" xlink:href="10.1177_1045389X12463464-eq5.tif"/>
</disp-formula></p>
<p>Another factor that impacts power dissipation in this circuit is the input capacitor ESR R<sub>Cin</sub>. Included this power dissipation, the total conduction energy loss in the on-stage is then shown in the following equation</p>
<p><disp-formula id="disp-formula6-1045389X12463464">
<label>(6)</label>
<mml:math display="block" id="math6-1045389X12463464">
<mml:mtable columnalign="left">
<mml:mtr>
<mml:mtd>
<mml:msub>
<mml:mtext>E</mml:mtext>
<mml:mrow>
<mml:mtext>loss</mml:mtext>
<mml:mo>_</mml:mo>
<mml:mtext>on</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:munderover>
<mml:mstyle displaystyle="true" mathsize="140%">
<mml:mo>∫</mml:mo>
</mml:mstyle>
<mml:mrow>
<mml:mtext>t</mml:mtext>
<mml:mn>0</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mtext>t</mml:mtext>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:munderover>
<mml:mrow>
<mml:mo>[</mml:mo>
<mml:mrow>
<mml:msubsup>
<mml:mtext>i</mml:mtext>
<mml:mrow>
<mml:mtext>L</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>on</mml:mtext>
</mml:mrow>
<mml:mn>2</mml:mn>
</mml:msubsup>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mtext>t</mml:mtext>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>⋅</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:msub>
<mml:mtext>R</mml:mtext>
<mml:mtext>L</mml:mtext>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mtext>R</mml:mtext>
<mml:mrow>
<mml:mtext>SW</mml:mtext>
<mml:mn>1</mml:mn>
<mml:mtext> DS</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>on</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>+</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:msub>
<mml:mtext>i</mml:mtext>
<mml:mtext>L</mml:mtext>
</mml:msub>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mtext>t</mml:mtext>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mtext>i</mml:mtext>
<mml:mrow>
<mml:mtext>PV</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
<mml:mn>2</mml:mn>
</mml:msup>
<mml:mo>⋅</mml:mo>
<mml:msub>
<mml:mtext>R</mml:mtext>
<mml:mrow>
<mml:mtext>Cin</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mo>]</mml:mo>
</mml:mrow>
<mml:mtext>dt</mml:mtext>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd>
<mml:mspace width="0.25em"/>
<mml:mspace width="0.25em"/>
<mml:mspace width="0.25em"/>
<mml:mspace width="0.25em"/>
<mml:mspace width="0.25em"/>
<mml:mspace width="0.25em"/>
<mml:mspace width="0.25em"/>
<mml:mspace width="0.25em"/>
<mml:mspace width="0.25em"/>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mo stretchy="false">[</mml:mo>
<mml:msubsup>
<mml:mtext>i</mml:mtext>
<mml:mrow>
<mml:mtext>L</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mspace width="0.25em"/>
<mml:mtext>rms</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msubsup>
<mml:mo>⋅</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:msub>
<mml:mtext>R</mml:mtext>
<mml:mtext>L</mml:mtext>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mtext>R</mml:mtext>
<mml:mrow>
<mml:mtext>DS</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>on</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>+</mml:mo>
<mml:msubsup>
<mml:mrow>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mtext>i</mml:mtext>
<mml:mtext>L</mml:mtext>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mtext>i</mml:mtext>
<mml:mtext>PV</mml:mtext>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mtext>rms</mml:mtext>
</mml:mrow>
<mml:mn>2</mml:mn>
</mml:msubsup>
<mml:mo>⋅</mml:mo>
<mml:msub>
<mml:mtext>R</mml:mtext>
<mml:mrow>
<mml:mtext>Cin</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">]</mml:mo>
<mml:mo>⋅</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>2</mml:mn>
<mml:msub>
<mml:mtext>V</mml:mtext>
<mml:mrow>
<mml:mtext>Hyst</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>⋅</mml:mo>
<mml:msub>
<mml:mtext>C</mml:mtext>
<mml:mrow>
<mml:mtext>in</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mtext>i</mml:mtext>
<mml:mrow>
<mml:mtext>L</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>on</mml:mtext>
<mml:mspace width="0.25em"/>
<mml:mtext>Avg</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mtext>i</mml:mtext>
<mml:mrow>
<mml:mtext>PV</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:math>
<graphic alternate-form-of="disp-formula6-1045389X12463464" xlink:href="10.1177_1045389X12463464-eq6.tif"/>
</disp-formula></p>
<p>As shown in the power loss model, when the inductor current is determined in the simulation, the power loss in the on-stage can be easily calculated.</p>
</sec>
<sec id="section8-1045389X12463464">
<title>Off-stage</title>
<p>From t<sub>1</sub> to t<sub>2</sub>, the SW2 and SW3 are turned on, the energy accumulated in the inductor and input capacitor is discharged into the ESU. Based on <xref ref-type="disp-formula" rid="disp-formula5-1045389X12463464">equation (5)</xref>, by applying the correlation between on-stage duty cycle and off-stage duty cycle in the DCM of boost converter as shown in <xref ref-type="disp-formula" rid="disp-formula7-1045389X12463464">equations (7)</xref> and <xref ref-type="disp-formula" rid="disp-formula8-1045389X12463464">(8)</xref>, the SW1 off-time can be calculated in the following <xref ref-type="disp-formula" rid="disp-formula9-1045389X12463464">equation (9)</xref>, where D<sub>on</sub> is the on-state duty cycle, while D<sub>off</sub> is the off-state duty cycle</p>
<p><disp-formula id="disp-formula7-1045389X12463464">
<label>(7)</label>
<mml:math display="block" id="math7-1045389X12463464">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>D</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>off</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>τ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>L</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>D</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>ON</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>·</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>+</mml:mo>
<mml:msqrt>
<mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>+</mml:mo>
<mml:mn>2</mml:mn>
<mml:msup>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>D</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>ON</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msup>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>τ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>L</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:msqrt>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula7-1045389X12463464" xlink:href="10.1177_1045389X12463464-eq7.tif"/>
</disp-formula></p>
<p>where <inline-formula id="inline-formula1-1045389X12463464">
<mml:math display="inline" id="math8-1045389X12463464">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>τ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>L</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> is the inductor time constant and is presented in <xref ref-type="disp-formula" rid="disp-formula8-1045389X12463464">equation (8)</xref></p>
<p><disp-formula id="disp-formula8-1045389X12463464">
<label>(8)</label>
<mml:math display="block" id="math9-1045389X12463464">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>τ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>L</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mtext>L</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>R</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>Load</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mtext>T</mml:mtext>
</mml:mrow>
</mml:mfrac>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mtext>L</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>R</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>Load</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>t</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mn>3</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>t</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula8-1045389X12463464" xlink:href="10.1177_1045389X12463464-eq8.tif"/>
</disp-formula></p>
<p>Thus, t<sub>OFF</sub> can be determined from <xref ref-type="disp-formula" rid="disp-formula5-1045389X12463464">equations (5)</xref>, <xref ref-type="disp-formula" rid="disp-formula7-1045389X12463464">(7)</xref> and <xref ref-type="disp-formula" rid="disp-formula8-1045389X12463464">(8)</xref> as follows</p>
<p><disp-formula id="disp-formula9-1045389X12463464">
<label>(9)</label>
<mml:math display="block" id="math10-1045389X12463464">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>t</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>OFF</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>t</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>ON</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>·</mml:mo>
<mml:mtext>L</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>R</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>Load</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>·</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mtext>T</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msup>
</mml:mrow>
</mml:mfrac>
<mml:mo>·</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>+</mml:mo>
<mml:msqrt>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>+</mml:mo>
<mml:mn>2</mml:mn>
<mml:mfrac>
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>t</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>ON</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msup>
<mml:mo>·</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>R</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>Load</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:mtext>T</mml:mtext>
<mml:mo>·</mml:mo>
<mml:mtext>L</mml:mtext>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:msqrt>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula9-1045389X12463464" xlink:href="10.1177_1045389X12463464-eq9.tif"/>
</disp-formula></p>
<p>Similar to on-stage, the off-stage inductor current can be calculated based on Kirchhoff’s voltage and current laws during steady state as follows</p>
<p><disp-formula id="disp-formula10-1045389X12463464">
<label>(10)</label>
<mml:math display="block" id="math11-1045389X12463464">
<mml:mrow>
<mml:mtext>L</mml:mtext>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>i</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>L</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>off</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mtext>t</mml:mtext>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
<mml:mrow>
<mml:mtext>dt</mml:mtext>
</mml:mrow>
</mml:mfrac>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>V</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>CAP</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>C</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>OUT</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:munderover>
<mml:mrow>
<mml:mo>∫</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mtext>t</mml:mtext>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mtext>t</mml:mtext>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:munderover>
<mml:msub>
<mml:mrow>
<mml:mtext>i</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>L</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>off</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mtext>t</mml:mtext>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mtext>dt</mml:mtext>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>V</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>PV</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.25em"/>
<mml:mo>−</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>R</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>L</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>R</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>DS</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>ON</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>·</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>i</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>PV</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>C</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>IN</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mfrac>
<mml:mrow>
<mml:mtext>d</mml:mtext>
<mml:msub>
<mml:mrow>
<mml:mtext>V</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>PV</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mtext>t</mml:mtext>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mtext>dt</mml:mtext>
</mml:mrow>
</mml:mfrac>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula10-1045389X12463464" xlink:href="10.1177_1045389X12463464-eq10.tif"/>
</disp-formula></p>
<p>The energy loss due to power conduction in this phase can be calculated as</p>
<p><disp-formula id="disp-formula11-1045389X12463464">
<label>(11)</label>
<mml:math display="block" id="math12-1045389X12463464">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>E</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>loss</mml:mtext>
<mml:mi>_</mml:mi>
<mml:mtext>off</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:munderover>
<mml:mrow>
<mml:mo>∫</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mtext>t</mml:mtext>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mtext>t</mml:mtext>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:munderover>
<mml:msubsup>
<mml:mrow>
<mml:mtext>i</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>L</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>off</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msubsup>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mtext>t</mml:mtext>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>·</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>R</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>L</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>R</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>SW</mml:mtext>
<mml:mn>2</mml:mn>
<mml:mspace width="0.25em"/>
<mml:mtext>DS</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>on</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>+</mml:mo>
<mml:mo stretchy="false">[</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>i</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>L</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>off</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mtext>t</mml:mtext>
<mml:mo stretchy="false">)</mml:mo>
<mml:mspace width="0.25em"/>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>i</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>PV</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:msup>
<mml:mrow>
<mml:mo stretchy="false">]</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msup>
<mml:mo>·</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>R</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>Cin</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:mo stretchy="false">[</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>i</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>L</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>off</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mtext>t</mml:mtext>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>V</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>OUT</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">/</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>R</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>Load</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:msup>
<mml:mrow>
<mml:mo stretchy="false">]</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msup>
<mml:mo>·</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>R</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>CAP</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mtext>dt</mml:mtext>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula11-1045389X12463464" xlink:href="10.1177_1045389X12463464-eq11.tif"/>
</disp-formula></p>
<p>In the implementation, the comparator that controls SW3 is carefully adjusted to include a short dead time in order to avoid the case when SW1, SW2 and SW3 simultaneously conducting current. Comparing with boost converter that adopts rectifier diode instead of synchronous switches, the power loss is significantly reduced in this stage.</p>
</sec>
<sec id="section9-1045389X12463464">
<title>Idle-stage</title>
<p>From time t<sub>2</sub> to t<sub>3</sub>, the MPPT circuit enters an idle-stage, SW1, SW2 and SW3 are switched off during this stage, the input capacitor voltage is charged from the lower hysteresis threshold to the upper threshold. In this work, the input current I<sub>PV</sub> is 1–2 orders of magnitude lower than the inductor current. The conduction power loss in this phase is negligible. However, from the MPPT accuracy perspective, it is important to consider the PV cell voltage during this phase since this relatively longer charging time t<sub>3</sub>–t<sub>2</sub> harvests most of the PV energy in practical implementation (<xref ref-type="fig" rid="fig9-1045389X12463464">Figure 9</xref>)</p>
<p><disp-formula id="disp-formula12-1045389X12463464">
<label>(12)</label>
<mml:math display="block" id="math13-1045389X12463464">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>E</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>PV</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>P</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>PV</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>·</mml:mo>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>t</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mn>3</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>t</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>≈</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>P</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>PV</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>·</mml:mo>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>t</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mn>3</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>t</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula12-1045389X12463464" xlink:href="10.1177_1045389X12463464-eq12.tif"/>
</disp-formula></p>
<fig id="fig9-1045389X12463464" position="float">
<label>Figure 9.</label>
<caption>
<p>MPPT voltage error and resultant power difference.</p>
<p>PV: photovoltaic; MPPT: maximum power point tracking.</p>
</caption>
<graphic xlink:href="10.1177_1045389X12463464-fig9.tif"/>
</fig>
<p>By re-visiting <xref ref-type="fig" rid="fig4-1045389X12463464">Figure 4</xref>, the PV power–voltage characteristics are evaluated with a numerical curve fitting and created a voltage–power function <inline-formula id="inline-formula2-1045389X12463464">
<mml:math display="inline" id="math14-1045389X12463464">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>P</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>PV</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>F</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>V</mml:mtext>
<mml:mo>-</mml:mo>
<mml:mtext>P</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>V</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>PV</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math>
</inline-formula> to approximate the PV cell power at certain voltage V<sub>PV</sub>. The energy loss due to the inaccuracy of the MPPT is then calculated by the following equation</p>
<p><disp-formula id="disp-formula13-1045389X12463464">
<label>(13)</label>
<mml:math display="block" id="math15-1045389X12463464">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>η</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>Error</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mtext>%</mml:mtext>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mrow>
<mml:munderover>
<mml:mo>∫</mml:mo>
<mml:mrow>
<mml:mtext>t</mml:mtext>
<mml:mn>0</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mtext>t</mml:mtext>
<mml:mn>3</mml:mn>
</mml:mrow>
</mml:munderover>
<mml:mo stretchy="false">[</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>F</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>V</mml:mtext>
<mml:mo>−</mml:mo>
<mml:mtext>P</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>V</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>MPP</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>F</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>V</mml:mtext>
<mml:mo>−</mml:mo>
<mml:mtext>P</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">[</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>V</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>PV</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mtext>t</mml:mtext>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo stretchy="false">]</mml:mo>
<mml:mtext>dt</mml:mtext>
</mml:mrow>
</mml:mrow>
<mml:mrow>
<mml:mrow>
<mml:munderover>
<mml:mo>∫</mml:mo>
<mml:mrow>
<mml:mtext>t</mml:mtext>
<mml:mn>0</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mtext>t</mml:mtext>
<mml:mn>3</mml:mn>
</mml:mrow>
</mml:munderover>
<mml:msub>
<mml:mrow>
<mml:mi>F</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>V</mml:mtext>
<mml:mo>−</mml:mo>
<mml:mtext>P</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>V</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>MPP</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mtext>dt</mml:mtext>
</mml:mrow>
</mml:mrow>
</mml:mfrac>
<mml:mo>·</mml:mo>
<mml:mn>100</mml:mn>
<mml:mtext>%</mml:mtext>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula13-1045389X12463464" xlink:href="10.1177_1045389X12463464-eq13.tif"/>
</disp-formula></p>
<p>where V<sub>MPP</sub> is the ideal MPP voltage. With the PV cell I–V characteristics shown in <xref ref-type="fig" rid="fig4-1045389X12463464">Figure 4</xref>, and considering the 10% MPP maximum voltage error, the energy losses due to the MPPT error are 3.2%, 2.7%, 2.3%, 2.1% and 1.5% of the theoretical maximum power of 500 down to 100 Lux LED lights, respectively.</p>
<p>Another important parameter of the idle-stage is the frequency of the charging pulse. It is largely dependent upon the time period t<sub>3</sub>–t<sub>2</sub>. The frequency, thus, is determined by the input capacitance C<sub>IN</sub>, PV cell current I<sub>PV</sub> and the preset hysteresis voltage range.</p>
<p>Based on the power losses analysis conducted in this section, an ultra-low–power MPPT converter is implemented with practical considerations of the component selections and presented in the ‘Sub-mW PV energy harvester implementation and experimental results’ section of this article.</p>
</sec>
</sec>
</sec>
<sec id="section10-1045389X12463464">
<title>Hybrid energy storage for EH-powered WSN</title>
<p>Although supercapacitors have been proved as a valid ESU in many works (<xref ref-type="bibr" rid="bibr4-1045389X12463464">Chen et al., 2010</xref>), several drawbacks exist in the electric double-layer capacitors. <xref ref-type="table" rid="table2-1045389X12463464">Table 2</xref> shows the comparison of three types of energy storages.</p>
<table-wrap id="table2-1045389X12463464" position="float">
<label>Table 2.</label>
<caption>
<p>Frequently used ESU: supercapacitor, solid-state thin-film battery and lithium-ion battery.</p>
</caption>
<graphic alternate-form-of="table2-1045389X12463464" xlink:href="10.1177_1045389X12463464-table2.tif"/>
<table>
<colgroup>
<col align="left"/>
<col align="left"/>
<col align="left"/>
<col align="left"/>
</colgroup>
<thead>
<tr>
<th align="left">ESU type</th>
<th align="left">Supercapacitor</th>
<th align="left">Solid-state thin-film MEC</th>
<th align="left">Lithium-ion battery</th>
</tr>
<tr>
<th align="left">Manufacture name</th>
<th align="left">NESSCAP EMHSR-2C5</th>
<th align="left">Infinite Power Solutions Thinergy MEC101</th>
<th align="left">Panasonic NCR18500</th>
</tr>
</thead>
<tbody>
<tr>
<td>Capacity (J)</td>
<td>31.3</td>
<td>14.8</td>
<td>25,920</td>
</tr>
<tr>
<td>Lifetime (years)</td>
<td>15–20</td>
<td>10</td>
<td>&lt;5</td>
</tr>
<tr>
<td>Maximum discharge current (mA)</td>
<td>&gt;5100</td>
<td>30</td>
<td>800</td>
</tr>
<tr>
<td>ESR (Ω)</td>
<td>0.3</td>
<td>50</td>
<td>0.05</td>
</tr>
<tr>
<td>Cycle number</td>
<td>&gt;500,000</td>
<td>&gt;10,000</td>
<td>&lt;500</td>
</tr>
<tr>
<td>Power loss due to self-discharge (µW)</td>
<td>
<inline-formula id="inline-formula3-1045389X12463464">
<mml:math display="block" id="math16-1045389X12463464">
<mml:mrow>
<mml:mo>≈</mml:mo>
</mml:mrow>
</mml:math>
</inline-formula>100</td>
<td>&lt;5</td>
<td>&lt;800</td>
</tr>
<tr>
<td>Dimension (mm)</td>
<td>23 × 21 × 10.5</td>
<td>25.4 × 24.4 × 0.03</td>
<td>50 (H) × 18.6 (D)</td>
</tr>
<tr>
<td>Energy density (mJ/mm<sup>3</sup>)</td>
<td>6.2</td>
<td>796</td>
<td>477</td>
</tr>
</tbody>
</table>
<table-wrap-foot>
<fn id="table-fn2-1045389X12463464">
<p>ESU: energy storage units; MEC: micro-energy cell.</p>
</fn>
</table-wrap-foot>
</table-wrap>
<p>Comparing with the solid-state thin-film battery (also known as micro-energy cell (MEC)), although the long lifetime and high cycle number enable a long-time deployment, the power loss due to self-discharge in supercapacitor is 20 times more. The low energy density of the supercapacitor limits the further miniaturization of the EH device. However, the direct utilization of the MEC is also not practical in some WSN applications. The current consumption of the wireless sensor node consists of sleep-mode current and active-mode current. In the active mode, the current consumption often excesses the maximum discharge current of 30 mA in MEC. The 50-Ω level ESR leads to a considerable voltage drop on the MEC. The voltage on the wireless sensor node may drop below the acceptable voltage threshold and disables the device. Also, when frequently running in this high current condition, the MEC may be damaged permanently. The system schematic diagram with the hybrid ESU proposed in this work is shown in <xref ref-type="fig" rid="fig10-1045389X12463464">Figure 10</xref>.</p>
<fig id="fig10-1045389X12463464" position="float">
<label>Figure 10.</label>
<caption>
<p>Hybrid energy storage and charge/discharge control circuits.</p>
<p>PV: photovoltaic; ESU: energy storage units; MEC: micro-energy cell.</p>
</caption>
<graphic xlink:href="10.1177_1045389X12463464-fig10.tif"/>
</fig>
<p>Since the charging voltage of MEC is 4.1–4.2 V, the supercapacitor C<sub>OUT</sub> is controlled from MEC Ctrl-1 signal to connect to MEC only when the supercapacitor voltage V<sub>OUT</sub> is within this range. Since the MEC does not require a constant charging current (<xref ref-type="bibr" rid="bibr10-1045389X12463464">Infinite Power Solutions, 2012</xref>), once the supercapacitor voltage reaches the charging voltage, the MEC is charged without current limiting. The MEC Ctrl-2 signal switches off the transistor when MEC voltage V<sub>B</sub> is lower than the deep discharge threshold of 3.8 V and avoids the damage to the MEC through over-discharge. The PV condition signal (PV Cond as shown in <xref ref-type="fig" rid="fig10-1045389X12463464">Figure 10</xref>) switches on the transistor when the PV cell voltage is lower than 1 V. By implementing such design, the MEC is only charged from supercapacitor within the range of 4.1–4.2 V. The additional energy is then stored in the MEC instead of supercapacitor. The MEC discharges when the PV cell generates limited voltage (e.g. during the night) until it reaches the deep discharge threshold of 3.8 V. In the active mode of WSN, the high current is mostly drawn from the supercapacitor. By partially replacing the supercapacitor energy storage with MEC, the leakage can be reduced by adopting smaller capacitor while the capacity maintains the same. In recent years, the fast development progress of the MEC modules increases the capacity of this type of device significantly (<xref ref-type="bibr" rid="bibr1-1045389X12463464">Armand and Tarascon, 2008</xref>). This proposed design can be directly used to replace the supercapacitor ESU with MEC ESU as the main energy storage when the capacity of MEC further increases in the future.</p>
</sec>
<sec id="section11-1045389X12463464">
<title>Sub-mW PV energy harvester implementation and experimental results</title>
<p>The validation of the proposed energy harvester–powered wireless sensor nodes are conducted by tests evaluating MPPT conversion efficiency, energy storage lifetime and overall system performance. Two types of energy harvesters are designed and implemented. Prototype I implements the MPPT method proposed in this article. Prototype II is designed without MPPT optimization. The schematic diagram of the proposed energy harvester–powered WSN is presented in <xref ref-type="fig" rid="fig11-1045389X12463464">Figure 11</xref>. The control logics of MPPT and hybrid ESU charge/discharge are implemented with two 4-channels Maxim MAX934 ultra-low–power comparators (<xref ref-type="bibr" rid="bibr16-1045389X12463464">Maxim, 2007</xref>). The power consumption of the control logics during MPPT and ESU charge/discharge is measured at 29 µW. The transistors adopted in this design are Vishay SiB914DK n-metal-oxide semiconductor (MOS) transistors with a resistance of 0.28 Ω at 1.5-V Vgs and gate capacitance at 68 pF.</p>
<fig id="fig11-1045389X12463464" position="float">
<label>Figure 11.</label>
<caption>
<p>Energy harvester-powered WSN system schematics.</p>
<p>PV: photovoltaic; MPPT: maximum power point tracking; ESU: energy storage units; MEC: micro-energy cell.</p>
</caption>
<graphic xlink:href="10.1177_1045389X12463464-fig11.tif"/>
</fig>
<p>Combined with Q<sub>g</sub> less than 1.5 nC, the switching loss of the transistor is negligible. The inductance of the MPPT inductor is 1 mH with ESR of 9 Ω. The input capacitor is 140 µF with an ESR of 10 mΩ. The output capacitor is a 2.5-F supercapacitor with a maximum voltage rating at 5 V. The supercapacitor has an internal direct current (DC) resistance around 2 Ω. The MEC is provided by Infinite Power Solutions with a capacity of 1.0 mA h and a charging voltage of 4.1–4.15 V. The output voltage regulator is a Texas Instruments TPS61221 boost converter with a minimum input voltage threshold at 0.7 V. The main PV cell adopted in the design is a Sanyo AM-1815 amorphous silicon solar cell with a dimension of 58 mm × 48 mm. The reference PV cell is Sanyo AM-1413 solar cell that adopts the same technology as the main PV cell. The resistance of the voltage divider resistors is between 0.5 and 10 MΩ. The high resistance reduces the conduction loss in the dividers. The aforementioned system is implemented on a 39 × 30-mm printed circuit board (PCB). The device is packaged with a polymer case printed by a three-dimensional (3D) printer. The overall device dimension is 88 mm × 60 mm. The picture of the device is shown in <xref ref-type="fig" rid="fig12-1045389X12463464">Figure 12</xref>.</p>
<fig id="fig12-1045389X12463464" position="float">
<label>Figure 12.</label>
<caption>
<p>Picture of the indoor light EH-powered WSN prototype.</p>
<p>EH: energy harvesting; WSN: wireless sensor network.</p>
</caption>
<graphic xlink:href="10.1177_1045389X12463464-fig12.tif"/>
</fig>
<p>The MPPT operation is shown in the captured oscilloscope waveform in <xref ref-type="fig" rid="fig13-1045389X12463464">Figure 13(a)</xref>. The test is conducted under 500 Lux LED lighting condition. The top waveform shows the MPPT voltage, and it obtains an upper threshold voltage of 4.13 V, while the lower threshold is 3.91 V. Comparing with the open-circuit voltage of 5.2 V, the ratio K<sub>FVOC</sub> is between 0.752 and 0.794. The average V<sub>mppt</sub> is at 0.773 of the measured open-circuit voltage. The average MPPT error is less than 1.8% of the ideal MPP ratio of 0.760. The bottom waveform illustrates the shunt resistor voltage that shows charging current during MPPT. The MPPT circuits operate in the DCM with a low duty cycle at 0.8%.</p>
<fig id="fig13-1045389X12463464" position="float">
<label>Figure 13.</label>
<caption>
<p>(a) MPPT PV cell voltage and charging current waveforms and (b) comparison of charging supercapacitor with/without MPPT.</p>
<p>MPPT: maximum power point tracking.</p>
</caption>
<graphic xlink:href="10.1177_1045389X12463464-fig13.tif"/>
</fig>
<p>Direct comparison was made to evaluate the performance difference between the proposed method implemented in prototype I and the EH without MPPT in prototype II. <xref ref-type="fig" rid="fig13-1045389X12463464">Figure 13(b)</xref> illustrates the charging performance at 500 Lux within a time period of 100 s. Within this period of time, a 30-mF supercapacitor is charged from 0.1 to 2.1 V with the proposed MPPT method and only 0.95 V without MPPT. The results clearly show that the charging performance is improved by adopting MPPT for the low-power PV cell. The energy conversion efficiency of the MPPT is calculated by <xref ref-type="disp-formula" rid="disp-formula14-1045389X12463464">equation (14)</xref>. The capacitor voltage is used to estimate the stored energy from start of charging time T<sub>0</sub> to end of charging time T<sub>1</sub></p>
<p><disp-formula id="disp-formula14-1045389X12463464">
<label>(14)</label>
<mml:math display="block" id="math17-1045389X12463464">
<mml:mrow>
<mml:msub>
<mml:mtext>η</mml:mtext>
<mml:mrow>
<mml:mtext>ML</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>ΔE</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>Cap</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:mstyle displaystyle="true">
<mml:mrow>
<mml:munderover>
<mml:mo>∫</mml:mo>
<mml:mrow>
<mml:mtext>T</mml:mtext>
<mml:mn>0</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mtext>T</mml:mtext>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:munderover>
<mml:mrow>
<mml:msub>
<mml:mtext>I</mml:mtext>
<mml:mrow>
<mml:mtext>PV</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mtext>t</mml:mtext>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>⋅</mml:mo>
<mml:msub>
<mml:mtext>V</mml:mtext>
<mml:mrow>
<mml:mtext>PV</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mtext>t</mml:mtext>
<mml:mo stretchy="false">)</mml:mo>
<mml:mtext>dτ</mml:mtext>
</mml:mrow>
</mml:mrow>
</mml:mstyle>
</mml:mrow>
</mml:mfrac>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>ΔE</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>Charge</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>ΔE</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>Leakage</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:mstyle displaystyle="true">
<mml:mrow>
<mml:munderover>
<mml:mo>∫</mml:mo>
<mml:mrow>
<mml:mtext>T</mml:mtext>
<mml:mn>0</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mtext>T</mml:mtext>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:munderover>
<mml:mrow>
<mml:msub>
<mml:mtext>I</mml:mtext>
<mml:mrow>
<mml:mtext>PV</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mtext>t</mml:mtext>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>⋅</mml:mo>
<mml:msub>
<mml:mtext>V</mml:mtext>
<mml:mrow>
<mml:mtext>PV</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mtext>t</mml:mtext>
<mml:mo stretchy="false">)</mml:mo>
<mml:mtext>dτ</mml:mtext>
</mml:mrow>
</mml:mrow>
</mml:mstyle>
</mml:mrow>
</mml:mfrac>
<mml:mo>≈</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mstyle scriptlevel="+1">
<mml:mfrac bevelled="true">
<mml:mn>1</mml:mn>
<mml:mn>2</mml:mn>
</mml:mfrac>
</mml:mstyle>
<mml:mtext>C</mml:mtext>
<mml:mo stretchy="false">(</mml:mo>
<mml:msubsup>
<mml:mtext>V</mml:mtext>
<mml:mn>1</mml:mn>
<mml:mn>2</mml:mn>
</mml:msubsup>
<mml:mo>−</mml:mo>
<mml:msubsup>
<mml:mtext>V</mml:mtext>
<mml:mn>0</mml:mn>
<mml:mn>2</mml:mn>
</mml:msubsup>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mover accent="true">
<mml:mrow>
<mml:msub>
<mml:mtext>I</mml:mtext>
<mml:mrow>
<mml:mtext>PV</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mo stretchy="true">¯</mml:mo>
</mml:mover>
<mml:mo>⋅</mml:mo>
<mml:mover accent="true">
<mml:mrow>
<mml:msub>
<mml:mtext>V</mml:mtext>
<mml:mrow>
<mml:mtext>PV</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mo stretchy="true">¯</mml:mo>
</mml:mover>
<mml:mo>⋅</mml:mo>
<mml:mtext>t</mml:mtext>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula14-1045389X12463464" xlink:href="10.1177_1045389X12463464-eq14.tif"/>
</disp-formula></p>
<p>By using MPPT, the input current and voltage variations are reduced; thus, the average current and voltage are used to calculate the input PV energy. It is worth noting that in low light intensity conditions due to the low output power, the leakage current of supercapacitor is no longer negligible. When energy leakage excesses the charging energy, the PV cells cease to charge the ESU. Thus, the minimum operative light intensity highly relies on the ESU leakage current. In this implementation, the average leakage current is 38 µW in 24-h measurement. In <xref ref-type="disp-formula" rid="disp-formula14-1045389X12463464">equation (14)</xref>, the conversion efficiency includes the power loss due to ESU self-discharge. The conversion efficiency and the harvested power are shown in <xref ref-type="fig" rid="fig14-1045389X12463464">Figure 14</xref>.</p>
<fig id="fig14-1045389X12463464" position="float">
<label>Figure 14.</label>
<caption>
<p>MPPT conversion efficiency in sub-mW power conditions (100–1000 µW).</p>
<p>MPPT: maximum power point tracking.</p>
</caption>
<graphic xlink:href="10.1177_1045389X12463464-fig14.tif"/>
</fig>
<p>In a typical office environment with light intensity at 480 Lux (fluorescent), the theoretical maximum output power of this PV cell is 500 µW. The implemented EH device harvests 392 µW in this condition, and the energy conversion efficiency is 79%. The minimum operative light intensity (when output power equates power loss in energy conversion) is between 120 and 130 Lux (<inline-formula id="inline-formula4-1045389X12463464">
<mml:math display="block" id="math18-1045389X12463464">
<mml:mrow>
<mml:mo>≈</mml:mo>
</mml:mrow>
</mml:math>
</inline-formula> 80 µW). The more detailed power analysis of the implementation is shown in <xref ref-type="fig" rid="fig15-1045389X12463464">Figure 15</xref>. The tests are conducted to charge the supercapacitor from 0 to 4.0 V. Except the input power measurement point at 100 µW, the higher power measurement points show that in spite of power losses in MPPT and control logics, the EH efficiency is obviously superior in systems with MPPT.</p>
<fig id="fig15-1045389X12463464" position="float">
<label>Figure 15.</label>
<caption>
<p>Simulated and measured power loss factors and output power results.</p>
<p>MPPT: maximum power point tracking; ESU: energy storage units.</p>
</caption>
<graphic xlink:href="10.1177_1045389X12463464-fig15.tif"/>
</fig>
<p>For extremely low input power (e.g. &lt;100 µW), the power gain from MPPT is offset by the inevitable power loss in MPPT based on this implementation. In a typical office environment, the light intensity is measured between 200 and 800 Lux with a 430 Lux average intensity. Thus, the PV cell power is between 180 and 900 µW. The power benefits from using MPPT are shown in <xref ref-type="fig" rid="fig16-1045389X12463464">Figure 16</xref> with a maximum power gain around 150% at the input power level of 500–600 µW. For the input power of &lt;180 µW, the control power of 29 µW and the conduction loss will not scale down along the input power. Thus, the negative impact of the MPPT power consumption will diminish the power gain from tracing correct MPP.</p>
<fig id="fig16-1045389X12463464" position="float">
<label>Figure 16.</label>
<caption>
<p>Measured power gain (harvested power with MPPT/harvested power without MPPT).</p>
<p>MPPT: maximum power point tracking.</p>
</caption>
<graphic xlink:href="10.1177_1045389X12463464-fig16.tif"/>
</fig>
<p>The proposed energy harvester is then tested as the power supply for ZigBee wireless sensor nodes (<xref ref-type="bibr" rid="bibr12-1045389X12463464">Jung et al., 2011</xref>). The ZigBee wireless sensor nodes are designed with a set of sensors performing the measurements on temperature, relative humidity and light intensity. The nodes are programmed to operate in low duty cycles (5-min time interval between measurements) to minimize the power consumption. When light intensity is high, the output power of EH provides sufficient power to the wireless sensor node, and the additional power is stored in the ESU. During the time period when no light is available, the energy storage provides the power to the nodes. The EH-powered wireless sensor node is placed on a cubical office desk illuminated by an overhead fluorescent light. The deployment location has no explosion to direct sunlight with nearest window (north facing) 5 m away. The average light intensity during daytime is measured at 430 Lux, and equivalent ideal maximum input power is 425 µW. The energy harvester passed a month-long deployment tests as a stable power supply for WSN. One week of the logged deployment results are shown in <xref ref-type="fig" rid="fig17-1045389X12463464">Figure 17</xref>.</p>
<fig id="fig17-1045389X12463464" position="float">
<label>Figure 17.</label>
<caption>
<p>Indoor light EH-powered WSN week-long deployment results.</p>
<p>ESU: energy storage units; WSN: wireless sensor network; PV: photovoltaic.</p>
</caption>
<graphic xlink:href="10.1177_1045389X12463464-fig17.tif"/>
</fig>
<p>The ESU is repeatedly charged and discharged between 3.23 and 4.12 V. In day 6, the supercapacitor is charged to 4.1 V, and the additional energy is stored in the MEC. The voltage of the ESU stabilized at the MEC charging voltage of 4.1 V. The output regulator with a minimum input voltage at 0.7 V provides a stable output voltage at 3.3 V during the test. The inclusion of the output regulator reduces the actual ESU minimum voltage from the mote minimum threshold voltage (2.5 V) to the minimum threshold voltage of the regulator (0.7 V), increases the ‘useable’ energy by 21.7% when the average conversion efficiency of the output switching regulator is measured at 81%. The supercapacitor and MEC energy storage have energy capacity equivalent to a4.1-V, 2.46-mA h battery, and the operative time under 0 Lux light intensity condition is measured at 73 h from fully charged condition.</p>
</sec>
<sec id="section12-1045389X12463464" sec-type="conclusions">
<title>Conclusion</title>
<p>The feasibility of power autonomous wireless sensor node from energy harvested from indoor light for applications such as BEM is investigated in this article. A power management module has been designed for such sub-mW EH. The proposed fractional open-circuit MPPT with synchronous rectifier boost converter structure achieves 79% conversion efficiency at the input power of 0.5 mW. The energy conversion in the power management module is carefully simulated and analysed in order to minimize the power loss. The optimized design achieves a minimum operative light intensity as low as 120–130 Lux (0.08 mW). The experimental results demonstrate the 145% higher harvested energy than direct charging when the energy storage was charged from 0 to 4 V. The proposed energy harvester is implemented into an 88 × 60 × 5-mm device, slightly larger than a credit card. When operating in standard office light intensity, the prototype can continuously power the wireless sensor node and achieves the required power autonomy. In the worst-case analysis, when light intensity is near zero, the hybrid ESU still provides a system lifetime of longer than 73 h. The prototyped energy harvester passed the month-long deployment tests as a valid power supply for wireless sensor node.</p>
<p>A total of 25 such energy harvesters are built and in a process of integrating into a WSN to verify the compatibility of EH and multi-hop wireless networking protocols. The future works of this proposed power management module including adopt the proposed impedance matching method to thermoelectric generator and rectified piezoelectric energy harvester.</p>
</sec>
</body>
<back>
<fn-group>
<fn fn-type="financial-disclosure">
<label>Funding</label>
<p>This work has been funded by Scientific Foundation Ireland through research project ITOBO (398-CRP).</p>
</fn>
</fn-group>
<ref-list>
<title>References</title>
<ref id="bibr1-1045389X12463464">
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Armand</surname><given-names>M</given-names></name>
<name><surname>Tarascon</surname><given-names>JM</given-names></name>
</person-group> (<year>2008</year>) <article-title>Building better batteries</article-title>. <source>Nature</source> <volume>451</volume>(<issue>7179</issue>): <fpage>652</fpage>–<lpage>657</lpage>.</citation>
</ref>
<ref id="bibr2-1045389X12463464">
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Brunelli</surname><given-names>D</given-names></name>
<name><surname>Benini</surname><given-names>L</given-names></name>
</person-group> (<year>2009</year>) <article-title>Designing and managing sub-milliwatt energy harvesting nodes: opportunities and challenges</article-title>. In: <conf-name>1st international conference on wireless communication, vehicular technology, information theory and aerospace &amp; electronic systems technology (wireless VITAE 2009)</conf-name>, <conf-date>17–20 May</conf-date>, <conf-loc>Aalborg, Denmark</conf-loc>, pp. <fpage>11</fpage>–<lpage>15</lpage>.</citation>
</ref>
<ref id="bibr3-1045389X12463464">
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Brunelli</surname><given-names>D</given-names></name>
<name><surname>Moser</surname><given-names>C</given-names></name>
<name><surname>Thiele</surname><given-names>L</given-names></name><etal/>
</person-group>. (<year>2009</year>) <article-title>Design of a solar-harvesting circuit for batteryless embedded systems</article-title>. <source>IEEE Transactions on Circuits and Systems I: Regular Papers</source> <volume>56</volume>(<issue>11</issue>): <fpage>2519</fpage>–<lpage>2528</lpage>.</citation>
</ref>
<ref id="bibr4-1045389X12463464">
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Chen</surname><given-names>H</given-names></name>
<name><surname>Wei</surname><given-names>B</given-names></name>
<name><surname>Ma</surname><given-names>D</given-names></name>
</person-group> (<year>2010</year>) <article-title>Energy storage and management system with carbon nanotube supercapacitor and multidirectional power delivery capability for autonomous wireless sensor nodes</article-title>. <source>IEEE Transactions on Power Electronics</source> <volume>25</volume>(<issue>12</issue>): <fpage>2897</fpage>–<lpage>2909</lpage>.</citation>
</ref>
<ref id="bibr5-1045389X12463464">
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Chini</surname><given-names>A</given-names></name>
<name><surname>Rovati</surname><given-names>L</given-names></name>
</person-group> (<year>2010</year>) <article-title>Micro-power photovoltaic harvester based on a frequency-to-voltage MPPT tracker</article-title>. <source>Electronics Letters</source> <volume>46</volume>(<issue>8</issue>): <fpage>587</fpage>–<lpage>589</lpage>.</citation>
</ref>
<ref id="bibr6-1045389X12463464">
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Dondi</surname><given-names>D</given-names></name>
<name><surname>Bertacchini</surname><given-names>A</given-names></name>
<name><surname>Brunelli</surname><given-names>D</given-names></name><etal/>
</person-group>. (<year>2008</year>) <article-title>Modeling and optimization of a solar energy harvester system for self-powered wireless sensor networks</article-title>. <source>IEEE Transactions on Industrial Electronics</source> <volume>55</volume>(<issue>7</issue>): <fpage>2759</fpage>–<lpage>2766</lpage>.</citation>
</ref>
<ref id="bibr7-1045389X12463464">
<citation citation-type="book">
<person-group person-group-type="author">
<name><surname>Gregorian</surname><given-names>R</given-names></name>
</person-group> (<year>1999</year>) <source>Introduction to CMOS OP-AMPS and Comparators</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>Wiley</publisher-name>.</citation>
</ref>
<ref id="bibr8-1045389X12463464">
<citation citation-type="web">
<person-group person-group-type="author">
<name><surname>Grigg</surname><given-names>P</given-names></name>
<name><surname>Slater</surname><given-names>A</given-names></name>
</person-group> (<year>2004</year>) <source>Assessment of Energy Efficiency Impact of Building Regulations Compliance Report</source>. Available at: <ext-link ext-link-type="uri" xlink:href="http://www.eeph.org.uk/">http://www.eeph.org.uk/</ext-link></citation>
</ref>
<ref id="bibr9-1045389X12463464">
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Hussein</surname><given-names>KH</given-names></name>
<name><surname>Muta</surname><given-names>I</given-names></name>
<name><surname>Hoshino</surname><given-names>T</given-names></name><etal/>
</person-group>. (<year>1995</year>) <article-title>Maximum photovoltaic power tracking: an algorithm for rapidly changing atmospheric conditions</article-title>. <source>IEEE Proceedings: C Generation Transmission and Distribution</source> <volume>142</volume>(<issue>1</issue>): <fpage>59</fpage>–<lpage>64</lpage>.</citation>
</ref>
<ref id="bibr10-1045389X12463464">
<citation citation-type="web">
<collab>Infinite Power Solutions</collab> (<year>2012</year>) <article-title>THINERGY micro-energy cells MEC 101 datasheet</article-title>. Available at: <ext-link ext-link-type="uri" xlink:href="http://www.infinitepowersolutions.com">http://www.infinitepowersolutions.com</ext-link></citation>
</ref>
<ref id="bibr11-1045389X12463464">
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Jiang</surname><given-names>X</given-names></name>
<name><surname>Polastre</surname><given-names>J</given-names></name>
<name><surname>Culler</surname><given-names>D</given-names></name>
</person-group> (<year>2005</year>) <article-title>Perpetual environmentally powered sensor networks</article-title>. In: <conf-name>Fourth international symposium on information processing in sensor networks (IPSN 2005)</conf-name>, <conf-date>15 April</conf-date>, <conf-loc>Los Angeles, California, USA</conf-loc>, pp. <fpage>463</fpage>–<lpage>468</lpage>.</citation>
</ref>
<ref id="bibr12-1045389X12463464">
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Jung</surname><given-names>JW</given-names></name>
<name><surname>Wang</surname><given-names>W</given-names></name>
<name><surname>Ingram</surname><given-names>MA</given-names></name>
</person-group> (<year>2011</year>) <article-title>Cooperative transmission range extension for duty cycle-limited wireless sensor networks</article-title>. In: <conf-name>2nd international conference on wireless communication, vehicular technology, information theory and aerospace &amp; electronic systems technology (wireless VITAE 2011)</conf-name>, <conf-date>28 February–3 March</conf-date>, <conf-loc>Chennai, India</conf-loc>, pp. <fpage>1</fpage>–<lpage>5</lpage>.</citation>
</ref>
<ref id="bibr13-1045389X12463464">
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Koutroulis</surname><given-names>E</given-names></name>
<name><surname>Kalaitzakis</surname><given-names>K</given-names></name>
<name><surname>Voulgaris</surname><given-names>NC</given-names></name>
</person-group> (<year>2001</year>) <article-title>Development of a microcontroller-based, photovoltaic maximum power point tracking control system</article-title>. <source>IEEE Transactions on Power Electronics</source> <volume>16</volume>(<issue>1</issue>): <fpage>46</fpage>–<lpage>54</lpage>.</citation>
</ref>
<ref id="bibr14-1045389X12463464">
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Lee</surname><given-names>D-Y</given-names></name>
<name><surname>Noh</surname><given-names>H-J</given-names></name>
<name><surname>Hyun</surname><given-names>D-S</given-names></name><etal/>
</person-group>. (<year>2003</year>) <article-title>An improved MPPT converter using current compensation method for small scaled PV-applications</article-title>. In: <conf-name>Eighteenth annual IEEE applied power electronics conference and exposition (APEC ‘03)</conf-name>, <conf-date>9–13 February</conf-date>, <conf-loc>Miami, Florida, USA. IEEE Conf.</conf-loc>, <volume>vol. 1</volume>, pp. <fpage>540</fpage>–<lpage>545</lpage>.</citation>
</ref>
<ref id="bibr15-1045389X12463464">
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Magno</surname><given-names>M</given-names></name>
<name><surname>Brunelli</surname><given-names>D</given-names></name>
<name><surname>Zappi</surname><given-names>P</given-names></name><etal/>
</person-group>. (<year>2008</year>) <article-title>A solar-powered video sensor node for energy efficient multimodal surveillance</article-title>. In: <conf-name>11th EUROMICRO conference on digital system design architectures, methods and tools (DSD ‘08)</conf-name>, <conf-date>3–5 September</conf-date>, <conf-loc>Parma, Italy. IEEE Conf.</conf-loc>, pp. <fpage>512</fpage>–<lpage>519</lpage>.</citation>
</ref>
<ref id="bibr16-1045389X12463464">
<citation citation-type="web">
<collab>Maxim</collab> (<year>2007</year>) <article-title>Ultra-low-power, low-cost comparators MAX931–934 datasheet</article-title>. Available at: <ext-link ext-link-type="uri" xlink:href="http://www.maxim-ic.com/datasheet">http://www.maxim-ic.com/datasheet</ext-link></citation>
</ref>
<ref id="bibr17-1045389X12463464">
<citation citation-type="web">
<collab>Maxwell Technologies</collab> (<year>2008</year>) <article-title>BoostCap ultracapacitor PC10 series datasheet</article-title>. Available at: <ext-link ext-link-type="uri" xlink:href="http://www.maxwell.com">http://www.maxwell.com</ext-link></citation>
</ref>
<ref id="bibr18-1045389X12463464">
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Mutoh</surname><given-names>N</given-names></name>
<name><surname>Inoue</surname><given-names>T</given-names></name>
</person-group> (<year>2007</year>) <article-title>A control method to charge series-connected ultra-electric double-layer capacitors suitable for photovoltaic generation systems combining MPPT control method</article-title>. <source>IEEE Transactions on Industrial Electronics</source> <volume>54</volume>(<issue>1</issue>): <fpage>374</fpage>–<lpage>383</lpage>.</citation>
</ref>
<ref id="bibr19-1045389X12463464">
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>O’Donnell</surname><given-names>T</given-names></name>
<name><surname>Wang</surname><given-names>W</given-names></name>
</person-group> (<year>2009</year>) <article-title>Power management, energy conversion and energy scavenging for smart systems</article-title>. <source>Microsystems</source> <volume>18</volume>: <fpage>241</fpage>–<lpage>266</lpage>.</citation>
</ref>
<ref id="bibr20-1045389X12463464">
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Paradiso</surname><given-names>JA</given-names></name>
<name><surname>Starner</surname><given-names>T</given-names></name>
</person-group> (<year>2005</year>) <article-title>Energy scavenging for mobile and wireless electronics</article-title>. <source>IEEE Pervasive Computing</source> <volume>4</volume>(<issue>1</issue>): <fpage>18</fpage>–<lpage>27</lpage>.</citation>
</ref>
<ref id="bibr21-1045389X12463464">
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Simjee</surname><given-names>F</given-names></name>
<name><surname>Chou</surname><given-names>PH</given-names></name>
</person-group> (<year>2006</year>) <article-title>Everlast: long-life, supercapacitor-operated wireless sensor node</article-title>. In: <conf-name>Proceedings of the 2006 international symposium on low power electronics and design (ISLPED’06)</conf-name>, <conf-date>4–6 October</conf-date>, pp. <fpage>197</fpage>–<lpage>202</lpage>.</citation>
</ref>
<ref id="bibr22-1045389X12463464">
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Simjee</surname><given-names>FI</given-names></name>
<name><surname>Chou</surname><given-names>PH</given-names></name>
</person-group> (<year>2008</year>) <article-title>Efficient charging of supercapacitors for extended lifetime of wireless sensor nodes</article-title>. <source>IEEE Transactions on Power Electronics</source> <volume>23</volume>(<issue>3</issue>): <fpage>1526</fpage>–<lpage>1536</lpage>.</citation>
</ref>
<ref id="bibr23-1045389X12463464">
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Tan</surname><given-names>YK</given-names></name>
<name><surname>Panda</surname><given-names>SK</given-names></name>
</person-group> (<year>2011</year>) <article-title>Optimized wind energy harvesting system using resistance emulator and active rectifier for wireless sensor nodes</article-title>. <source>IEEE Transactions on Power Electronics</source> <volume>26</volume>(<issue>1</issue>): <fpage>38</fpage>–<lpage>50</lpage>.</citation>
</ref>
<ref id="bibr24-1045389X12463464">
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Wang</surname><given-names>W</given-names></name>
<name><surname>O’Donnell</surname><given-names>T</given-names></name>
<name><surname>Wang</surname><given-names>N</given-names></name><etal/>
</person-group>. (<year>2010</year>) <article-title>Design considerations of sub-mW indoor light energy harvesting for wireless sensor systems</article-title>, <source>ACM Journal on Emerging Technologies in Computing Systems (JETC)</source> <volume>6</volume>(<issue>2</issue>): <fpage>1</fpage>–<lpage>26</lpage>.</citation>
</ref>
<ref id="bibr25-1045389X12463464">
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Wen</surname><given-names>Y</given-names></name>
<name><surname>Agogino</surname><given-names>AM</given-names></name>
</person-group> (<year>2011</year>) <article-title>Personalized dynamic design of networked lighting for energy-efficiency in open-plan offices</article-title>. <source>Energy and Buildings</source> <volume>43</volume>(<issue>8</issue>): <fpage>1919</fpage>–<lpage>1924</lpage>.</citation>
</ref>
</ref-list>
</back>
</article>