<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v2.3 20070202//EN" "journalpublishing.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">PIG</journal-id>
<journal-id journal-id-type="hwp">sppig</journal-id>
<journal-title>Proceedings of the Institution of Mechanical Engineers, Part G: Journal of Aerospace Engineering</journal-title>
<issn pub-type="ppub">0954-4100</issn>
<issn pub-type="epub">2041-3025</issn>
<publisher>
<publisher-name>SAGE Publications</publisher-name>
<publisher-loc>Sage UK: London, England</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1177/0954410011406203</article-id>
<article-id pub-id-type="publisher-id">10.1177_0954410011406203</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Articles</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Multibody simulation of a generalized predictive controller for tiltrotor active aeroelastic control</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name><surname>Mattaboni</surname><given-names>M</given-names></name>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name><surname>Masarati</surname><given-names>P</given-names></name>
<xref ref-type="corresp" rid="corresp1-0954410011406203">*</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Mantegazza</surname><given-names>P</given-names></name>
</contrib>
<aff id="aff1-0954410011406203">Dipartimento di Ingegneria Aerospaziale, Politecnico di Milano, Milano, Italy</aff>
</contrib-group>
<author-notes>
<corresp id="corresp1-0954410011406203"><label>*</label>Corresponding author: Dipartimento di Ingegneria Aerospaziale, Politecnico di Milano, Via La Masa 34, 20156 Milano, Italy. email: <email>masarati@aero.polimi.it</email></corresp>
</author-notes>
<pub-date pub-type="epub-ppub">
<month>2</month>
<year>2012</year>
</pub-date>
<volume>226</volume>
<issue>2</issue>
<fpage>197</fpage>
<lpage>216</lpage>
<history>
<date date-type="received"><day>2</day><month>9</month><year>2010</year></date>
<date date-type="accepted"><day>16</day><month>3</month><year>2011</year></date>
</history>
<permissions>
<copyright-statement>© IMechE 2011</copyright-statement>
<copyright-year>2011</copyright-year>
<copyright-holder content-type="society">Institution of Mechanical Engineers</copyright-holder>
</permissions>
<abstract>
<p>A generalized predictive control has been developed for the control of the aeroelasticity and structural dynamics of a tiltrotor. Adaptivity is the key feature of the proposed technique. It gives the controller the capability to autonomously follow the variations of the system. A comprehensive simulation system has been adopted to design and test the adaptive regulator under realistic conditions. The aeroservoelastic tiltrotor has been modelled using a multibody approach, considering the structural dynamics, the aerodynamics, the blade pitch control system kinematics, and actuator and sensor dynamics. Numerical simulations illustrate the capability of the adaptive controller to reduce wing vibrations and loads while significantly extending the flutter-free flight envelope. This controller shows satisfactory performances within the whole flight envelope as it is able to properly work in different rotor trim conditions and varying structural properties in the presence of external disturbances and measurement noise.</p>
</abstract>
<kwd-group>
<kwd>aeroservoelasticity</kwd>
<kwd>adaptive control</kwd>
<kwd>tiltrotor</kwd>
<kwd>flutter suppression</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="sec1-0954410011406203"><title>1 INTRODUCTION</title>
<p>The use of active control to improve the aeroelastic behaviour of structures subjected to air loads is very appealing since it promises lighter structures and more efficient vehicles. This holds true, especially for rotary wing aircraft, where rotors cause particularly high vibratory levels.</p>
<p>Tiltrotors are rather peculiar aircraft; in the most often used configuration, two rotors are located at the wing tips, mounted on a tilting nacelle that allows to change the orientation of the rotor thrust about the pitch axis of the aircraft. As a consequence, they can fly in two operating modes: <italic>helicopter</italic>, when the nacelles are in vertical position; the rotors provide the thrust required for lifting and the control moments, much like conventional helicopters; <italic>airplane</italic>, when the nacelles are in horizontal position; the tiltrotor operates as a conventional aircraft, with thrust provided by the propelling rotors, and lift and control mostly provided by conventional aerodynamic surfaces.</p>
<p>The combination of the two operating conditions gives tiltrotor aircraft the capability to take-off and land like helicopters, while overcoming the maximum speed limitation of helicopters intrinsic to lift and thrust simultaneously provided by rotary wing in forward-flight.</p>
<p>Because of the presence of the rotors at the wing tips, tiltrotor aircraft experience vibration levels higher than conventional aircraft. Moreover, the maximum speed when operating in airplane mode is limited by whirl-flutter, an aeroelastic instability that arises because a gimbaled rotor is placed on a flexible suspension (the wing). The rotor is mounted on a gimbal to reduce the moments it transfers to the wing. A passive intervention that may reduce whirl-flutter proneness consists in increasing the torsional stiffness of the wing. From a structural point of view, for a given structural design solution, this requires one to increase the thickness of the wing airfoil. However, from an aerodynamics point of view this solution implies an increase in drag, leading to less efficient vehicles.</p>
<p>Complex machines like tiltrotor aircraft are required to fly in many conditions, characterized by different flight velocities, altitudes, rotor angular speeds and nacelle tilt angles. All these parameters strongly affect the global dynamic and aeroelastic properties of the system, like frequency and damping of the structural modes of the wing. As a consequence, a single controller, designed for a specific flight condition, cannot be effectively used in all operating conditions.</p>
<p>Different aspects of active control of tiltrotor aircraft have been addressed in the literature. In 1997, Nixon <italic>et al</italic>. used a higher harmonic control approach to investigate vibration control of the wing-rotor aeroelastic testing system (WRATS), a tiltrotor semispan model operated by NASA and Army Research Laboratory at the Langley Research Center's Transonic Dynamics Tunnel (TDT) [<xref ref-type="bibr" rid="bibr1-0954410011406203"><bold>1</bold></xref>]. The control was applied to the conventional pitch control system of the rotor through the swashplate, and to the flaperon. The same wind-tunnel model was used to investigate the generalized predictive control (GPC) [<xref ref-type="bibr" rid="bibr2-0954410011406203"><bold>2</bold></xref>–<xref ref-type="bibr" rid="bibr4-0954410011406203"><bold>4</bold></xref>] both analytically and experimentally. In the same years, the application of adaptive control techniques to flight control of tiltrotor aircraft was investigated (e.g. neural network-based feedback linearization, Rysdyc and Calise [<xref ref-type="bibr" rid="bibr5-0954410011406203"><bold>5</bold></xref>, <xref ref-type="bibr" rid="bibr6-0954410011406203"><bold>6</bold></xref>]); this is an active research field [<xref ref-type="bibr" rid="bibr7-0954410011406203"><bold>7</bold></xref>], in view of the innumerable promising applications of vertical take-off and landing-capable high-performance unmanned vehicles. Mueller <italic>et al</italic>. [<bold>8</bold>] investigated the application of a simple single-input single-output control, compared to more sophisticated linear quadratic Gaussian and GPC control strategies, to the multibody model of a semi span tiltrotor configuration. Singh <italic>et al</italic>. [<xref ref-type="bibr" rid="bibr9-0954410011406203"><bold>9</bold></xref>] investigated flutter suppression of a model of the XV-15 experimental tiltrotor aircraft based on a linear quadratic regulator, showing the robustness of the proposed scheme and its capability to control the aircraft stability observing only a minimal number of wing states.</p>
<p>This study discusses an adaptive control system [<xref ref-type="bibr" rid="bibr10-0954410011406203"><bold>10</bold></xref>] based on the GPC methodology. The control system can adapt to the variations of the system by identifying them on line from the input and output measures. The controller is designed on the basis of the identified model. The model is identified in the form of an auto-regressive eXogenous (ARX) or an auto-regressive moving-average eXogenous (ARMAX) system. The GPC uses it to predict the output of the real system on a finite prediction horizon. The control inputs are computed by minimizing the difference between the predicted and the desired outputs in a least squares (LS) sense. The computational efficiency of GPC allows to use it in real-time to control aeroelastic systems, characterized by fast dynamics and requiring high control frequency, as shown for example in recent fixed-wing applications [<xref ref-type="bibr" rid="bibr11-0954410011406203"><bold>11</bold></xref>–<xref ref-type="bibr" rid="bibr13-0954410011406203"><bold>13</bold></xref>]. In this study a comprehensive simulation system has been developed to simulate, design and tune under realistic conditions a GPC regulator for the control of tiltrotor structural dynamics with a twofold objective: reduce vibrations and wing loads, and extend the flutter-free flight envelope using the swashplate controls as inputs, without the need to add <italic>ad hoc</italic> control devices. The capability of the GPC regulator to autonomously follow the system variations and to artificially stabilize the system beyond the flutter is investigated in detail from a numerical point of view.</p>
<p>The simulation system is composed by the elements shown in the block diagram of <xref ref-type="fig" rid="fig1-0954410011406203">Fig. 1</xref>. Each part is described in this article. In detail, the aeroservoelastic model of the <italic>tiltrotor</italic>, inclusive of actuators and sensors, has been realized using the multibody modelling technique described in <xref ref-type="sec" rid="sec2-0954410011406203">section 2</xref>. This technique is widely used for the simulation of tiltrotor aircraft since it easily allows one to model the complexity of these systems in a general way [<xref ref-type="bibr" rid="bibr14-0954410011406203"><bold>14</bold></xref>] without the need to develop specific software [<xref ref-type="bibr" rid="bibr15-0954410011406203"><bold>15</bold></xref>].
<fig id="fig1-0954410011406203" position="float"><label>Fig. 1</label><caption><p>Comprehensive simulation system</p></caption><graphic xlink:href="10.1177_0954410011406203-fig1.tif"/></fig></p>
<p>The <italic>GPC regulator</italic> is implemented as an external process. The inputs of the regulator are the measures obtained from the multibody model, while the outputs are the commands imposed to the swashplate actuators. <xref ref-type="sec" rid="sec7-0954410011406203">Section 3</xref> describes the control methodology, along with its connection to the multibody model. The results of the extensive simulations carried out with the GPC controller are shown in <xref ref-type="sec" rid="sec11-0954410011406203">sections 4</xref> to <xref ref-type="sec" rid="sec18-0954410011406203">7</xref>. Conclusions are drawn in <xref ref-type="sec" rid="sec19-0954410011406203">section 8</xref>, where further development of this study is anticipated.</p></sec>
<sec id="sec2-0954410011406203"><title>2 MODEL DESCRIPTION</title>
<p>The tiltrotor multibody model used in this study represents the WRATS, a semispan aeroelastic wind-tunnel model tested at the TDT of NASA's Langley Research Center. The WRATS has been used to investigate new tiltrotor configurations; different versions of the system have been developed: the initial one, with a three-blade hingeless stiff-inplane rotor, along with three-blade hingeless and four-blade semi-articulated soft-inplane variants. This study focuses on the original three-blade stiff-inplane rotor design.</p>
<p>All the multibody simulations of the time response of the WRATS have been performed using the free general-purpose multibody simulation software MBDyn (<ext-link ext-link-type="uri" xlink:href="http://www.mbdyn.org">http://www.mbdyn.org</ext-link>), developed at the Dipartimento di Ingegneria Aerospaziale of the University Politecnico di Milano.</p>
<sec id="sec3-0954410011406203"><title>2.1 The multibody solver ‘MBDyn’</title>
<p>Although designed from the beginning with tiltrotor aeroservoelasticity and aeromechanics in mind [<xref ref-type="bibr" rid="bibr16-0954410011406203"><bold>16</bold></xref>], MBDyn is based on a general purpose multibody formulation that allows to model generic multidisciplinary problems, characterized by kinematically exact constrained rigid body dynamics, deformable components, aerodynamics, and controls. It solves initial value problems in form of differential-algebraic equations (DAE), using a family of multistep A/L-stable tunable integration algorithms [<xref ref-type="bibr" rid="bibr17-0954410011406203"><bold>17</bold></xref>].</p>
<p>The Newton--Euler equations that describe the dynamics of a system of unconstrained rigid bodies
<disp-formula id="disp-formula1a-0954410011406203"><label>(1a)</label><graphic xlink:href="10.1177_0954410011406203-eq1.tif"/></disp-formula>
<disp-formula id="disp-formula1b-0954410011406203"><label>(1b)</label><graphic xlink:href="10.1177_0954410011406203-eq2.tif"/></disp-formula>
are written; <bold><italic>q</italic></bold> ∈ ℝ<sup><italic>n</italic></sup> are the <italic>n</italic> coordinates of the system, <bold>M</bold> ∈ ℝ<sup><italic>n</italic>×<italic>n</italic></sup> is the mass matrix, <bold><italic>p</italic></bold> ∈ ℝ<sup><italic>n</italic></sup> are the momentum and momenta moments, and <bold><italic>f</italic></bold> : ℝ<sup>3<italic>n</italic>+1</sup> ↦ ℝ<sup><italic>n</italic></sup> are the remaining forces, possibly dependent on the configuration of the system (elastic, viscous, and aerodynamic). Equations (<xref ref-type="disp-formula" rid="disp-formula1a-0954410011406203">1</xref>) are augmented by <italic>c</italic> kinematic constraint equations <bold>φ</bold>(<bold><italic>q</italic></bold>, <italic>t</italic>) : ℝ<sup><italic>n</italic>+1</sup> ↦ ℝ<sup><italic>c</italic></sup> using Lagrange's multipliers <bold>λ</bold> ∈ ℝ<sup><italic>c</italic></sup>, yielding
<disp-formula id="disp-formula2a-0954410011406203"><label>(2a)</label><graphic xlink:href="10.1177_0954410011406203-eq3.tif"/></disp-formula>
<disp-formula id="disp-formula2b-0954410011406203"><label>(2b)</label><graphic xlink:href="10.1177_0954410011406203-eq4.tif"/></disp-formula>
<disp-formula id="disp-formula2c-0954410011406203"><label>(2c)</label><graphic xlink:href="10.1177_0954410011406203-eq5.tif"/></disp-formula>
resulting in a set of implicit DAEs.</p></sec>
<sec id="sec4-0954410011406203"><title>2.2 Comprehensive aeroservoelastic model</title>
<p>The aeroservoelastic model of the WRATS model implemented in MBDyn [<xref ref-type="bibr" rid="bibr2-0954410011406203"><bold>2</bold></xref>] evolved over the years in support of wind-tunnel testing at NASA LaRC (soft-inplane [<xref ref-type="bibr" rid="bibr18-0954410011406203"><bold>18</bold></xref>, <xref ref-type="bibr" rid="bibr19-0954410011406203"><bold>19</bold></xref>], stiff-inplane [<xref ref-type="bibr" rid="bibr20-0954410011406203"><bold>20</bold></xref>, <xref ref-type="bibr" rid="bibr21-0954410011406203"><bold>21</bold></xref>]). <xref ref-type="fig" rid="fig2-0954410011406203">Figure 2</xref> shows a sketch of the WRATS multibody model. It consists of the following.
<list id="list1-0000000000406203" list-type="order">
<list-item><p><italic>Wing:</italic> It is modelled using six three-node beam elements. MBDyn implements an original non-linear, geometrically exact finite-volume beam element, described in reference [<xref ref-type="bibr" rid="bibr22-0954410011406203"><bold>22</bold></xref>]. The wing aerodynamics is modelled using quasi-steady strip theory with coefficients from look-up tables.</p></list-item>
<list-item><p><italic>Pylon:</italic> It is attached to the wing tip; its tilting with respect to the wing can be driven to model the aircraft in <italic>airplane mode</italic>, in <italic>helicopter mode</italic> or in any intermediate configuration.</p></list-item>
<list-item><p><italic>Mast:</italic> It is modelled using two two-node beam elements.</p></list-item>
<list-item><p><italic>Swashplate:</italic> It is modelled on a physical basis, along with the exact kinematics of the blade pitching mechanism.</p></list-item>
<list-item><p><italic>Rotor:</italic> It is modelled using an ideal gimbal joint [<xref ref-type="bibr" rid="bibr23-0954410011406203"><bold>23</bold></xref>] between the hub and the mast. The flexbeams and the blades are modelled using beam elements. The blade aerodynamics is modelled with the blade element approach coupled with the momentum theory, using a uniform inflow model.</p></list-item>
<list-item><p><italic>Actuators:</italic> The swashplate motions – collective (θ<sub>0</sub>), and lateral (θ<sub><italic>s</italic></sub>) and longitudinal cyclic (θ<sub><italic>c</italic></sub>) – are driven by actuators with bandwidth limited to up to 20 Hz.</p></list-item>
<list-item><p><italic>Sensors:</italic> The inputs of the GPC regulator are the measurements of the wing root torsional (<italic>M</italic><sub><italic>T</italic></sub>) and bending moments (<italic>M</italic><sub><italic>B</italic>1</sub> and <italic>M</italic><sub><italic>B</italic>2</sub>). (In the WRATS model, the moments are inferred using a set of strain gauges appropriately placed at the wing root.) The measured moments are conditioned using a fourth-order low-pass Butterworth filter with a 20-Hz cut frequency to avoid aliasing and control spill-over, limiting the regulator inputs within the frequency bandwidth of interest.</p></list-item>
</list></p>
<fig id="fig2-0954410011406203" position="float"><label>Fig. 2</label><caption><p>Tiltrotor multibody model: airplane (top) and helicopter (bottom) mode</p></caption><graphic xlink:href="10.1177_0954410011406203-fig2.tif"/></fig>
<p>A simplified model has also been realized using rigid blades and neglecting the aerodynamics of the wing. The simplified model has been used to design and tune the controller. A significant number of simulations are required in this phase to tune the parameters of the regulator. Hence, a simplified model of reduced complexity allows one to significantly reduce the computational time. The differences between the two models are highlighted in the following sections. In any case, since an adaptive control methodology is used, the differences between the two models are not expected to play an essential role, because the GPC regulator must be able to adapt autonomously and compensate them.</p></sec>
<sec id="sec5-0954410011406203"><title>2.3 Rotor trim</title>
<p>The tiltrotor has been analysed in <italic>airplane mode</italic> with the rotor in windmill condition. In this configuration, whirl-flutter can arise at high advance velocity. The instability is determined by the adverse interaction between the rotor and its flexible support, i.e. the wing.</p>
<p>The objective of the control is twofold: reduce the wing vibratory level and the loads at the wing root when the airstream velocity is below the whirl-flutter velocity, and thus the model is naturally stable, then stabilize the system beyond the flutter speed of the uncontrolled system. The desired flight envelope, in which the tiltrotor must be either naturally or artificially stable, is set between 0 and 200 kts at sea level.</p>
<p>The trim collective angle, <inline-formula id="ilm1-0954410011406203"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math1-0954410011406203"><mml:mrow><mml:msubsup><mml:mi>θ</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mtext>TRIM</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, clearly depends on the airstream velocity. It has been computed using multibody simulations with the isolated rotor in axial flow to obtain the rotor thrust and torque as functions of the collective input at different velocities. The rotor was considered isolated to avoid potentially unstable interactions with the wing structure.</p>
<p><xref ref-type="fig" rid="fig3-0954410011406203">Figure 3</xref>(a) shows the collective-torque curves for different values of airstream velocity <italic>V</italic><sub>∞</sub>, ranging from 40 to 220 kts. The windmill collective curve is marked. <xref ref-type="fig" rid="fig3-0954410011406203">Figure 3</xref>(b) shows the dependence of <inline-formula id="ilm2-0954410011406203"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math2-0954410011406203"><mml:mrow><mml:msubsup><mml:mi>θ</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mtext>TRIM</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> on the airstream velocity. The same figure shows also a different trim condition used to test the capability of the regulator to adapt to different working conditions. In this trim condition, the rotor generates a constant thrust of 50 lbf. <xref ref-type="fig" rid="fig3-0954410011406203">Figure 3</xref>(b) shows a slight difference between the trim collective angles of the rigid and flexible blade models. To trim the flexible rotor, slightly higher collective angles are needed to compensate for the thrust reduction due to the deformation of the blades. Although the difference may look minimal, it is worth noticing that the rotor thrust is extremely sensitive to collective at high airstream velocities, which require large collective angles. During the simulations the <italic>trim input</italic> shown in <xref ref-type="fig" rid="fig1-0954410011406203">Fig. 1</xref> is updated as a function of the airstream velocity using the relationship between <inline-formula id="ilm3-0954410011406203"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math3-0954410011406203"><mml:mrow><mml:msubsup><mml:mi>θ</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mtext>TRIM</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <italic>V</italic><sub>∞</sub>.
<fig id="fig3-0954410011406203" position="float"><label>Fig. 3</label><caption><p>Rotor trim</p></caption><graphic xlink:href="10.1177_0954410011406203-fig3.tif"/></fig></p>
<p><xref ref-type="fig" rid="fig4-0954410011406203">Figure 4</xref> shows the relationship between the commanded and the actual blade collective angle. The difference between the two angles, and significantly the non-linearity that appears between 35° and 40°, is related to the kinematics of the pitch control system, which is exactly modelled in the multibody model. This relationship also depends on the blade flap angle β. The trim collective angles are below 40° for both trim conditions within the entire flight envelope.
<fig id="fig4-0954410011406203" position="float"><label>Fig. 4</label><caption><p>Effect of control system kinematics on actual blade pitch angle</p></caption><graphic xlink:href="10.1177_0954410011406203-fig4.tif"/></fig></p>
<p>The original model has a different blade root pitch offset, and higher collective angles were required to trim the rotor. As a consequence, the rotor could not be trimmed within the desired flight envelope, because the limits of the pitch control kinematics were exceeded at high speed. A nose-up 30° rigid pitch has been imposed at the blade root to keep the pitch angle far from those limits, and to be able to trim the rotor up to 220 kts, as shown in the previous figures. This type of modification is allowed by the actual wind-tunnel model hardware, thanks to its versatile design.</p></sec>
<sec id="sec6-0954410011406203"><title>2.4 Stability analysis</title>
<p>The stability of the airplane mode trim condition has been assessed as a function of the airstream velocity by determining the baseline whirl-flutter velocity. The stability analysis of trajectories of a complex non-linear system modelled using the multibody approach cannot be easily addressed using analytical methods based on a linearized expression of the governing equations. Experimental methods able to extract stability characteristics from measured data can be applied to transient analysis resulting from numerical ‘virtual’ experiments [<xref ref-type="bibr" rid="bibr24-0954410011406203"><bold>24</bold></xref>, <xref ref-type="bibr" rid="bibr25-0954410011406203"><bold>25</bold></xref>].</p>
<p>The tiltrotor model trimmed at constant speed forward flight has been excited with an impulsive out-of-plane force applied at the wing tip after 3 s. The transient caused by the perturbation has been analysed using an approach based on the proper orthogonal decomposition (POD) [<xref ref-type="bibr" rid="bibr24-0954410011406203"><bold>24</bold></xref>] applied to the displacement, rotation vector components, linear and angular velocities of the wing nodes to estimate the frequency and the damping of the natural modes of the wing. The test has been repeated at different airstream speeds over the desired range. The tiltrotor with rigid blades does not show any instability up to 200 kts when the downstop spring is engaged.</p>
<p>In order to assess the flutter suppression capabilities of the GPC regulator, the stiffness properties of the wing have been arbitrarily reduced with respect to their baseline value, to bring the whirl-flutter airstream velocity within the flight envelope. The reduced values are <italic>GJ</italic> = 0.27<italic>GJ</italic><sup>baseline</sup>, <inline-formula id="ilm4-0954410011406203"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math4-0954410011406203"><mml:mrow><mml:mi>E</mml:mi><mml:msub><mml:mi>J</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn><mml:mi>E</mml:mi><mml:msubsup><mml:mi>J</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mtext>baseline</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:msub><mml:mi>J</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn><mml:mi>E</mml:mi><mml:msubsup><mml:mi>J</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mtext>baseline</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, respectively for the torsional, in-plane and out-of-plane bending stiffnesses. <xref ref-type="table" rid="table1-0954410011406203">Table 1</xref> compares the first natural frequencies for the baseline and the modified wing.
<table-wrap id="table1-0954410011406203" position="float"><label>Table 1</label><caption><p>Wing natural frequencies</p></caption>
<graphic alternate-form-of="table1-0954410011406203" xlink:href="10.1177_0954410011406203-table1.tif"/>
<table frame="hsides"><thead>
<tr><th>Mode</th>
<th>Baseline (Hz)</th>
<th>Modified (Hz)</th></tr></thead>
<tbody>
<tr>
<td>First torsional</td>
<td>15.86</td>
<td>8.56</td></tr>
<tr>
<td>First out-of-plane bending</td>
<td>6.01</td>
<td>5.32</td></tr>
<tr>
<td>First in-plane bending</td>
<td>7.16</td>
<td>6.78</td></tr>
</tbody>
</table>
</table-wrap></p>
<p>A reduction of the torsional stiffness is essentially the consequence of a reduction of the wing thickness. This reduces the passive drag of the wing, resulting in a more aerodynamically efficient wing design. The feasibility of a stiffness reduction with no impact on aeroelastic stability is thus very appealing. A thickness reduction of the wing of the WRATS model, without significantly degrading whirl-flutter stability, was attempted in the 1990s using passive aeroelastic tailoring [<xref ref-type="bibr" rid="bibr26-0954410011406203"><bold>26</bold></xref>–<xref ref-type="bibr" rid="bibr28-0954410011406203"><bold>28</bold></xref>]. The experimental verification was appreciably successful.</p>
<p><xref ref-type="fig" rid="fig5-0954410011406203">Figure 5</xref>(a) shows frequency and damping of the first three natural modes of the wing for the model with the rotor trimmed in windmill condition and with rigid blades. The model is stable up to 153 kts. The unstable mode frequency is 4.5 Hz. The mode is characterized by a coupling between the hub motion and the wing out-of-plane bending and torsional deformation. Acree <italic>et al</italic>. [<xref ref-type="bibr" rid="bibr29-0954410011406203"><bold>29</bold></xref>] note that the powered flight condition may present lower flutter boundaries, and thus always recommend to consider it when evaluating tiltrotor stability. The same analysis conducted with the constant thrust trim condition in fact reveals a negative effect of the thrust on the whirl-flutter instability, since the flutter velocity reduces to 145 kts, as shown in <xref ref-type="fig" rid="fig5-0954410011406203">Fig. 5</xref>(b).
<fig id="fig5-0954410011406203" position="float"><label>Fig. 5</label><caption><p>Whirl-flutter velocity assessment</p></caption><graphic xlink:href="10.1177_0954410011406203-fig5.tif"/></fig></p>
<p>At a first glance, this result seems to be in contrast with the behaviour of the four-blade soft-inplane variant of the WRATS (Fig. 9 of reference [<bold>30</bold>]), which exhibited a greater stability and a much larger flutter speed when ‘powered’. In that case, a possible explanation for the observed behaviour was given in references [<xref ref-type="bibr" rid="bibr19-0954410011406203"><bold>19</bold></xref>, <xref ref-type="bibr" rid="bibr31-0954410011406203"><bold>31</bold></xref>, <xref ref-type="bibr" rid="bibr32-0954410011406203"><bold>32</bold></xref>], based on some freeplay eventually discovered in the drive train during that specific test campaign.</p>
<p>The effect of rotor thrust on the whirl-flutter instability of the three-bladed stiff-in-plane rotor used in this study has been further investigated. <xref ref-type="fig" rid="fig6-0954410011406203">Figure 6</xref>(a) shows the damping of the critical flutter mode for different thrust values. <xref ref-type="fig" rid="fig6-0954410011406203">Figure 6</xref>(b) shows the dependence of the whirl-flutter velocity on the rotor thrust. The negative effect of positive thrust on stability can be clearly seen.
<fig id="fig6-0954410011406203" position="float"><label>Fig. 6</label><caption><p>Effect of rotor thrust on tiltrotor stability</p></caption><graphic xlink:href="10.1177_0954410011406203-fig6.tif"/></fig></p>
<p><xref ref-type="fig" rid="fig10-0954410011406203">Figure 10</xref> of reference [<xref ref-type="bibr" rid="bibr30-0954410011406203"><bold>30</bold></xref>] presented the behaviour of the stiff-inplane variant of the WRATS, as measured during whirl-flutter wind-tunnel tests. In that reference, the damping associated to the first wing beam bending mode appears to be significantly larger in powered configuration as opposed to windmill. However, the above-mentioned figure also shows that as soon as <italic>V</italic><sub>∞</sub> is increased and the damping decreases, the curve in the powered case drops more rapidly than in the windmill case, crossing zero few knots before the one measured in windmill. <xref ref-type="fig" rid="fig6-0954410011406203">Figure 6</xref>(a) shows that the results presented in this study are qualitatively consistent with the experimental behaviour of reference [<xref ref-type="bibr" rid="bibr30-0954410011406203"><bold>30</bold></xref>].</p>
<p>To point out the differences between the windmill and the constant thrust trim conditions at whirl-flutter, the POD has been applied to the computed rotor motion, consisting in:
<list id="list2-0000000000406203" list-type="alpha-lower">
<list-item><p>the displacement, rotation vector, linear and angular velocity components of the blade nodes relative to the shaft, transformed in a blade local reference frame, with axis <italic>Yloc</italic> along the blade span, axis <italic>Zloc</italic> aligned with the shaft and axis <italic>Xloc</italic> oriented accordingly to the right-hand rule; <italic>Zloc</italic> is related to flapping, while <italic>Xloc</italic> is related to lead-lag;</p></list-item>
<list-item><p>the displacement, rotation vector, linear and angular velocity components of the hub node relative to the shaft node, transformed in a rotating frame.</p></list-item>
</list><xref ref-type="table" rid="table2-0954410011406203">Table 2</xref> shows the identified frequency and damping of the two dominant modes at flutter, and <xref ref-type="fig" rid="fig7-0954410011406203">Fig. 7</xref> presents the amplitude and the phase of rotor motion components (scaled with blade 1 <italic>Zloc</italic> component equal to 1) for both modes and trim conditions. Both modes are cyclic in nature since the relative phase among the motion of the blades is 120° for all components. The <italic>Zloc</italic> displacement (flap) shows the largest participation in both modes, highlighting their nature of rotor disc precession. Mode 2's <italic>Xloc</italic> displacement (lead-lag) is twice that of mode 1. Since the modes are cyclic, their frequency can be transformed from the rotating to the fixed frame according to ω<sub>fixed</sub> = ‖ω<sub>rotating</sub> − Ω‖, where Ω = 12.37 Hz is the rotor angular velocity. Therefore, the frequencies identified from the rotor motion in the rotating frame (<xref ref-type="table" rid="table2-0954410011406203">Table 2</xref>), when transformed in the fixed frame are very close to the frequency of the first out-of-plane bending mode of the wing.
<fig id="fig7-0954410011406203" position="float"><label>Fig. 7</label><caption><p>Identified POM shapes</p></caption><graphic xlink:href="10.1177_0954410011406203-fig7.tif"/></fig>
<table-wrap id="table2-0954410011406203" position="float"><label>Table 2</label><caption><p>Damping (ξ) and frequency (ω) of identified dominant rotor modes at flutter velocity</p></caption>
<graphic alternate-form-of="table2-0954410011406203" xlink:href="10.1177_0954410011406203-table2.tif"/>
<table frame="hsides"><thead>
<tr><th/>
<th colspan="2">Windmill (<italic>V</italic><sub>∞</sub> = 153 kts)<hr/></th>
<th colspan="2">Const. thrust (<italic>V</italic><sub>∞</sub> = 145 kts)<hr/></th></tr>
<tr><th/>
<th>ξ [Ad.]</th>
<th>ω [Hz]</th>
<th>ξ [Ad.]</th>
<th>ω [Hz]</th></tr></thead>
<tbody>
<tr>
<td>Mode 1</td>
<td>0.0173</td>
<td>17.56</td>
<td>0.0095</td>
<td>17.46</td></tr>
<tr>
<td>Mode 2</td>
<td>-0.0001</td>
<td>7.65</td>
<td>0.0005</td>
<td>7.44</td></tr>
</tbody>
</table>
</table-wrap></p>
<p>In any case, the differences between the two trim conditions appear to be very small.</p>
<p>The stability analysis of the tiltrotor model with flexible blades unexpectedly showed that the whirl-flutter velocity is significantly greater than the one with rigid blades: 180 kts for windmill trim and 158 kts for constant thrust trim. The reduction of the whirl-flutter speed with constant thrust is confirmed, and more pronounced. This difference has not been investigated further because it is not deemed essential, given the focus of the work.</p>
<p>The regulator has been designed using the rigid blade model, the most critical configuration from a stability point of view. Its capability to adapt to a more detailed model, with slightly different aeroelastic behaviour, has been subsequently verified.</p></sec></sec>
<sec id="sec7-0954410011406203"><title>3 CONTROL</title>
<p>A multi-input multi-output GPC controller in discrete-time has been implemented. The controller consists of two blocks: an <italic>identifier</italic>, for on-line model identification, and a <italic>controller</italic> that uses the identified model to compute the control inputs. A representative reduced order model (ROM) of the problem needs to be identified, so to avoid ill-posed identification problems and excessive computational burden. As a consequence, no analytical knowledge of the system is needed. The identifier and controller are continuously updated; the identification of the ROM and the synthesis of the control must be carried out at each time step.</p>
<p>The basic idea underlying predictive control (PC) is to compute the control inputs that minimize the difference between the predicted and the desired outputs on a finite control horizon. PC is an advanced control methodology, widely used in industrial applications, especially to control chemical and nuclear power plants [<xref ref-type="bibr" rid="bibr33-0954410011406203"><bold>33</bold></xref>, <xref ref-type="bibr" rid="bibr34-0954410011406203"><bold>34</bold></xref>]. These systems are usually characterized by slow dynamics; their low-control frequency allows one to solve a constrained minimization at each time step to determine the control inputs. On the contrary, aeroelastic systems are characterized by much faster dynamics [<xref ref-type="bibr" rid="bibr3-0954410011406203"><bold>3</bold></xref>, <xref ref-type="bibr" rid="bibr11-0954410011406203"><bold>11</bold></xref>, <xref ref-type="bibr" rid="bibr35-0954410011406203"><bold>35</bold></xref>]. The required higher control frequencies make computationally expensive constrained minimizations impractical in real-time. GPC is an effective implementation of PC where the system model is in the ARX or ARMAX form, and the minimization problem for the control inputs is solved in closed form without any constraint.</p>
<sec id="sec8-0954410011406203"><title>3.1 Identifier</title>
<p>Starting from the measures <bold><italic>y</italic></bold> and <bold><italic>u</italic></bold> of the system outputs and inputs, a model in ARMAX form
<disp-formula id="disp-formula3-0954410011406203"><label>(3)</label><graphic xlink:href="10.1177_0954410011406203-eq6.tif"/></disp-formula>
is identified; <bold><italic>ŷ</italic></bold><sub><italic>k</italic></sub> ∈ ℝ<sup><italic>p</italic></sup> are the predicted outputs at time step <italic>k</italic>, <bold><italic>y</italic></bold><sub><italic>k</italic>−<italic>i</italic></sub> ∈ ℝ<sup><italic>p</italic></sup> the measured outputs at time step <italic>k</italic> − <italic>i</italic>, <bold><italic>u</italic></bold><sub><italic>k</italic>−<italic>i</italic></sub> ∈ ℝ<sup><italic>m</italic></sup> are the measured inputs at time step <italic>k</italic> − <italic>i</italic>, and <bold>A</bold><sub><italic>i</italic></sub> ∈ ℝ<sup><italic>p</italic>×<italic>p</italic></sup>, <bold>B</bold><sub><italic>i</italic></sub> ∈ ℝ<sup><italic>p</italic>×<italic>m</italic></sup> and <bold>C</bold><sub><italic>i</italic></sub> ∈ ℝ<sup><italic>p</italic>×<italic>p</italic></sup> the ARMAX model parameter matrices
<disp-formula id="disp-formula4-0954410011406203"><label>(4)</label><graphic xlink:href="10.1177_0954410011406203-eq7.tif"/></disp-formula>
is the estimate of the identification error at time step <italic>k</italic> − <italic>i</italic>. The model order is given by <italic>n</italic><sub><italic>a</italic></sub>, <italic>n</italic><sub><italic>b</italic></sub>, and <italic>n</italic><sub><italic>c</italic></sub>; in this study, <italic>n</italic><sub><italic>a</italic></sub> = <italic>n</italic><sub><italic>b</italic></sub> = <italic>n</italic><sub><italic>c</italic></sub> = <italic>n</italic> are used.</p>
<p>An ARX model is obtained by discarding the contribution of the identification error; the ARX model assumes a white noise, whereas the ARMAX assumes a white noise filtered by the system defined by matrices <bold>C</bold><sub><italic>i</italic></sub> ∈ ℝ<sup><italic>p</italic>×<italic>p</italic></sup>, which need to be identified along with matrices <bold>A</bold><sub><italic>i</italic></sub> and <bold>B</bold><sub><italic>i</italic></sub>.</p>
<p>A recursive approach with forgetting factor, the extended least square (ELS) algorithm, is used to compute the elements of matrices <bold>A</bold><sub><italic>i</italic></sub>, <bold>B</bold><sub><italic>i</italic></sub>, and <bold>C</bold><sub><italic>i</italic></sub> of the ARMAX model. Equation (<xref ref-type="disp-formula" rid="disp-formula3-0954410011406203">3</xref>) can be arranged as
<disp-formula id="disp-formula5-0954410011406203"><label>(5)</label><graphic xlink:href="10.1177_0954410011406203-eq8.tif"/></disp-formula>
where
<disp-formula id="disp-formula6-0954410011406203"><label>(6)</label><graphic xlink:href="10.1177_0954410011406203-eq9.tif"/></disp-formula>
is a <italic>p</italic> × <italic>n</italic>(<italic>p</italic> + <italic>m</italic> + <italic>p</italic>) matrix, and
<disp-formula id="disp-formula7-0954410011406203"><label>(7)</label><graphic xlink:href="10.1177_0954410011406203-eq10.tif"/></disp-formula>
is a <italic>n</italic>(<italic>p</italic> + <italic>m</italic> + <italic>p</italic>) × 1 vector. When the moving average (MA) part is neglected, the recursive least squares (RLS) algorithm needs to be used.</p>
<p>The <italic>forgetting factor</italic> 0 &lt; μ ≤ 1 is accounted for by introducing an exponentially weighted figure of merit <italic>J</italic><sub><italic>k</italic></sub>
<disp-formula id="disp-formula8-0954410011406203"><label>(8)</label><graphic xlink:href="10.1177_0954410011406203-eq11.tif"/></disp-formula>
that needs to be minimized to compute the unknown coefficients; <bold>ε</bold> is the identification error defined in equation (<xref ref-type="disp-formula" rid="disp-formula4-0954410011406203">4</xref>). The forgetting factor is needed to obtain a fast response of the identification to system variation by giving higher weight to recent time steps. The parameter Γ = 1/(1 − μ) is often used as an index of the effective length of the identification time window.</p>
<p>The minimization of the performance index is realized using a <italic>recursive</italic> approach to reduce the computational burden. The RLS/ELS algorithm with forgetting factor is summarized by the recursive steps
<disp-formula id="disp-formula9a-0954410011406203"><label>(9a)</label><graphic xlink:href="10.1177_0954410011406203-eq12.tif"/></disp-formula>
<disp-formula id="disp-formula9b-0954410011406203"><label>(9b)</label><graphic xlink:href="10.1177_0954410011406203-eq13.tif"/></disp-formula>
<disp-formula id="disp-formula19c-0954410011406203"><label>(9c)</label><graphic xlink:href="10.1177_0954410011406203-eq14.tif"/></disp-formula>
<disp-formula id="disp-formula9d-0954410011406203"><label>(9d)</label><graphic xlink:href="10.1177_0954410011406203-eq15.tif"/></disp-formula>
</p>
<p>If no significant ill-conditioning appears, the formulation is particularly efficient, because it does not require any matrix inversion. It is perfectly equivalent to LS when the covariance matrix <bold>P</bold> is initialized appropriately. Initialization may be done using a batch LS algorithm for the first few time steps. (A minimal number of time steps is needed to have a well-posed problem.) However, the algorithm works well even with a less than ideal initialization, like <bold>P</bold><sub>0</sub> = λ<bold>I</bold>, with λ &gt; 0 arbitrary, and <bold>Θ</bold><sub>0</sub> = <bold>0</bold>. In this case, initial transients may be affected by significant error; however it quickly vanishes thanks to the forgetting factor. Ill-conditioning may result from insufficient excitation of the system or intrinsic lack of reachability.</p></sec>
<sec id="sec9-0954410011406203"><title>3.2 Controller</title>
<p>The control inputs are computed by minimizing the difference between the predicted and the desired outputs in a LS sense. The vector of the predicted outputs for the subsequent <italic>s</italic> time steps is
<disp-formula id="disp-formula10-0954410011406203"><label>(10)</label><graphic xlink:href="10.1177_0954410011406203-eq16.tif"/></disp-formula>
with <bold><inline-formula id="ilm13-0954410011406203"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math13-0954410011406203"><mml:mi mathvariant="script">Y</mml:mi></mml:math></inline-formula></bold><sub><italic>f</italic></sub> = {<bold><italic>ŷ</italic></bold><sub><italic>k</italic>+<italic>s</italic>−1</sub>;…; <bold><italic>ŷ</italic></bold><sub><italic>k</italic></sub>}. The future inputs vector <bold><inline-formula id="ilm14-0954410011406203"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math14-0954410011406203"><mml:mi mathvariant="script">U</mml:mi></mml:math></inline-formula></bold><sub><italic>f</italic></sub> = {<bold><italic>u</italic></bold><sub><italic>k</italic>+<italic>s</italic>−1</sub>;…; <bold><italic>u</italic></bold><sub><italic>k</italic></sub>}, the previous measured outputs vector <bold><inline-formula id="ilm15-0954410011406203"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math15-0954410011406203"><mml:mi mathvariant="script">Y</mml:mi></mml:math></inline-formula></bold><sub><italic>p</italic></sub> = {<italic><bold>y</bold></italic><sub><italic>k</italic>−1</sub>;…; <italic><bold>y</bold></italic><sub><italic>k</italic>−<italic>n</italic></sub>}, inputs vector <bold><inline-formula id="ilm16-0954410011406203"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math16-0954410011406203"><mml:mi mathvariant="script">U</mml:mi></mml:math></inline-formula></bold><sub><italic>p</italic></sub> = {<bold><italic>u</italic></bold><sub><italic>k</italic>−1</sub>;…; <bold><italic>u</italic></bold><sub><italic>k</italic>−<italic>n</italic></sub>} and identification error vector <bold>ℰ</bold><sub><italic>p</italic></sub> = {<bold>ε</bold><sub><italic>k</italic>−1</sub>;…; <bold>ε</bold><sub><italic>k</italic>−<italic>n</italic></sub>} are defined accordingly. The parameter <italic>s</italic> is called <italic>control horizon</italic>. The matrices in equation (<xref ref-type="disp-formula" rid="disp-formula10-0954410011406203">10</xref>) are
<disp-formula id="disp-formula11-0954410011406203"><label>(11)</label><graphic xlink:href="10.1177_0954410011406203-eq17.tif"/></disp-formula>
. The matrix sub-blocks are recursively defined as functions of the ARMAX model matrices of equation (<xref ref-type="disp-formula" rid="disp-formula3-0954410011406203">3</xref>)
<disp-formula id="disp-formula12-0954410011406203"><label>(12)</label><graphic xlink:href="10.1177_0954410011406203-eq18.tif"/></disp-formula>
. The control inputs are computed by minimizing the functional
<disp-formula id="disp-formula13-0954410011406203"><label>(13)</label><graphic xlink:href="10.1177_0954410011406203-eq19.tif"/></disp-formula>
where ρ is the control penalty function and <bold><inline-formula id="ilm17-0954410011406203"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math17-0954410011406203"><mml:mi mathvariant="script">Y</mml:mi></mml:math></inline-formula></bold><sub><italic>d</italic></sub> is the vector of the desired outputs. For loads reduction and flutter suppression the desired output is <bold><inline-formula id="ilm18-0954410011406203"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math18-0954410011406203"><mml:mi mathvariant="script">Y</mml:mi></mml:math></inline-formula></bold><sub><italic>d</italic></sub> = <bold>0</bold>.</p>
<p>The definition of the PC functional could be more complex. In principle, some constraints, for example upper/lower bounds on control variables, could be added at the cost of increasing the computational effort. The GPC allows one to find the solution of the minimization of equation (<xref ref-type="disp-formula" rid="disp-formula13-0954410011406203">13</xref>) in closed form
<disp-formula id="disp-formula14-0954410011406203"><label>(14)</label><graphic xlink:href="10.1177_0954410011406203-eq20.tif"/></disp-formula>
because no constraints are defined on the input and output variables, resulting in a quadratic functional. The performances and the control effort can be tuned by means of the parameter ρ, which represents a generic scalar weight on the control cost. When ρ = 0 the so-called <italic>deadbeat</italic> control [<xref ref-type="bibr" rid="bibr36-0954410011406203"><bold>36</bold></xref>] is obtained, which results from the generalized moore–penrose inverse, or pseudo-inverse, of matrix <bold><inline-formula id="ilm19-0954410011406203"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math19-0954410011406203"><mml:mi mathvariant="script">D</mml:mi></mml:math></inline-formula></bold>. In fact, (<bold><inline-formula id="ilm20-0954410011406203"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math20-0954410011406203"><mml:mi mathvariant="script">D</mml:mi></mml:math></inline-formula></bold><sup><italic>T</italic></sup> <bold><inline-formula id="ilm21-0954410011406203"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math21-0954410011406203"><mml:mi mathvariant="script">D</mml:mi></mml:math></inline-formula></bold>)<sup>−1</sup> <bold><inline-formula id="ilm22-0954410011406203"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math22-0954410011406203"><mml:mi mathvariant="script">D</mml:mi></mml:math></inline-formula></bold><sup><italic>T</italic></sup> = <bold><inline-formula id="ilm23-0954410011406203"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math23-0954410011406203"><mml:mi mathvariant="script">D</mml:mi></mml:math></inline-formula></bold><sup>†</sup> as soon as <bold><inline-formula id="ilm24-0954410011406203"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math24-0954410011406203"><mml:mi mathvariant="script">D</mml:mi></mml:math></inline-formula></bold> is full column-rank.</p>
<p>Of all the control inputs computed from equation (<xref ref-type="disp-formula" rid="disp-formula14-0954410011406203">14</xref>) for the <italic>s</italic> subsequent time steps, only those related to the first step are used, according to the <italic>receding horizon</italic> approach. A new minimization problem is solved for each subsequent time step, as soon as a new set of measurements and possibly a new identification of the system are available. The algorithm for the controller with the ARX model results from neglecting matrices <bold><inline-formula id="ilm25-0954410011406203"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math25-0954410011406203"><mml:mi mathvariant="script">C</mml:mi></mml:math></inline-formula></bold> in the previous equations.</p></sec>
<sec id="sec10-0954410011406203"><title>3.3 Control integration with multibody model</title>
<p>As shown in <xref ref-type="fig" rid="fig1-0954410011406203">Fig. 1</xref>, the controller is an external process with respect to the multibody simulation. In practice, MBDyn simulates the real system; the (already discrete) output of the sensors is virtually sampled and used by the GPC regulator to compute the control inputs that are sent back to MBDyn. The communication between the two processes is performed <italic>via</italic> standard UNIX sockets.</p>
<p>Before being used in the GPC algorithm, the measured inputs <bold><italic>y</italic></bold><sup><italic>m</italic></sup> and outputs <bold><italic>u</italic></bold><sup><italic>m</italic></sup> are scaled: <bold><italic>y</italic></bold> = <bold>S</bold><sub><italic>y</italic></sub> <bold><italic>y</italic></bold><sup><italic>m</italic></sup> and <bold><italic>u</italic></bold> = <bold>S</bold><sub><italic>u</italic></sub> <bold><italic>u</italic></bold><sup><italic>m</italic></sup>; the scaling matrices <bold>S</bold><sub><italic>y</italic></sub> and <bold>S</bold><sub><italic>u</italic></sub> are diagonal. The measured outputs <bold><italic>y</italic></bold> are also preconditioned (the <italic>measures conditioning</italic> block in <xref ref-type="fig" rid="fig1-0954410011406203">Fig. 1</xref>) by removing the mean value, which is computed using a fixed number of preceding time steps. Measure preconditioning yielded better regulator performances in coupled simulations. The mean value of the measured outputs <inline-formula id="ilm5-0954410011406203"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math5-0954410011406203"><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula> is recursively updated according to <inline-formula id="ilm6-0954410011406203"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math6-0954410011406203"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo>–</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>–</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> where <italic>L</italic> is the number of time steps corresponding to the window used to compute the mean value. The amplitude of the controller outputs is scaled using the inverse of the inputs scaling matrix, i.e. <inline-formula id="ilm7-0954410011406203"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math7-0954410011406203"><mml:mrow><mml:msubsup><mml:mi>u</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mtext>CON</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mi>u</mml:mi><mml:mrow><mml:mo>–</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>u</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and then limited (<italic>control limitation</italic> block in <xref ref-type="fig" rid="fig1-0954410011406203">Fig. 1</xref>) to a maximum of 5°, i.e. <inline-formula id="ilm8-0954410011406203"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math8-0954410011406203"><mml:mrow><mml:mo>–</mml:mo><mml:mn>5</mml:mn><mml:mo>°</mml:mo><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>u</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mtext>CON</mml:mtext></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:mn>5</mml:mn><mml:mo>°</mml:mo></mml:mrow></mml:math></inline-formula>, to avoid requesting the actuators an excessively ample motion. The <italic>identification input</italic> is subsequently added to the <italic>trim input</italic> and to the <italic>control input</italic> to obtain the total motion requested to the actuators, as shown in <xref ref-type="fig" rid="fig1-0954410011406203">Fig. 1</xref>. The <italic>identification input</italic> plays a fundamental role in keeping the identification problem well-posed, so that the identifier is able to follow the variations of the system, especially when the inputs and outputs are negligible because the external disturbances are too small. In this study, white noise low-pass filtered to excite only the bandwidth of interest has been used as <italic>identification input</italic>. The amplitude of the identification input is a critical parameter: it needs to be large enough to allow a correct identification, without excessively degrading the performances of the system (e.g. reduced comfort, insurgence of fatigue issues).</p>
<p>The GPC algorithm allows to take the identification input into account by modifying equation (<xref ref-type="disp-formula" rid="disp-formula10-0954410011406203">10</xref>) as
<disp-formula id="disp-formula15-0954410011406203"><label>(15)</label><graphic xlink:href="10.1177_0954410011406203-eq21.tif"/></disp-formula>
Since the identification input <inline-formula id="ilm9-0954410011406203"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math9-0954410011406203"><mml:mrow><mml:msubsup><mml:mi>u</mml:mi><mml:mi>f</mml:mi><mml:mrow><mml:mtext>ID</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is added to the control input <bold><inline-formula id="ilm26-0954410011406203"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math26-0954410011406203"><mml:mi mathvariant="script">U</mml:mi></mml:math></inline-formula></bold><sub><italic>f</italic></sub>, they both multiply the same matrix <bold><inline-formula id="ilm27-0954410011406203"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math27-0954410011406203"><mml:mi mathvariant="script">D</mml:mi></mml:math></inline-formula></bold>; thus, the identifier does not change, and equation (<xref ref-type="disp-formula" rid="disp-formula14-0954410011406203">14</xref>) becomes
<disp-formula id="disp-formula16-0954410011406203"><label>(16)</label><graphic xlink:href="10.1177_0954410011406203-eq22.tif"/></disp-formula>
</p></sec></sec>
<sec id="sec11-0954410011406203"><title>4 REGULATOR PRELIMINARY ANALYSES</title>
<p>This section discusses the effect of model order <italic>n</italic> and control horizon <italic>s</italic> on the performances of identifier and controller. Particular focus is placed on the required computational time because it is a crucial parameter for the real-time application of this kind of regulator. The results shown in this section have been obtained by exciting the tiltrotor model with a vertical turbulence while flying at 140 kts (i.e. below flutter speed). The system is thus excited by an unmeasured external input; measurement noise is added, consisting in white noise with 1 lbf<sup>2</sup> ft<sup>2</sup> variance, low-pass filtered at 50 Hz. <xref ref-type="table" rid="table3-0954410011406203">Table 3</xref> compares the performances of the identifier using ARX and ARMAX models of different orders. The quadratic identification error ε<sup>ID</sup>, defined as
<disp-formula id="disp-formula17-0954410011406203"><label>(17)</label><graphic xlink:href="10.1177_0954410011406203-eq23.tif"/></disp-formula>
is used to evaluate the quality of the identification. The table also shows the computational time (c.t.) in milliseconds on an AMD Athlon 64 X2 Dual Core Processor 5600+.
<table-wrap id="table3-0954410011406203" position="float"><label>Table 3</label><caption><p>Identifier performances</p></caption>
<graphic alternate-form-of="table3-0954410011406203" xlink:href="10.1177_0954410011406203-table3.tif"/>
<table frame="hsides"><thead>
<tr><th/>
<th colspan="2">ARX<hr/></th>
<th colspan="2">ARMAX<hr/></th></tr>
<tr><th><italic>n</italic></th>
<th>c.t. [ms]</th>
<th><italic>ε</italic><sup>ID</sup></th>
<th>c.t. [ms]</th>
<th>ε<sup>ID</sup></th></tr></thead>
<tbody>
<tr>
<td>8</td>
<td>0.0642</td>
<td>1352.7</td>
<td>0.1159</td>
<td>1336.1</td></tr>
<tr>
<td>12</td>
<td>0.1116</td>
<td>1272.1</td>
<td>0.2324</td>
<td>1249.9</td></tr>
<tr>
<td>16</td>
<td>0.1904</td>
<td>1231.7</td>
<td>0.3934</td>
<td>1217.4</td></tr>
<tr>
<td>20</td>
<td>0.2758</td>
<td>1188.8</td>
<td>0.5923</td>
<td>1175.0</td></tr>
<tr>
<td>24</td>
<td>0.3819</td>
<td>1167.2</td>
<td>0.8249</td>
<td>1160.4</td></tr>
<tr>
<td>28</td>
<td>0.5177</td>
<td>1154.7</td>
<td>1.2392</td>
<td>1150.9</td></tr>
<tr>
<td>32</td>
<td>0.6604</td>
<td>1147.5</td>
<td>1.8458</td>
<td>1148.9</td></tr>
</tbody>
</table>
</table-wrap></p>
<p>As expected, the quality of the identification increases with the model order; however, the computational time increases more than linearly. Only limited improvement is obtained with the ARMAX model, whereas the computational time increases significantly.</p>
<p>The performances of the controller are shown in <xref ref-type="table" rid="table4-0954410011406203">Table 4</xref> as functions of the model order <italic>n</italic> and of the control horizon <italic>s</italic>. The capability to reduce vibrations is evaluated using the ratio between the variance of the wing tip out-of-plane displacement computed with and without the regulator enabled, η = 100 σ<sup>ON</sup>/σ<sup>OFF</sup>. The c.t. required by the controller is also shown. All the results have been obtained using a constant control penalty ρ = 5000.
<table-wrap id="table4-0954410011406203" position="float"><label>Table 4</label><caption><p>Controller performances</p></caption>
<graphic alternate-form-of="table4-0954410011406203" xlink:href="10.1177_0954410011406203-table4.tif"/>
<table frame="hsides"><thead>
<tr><th/>
<th/>
<th colspan="2">ARX<hr/></th>
<th colspan="2">ARMAX<hr/></th></tr>
<tr><th><italic>n</italic></th>
<th><italic>s</italic></th>
<th>η [ad.]</th>
<th>c.t. [ms]</th>
<th>η [ad.]</th>
<th>c.t. [ms]</th></tr></thead>
<tbody>
<tr>
<td>16</td>
<td>16</td>
<td>33.97</td>
<td>0.6191</td>
<td>29.87</td>
<td>0.7514</td></tr>
<tr>
<td>16</td>
<td>24</td>
<td>14.04</td>
<td>1.3445</td>
<td>13.75</td>
<td>1.5390</td></tr>
<tr>
<td>16</td>
<td>32</td>
<td>3.11</td>
<td>2.4973</td>
<td>3.49</td>
<td>2.7393</td></tr>
<tr>
<td>24</td>
<td>24</td>
<td>27.21</td>
<td>1.5313</td>
<td>29.75</td>
<td>1.8315</td></tr>
<tr>
<td>24</td>
<td>32</td>
<td>2.79</td>
<td>2.7286</td>
<td>2.73</td>
<td>3.1418</td></tr>
<tr>
<td>24</td>
<td>48</td>
<td>2.26</td>
<td>7.0578</td>
<td>2.19</td>
<td>7.7660</td></tr>
<tr>
<td>32</td>
<td>32</td>
<td>3.91</td>
<td>3.0052</td>
<td>4.27</td>
<td>3.5478</td></tr>
<tr>
<td>32</td>
<td>48</td>
<td>3.29</td>
<td>7.5971</td>
<td>3.21</td>
<td>8.5918</td></tr>
<tr>
<td>32</td>
<td>64</td>
<td>2.72</td>
<td>16.6403</td>
<td>2.88</td>
<td>19.5071</td></tr>
</tbody>
</table>
</table-wrap></p>
<p>The table clearly shows that there is no significant difference in the controller performances between ARX and ARMAX models. As a consequence, an ARX model is used in the rest of the work since it requires less computational time.</p>
<p>In order to obtain the desired performances over all the different flight conditions extensive numerical simulations were required to tune the parameters of the GPC algorithm. The baseline set of parameters used to compute the results shown in the following sections is summarized in <xref ref-type="table" rid="table5-0954410011406203">Table 5</xref>. A constant penalty function ρ was considered for the sake of simplicity. The value ρ = 5000 was chosen since it yields sufficiently good performances at all the airstream velocities of interest, as shown in the following sections. Possible performance improvement resulting from the parameterization of ρ as a function of the airstream velocity needs to be investigated. Whenever a different parameter value was used in a simulation, its value has been noted in the text.
<table-wrap id="table5-0954410011406203" position="float"><label>Table 5</label><caption><p>GPC baseline parameters</p></caption>
<graphic alternate-form-of="table5-0954410011406203" xlink:href="10.1177_0954410011406203-table5.tif"/>
<table frame="hsides"><thead>
<tr><th>Parameter</th>
<th>Value</th></tr></thead>
<tbody>
<tr>
<td>ARX model order (<italic>n</italic>)</td>
<td>24</td></tr>
<tr>
<td>Forgetting factor (μ)</td>
<td>0.999</td></tr>
<tr>
<td>Control horizon (<italic>s</italic>)</td>
<td>48</td></tr>
<tr>
<td>Penalty function (ρ)</td>
<td>5000</td></tr>
<tr>
<td>Control frequency (<italic>f</italic><sub><italic>c</italic></sub>)</td>
<td>400 Hz</td></tr>
<tr>
<td>Inputs scale matrix (<bold>S</bold><sub><bold><italic>u</italic></bold></sub>)</td>
<td><bold>I</bold><sub><bold>3</bold></sub></td></tr>
<tr>
<td>Outputs scale matrix (<bold>S</bold><sub><bold><italic>y</italic></bold></sub>)</td>
<td><bold>I</bold><sub><bold>3</bold></sub></td></tr>
</tbody>
</table>
</table-wrap></p></sec>
<sec id="sec12-0954410011406203"><title>5 SELF-TUNING REGULATOR</title>
<p>When the system under control is time-invariant, the GPC algorithm can be used to obtain a self-tuning regulator, exploiting adaptivity only during the initial phase dedicated to the identification of matrices <bold><inline-formula id="ilm28-0954410011406203"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math28-0954410011406203"><mml:mi mathvariant="script">A</mml:mi></mml:math></inline-formula></bold>, <bold>ℬ</bold>, and <bold><inline-formula id="ilm29-0954410011406203"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math29-0954410011406203"><mml:mi mathvariant="script">C</mml:mi></mml:math></inline-formula></bold> of equation (<xref ref-type="disp-formula" rid="disp-formula10-0954410011406203">10</xref>). The resulting model is used to compute the control inputs without further modification to the matrices. This is the simplest use of the GPC controller. The system under control needs to be stable, otherwise it would diverge during the identification phase.</p>
<p>In the two following sub-sections, the self-tuning regulator is used to improve the gust response at <italic>V</italic><sub>∞</sub> = 80 kts, a velocity well below whirl-flutter, and at <italic>V</italic><sub>∞</sub> = 150 kts, right below flutter onset. The simulations have been performed using the model with rigid blades, without any measurement noise. Since the airstream velocity is constant, and therefore the system under control can be considered time-invariant, the forgetting factor of the RLS algorithm was set to μ = 1.</p>
<sec id="sec13-0954410011406203"><title>5.1 Response to cosine-shaped gust</title>
<p><xref ref-type="fig" rid="fig8-0954410011406203">Figure 8</xref> shows the wing tip displacement and the related collective angle when the aircraft experiences a vertical cosine-shaped gust for different regulator settings and airstream velocities. The gust wavelength is 40 in., and the peak velocity is 30 kts. The identification is switched off after 8 s. An identification input, with a 20 Hz bandwidth and 0.25 deg<sup>2</sup> variance, is added only when the identification is active. The controller is switched on after 2.5 s.
<fig id="fig8-0954410011406203" position="float"><label>Fig. 8</label><caption><p>Tiltrotor response to a cosine-shaped gust</p></caption><graphic xlink:href="10.1177_0954410011406203-fig8.tif"/></fig></p>
<p>At 80 kts (<xref ref-type="fig" rid="fig8-0954410011406203">Fig. 8</xref>(a)), the GPC controller has a limited effect on the tiltrotor response because the system is naturally well damped. However, it slightly increases the damping, as shown by the transient of the curve with ρ = 5000 compared to the baseline and the one with ρ = 500 000. At 140 kts (<xref ref-type="fig" rid="fig8-0954410011406203">Fig. 8</xref>(b)), right below flutter onset, the wing tip response to the same gust is significantly damped by the regulator.</p>
<p>The same figures illustrate the effect of the control penalty function ρ: when ρ is reduced the control increases the damping, at the cost of a significant increase of the control effort, as clearly shown in <xref ref-type="fig" rid="fig8-0954410011406203">Fig. 8(c) and (d)</xref>. <xref ref-type="fig" rid="fig8-0954410011406203">Figure 8</xref>(a) shows how too low a control penalty function value can destabilize the system even when the airstream velocity is far below the flutter onset value.</p></sec>
<sec id="sec14-0954410011406203"><title>5.2 Response to continuous gust</title>
<p>The self-tuning regulator is also able to improve the response to atmospheric turbulence (the gust velocity is modelled as a low-pass filtered random signal with maximum amplitude of 10 m/s). The self-tuning phase is exactly the same as in the previous simulation (excitation from 0 to 8 s, control on since 2.5 s); the turbulence is introduced after 10 s. This analysis also shows the robustness of the identification algorithm that works properly in the presence of an external unmeasured input, as the atmospheric turbulence.</p>
<p><xref ref-type="fig" rid="fig9-0954410011406203">Figure 9</xref> compares the baseline and the controlled response at 80 and 150 kts. The GPC regulator is clearly able to reduce the output intensity, both for wing tip out-of-plane displacement (not shown) and wing root moments. In detail, <xref ref-type="fig" rid="fig9-0954410011406203">Fig. 9</xref>(a) shows that the controller with ρ = 500 000 has no appreciable effect on the response, while <xref ref-type="fig" rid="fig9-0954410011406203">Fig. 9</xref>(b) shows only marginal effect, since the value of the penalty function is too large. Significant response to identification input occurs at 150 kts before the control is switched on because this flight condition is very close to flutter.</p>
<fig id="fig9-0954410011406203" position="float"><label>Fig. 9</label><caption><p>Tiltrotor response to atmospheric turbulence</p></caption><graphic xlink:href="10.1177_0954410011406203-fig9.tif"/></fig>
<p><xref ref-type="table" rid="table6-0954410011406203">Table 6</xref> shows the variance reduction factor η for wing root torsional and bending moments and for wing tip out-of-plane displacement and acceleration. These results clearly show that the effect of the controller increases with the velocity, and that the controller acts mainly on wing torsion and out-of-plane bending, the wing straining mainly involved in the whirl-flutter mechanism.
<table-wrap id="table6-0954410011406203" position="float"><label>Table 6</label><caption><p>Reduction factors for moments <italic>M</italic><sub><italic>T</italic></sub>, <italic>M</italic><sub><italic>B</italic>1</sub>, and <italic>M</italic><sub><italic>B</italic>2</sub> and <italic>z</italic><sub>TIP</sub> and <inline-formula id="ilm10-0954410011406203"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math10-0954410011406203"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>¨</mml:mo></mml:mover><mml:mrow><mml:mtext>TIP</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p></caption>
<graphic alternate-form-of="table6-0954410011406203" xlink:href="10.1177_0954410011406203-table6.tif"/>
<table frame="hsides"><thead>
<tr><th/>
<th colspan="2"><italic>V</italic><sub>∞</sub> = 80 kts<hr/></th>
<th colspan="2"><italic>V</italic><sub>∞</sub> = 150 kts<hr/></th></tr>
<tr><th/>
<th>η % (ρ = 5000)</th>
<th>η % (ρ = 500 000)</th>
<th>η % (ρ = 5000)</th>
<th>η % (ρ = 500 000)</th></tr></thead>
<tbody>
<tr>
<td><italic>M</italic><sub><italic>T</italic></sub></td>
<td>79.18</td>
<td>99.68</td>
<td>6.38</td>
<td>32.42</td></tr>
<tr>
<td><italic>M</italic><sub><italic>B</italic>1</sub></td>
<td>16.49</td>
<td>91.67</td>
<td>0.51</td>
<td>26.62</td></tr>
<tr>
<td><italic>M</italic><sub><italic>B</italic>2</sub></td>
<td>35.08</td>
<td>91.05</td>
<td>7.81</td>
<td>75.55</td></tr>
<tr>
<td><italic>z</italic><sub>TIP</sub></td>
<td>15.98</td>
<td>91.66</td>
<td>0.46</td>
<td>26.57</td></tr>
<tr>
<td><inline-formula id="ilm11-0954410011406203"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math11-0954410011406203"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>¨</mml:mo></mml:mover><mml:mrow><mml:mtext>TIP</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></td>
<td>52.85</td>
<td>94.43</td>
<td>13.95</td>
<td>29.80</td></tr>
</tbody>
</table>
</table-wrap></p></sec></sec>
<sec id="sec15-0954410011406203"><title>6 ADAPTIVE REGULATOR</title>
<p>A truly adaptive control system is obtained through an uninterrupted identification (and identification input) using a forgetting factor μ less than one in the RLS/ELS identification algorithm.</p>
<p><xref ref-type="fig" rid="fig10-0954410011406203">Figure 10</xref> shows the results of a simulation where the tiltrotor is excited by two cosine-shaped gusts. The first one occurs at the beginning of the simulation, when the airstream velocity is 80 kts, while the second one occurs after 13 s, when the airstream velocity increased to 140 kts according to the velocity profile shown in <xref ref-type="fig" rid="fig10-0954410011406203">Fig. 10</xref>(a). <xref ref-type="fig" rid="fig10-0954410011406203">Figure 10</xref>(b) shows the response for:
<list id="list3-0000000000406203" list-type="alpha-lower">
<list-item><p>the baseline uncontrolled model;</p></list-item>
<list-item><p>the model controlled using the self-tuning controller designed at 80 kts, and then kept unchanged when the airstream velocity is changed;</p></list-item>
<list-item><p>the model controlled with the adaptive controller.</p></list-item>
</list>Before the first gust appearance, there is an adaptation phase (not shown in the figure) during which the controlled models adapt the controller to the 80 kts velocity.</p>
<p>At 80 kts, the three responses do not differ significantly. The response with the adaptive controller is more clearly damped at 140 kts. The self-tuning controller used outside the design condition shows an insufficient robustness. This simulation clearly shows that the controller is effectively able to follow the variations of the system, giving satisfactory performances both at 80 and 140 kts. The identification input is essential: at 140 kts, the controller would not be able to properly work without it.</p>
<sec id="sec16-0954410011406203"><title>6.1 Flutter suppression</title>
<p>The adaptive controller can be used to suppress flutter. Initially, the regulator needs to adapt while the system is in a stable condition. The airstream velocity can be subsequently increased beyond the baseline flutter velocity, since the controller smoothly follows the variation of the system while stabilizing it. Initial tuning under stable conditions is needed to avoid divergence while the regulator is still unable to control the system.</p>
<p><xref ref-type="fig" rid="fig11-0954410011406203">Figure 11</xref>(a) to (d) shows the wing root moments and the wing tip out-of-plane displacement for a simulation where the velocity remains constant at 80 kts for 6 s, then increases up to 200 kts in 12 s. The tiltrotor is excited by atmospheric turbulence and by the identification input (a white noise with 0.04 deg<sup>2</sup> variance low-pass filtered at 20 Hz) needed to keep the identification always active. <xref ref-type="fig" rid="fig11-0954410011406203">Figure 11</xref>(a) to (d) clearly shows, that the GPC controller can stabilize the system within the entire desired flight envelope, and can adapt also in the presence of significant external disturbances and measurement noise in the wing root moments.
<fig id="fig10-0954410011406203" position="float"><label>Fig. 10</label><caption><p>Adaptive controller performances</p></caption><graphic xlink:href="10.1177_0954410011406203-fig10.tif"/></fig>
<fig id="fig11-0954410011406203" position="float"><label>Fig. 11</label><caption><p>Adaptive controller flutter suppression capabilities</p></caption><graphic xlink:href="10.1177_0954410011406203-fig11.tif"/></fig></p>
<p>It is worth noticing that these performances have been obtained with limited control effort. <xref ref-type="fig" rid="fig11-0954410011406203">Figure 11</xref>(e) shows the rotor collective θ<sub>0</sub>, the lateral θ<sub><italic>s</italic></sub>, and the longitudinal cyclic θ<sub><italic>c</italic></sub> controls commanded by the regulator. The regulator uses all three inputs. The most intensively used is the longitudinal cyclic; however, the control effort is limited, since the maximum amplitude is less than 2 deg in the worst condition. As expected, the control action is higher at high airstream velocity. As shown in <xref ref-type="fig" rid="fig11-0954410011406203">Fig. 11</xref>(f), the <italic>identification inputs</italic> are significantly lower than the <italic>control inputs</italic>.</p>
<p>The simulations showed the capability of the controller to stabilize the tiltrotor up to 210 kts. Beyond this velocity, it is not clear whether the loss of stability is related to the capabilities of the controller, or it occurs because the limits of the pitch control system kinematics are about to be exceeded. In any case, the model could be stabilized within the entire desired flight envelope, and the regulator was able to significantly increase the whirl-flutter velocity (more than 35  per cent from baseline).</p></sec>
<sec id="sec17-0954410011406203"><title>6.2 Further considerations</title>
<p>In this section, the power spectral density (PSD) of the wing root moments is analysed in order to investigate the adaptive regulator performances in detail.</p>
<p><xref ref-type="fig" rid="fig12-0954410011406203">Figure 12</xref> shows the PSD of the out-of-plane bending moment computed at constant airstream velocities of, respectively, 80 and 140 kts when the system is excited by a continuous vertical gust; five different signals are plotted in the graphs tagged as follows.
<list id="list4-0000000000406203" list-type="order">
<list-item><p><italic>Baseline:</italic> The adaptive regulator is turned off; therefore, the system is excited only by the continuous gust.</p></list-item>
<list-item><p><italic>Identification input:</italic> The adaptive regulator is turned off, but the system is excited also by the identification input described in <xref ref-type="sec" rid="sec10-0954410011406203">section 3.3</xref>.</p></list-item>
<list-item><p><italic>Control on:</italic> The adaptive regulator is active.</p></list-item>
<list-item><p><italic>Control weighted:</italic> The adaptive regulator is active, but the definition of the functional of equation (<xref ref-type="disp-formula" rid="disp-formula13-0954410011406203">13</xref>) is modified by adding a weight matrix
<disp-formula id="disp-formula18-0954410011406203"><label>(18)</label><graphic xlink:href="10.1177_0954410011406203-eq24.tif"/></disp-formula>
namely
<disp-formula id="disp-formula19-0954410011406203"><label>(19)</label><graphic xlink:href="10.1177_0954410011406203-eq25.tif"/></disp-formula>
 Matrix <bold><inline-formula id="ilm30-0954410011406203"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math30-0954410011406203"><mml:mi mathvariant="script">W</mml:mi></mml:math></inline-formula></bold><sub><italic>u</italic></sub> is designed to penalize the collective input.</p></list-item>
<list-item><p><italic>Control no collective:</italic> The adaptive regulator is active, but only the lateral and the longitudinal cyclic are used to control the system. As a consequence the identification input on the collective channel has been set to zero.</p></list-item>
</list><xref ref-type="fig" rid="fig12-0954410011406203">Figure 12</xref> clearly shows that all the three different controllers are able to significantly reduce the PSD of the out-of-plane bending moment in the bandwidth of interest with respect to the <italic>baseline</italic> case. The identification input has only a limited effect since the out-of-plane bending moment is mainly excited by the vertical gust. Analogous results have been obtained on the wing torque, while the analysis of the PSD of the in-plane bending moment, shown in <xref ref-type="fig" rid="fig13-0954410011406203">Fig. 13</xref>, is more interesting. In this case the effect of the identification input is not negligible because the vertical gust is not significantly exciting the moment in this direction. On the contrary, this is mainly excited by the identification input applied to the rotor collective. With the <italic>control on</italic>, the result is even worse because the regulator uses the collective input to reduce the out-of-plane bending and torsional moments and so it further excites the in-plane bending moment. An attempt to limit the excitation of the in-plane bending moment using the <italic>control weighted</italic> approach resulted in a slight reduction of the PSD with respect to the <italic>identification input</italic> case. A regulator with only the two cyclic control inputs would allow to avoid the degradation of the in-plane bending moment, yielding good performances under stable conditions as shown in <xref ref-type="fig" rid="fig12-0954410011406203">Fig. 12</xref>. However, this controller is not able to suppress the whirl-flutter, as shown in <xref ref-type="fig" rid="fig14-0954410011406203">Fig. 14</xref>. The figure shows the results of a simulation in which the airstream velocity is increased up to 200 kts. This result indicates that the collective input plays a fundamental role in the suppression of flutter. The <italic>weighted control</italic> is able to suppress flutter, although with degraded effectiveness (e.g. increased wing tip displacement amplitude with respect to the <italic>control on</italic> case).
<fig id="fig12-0954410011406203" position="float"><label>Fig. 12</label><caption><p>Wing root out-of-plane bending moment PSD</p></caption><graphic xlink:href="10.1177_0954410011406203-fig12.tif"/></fig>
<fig id="fig13-0954410011406203" position="float"><label>Fig. 13</label><caption><p>Wing root in-plane bending moment PSD</p></caption><graphic xlink:href="10.1177_0954410011406203-fig13.tif"/></fig>
<fig id="fig14-0954410011406203" position="float"><label>Fig. 14</label><caption><p>Flutter suppression capabilities of the three regulators</p></caption><graphic xlink:href="10.1177_0954410011406203-fig14.tif"/></fig></p>
<p>This analysis clearly shows that the collective pitch is required to suppress whirl flutter. However, the participation of this control is detrimental with respect to in-plane bending loads, although it is worth noticing that the increase in bending moment PSD is large (almost two orders of magnitude), but in absolute terms the PSD of the in-plane bending moment is less than that of the out-of-plane one. Tiltrotor control could be implemented using other devices in addition to existing rotor controls, e.g. independent blade control (IBC) or other aerodynamic surfaces like ailerons or flaperons, as proposed in reference [<xref ref-type="bibr" rid="bibr1-0954410011406203"><bold>1</bold></xref>], at the cost of significantly increased complexity (IBC) or larger actuator bandwidth (flaperons). This analysis gives the designer the possibility to choose the most appropriate control strategy for loads reduction or flutter suppression.</p></sec></sec>
<sec id="sec18-0954410011406203"><title>7 SIMULATION WITH DETAILED MODEL</title>
<p>This section presents some results obtained using the detailed model (with flexible blades and wing aerodynamics), to illustrate how the GPC controller tuned using the simplified model works properly also with the detailed one. The flutter suppression task in this case is less demanding, since the baseline flutter velocity of the more detailed model is higher than that of the simplified one. During the simulation, the tiltrotor is excited by atmospheric turbulence; measurement noise is accounted for. The airstream velocity is kept constant at 150 kts for 16 s, and then increased up to the flight envelope limit of 200 kts in 6 s.</p>
<p>Flutter suppression and vibration reduction capabilities similar to those of the simplified model are obtained also for the detailed model, as shown in <xref ref-type="fig" rid="fig15-0954410011406203">Fig. 15</xref>(a), where the uncontrolled baseline response is compared to the controlled response for the wing root out-of-plane bending moment. <xref ref-type="fig" rid="fig15-0954410011406203">Figure 15</xref>(b) shows the response of the tiltrotor to the same mission profile but with the rotor trimmed at constant thrust. Even though the stability properties with the constant thrust trim are different, the GPC regulator behaves as expected, showing the intrinsic robustness of the adaptive controller.
<fig id="fig15-0954410011406203" position="float"><label>Fig. 15</label><caption><p>Adaptive controller performances with detailed tiltrotor model</p></caption><graphic xlink:href="10.1177_0954410011406203-fig15.tif"/></fig></p></sec>
<sec id="sec19-0954410011406203"><title>8 CONCLUSIONS</title>
<p>A comprehensive simulation system has been developed to control a multibody model of a tiltrotor using an adaptive GPC controller under realistic operating conditions.</p>
<p>An aeroservoelastic model of the tiltrotor, including the dynamics of actuators and sensors, has been used. The model is excited by gusts and/or turbulence, accounting for measurement noise. Extensive numerical simulations have been carried out to assess the aeroelastic stability properties of the uncontrolled system and to tune the GPC regulator parameters and test its capability to follow the variations of the system.</p>
<p>The performances of the regulator have been found satisfactory, since it was able to significantly increase the damping and reduce the vibrations in flight conditions where the uncontrolled model shows stable response, while extending the flutter-free flight envelope of a modified wing with reduced stiffness, increasing the whirl-flutter velocity by more than 35 per cent with respect to that of the uncontrolled system.</p>
<p>The regulator tuned using a simplified model of the tiltrotor in windmill condition worked correctly at different trim conditions and when applied to a more detailed model of the rotorcraft, thus showing significant robustness.</p>
<p>Further investigation is needed to assess the stability of the response of the controlled aeroelastic model and to improve the model itself, although the robustness of the controller does not require a very accurate one. From the control point of view, the differences in the behaviour of the ARX and ARMAX controllers need further investigation. The reduction of the model order and the reduction of the control frequency need to be further investigated as well, to obtain a smaller controller with better real-time performances.</p></sec>
</body>
<back>
<sec id="sec20-0954410011406203"><title>FUNDING</title>
<p>This research received no specific grant from any funding agency in the public, commercial, or not-for-profit sectors.</p></sec>
<ack><title>ACKNOWLEDGEMENT</title>
<p>The authors acknowledge the contribution of Dr. Jinwei Shen to recent development of the WRATS stiff-inplane multibody model.</p></ack>
<ref-list>
<title>REFERENCES</title>
<ref id="bibr1-0954410011406203"><label>1</label><citation citation-type="confproc"><person-group person-group-type="author"><name><surname>Nixon</surname><given-names>MW</given-names></name><name><surname>Kvaternik</surname><given-names>RG</given-names></name><name><surname>Settle</surname><given-names>TB</given-names></name></person-group> <source>Higher harmonic control tiltrotor vibration reduction</source>. <conf-name>In International Forum on Aeroelasticity and Structural Dynamics 1997</conf-name>, <conf-loc>Rome, Italy</conf-loc>, <conf-date>17–20 June 1997</conf-date>, vol. <volume>2</volume>, pp. <fpage>327</fpage>–<lpage>334</lpage>.</citation></ref>
<ref id="bibr2-0954410011406203"><label>2</label><citation citation-type="confproc"><person-group person-group-type="author"><name><surname>Ghiringhelli</surname><given-names>GL</given-names></name><name><surname>Masarati</surname><given-names>P</given-names></name><name><surname>Mantegazza</surname><given-names>P</given-names></name><name><surname>Nixon</surname><given-names>MW</given-names></name></person-group>. <source>Multi-body analysis of an active control for a tiltrotor</source>. <conf-name>In International Forum on Aeroelasticity and Structural Dynamics 1999</conf-name>, <conf-loc>Williamsburg, Virginia</conf-loc>, <conf-date>22–25 June 1999</conf-date>, pp. <fpage>149</fpage>–<lpage>158</lpage>.</citation></ref>
<ref id="bibr3-0954410011406203"><label>3</label><citation citation-type="confproc"><person-group person-group-type="author"><name><surname>Kvaternik</surname><given-names>RG</given-names></name><name><surname>Juang</surname><given-names>J-N</given-names></name><name><surname>Bennett</surname><given-names>RL</given-names></name></person-group>. <source>Exploratory studies in generalized predictive control for active aeroelastic control of tiltrotor aircraft</source>. <conf-name>TM 2000-210552</conf-name>, <conf-loc>NASA, Washington</conf-loc>, <conf-date>October 2000</conf-date>.</citation></ref>
<ref id="bibr4-0954410011406203"><label>4</label><citation citation-type="confproc"><person-group person-group-type="author"><name><surname>Kvaternik</surname><given-names>RG</given-names></name><name><surname>Piatak</surname><given-names>DJ</given-names></name><name><surname>Hampton</surname><given-names>V</given-names></name><name><surname>Nixon</surname><given-names>MW</given-names></name><name><surname>Langston</surname><given-names>CW</given-names></name><name><surname>Singleton</surname><given-names>JD</given-names></name><name><surname>Bennett</surname><given-names>RL</given-names></name><name><surname>Brown</surname><given-names>RK</given-names></name></person-group>. <source>An experimental evaluation of generalized predictive control for tiltrotor aeroelastic stability augmentation in airplane mode of flight</source>. In <conf-name>Proceedings of 57th American Helicopter Society Annual Forum</conf-name>, <conf-loc>Washington, District of Columbia</conf-loc>, <conf-date>9–11 May 2001</conf-date>.</citation></ref>
<ref id="bibr5-0954410011406203"><label>5</label><citation citation-type="confproc"><person-group person-group-type="author"><name><surname>Rysdyk</surname><given-names>RT</given-names></name><name><surname>Calise</surname><given-names>AJ</given-names></name></person-group>. <source>Nonlinear adaptive control of tiltrotor aircraft using neural networks</source>. In <conf-name>SAE/AIAA World Aviation Congress</conf-name>, <conf-loc>Anaheim, California</conf-loc>, <conf-date>13–16 October 1997</conf-date>.</citation></ref>
<ref id="bibr6-0954410011406203"><label>6</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Calise</surname><given-names>AJ</given-names></name><name><surname>Rysdyk</surname><given-names>RT</given-names></name></person-group> <article-title>Nonlinear adaptive flight control using neural networks</article-title>. <source>IEEE Control Syst. Maga</source>. <year>1998</year>, <volume>18</volume>(<issue>6</issue>), <fpage>14</fpage>–<lpage>25</lpage>.</citation></ref>
<ref id="bibr7-0954410011406203"><label>7</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>B.-M.</given-names></name><name><surname>Kim</surname><given-names>BS</given-names></name><name><surname>Kim</surname><given-names>N.-W.</given-names></name></person-group> <article-title>Trajectory tracking controller design using neural networks for a tiltrotor unmanned aerial vehicle</article-title>. <source>Proc. IMechE, Part G: J. Aerospace Engineering</source>. <year>2010</year>, <volume>224</volume>(<issue>8</issue>), <fpage>881</fpage>–<lpage>896</lpage>.</citation></ref>
<ref id="bibr8-0954410011406203"><label>8</label><citation citation-type="confproc"><person-group person-group-type="author"><name><surname>Mueller</surname><given-names>JP</given-names></name><name><surname>Gourinat</surname><given-names>Y</given-names></name><name><surname>Ferrer</surname><given-names>R</given-names></name><name><surname>Krysinski</surname><given-names>T</given-names></name><name><surname>Kerdreux</surname><given-names>B</given-names></name></person-group>. <source>A numerical study on active control for tiltrotor whirl flutter stability augmentation</source>. In <conf-name>Proceedings of American Helicopter Society 4th Decennial Specialist's Conference on Aeromechanics</conf-name>, <conf-loc>Fisherman's Wharf, San Francisco, California, USA</conf-loc>, <conf-date>21–23 January 2004</conf-date>, pp. <fpage>275</fpage>–<lpage>293</lpage>.</citation></ref>
<ref id="bibr9-0954410011406203"><label>9</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Singh</surname><given-names>R</given-names></name><name><surname>Gandhi</surname><given-names>F</given-names></name><name><surname>Paik</surname><given-names>J</given-names></name><name><surname>Hathaway</surname><given-names>E</given-names></name></person-group> <article-title>Active tiltrotor whirl-flutter stability augmentation using wing-flaperon and swash-plate actuation</article-title>. <source>J. Aircr.</source>. <year>2007</year>, <volume>44</volume>(<issue>5</issue>), <fpage>1439</fpage>–<lpage>1446</lpage>.</citation></ref>
<ref id="bibr10-0954410011406203"><label>10</label><citation citation-type="confproc"><person-group person-group-type="author"><name><surname>Dumont</surname><given-names>GA</given-names></name><name><surname>Huzmezan</surname><given-names>M</given-names></name></person-group>. <source>Concepts, methods and techniques in adaptive control</source>. In <conf-name>Proceedings of American Control Conference</conf-name>, vol. <volume>2</volume>, <year>2002</year>, <conf-loc>Anchorage, Alaska, USA</conf-loc>, <conf-date>8–10 May, 2002</conf-date>, pp. <fpage>1137</fpage>–<lpage>1150</lpage>.</citation></ref>
<ref id="bibr11-0954410011406203"><label>11</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Haley</surname><given-names>P</given-names></name><name><surname>Soloway</surname><given-names>D</given-names></name></person-group> <article-title>Generalized predictive control for active flutter suppression</article-title>. <source>IEEE Control Syst. Maga.</source>. <year>1997</year>, <volume>17</volume>(<issue>4</issue>), <fpage>64</fpage>–<lpage>70</lpage>.</citation></ref>
<ref id="bibr12-0954410011406203"><label>12</label><citation citation-type="confproc"><person-group person-group-type="author"><name><surname>Mattaboni</surname><given-names>M</given-names></name><name><surname>Quaranta</surname><given-names>G</given-names></name><name><surname>Mantegazza</surname><given-names>P</given-names></name></person-group>. <source>Comparison of flutter suppression capabilities of two adaptive control techniques</source>. In <conf-name>International Forum on Aeroelasticity and Structural Dynamics 2009</conf-name>, <conf-loc>Seattle, Washington</conf-loc>, <conf-date>21–25 June 2009</conf-date>, pp. <fpage>1</fpage>–<lpage>40</lpage>.</citation></ref>
<ref id="bibr13-0954410011406203"><label>13</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Mattaboni</surname><given-names>M</given-names></name><name><surname>Quaranta</surname><given-names>G</given-names></name><name><surname>Mantegazza</surname><given-names>P</given-names></name></person-group> <article-title>Active flutter suppression for a three-surface transport aircraft by recurrent neural networks</article-title>. <source>J. Guid. Control Dyn.</source>. <year>2009</year>, <volume>32</volume>(<issue>4</issue>), <fpage>1295</fpage>–<lpage>1307</lpage>.</citation></ref>
<ref id="bibr14-0954410011406203"><label>14</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Krüger</surname><given-names>WR</given-names></name></person-group> <article-title>A multi-body approach for modelling manoeuvring aeroelastic aircraft during preliminary design</article-title>. <source>Proc. IMechE Part G: J. Aerospace Engineering</source>. <year>2008</year>, <volume>222</volume>(<issue>6</issue>), <fpage>887</fpage>–<lpage>894</lpage>.</citation></ref>
<ref id="bibr15-0954410011406203"><label>15</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Srinivas</surname><given-names>V</given-names></name><name><surname>Chopra</surname><given-names>I</given-names></name></person-group> <article-title>Validation of a comprehensive aeroelastic analysis for tiltrotor aircraft</article-title>. <source>J. Am. Helicopter Soc.</source>. <year>1998</year>, <volume>43</volume>, <fpage>333</fpage>–<lpage>333</lpage>.</citation></ref>
<ref id="bibr16-0954410011406203"><label>16</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ghiringhelli</surname><given-names>GL</given-names></name><name><surname>Masarati</surname><given-names>P</given-names></name><name><surname>Mantegazza</surname><given-names>P</given-names></name><name><surname>Nixon</surname><given-names>MW</given-names></name></person-group> <article-title>Multi-body analysis of a tiltrotor configuration</article-title>. <source>Nonlinear Dyn</source>. <year>1999</year>, <volume>19</volume>(<issue>4</issue>), <fpage>333</fpage>–<lpage>357</lpage>.</citation></ref>
<ref id="bibr17-0954410011406203"><label>17</label><citation citation-type="confproc"><person-group person-group-type="author"><name><surname>Masarati</surname><given-names>P</given-names></name><name><surname>Lanz</surname><given-names>M</given-names></name><name><surname>Mantegazza</surname><given-names>P</given-names></name></person-group>. <source>Multistep integration of ordinary, stiff and differential-algebraic problems for multibody dynamics applications</source>. In <conf-name>XVI Congresso Nazionale AIDAA</conf-name>, <conf-loc>Palermo</conf-loc>, <conf-date>24–28 September 2001</conf-date>, pp. <fpage>711</fpage>–<lpage>10</lpage>.</citation></ref>
<ref id="bibr18-0954410011406203"><label>18</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Masarati</surname><given-names>P</given-names></name><name><surname>Piatak</surname><given-names>DJ</given-names></name><name><surname>Quaranta</surname><given-names>G</given-names></name><name><surname>Singleton</surname><given-names>JD</given-names></name><name><surname>Shen</surname><given-names>J</given-names></name></person-group>. <source>Soft-inplane tiltrotor aeromechanics investigation using two multibody analyses</source>. In <conf-name>31st ERF</conf-name>, <conf-loc>Firenze, Italy</conf-loc>, <conf-date>13–15 September 2005</conf-date>, pp. <fpage>2571</fpage>–<lpage>2578</lpage>.</citation></ref>
<ref id="bibr19-0954410011406203"><label>19</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Masarati</surname><given-names>P</given-names></name><name><surname>Piatak</surname><given-names>DJ</given-names></name><name><surname>Quaranta</surname><given-names>G</given-names></name><name><surname>Singleton</surname><given-names>JD</given-names></name><name><surname>Shen</surname><given-names>J</given-names></name></person-group> <article-title>Soft-inplane tiltrotor aeromechanics investigation using two comprehensive multibody solvers</article-title>. <source>J. Am. Helicopter Soc.</source>. <year>2008</year>, <volume>53</volume>, <fpage>179</fpage>–<lpage>192</lpage>.</citation></ref>
<ref id="bibr20-0954410011406203"><label>20</label><citation citation-type="confproc"><person-group person-group-type="author"><name><surname>Shen</surname><given-names>J</given-names></name><name><surname>Masarati</surname><given-names>P</given-names></name><name><surname>Roget</surname><given-names>B</given-names></name><name><surname>Piatak</surname><given-names>DJ</given-names></name><name><surname>Nixon</surname><given-names>MW</given-names></name></person-group>. <source>Stiff-inplane tiltrotor aeromechanics investigation using two multibody analyses</source>. In <conf-name>Multibody Dynamics 2007</conf-name>, <conf-loc>Milano, Italy</conf-loc>, <conf-date>June 25–28 June</conf-date>.</citation></ref>
<ref id="bibr21-0954410011406203"><label>21</label><citation citation-type="confproc"><person-group person-group-type="author"><name><surname>Shen</surname><given-names>J</given-names></name><name><surname>Masarati</surname><given-names>P</given-names></name><name><surname>Piatak</surname><given-names>DJ</given-names></name><name><surname>Nixon</surname><given-names>MW</given-names></name><name><surname>Singleton</surname><given-names>JD</given-names></name><name><surname>Roget</surname><given-names>B</given-names></name></person-group>. <source>Modeling a stiff-inplane tiltrotor using two multibody analyses: a validation study</source>. In <conf-name>64th AHS Forum</conf-name>, <conf-loc>Montreal, Canada</conf-loc>, <conf-date>29 April–1 May 2008</conf-date>, pp. <fpage>G3.1</fpage>–<lpage>10</lpage>.</citation></ref>
<ref id="bibr22-0954410011406203"><label>22</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ghiringhelli</surname><given-names>GL</given-names></name><name><surname>Masarati</surname><given-names>P</given-names></name><name><surname>Mantegazza</surname><given-names>P</given-names></name></person-group> <article-title>A Multi-Body Implementation of Finite Volume Beams</article-title>. <source>AIAA J.</source>. <year>2000</year>, <volume>38</volume>(<issue>1</issue>), <fpage>131</fpage>–<lpage>138</lpage>.</citation></ref>
<ref id="bibr23-0954410011406203"><label>23</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Masarati</surname><given-names>P</given-names></name><name><surname>Morandini</surname><given-names>M</given-names></name></person-group> <article-title>An ideal homokinetic joint formulation for general-purpose multibody real-time simulation</article-title>. <source>Multibody Syst. Dyn.</source>. <year>October 2008</year>, <volume>20</volume>(<issue>3</issue>), <fpage>251</fpage>–<lpage>270</lpage>.</citation></ref>
<ref id="bibr24-0954410011406203"><label>24</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Quaranta</surname><given-names>G</given-names></name><name><surname>Mantegazza</surname><given-names>P</given-names></name><name><surname>Masarati</surname><given-names>P</given-names></name></person-group> <article-title>Assessing the local stability of periodic motions for large multibody non-linear systems using proper orthogonal decomposition</article-title>. <source>J. Sound Vib.</source>. <year>2004</year>, <volume>271</volume>(<issue>3--5</issue>), <fpage>1015</fpage>–<lpage>1038</lpage>.</citation></ref>
<ref id="bibr25-0954410011406203"><label>25</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Bauchau</surname><given-names>OA</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name></person-group> <article-title>Stability analysis of complex multibody systems</article-title>. <source>J. Comput. Nonlinear Dyn.</source>. <year>2006</year>, <volume>1</volume>, <fpage>71</fpage>–<lpage>71</lpage>.</citation></ref>
<ref id="bibr26-0954410011406203"><label>26</label><citation citation-type="confproc"><person-group person-group-type="author"><name><surname>Popelka</surname><given-names>DA</given-names></name><name><surname>Lindsay</surname><given-names>D</given-names></name><name><surname>Baker</surname><given-names>DJ</given-names></name></person-group>. <source>Results of an Aeroelastic Tailoring Study for a Composite Tiltrotor Wing</source>. In <conf-name>Proceedings of 51st American Helicopter Society Annual Forum</conf-name>, <conf-loc>Fort Worth, Texas, USA</conf-loc>, <conf-date>9–11 May 1995</conf-date>.</citation></ref>
<ref id="bibr27-0954410011406203"><label>27</label><citation citation-type="confproc"><person-group person-group-type="author"><name><surname>Nixon</surname><given-names>MW</given-names></name><name><surname>Piatak</surname><given-names>DJ</given-names></name><name><surname>Corso</surname><given-names>LM</given-names></name><name><surname>Popelka</surname><given-names>DA</given-names></name></person-group>. <source>Aeroelastic tailoring for stability augmentation and performance enhancements of tiltrotor aircraft</source>. In <conf-name>Proceedings of 55th American Helicopter Society Annual Forum</conf-name>, <conf-loc>Montreal, Canada</conf-loc>, <conf-date>25–27 May 1999</conf-date>.</citation></ref>
<ref id="bibr28-0954410011406203"><label>28</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Corso</surname><given-names>LM</given-names></name><name><surname>Popelka</surname><given-names>DA</given-names></name><name><surname>Nixon</surname><given-names>MW</given-names></name></person-group> <article-title>Design, Analysis, and Test of a Composite Tailored Tiltrotor Wing</article-title>. <source>J. Am. Helicopter Soc.</source>. <year>2000</year>, <volume>45</volume>(<issue>3</issue>), <fpage>207</fpage>–<lpage>215</lpage>.</citation></ref>
<ref id="bibr29-0954410011406203"><label>29</label><citation citation-type="confproc"><person-group person-group-type="author"><name><surname>Acree</surname><given-names>CW</given-names><suffix>Jr</suffix></name><name><surname>Peyran</surname><given-names>RJ</given-names></name><name><surname>Johnson</surname><given-names>W</given-names></name></person-group>. <source>Rotor design for whirl flutter: An examination of options for improving tiltrotor aeroelastic stability margins</source>. In <conf-name>55th AHS Forum</conf-name>, <conf-loc>Montréal, Quebec, Canada</conf-loc>, <conf-date>25–27 May 1999</conf-date>, pp. <fpage>1</fpage>–<lpage>19</lpage>.</citation></ref>
<ref id="bibr30-0954410011406203"><label>30</label><citation citation-type="confproc"><person-group person-group-type="author"><name><surname>Nixon</surname><given-names>MW</given-names></name><name><surname>Langston</surname><given-names>CW</given-names></name><name><surname>Singleton</surname><given-names>JD</given-names></name><name><surname>Piatak</surname><given-names>DJ</given-names></name><name><surname>Kvaternik</surname><given-names>RG</given-names></name><name><surname>Corso</surname><given-names>LM</given-names></name><name><surname>Brown</surname><given-names>RK</given-names></name></person-group>. <source>Aeroelastic stability of a four-bladed semi-articulated soft-inplane tiltrotor model</source>. In <conf-name>American Helicopter Society 59th Annual Forum</conf-name>, <conf-loc>Phoenix, Arizona</conf-loc>, <conf-date>6–8 May 2003</conf-date>, <volume>107</volume>(<issue>1075</issue>), <fpage>529</fpage>–<lpage>538</lpage>.</citation></ref>
<ref id="bibr31-0954410011406203"><label>31</label><citation citation-type="confproc"><person-group person-group-type="author"><name><surname>Masarati</surname><given-names>P</given-names></name><name><surname>Piatak</surname><given-names>DJ</given-names></name><name><surname>Quaranta</surname><given-names>G</given-names></name><name><surname>Singleton</surname><given-names>JD</given-names></name></person-group>. <source>Further results of soft-inplane tiltrotor aeromechanics investigation using two multibody analyses</source>. In <conf-name>American Helicopter Society 60th Annual Forum</conf-name>, <conf-loc>Baltimore, Maryland</conf-loc>, <conf-date>7–10 June 2004</conf-date>, <volume>28</volume>(<issue>7</issue>), <fpage>885</fpage>–<lpage>890</lpage>.</citation></ref>
<ref id="bibr32-0954410011406203"><label>32</label><citation citation-type="confproc"><person-group person-group-type="author"><name><surname>Shen</surname><given-names>J</given-names></name><name><surname>Singleton</surname><given-names>JD</given-names></name><name><surname>Piatak</surname><given-names>DJ</given-names></name><name><surname>Bauchau</surname><given-names>OA</given-names></name></person-group>. <source>Multibody dynamics simulation and experimental investigation of a model-scale tiltrotor</source>. In <conf-name>61st American Helicopter Society Annual Forum</conf-name>, <conf-loc>Grapevine, TX, USA</conf-loc>, <conf-date>1–3 June, 2005</conf-date>.</citation></ref>
<ref id="bibr33-0954410011406203"><label>33</label><citation citation-type="book"><person-group person-group-type="author"><name><surname>Qin</surname><given-names>SJ</given-names></name><name><surname>Badgwell</surname><given-names>TA</given-names></name></person-group>. <article-title>An overview of industrial model predictive control technology</article-title>. In <source>Proceedings of 5th International Conference on <italic>Chemical process control CACHE, AICHE</italic></source> (Eds <person-group person-group-type="editor"><name><surname>Kantor</surname><given-names>JC</given-names></name><name><surname>Garcia</surname><given-names>CE</given-names></name><name><surname>Carnahan</surname><given-names>B</given-names></name></person-group>), <publisher-name>American Institute of Chemical Engineers</publisher-name>, <publisher-loc>Tahoe City, CA, USA</publisher-loc>, <day>7–12</day> <month>January</month>, <year>1996</year>.</citation></ref>
<ref id="bibr34-0954410011406203"><label>34</label><citation citation-type="book"><person-group person-group-type="author"><name><surname>Camacho</surname><given-names>EF</given-names></name><name><surname>Bordons</surname><given-names>C</given-names></name></person-group>. <source>Model predictive control</source>, <year>2004</year> (<publisher-name>Springer</publisher-name>, <publisher-loc>London</publisher-loc>).</citation></ref>
<ref id="bibr35-0954410011406203"><label>35</label><citation citation-type="book"><person-group person-group-type="author"><name><surname>Kvaternik</surname><given-names>RG</given-names></name><name><surname>Eure</surname><given-names>KW</given-names></name><name><surname>Juang</surname><given-names>JN</given-names></name></person-group>. <source>Exploratory studies in generalized predictive control for active gust load alleviation. Technical Report TM–2006–214296</source>, <publisher-name>NASA</publisher-name>, <month>April</month> <year>2006</year>.</citation></ref>
<ref id="bibr36-0954410011406203"><label>36</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Juang</surname><given-names>J-N</given-names></name><name><surname>Phan</surname><given-names>M</given-names></name></person-group>. <source>Deadbeat predictive controllers, TM 112862</source>, <publisher-name>NASA</publisher-name>, <year>1997</year>.</citation></ref>
</ref-list>
<app-group>
<app id="app1-0954410011406203"><title>APPENDIX</title>
<def-list><title>Notation</title>
<def-item><term><bold><inline-formula id="ilm31-0954410011406203"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math31-0954410011406203"><mml:mi mathvariant="script">A</mml:mi></mml:math></inline-formula></bold></term><def><p>matrix of collected autonomous part matrices</p></def></def-item>
<def-item><term><bold>A</bold><sub><italic>i</italic></sub></term><def><p>identified model autonomous part matrices</p></def></def-item>
<def-item><term><bold>ℬ</bold></term><def><p>matrix of collected exogenous part matrices</p></def></def-item>
<def-item><term><bold>B</bold><sub><italic>i</italic></sub></term><def><p>identified model exogenous part matrices</p></def></def-item>
<def-item><term><bold><inline-formula id="ilm32-0954410011406203"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math32-0954410011406203"><mml:mi mathvariant="script">C</mml:mi></mml:math></inline-formula></bold></term><def><p>matrix of collected MA part matrices</p></def></def-item>
<def-item><term><bold>C</bold><sub><italic>i</italic></sub></term><def><p>identified model MA part matrices</p></def></def-item>
<def-item><term><bold><inline-formula id="ilm33-0954410011406203"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math33-0954410011406203"><mml:mi mathvariant="script">D</mml:mi></mml:math></inline-formula></bold></term><def><p>future inputs influence matrix</p></def></def-item>
<def-item><term><bold>ℰ</bold><sub><italic>p</italic></sub></term><def><p>identification error vector</p></def></def-item>
<def-item><term><italic>EJ</italic><sub>1,2</sub></term><def><p>wing beamwise/chordwise bending stiffnesses</p></def></def-item>
<def-item><term><bold><italic>f</italic></bold></term><def><p>active forces</p></def></def-item>
<def-item><term><italic>GJ</italic></term><def><p>wing torsional stiffness</p></def></def-item>
<def-item><term><bold>I</bold></term><def><p>identity matrix</p></def></def-item>
<def-item><term><italic>J</italic></term><def><p>cost functional</p></def></def-item>
<def-item><term><italic>m</italic></term><def><p>number of inputs</p></def></def-item>
<def-item><term><bold>M</bold></term><def><p>mass matrix</p></def></def-item>
<def-item><term><italic>M</italic><sub><italic>T</italic></sub></term><def><p>wing root torsional moment</p></def></def-item>
<def-item><term><italic>M</italic><sub><italic>B</italic>1,<italic>B</italic>2</sub></term><def><p>wing root beamwise/chordwise bending moments</p></def></def-item>
<def-item><term><italic>n</italic></term><def><p>identified model order</p></def></def-item>
<def-item><term><italic>n</italic><sub><italic>a</italic></sub></term><def><p>order of identified model autonomous part (equal to <italic>n</italic>)</p></def></def-item>
<def-item><term><italic>n</italic><sub><italic>b</italic></sub></term><def><p>order of identified model exogenous part (equal to <italic>n</italic>)</p></def></def-item>
<def-item><term><italic>n</italic><sub><italic>c</italic></sub></term><def><p>order of identified MA average part (equal to <italic>n</italic>)</p></def></def-item>
<def-item><term><italic>p</italic></term><def><p>number of outputs</p></def></def-item>
<def-item><term><bold><italic>p</italic></bold></term><def><p>momentum and momenta moment</p></def></def-item>
<def-item><term><bold>P</bold></term><def><p>model identification error covariance matrix</p></def></def-item>
<def-item><term><bold><italic>q</italic></bold></term><def><p>kinematic coordinates</p></def></def-item>
<def-item><term><italic>s</italic></term><def><p>prediction horizon</p></def></def-item>
<def-item><term><bold>S</bold><sub><italic>u</italic>,<italic>y</italic></sub></term><def><p>inputs/outputs scaling matrices</p></def></def-item>
<def-item><term><italic>t</italic></term><def><p>time</p></def></def-item>
<def-item><term><bold><italic>u</italic></bold></term><def><p>measured inputs</p></def></def-item>
<def-item><term><bold><inline-formula id="ilm34-0954410011406203"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math34-0954410011406203"><mml:mi mathvariant="script">U</mml:mi></mml:math></inline-formula></bold><sub><italic>f</italic></sub></term><def><p>future inputs vector</p></def></def-item>
<def-item><term><bold><inline-formula id="ilm35-0954410011406203"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math35-0954410011406203"><mml:mi mathvariant="script">U</mml:mi></mml:math></inline-formula></bold><sub><italic>p</italic></sub></term><def><p>previous inputs vector</p></def></def-item>
<def-item><term><italic>V</italic><sub>∞</sub></term><def><p>asymptotic airstream velocity</p></def></def-item>
<def-item><term><bold><inline-formula id="ilm36-0954410011406203"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math36-0954410011406203"><mml:mi mathvariant="script">W</mml:mi></mml:math></inline-formula></bold><sub><italic>u</italic></sub></term><def><p>future inputs weight matrix</p></def></def-item>
<def-item><term><bold><italic>y</italic></bold></term><def><p>measured outputs</p></def></def-item>
<def-item><term><bold><italic>ŷ</italic></bold></term><def><p>predicted outputs</p></def></def-item>
<def-item><term><inline-formula id="ilm12-0954410011406203"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math12-0954410011406203"><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula></term><def><p>measured outputs estimated mean value</p></def></def-item>
<def-item><term><bold><inline-formula id="ilm37-0954410011406203"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math37-0954410011406203"><mml:mi mathvariant="script">Y</mml:mi></mml:math></inline-formula></bold><sub><italic>d</italic></sub></term><def><p>desired outputs vector</p></def></def-item>
<def-item><term><bold><inline-formula id="ilm38-0954410011406203"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math38-0954410011406203"><mml:mi mathvariant="script">Y</mml:mi></mml:math></inline-formula></bold><sub><italic>f</italic></sub></term><def><p>predicted outputs vector</p></def></def-item>
<def-item><term><bold><inline-formula id="ilm39-0954410011406203"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math39-0954410011406203"><mml:mi mathvariant="script">Y</mml:mi></mml:math></inline-formula></bold><sub><italic>p</italic></sub></term><def><p>previous measured outputs vector</p></def></def-item>
<def-item><term><italic>z</italic><sub>TIP</sub></term><def><p>wing tip out-of-plane displacement</p></def></def-item>
<def-item><term>β</term><def><p>rotor blade flap angle</p></def></def-item>
<def-item><term>Γ</term><def><p>identification window effective length index</p></def></def-item>
<def-item><term><bold>ε</bold></term><def><p>identification error</p></def></def-item>
<def-item><term>ε<sup>ID</sup></term><def><p>quadratic identification error</p></def></def-item>
<def-item><term>η</term><def><p>variance ratio (percent)</p></def></def-item>
<def-item><term>θ<sub>0,<italic>c</italic>,<italic>s</italic></sub></term><def><p>collective/longitudinal/lateral cyclic pitch angles</p></def></def-item>
<def-item><term><bold>Θ</bold></term><def><p>matrix of collected model matrices</p></def></def-item>
<def-item><term><bold>λ</bold></term><def><p>Lagrange's multipliers</p></def></def-item>
<def-item><term>μ</term><def><p>forgetting factor</p></def></def-item>
<def-item><term>ρ</term><def><p>control penalty function</p></def></def-item>
<def-item><term><bold>ϕ</bold></term><def><p>vector of collected measures</p></def></def-item>
<def-item><term><bold>φ</bold></term><def><p>kinematic constraints</p></def></def-item>
<def-item><term>Ω</term><def><p>rotor angular velocity</p></def></def-item></def-list>
</app></app-group>
</back>
</article>