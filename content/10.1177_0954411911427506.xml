<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v2.3 20070202//EN" "journalpublishing.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">PIH</journal-id>
<journal-id journal-id-type="hwp">sppih</journal-id>
<journal-title>Proceedings of the Institution of Mechanical Engineers, Part H: Journal of Engineering in Medicine</journal-title>
<issn pub-type="ppub">0954-4119</issn>
<issn pub-type="epub">2041-6518</issn>
<publisher>
<publisher-name>SAGE Publications</publisher-name>
<publisher-loc>Sage UK: London, England</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1177/0954411911427506</article-id>
<article-id pub-id-type="publisher-id">10.1177_0954411911427506</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Original Articles</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Finite-element analysis for magnetic resonance image artifact evaluation</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name><surname>Montesinos</surname><given-names>César AF</given-names></name>
<xref ref-type="aff" rid="aff1-0954411911427506">1</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name><surname>Tse</surname><given-names>Zion TH</given-names></name>
<xref ref-type="aff" rid="aff2-0954411911427506">2</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Chan</surname><given-names>Yum J</given-names></name>
<xref ref-type="aff" rid="aff3-0954411911427506">3</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Elhawary</surname><given-names>Haytham</given-names></name>
<xref ref-type="aff" rid="aff2-0954411911427506">2</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Rea</surname><given-names>Marc</given-names></name>
<xref ref-type="aff" rid="aff1-0954411911427506">1</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Hamed</surname><given-names>Abbi</given-names></name>
<xref ref-type="aff" rid="aff1-0954411911427506">1</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Young</surname><given-names>Ian</given-names></name>
<xref ref-type="aff" rid="aff1-0954411911427506">1</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Lamperth</surname><given-names>Michael</given-names></name>
<xref ref-type="aff" rid="aff1-0954411911427506">1</xref>
</contrib>
</contrib-group>
<aff id="aff1-0954411911427506"><label>1</label>Mechanical Engineering Department, Imperial College London, UK</aff>
<aff id="aff2-0954411911427506"><label>2</label>Radiology Department, Harvard Medical School, Brigham and Women’s Hospital, USA</aff>
<aff id="aff3-0954411911427506"><label>3</label>Mechanical Engineering Department, University of Hong Kong, Hong Kong</aff>
<author-notes>
<corresp id="corresp1-0954411911427506">Zion TH Tse, Radiology Department, Harvard Medical School, Brigham and Women’s Hospital, 75 Francis Street, Boston MA 02115, USA. Email: <email>ziontse@bwh.harvard.edu</email></corresp>
</author-notes>
<pub-date pub-type="epub-ppub">
<month>1</month>
<year>2012</year>
</pub-date>
<volume>226</volume>
<issue>1</issue>
<fpage>49</fpage>
<lpage>54</lpage>
<history>
<date date-type="received">
<day>1</day>
<month>6</month>
<year>2011</year>
</date>
<date date-type="accepted">
<day>30</day>
<month>9</month>
<year>2011</year>
</date>
</history>
<permissions>
<copyright-statement>© IMechE 2011</copyright-statement>
<copyright-year>2011</copyright-year>
<copyright-holder content-type="society">Institution of Mechanical Engineers</copyright-holder>
</permissions>
<abstract>
<p>The static magnetic field of a magnetic resonance imaging scanner can be distorted by the presence of materials, perturbing the spatial encoding process in magnetic resonance imaging and often resulting in image artifacts. The relationship between the image artifact size and magnetic susceptibility of the material specimen is of interest to engineers for the design of devices that are to be compatible with the imaging volume of the scanner. In this study, a finite-element method was used to simulate the distorted magnetic field of samples with different susceptibilities. With the knowledge of the external- and self- magnetic field interactions, a Lorentz correction was applied to compute the magnetic field deviation. The simulated results were then validated by the corresponding experimental magnetic resonance images.</p>
</abstract>
<kwd-group>
<kwd>Magnetic finite-element analysis</kwd>
<kwd>magnetic resonance image artifact</kwd>
<kwd>magnetic resonance compatibility</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="section1-0954411911427506" sec-type="intro">
<title>Introduction</title>
<p>Magnetic susceptibility is the level of magnetization of a material under an applied magnetic field, and is an important factor to consider when determining the magnetic resonance (MR) compatibility of a material.<sup><xref ref-type="bibr" rid="bibr1-0954411911427506">1</xref></sup> Materials with high susceptibility can induce large attraction forces in the MR scanner and can adversely affect the magnetic field homogeneity.<sup><xref ref-type="bibr" rid="bibr1-0954411911427506">1</xref></sup> The magnetic susceptibility of materials used inside an MR environment can lead to safety issues concerning both clinicians and patients, as well as to the distortion of the MR image.<sup><xref ref-type="bibr" rid="bibr2-0954411911427506">2</xref>–<xref ref-type="bibr" rid="bibr4-0954411911427506">4</xref></sup> In addition, radio frequency (RF) and switched gradient fields generated by the scanner also raise concerns of MR safety and compatibility. RF can produce thermal effects in conductive materials, which can potentially cause skin burns in patients.<sup><xref ref-type="bibr" rid="bibr5-0954411911427506">5</xref></sup> Cable loops, which can effectively act as an antenna in the scanner and interfere with the RF field, should be avoided, especially if the cables are expected to have direct contact with patients.<sup><xref ref-type="bibr" rid="bibr4-0954411911427506">4</xref>,<xref ref-type="bibr" rid="bibr5-0954411911427506">5</xref></sup> Fast switched gradients can induce significant eddy currents and damage the functionality of electronic devices used in the scanner. Magnetic resonance imaging (MRI) compatible devices are therefore designed cautiously to avoid interference from these fields.<sup><xref ref-type="bibr" rid="bibr6-0954411911427506">6</xref>,<xref ref-type="bibr" rid="bibr7-0954411911427506">7</xref></sup> The magnetic susceptibility effect has been analyzed in the literature.<sup><xref ref-type="bibr" rid="bibr8-0954411911427506">8</xref>–<xref ref-type="bibr" rid="bibr11-0954411911427506">11</xref></sup> Susceptibility interference to the static magnetic fields induced by commonly used engineering materials is the main focus of the work described here.</p>
<p>Based on Maxwell’s equations, Durrant et al.<sup><xref ref-type="bibr" rid="bibr8-0954411911427506">8</xref></sup> presented magnetic field distribution equations related to the susceptibility of a sample and the surrounding substance, introducing the concepts of <italic>external field</italic> and <italic>self field</italic> for modeling field distortion. In MRI, the magnetic field in and around a sample is perturbed by the interaction of the magnetic moments of the molecules in the sample. The magnetic field experienced by a nucleus in a molecule can be considered as the sum of the external fields <inline-formula id="inline-formula1-0954411911427506">
<mml:math display="inline" id="math1-0954411911427506">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>ext</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula> produced by all other molecules and the self field <inline-formula id="inline-formula2-0954411911427506">
<mml:math display="inline" id="math2-0954411911427506">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>self</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula> produced by the molecule itself.<sup><xref ref-type="bibr" rid="bibr8-0954411911427506">8</xref>,<xref ref-type="bibr" rid="bibr12-0954411911427506">12</xref></sup></p>
<p>Distortion of the static magnetic field by a material sample placed in an MRI scanner can generate artifacts in the subsequently acquired images. The size of the image artifacts produced by a material and its magnetic susceptibility are strongly correlated. Moreover, given Maxwell’s equations,<sup><xref ref-type="bibr" rid="bibr8-0954411911427506">8</xref></sup> the size of the artifact can be computed as the field distortion caused by a body with a given geometry. In our previous work,<sup><xref ref-type="bibr" rid="bibr13-0954411911427506">13</xref></sup> a methodology was described to select suitable materials for constructing MR compatible devices based upon the requirements of material stiffness, cost and its desired location within the scanner. The results were derived from a large amount of empirical data obtained by scanning the samples of different materials under two geometric configurations using a variety of scanning protocols. The current work describes a method that can simulate the image distortion which occurs in MR image data by magnetic susceptibility interference to the static magnetic fields. The method is based on the finite-element method (FEM), and requires knowledge of the applied magnetic field strength, the geometry of the sample and the magnetic susceptibility of the material.</p>
<p>This paper begins by describing the governing equations required to compute magnetic field distortion, followed by solving the governing FEM equations numerically. Finally, the simulation and experimental results are compared and discussed to demonstrate the accuracy and effectiveness of artifact prediction.</p>
</sec>
<sec id="section2-0954411911427506">
<title>Magnetic fields present in MRI</title>
<p>When a sample is placed in an MRI scanner, the static magnetic field distortion can be predicted by magnetic principles at both the macroscopic and microscopic levels.<sup><xref ref-type="bibr" rid="bibr5-0954411911427506">5</xref></sup> The derived field-position relationship can effectively characterize image distortion in MRI images.<sup><xref ref-type="bibr" rid="bibr1-0954411911427506">1</xref>,<xref ref-type="bibr" rid="bibr14-0954411911427506">14</xref></sup></p>
<p>When assessing the electric and magnetic fields experienced by atomic nuclei in a sample, the relationship between these fields must be analyzed. The physical effects, from which susceptibility can be derived, result from electromagnetic properties of charges in motion, and can be described by Maxwell’s equations in either microscopic or macroscopic forms.<sup><xref ref-type="bibr" rid="bibr8-0954411911427506">8</xref></sup> The microscopic form calculates the local field in the nucleus, with equations describing the electric field <bold>e</bold> and magnetic field <bold>b</bold> produced by each charged elementary particle, characterizing the local self field produced by single molecules in the sample. With simple substances, i.e. with only one type of molecules in the sample, the self-magnetic field is equal to <inline-formula id="inline-formula3-0954411911427506">
<mml:math display="inline" id="math3-0954411911427506">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>self</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>2</mml:mn>
<mml:msub>
<mml:mrow>
<mml:mi>μ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:mn>3</mml:mn>
</mml:mrow>
</mml:mfrac>
<mml:mtext>M</mml:mtext>
</mml:mrow>
</mml:math></inline-formula>,<sup><xref ref-type="bibr" rid="bibr8-0954411911427506">8</xref></sup> where M is the magnetization (or magnetic dipole moment per unit volume) and <inline-formula id="inline-formula4-0954411911427506">
<mml:math display="inline" id="math4-0954411911427506">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>μ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mn>4</mml:mn>
<mml:mi>π</mml:mi>
<mml:mo>×</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mn>10</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mo>−</mml:mo>
<mml:mn>7</mml:mn>
</mml:mrow>
</mml:msup>
<mml:mtext>H</mml:mtext>
<mml:mo stretchy="false">/</mml:mo>
<mml:mtext>m</mml:mtext>
</mml:mrow>
</mml:math></inline-formula> is the permeability of free space.</p>
<p>However, it is impractical to solve a large system of Maxwell’s microscopic equations. Modeling can thus be simplified using Maxwell’s macroscopic equations, assuming the introduced sample to be a continuum. It is noted that Maxwell’s macroscopic equations, which best describe the relationship between the global electric field E and global magnetic field B, do not consider the local field within a host molecule because the equations assume the point of interest is far from the host molecule.<sup><xref ref-type="bibr" rid="bibr8-0954411911427506">8</xref></sup> Instead, the macroscopic field, denoted <inline-formula id="inline-formula5-0954411911427506">
<mml:math display="inline" id="math5-0954411911427506">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>macroscopic</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula>, contains a weighted magnetic field contribution of the host molecule <inline-formula id="inline-formula6-0954411911427506">
<mml:math display="inline" id="math6-0954411911427506">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>self</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula>. As a result, the external field <inline-formula id="inline-formula7-0954411911427506">
<mml:math display="inline" id="math7-0954411911427506">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>ext</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula> can be computed by subtracting <inline-formula id="inline-formula8-0954411911427506">
<mml:math display="inline" id="math8-0954411911427506">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>macroscopic</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula> from <inline-formula id="inline-formula9-0954411911427506">
<mml:math display="inline" id="math9-0954411911427506">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>self</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula>. The average external field originating in external sources outside the molecule<sup><xref ref-type="bibr" rid="bibr8-0954411911427506">8</xref></sup> can thus be written as</p>
<p>
<disp-formula id="disp-formula1-0954411911427506">
<label>(1)</label>
<mml:math display="block" id="math10-0954411911427506">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>ext</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>macroscopic</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>self</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mtext>B</mml:mtext>
<mml:mo>−</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>2</mml:mn>
<mml:msub>
<mml:mrow>
<mml:mi>μ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:mn>3</mml:mn>
</mml:mrow>
</mml:mfrac>
<mml:mtext>M</mml:mtext>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula1-0954411911427506" xlink:href="10.1177_0954411911427506-eq1.tif"/>
</disp-formula>
</p>
<p>This method of estimating the relationship of the magnetic field between the microscopic and the macroscopic scale is called the Lorentz correction,<sup><xref ref-type="bibr" rid="bibr8-0954411911427506">8</xref></sup> and the correction assumes spherical symmetry of an isotropic material with uniform properties in all directions. The macroscopic magnetization, denoted M, can be expressed as</p>
<p>
<disp-formula id="disp-formula2-0954411911427506">
<label>(2)</label>
<mml:math display="block" id="math11-0954411911427506">
<mml:mrow>
<mml:mtext>M</mml:mtext>
<mml:mo>=</mml:mo>
<mml:mi>χ</mml:mi>
<mml:mo>·</mml:mo>
<mml:mtext>H</mml:mtext>
<mml:mo>=</mml:mo>
<mml:mi>χ</mml:mi>
<mml:mo>·</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mi>μ</mml:mi>
</mml:mrow>
</mml:mfrac>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mi>χ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>+</mml:mo>
<mml:mi>χ</mml:mi>
</mml:mrow>
</mml:mfrac>
<mml:mo>·</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>μ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula2-0954411911427506" xlink:href="10.1177_0954411911427506-eq2.tif"/>
</disp-formula>
</p>
<p>where <inline-formula id="inline-formula10-0954411911427506">
<mml:math display="inline" id="math12-0954411911427506">
<mml:mrow>
<mml:mi>χ</mml:mi>
</mml:mrow>
</mml:math></inline-formula> is the magnetic susceptibility. Using <xref ref-type="disp-formula" rid="disp-formula1-0954411911427506">equations (1)</xref> and <xref ref-type="disp-formula" rid="disp-formula2-0954411911427506">(2)</xref>, we can write <inline-formula id="inline-formula11-0954411911427506">
<mml:math display="inline" id="math13-0954411911427506">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>ext</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula> as</p>
<p>
<disp-formula id="disp-formula3-0954411911427506">
<label>(3)</label>
<mml:math display="block" id="math14-0954411911427506">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>ext</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mn>3</mml:mn>
</mml:mrow>
</mml:mfrac>
<mml:mfrac>
<mml:mrow>
<mml:mi>χ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo stretchy="false">(</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>+</mml:mo>
<mml:mi>χ</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:mfrac>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula3-0954411911427506" xlink:href="10.1177_0954411911427506-eq3.tif"/>
</disp-formula>
</p>
<p>In Maxwell’s equations, the external electric field and magnetic field are coupled and needed to be considered together. However, the fields can be decoupled if the model is macroscopically stationary, such as in the case of the main magnetic field in an MRI scanner.<sup><xref ref-type="bibr" rid="bibr8-0954411911427506">8</xref></sup> Therefore, only the magnetic field B is required to be calculated, as shown in the following equations</p>
<p>
<disp-formula id="disp-formula4-0954411911427506">
<label>(4)</label>
<mml:math display="block" id="math15-0954411911427506">
<mml:mrow>
<mml:mo>∇</mml:mo>
<mml:mo>·</mml:mo>
<mml:mtext>B</mml:mtext>
<mml:mo>=</mml:mo>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula4-0954411911427506" xlink:href="10.1177_0954411911427506-eq4.tif"/>
</disp-formula>
</p>
<p>
<disp-formula id="disp-formula5-0954411911427506">
<label>(5)</label>
<mml:math display="block" id="math16-0954411911427506">
<mml:mrow>
<mml:mo>∇</mml:mo>
<mml:mo>×</mml:mo>
<mml:mtext>H</mml:mtext>
<mml:mo>=</mml:mo>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula5-0954411911427506" xlink:href="10.1177_0954411911427506-eq5.tif"/>
</disp-formula>
</p>
<p>
<disp-formula id="disp-formula6-0954411911427506">
<label>(6)</label>
<mml:math display="block" id="math17-0954411911427506">
<mml:mrow>
<mml:mtext>B</mml:mtext>
<mml:mo>=</mml:mo>
<mml:mi>μ</mml:mi>
<mml:mtext>H</mml:mtext>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>μ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>+</mml:mo>
<mml:mi>χ</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mtext>H</mml:mtext>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>μ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mrow>
<mml:mi>μ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mtext>H</mml:mtext>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula6-0954411911427506" xlink:href="10.1177_0954411911427506-eq6.tif"/>
</disp-formula>
</p>
<p>where μ<sub><italic>r</italic></sub> is the relative magnetic permeability in which <inline-formula id="inline-formula12-0954411911427506">
<mml:math display="inline" id="math18-0954411911427506">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>μ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mo stretchy="false">(</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>+</mml:mo>
<mml:mi>χ</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math></inline-formula>, and H is the magnetic field strength.</p>
</sec>
<sec id="section3-0954411911427506">
<title>Computation</title>
<p>The aim of the current study is to predict the size of the artifact when placing certain samples in the MRI magnetic field. To predict the distorted image and to measure the size of the generated artifact, a three-step procedure is adopted. The accuracy of the simulated results can be determined by comparing the results with their experimental counterpart.</p>
<sec id="section4-0954411911427506">
<title>Step I: magnetic field distribution</title>
<p>A uniform medium (usually air or water) of susceptibility χ<sub>0</sub> is first considered, to which a uniform magnetic field B<sub>0</sub> is applied, with χ<sub>0</sub> being close to 0. From the Lorentz correction in <xref ref-type="disp-formula" rid="disp-formula3-0954411911427506">equation (3)</xref>, the external field <inline-formula id="inline-formula13-0954411911427506">
<mml:math display="inline" id="math19-0954411911427506">
<mml:mrow>
<mml:msubsup>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>ext</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msubsup>
</mml:mrow>
</mml:math></inline-formula> is shown as</p>
<p>
<disp-formula id="disp-formula7-0954411911427506">
<label>(7)</label>
<mml:math display="block" id="math20-0954411911427506">
<mml:mrow>
<mml:msubsup>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>ext</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msubsup>
<mml:mo>=</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mn>3</mml:mn>
</mml:mrow>
</mml:mfrac>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>χ</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>χ</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>≈</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mn>3</mml:mn>
</mml:mrow>
</mml:mfrac>
<mml:msub>
<mml:mrow>
<mml:mtext>χ</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula7-0954411911427506" xlink:href="10.1177_0954411911427506-eq7.tif"/>
</disp-formula>
</p>
<p>By introducing a sample with a susceptibility of χ<sub><italic>s</italic></sub>, the magnetic field is distorted. The new magnetic fields within and outside the sample, denoted <inline-formula id="inline-formula14-0954411911427506">
<mml:math display="inline" id="math21-0954411911427506">
<mml:mrow>
<mml:msubsup>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>ext</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>in</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msubsup>
</mml:mrow>
</mml:math></inline-formula> and <inline-formula id="inline-formula15-0954411911427506">
<mml:math display="inline" id="math22-0954411911427506">
<mml:mrow>
<mml:msubsup>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>ext</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>out</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msubsup>
</mml:mrow>
</mml:math></inline-formula>, respectively, are computed according to</p>
<p>
<disp-formula id="disp-formula8-0954411911427506">
<mml:math display="block" id="math23-0954411911427506">
<mml:mrow>
<mml:mtext>Inside the sample</mml:mtext>
<mml:mspace width="0.75em"/>
<mml:msubsup>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>ext</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>in</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msubsup>
<mml:mo>=</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mn>3</mml:mn>
</mml:mrow>
</mml:mfrac>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>χ</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mn>s</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>χ</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mn>s</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mspace width="1.00em"/>
<mml:msub>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>in</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>≈</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mn>3</mml:mn>
</mml:mrow>
</mml:mfrac>
<mml:msub>
<mml:mrow>
<mml:mtext>χ</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mn>s</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>in</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula8-0954411911427506" xlink:href="10.1177_0954411911427506-eq8.tif"/></disp-formula>
</p>
<p>
<disp-formula id="disp-formula9-0954411911427506">
<label>(8)</label>
<mml:math display="block" id="math24-0954411911427506">
<mml:mrow>
<mml:mtext>Outside the sample</mml:mtext>
<mml:mspace width="0.25em"/>
<mml:msubsup>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>ext</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>out</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msubsup>
<mml:mo>=</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mn>3</mml:mn>
</mml:mrow>
</mml:mfrac>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>χ</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>χ</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mspace width="1.00em"/>
<mml:msub>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>out</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>≈</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mn>3</mml:mn>
</mml:mrow>
</mml:mfrac>
<mml:msub>
<mml:mrow>
<mml:mtext>χ</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>out</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula9-0954411911427506" xlink:href="10.1177_0954411911427506-eq9.tif"/>
</disp-formula>
</p>
<p>B<sub>in</sub> and B<sub>out</sub> represent the macroscopic magnetic field values with the sample present but before the Lorentz correction. The field distortion (<inline-formula id="inline-formula16-0954411911427506">
<mml:math display="inline" id="math25-0954411911427506">
<mml:mrow>
<mml:mi>Δ</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>ext</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula>) inside the sample <inline-formula id="inline-formula17-0954411911427506">
<mml:math display="inline" id="math26-0954411911427506">
<mml:mrow>
<mml:mi>Δ</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>ext</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>in</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula> and outside the sample <inline-formula id="inline-formula18-0954411911427506">
<mml:math display="inline" id="math27-0954411911427506">
<mml:mrow>
<mml:mi>Δ</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>ext</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>out</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula> are therefore</p>
<p>
<disp-formula id="disp-formula10-0954411911427506">
<mml:math display="block" id="math28-0954411911427506">
<mml:mrow>
<mml:mtext>Inside the sample</mml:mtext>
<mml:mspace width="0.75em"/>
<mml:mi>Δ</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>ext</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>in</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:msubsup>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>ext</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>in</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msubsup>
<mml:mo>−</mml:mo>
<mml:msubsup>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>ext</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msubsup>
<mml:mo>≈</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mn>3</mml:mn>
</mml:mrow>
</mml:mfrac>
<mml:msub>
<mml:mrow>
<mml:mtext>χ</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mn>s</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>in</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:mo>(</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mn>3</mml:mn>
</mml:mrow>
</mml:mfrac>
<mml:msub>
<mml:mrow>
<mml:mtext>χ</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula10-0954411911427506" xlink:href="10.1177_0954411911427506-eq10.tif"/></disp-formula>
</p>
<p>
<disp-formula id="disp-formula11-0954411911427506">
<label>(9)</label>
<mml:math display="block" id="math29-0954411911427506">
<mml:mrow>
<mml:mtext>Outside the sample</mml:mtext>
<mml:mspace width="0.75em"/>
<mml:mi>Δ</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>ext</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>out</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:msubsup>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>ext</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>out</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msubsup>
<mml:mo>−</mml:mo>
<mml:msubsup>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>ext</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msubsup>
<mml:mo>≈</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mn>3</mml:mn>
</mml:mrow>
</mml:mfrac>
<mml:msub>
<mml:mrow>
<mml:mtext>χ</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mspace width="0.25em"/>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>out</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula11-0954411911427506" xlink:href="10.1177_0954411911427506-eq11.tif"/>
</disp-formula>
</p>
<p>Analytical solutions of <xref ref-type="disp-formula" rid="disp-formula11-0954411911427506">equation (9)</xref> may be available for samples with simple geometries and certain boundary conditions. For ellipsoidal bodies, the field inside the sample is constant and depends on the geometry characterized by its geometric factor, while the field outside the sample depends on the position of interest and the size of the sample. In geometries where analytical expressions for field computation are not available, <xref ref-type="disp-formula" rid="disp-formula4-0954411911427506">equations (4)</xref> to <xref ref-type="disp-formula" rid="disp-formula6-0954411911427506">(6)</xref> can be solved by using FEM to find the field distribution as outlined in Step III.</p>
</sec>
<sec id="section5-0954411911427506">
<title>Step II: image distortion</title>
<p>Once the magnetic field distortion <inline-formula id="inline-formula19-0954411911427506">
<mml:math display="inline" id="math30-0954411911427506">
<mml:mrow>
<mml:mi>Δ</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>ext</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula> is known, <xref ref-type="disp-formula" rid="disp-formula14-0954411911427506">equation (10)</xref> can be used to find the position error in the image and generate the distorted image.<sup><xref ref-type="bibr" rid="bibr1-0954411911427506">1</xref></sup> In the current study, the image distortion due to susceptibility depends on the <italic>z</italic>-component of the magnetic field <inline-formula id="inline-formula20-0954411911427506">
<mml:math display="inline" id="math31-0954411911427506">
<mml:mrow>
<mml:mi>Δ</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>z</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>ext</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula> only, and the position error in the <italic>x</italic>-direction is</p>
<p>
<disp-formula id="disp-formula12-0954411911427506">
<mml:math display="block" id="math32-0954411911427506">
<mml:mrow>
<mml:mtext>f</mml:mtext>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>f</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mtext>γ</mml:mtext>
<mml:mo>.</mml:mo>
<mml:mrow>
<mml:mo>[</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>G</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>R</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mtext>x</mml:mtext>
<mml:mo>+</mml:mo>
<mml:mtext>Δ</mml:mtext>
<mml:msub>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>z</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>ext</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mtext>x</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>y</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>z</mml:mtext>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>]</mml:mo>
</mml:mrow>
<mml:mo>=</mml:mo>
<mml:mtext>γ</mml:mtext>
<mml:mo>.</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>G</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>R</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mtext>x</mml:mtext>
<mml:mo>′</mml:mo>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula12-0954411911427506" xlink:href="10.1177_0954411911427506-eq12.tif"/>
</disp-formula>
</p>
<p>
<disp-formula id="disp-formula13-0954411911427506">
<mml:math display="block" id="math33-0954411911427506">
<mml:mrow>
<mml:mtext>or x</mml:mtext>
<mml:mo>′</mml:mo>
<mml:mo stretchy="false">(</mml:mo>
<mml:mtext>x</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>y</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>z</mml:mtext>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mtext>x</mml:mtext>
<mml:mo>+</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mtext>Δ</mml:mtext>
<mml:msub>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>z</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>ext</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mtext>x</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>y</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>z</mml:mtext>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>G</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>R</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula13-0954411911427506" xlink:href="10.1177_0954411911427506-eq13.tif"/>
</disp-formula>
</p>
<p>
<disp-formula id="disp-formula14-0954411911427506">
<label>(10)</label>
<mml:math display="block" id="math34-0954411911427506">
<mml:mrow>
<mml:mtext>Position error in</mml:mtext>
<mml:mspace width="0.25em"/>
<mml:mi>x</mml:mi>
<mml:mo>−</mml:mo>
<mml:mtext>direction</mml:mtext>
<mml:mspace width="0.25em"/>
<mml:mi>Δ</mml:mi>
<mml:mi>x</mml:mi>
<mml:mo>=</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo>−</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo>′</mml:mo>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mtext>Δ</mml:mtext>
<mml:msub>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>z</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>ext</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mtext>x</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>y</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>z</mml:mtext>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>G</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>R</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula14-0954411911427506" xlink:href="10.1177_0954411911427506-eq14.tif"/>
</disp-formula>
</p>
<p>where <inline-formula id="inline-formula21-0954411911427506">
<mml:math display="inline" id="math35-0954411911427506">
<mml:mrow>
<mml:mi>f</mml:mi>
</mml:mrow>
</mml:math></inline-formula> is the Larmor frequency of the excited nucleus, <inline-formula id="inline-formula22-0954411911427506">
<mml:math display="inline" id="math36-0954411911427506">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>f</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula> is the Larmor frequency at the position chosen as <italic>x</italic><sub>0</sub> = 0, γ is the gyromagnetic ratio, <italic>G<sub>R</sub></italic> is the applied magnetic gradient, <italic>x</italic> is the true <italic>x</italic>-coordinate position of the excited nucleus, and <inline-formula id="inline-formula23-0954411911427506">
<mml:math display="inline" id="math37-0954411911427506">
<mml:mrow>
<mml:mi>x</mml:mi>
<mml:mo>′</mml:mo>
</mml:mrow>
</mml:math></inline-formula> is the apparent position of the nucleus in the image due to the susceptibility distortion. Once the position errors for all points in the generated image are computed, the distorted image is then rendered and compared with the corresponding image obtained by an MRI scan of the sample.</p>
</sec>
<sec id="section6-0954411911427506">
<title>Step III: numerical solution using FEM</title>
<p>This step is to compute the image artifact in order to establish the relationship between the susceptibility of the material and the artifact size. Although the perturbed magnetic field distribution can be obtained by solving Maxwell’s differential <xref ref-type="disp-formula" rid="disp-formula4-0954411911427506">equations (4)</xref> to <xref ref-type="disp-formula" rid="disp-formula6-0954411911427506">(6)</xref> directly, it has been shown by Collins et al.<sup><xref ref-type="bibr" rid="bibr15-0954411911427506">15</xref></sup> that a simpler method is available. Because <xref ref-type="disp-formula" rid="disp-formula5-0954411911427506">equation (5)</xref> that implies H is an irrotational field, it can be expressed in terms of the scalar magnetic potential <inline-formula id="inline-formula24-0954411911427506">
<mml:math display="inline" id="math38-0954411911427506">
<mml:mrow>
<mml:mi>Φ</mml:mi>
</mml:mrow>
</mml:math></inline-formula></p>
<p>
<disp-formula id="disp-formula15-0954411911427506">
<label>(11)</label>
<mml:math display="block" id="math39-0954411911427506">
<mml:mrow>
<mml:mtext>H</mml:mtext>
<mml:mo>=</mml:mo>
<mml:mo>−</mml:mo>
<mml:mo>∇</mml:mo>
<mml:mi>Φ</mml:mi>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula15-0954411911427506" xlink:href="10.1177_0954411911427506-eq15.tif"/>
</disp-formula>
</p>
<p>Then, using <xref ref-type="disp-formula" rid="disp-formula4-0954411911427506">equations (4)</xref>, <xref ref-type="disp-formula" rid="disp-formula6-0954411911427506">(6)</xref> and <xref ref-type="disp-formula" rid="disp-formula15-0954411911427506">(11)</xref>, we have</p>
<p>
<disp-formula id="disp-formula16-0954411911427506">
<label>(12)</label>
<mml:math display="block" id="math40-0954411911427506">
<mml:mrow>
<mml:mo>∇</mml:mo>
<mml:mo>·</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>μ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mrow>
<mml:mi>μ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mtext>H</mml:mtext>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>=</mml:mo>
<mml:mo>∇</mml:mo>
<mml:mo>·</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>μ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mrow>
<mml:mi>μ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>∇</mml:mo>
<mml:mi>Φ</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>=</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>⇒</mml:mo>
<mml:mo>∇</mml:mo>
<mml:mo>·</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>μ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>∇</mml:mo>
<mml:mi>Φ</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>=</mml:mo>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula16-0954411911427506" xlink:href="10.1177_0954411911427506-eq16.tif"/>
</disp-formula>
</p>
<p><xref ref-type="disp-formula" rid="disp-formula16-0954411911427506">Equation (12)</xref> is solved using the FEM, in which the study volume is discretized into small tetrahedral elements and the governing equations solved numerically at each local element. The mesh size, also known as spatial resolution, is chosen such that the model is accurate while keeping processing times within reasonable limits. To reduce the computational requirements, the problem region contains only the sample and its immediate surrounding volume. Given that the field far away from the sample is undistorted, <xref ref-type="disp-formula" rid="disp-formula17-0954411911427506">equation (13)</xref> can be deduced from <xref ref-type="disp-formula" rid="disp-formula6-0954411911427506">equations (6)</xref> and <xref ref-type="disp-formula" rid="disp-formula15-0954411911427506">(11)</xref></p>
<p>
<disp-formula id="disp-formula17-0954411911427506">
<label>(13)</label>
<mml:math display="block" id="math41-0954411911427506">
<mml:mrow>
<mml:mtext>B</mml:mtext>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>μ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mrow>
<mml:mi>μ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mo>−</mml:mo>
<mml:mo>∇</mml:mo>
<mml:mi>Φ</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>=</mml:mo>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>μ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mrow>
<mml:mi>μ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mi>d</mml:mi>
<mml:mi>Φ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>dx</mml:mi>
</mml:mrow>
</mml:mfrac>
<mml:mi mathvariant="bold">i</mml:mi>
<mml:mo>+</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mi>d</mml:mi>
<mml:mi>Φ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>dy</mml:mi>
</mml:mrow>
</mml:mfrac>
<mml:mi mathvariant="bold">j</mml:mi>
<mml:mo>+</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mi>d</mml:mi>
<mml:mi>Φ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>dz</mml:mi>
</mml:mrow>
</mml:mfrac>
<mml:mi mathvariant="bold">k</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula17-0954411911427506" xlink:href="10.1177_0954411911427506-eq17.tif"/>
</disp-formula>
</p>
<p>After the scalar magnetic potential <inline-formula id="inline-formula25-0954411911427506">
<mml:math display="inline" id="math42-0954411911427506">
<mml:mrow>
<mml:mi>Φ</mml:mi>
</mml:mrow>
</mml:math></inline-formula> is solved, the field <inline-formula id="inline-formula26-0954411911427506">
<mml:math display="inline" id="math43-0954411911427506">
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
</mml:math></inline-formula> is calculated using <xref ref-type="disp-formula" rid="disp-formula17-0954411911427506">equation (13)</xref>. Using <xref ref-type="disp-formula" rid="disp-formula3-0954411911427506">equations (3)</xref>, <xref ref-type="disp-formula" rid="disp-formula6-0954411911427506">(6)</xref> and <xref ref-type="disp-formula" rid="disp-formula15-0954411911427506">(11)</xref>, the external field <inline-formula id="inline-formula27-0954411911427506">
<mml:math display="inline" id="math44-0954411911427506">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>ext</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula> can be obtained from <inline-formula id="inline-formula28-0954411911427506">
<mml:math display="inline" id="math45-0954411911427506">
<mml:mrow>
<mml:mi>Φ</mml:mi>
</mml:mrow>
</mml:math></inline-formula>, which leads to</p>
<p>
<disp-formula id="disp-formula18-0954411911427506">
<label>(14)</label>
<mml:math display="block" id="math46-0954411911427506">
<mml:mrow>
<mml:mtable align="right" width="80%">
<mml:mtr>
<mml:mtd columnalign="right" columnspan="1">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>ext</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mn>3</mml:mn>
</mml:mrow>
</mml:mfrac>
<mml:mfrac>
<mml:mrow>
<mml:mi>χ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo stretchy="false">(</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>+</mml:mo>
<mml:mi>χ</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:mfrac>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mtext>B</mml:mtext>
<mml:mo>≈</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mn>3</mml:mn>
</mml:mrow>
</mml:mfrac>
<mml:mi>χ</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="right" columnspan="1">
<mml:mrow>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>μ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mrow>
<mml:mi>μ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mn>3</mml:mn>
</mml:mrow>
</mml:mfrac>
<mml:mi>χ</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mtext>H</mml:mtext>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>μ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mrow>
<mml:mi>μ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mn>3</mml:mn>
</mml:mrow>
</mml:mfrac>
<mml:mi>χ</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mo>−</mml:mo>
<mml:mo>∇</mml:mo>
<mml:mi>Φ</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="right" columnspan="1">
<mml:mrow>
<mml:mo>⇒</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext>B</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>ext</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>≈</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>μ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mrow>
<mml:mi>μ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>r</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mn>3</mml:mn>
</mml:mrow>
</mml:mfrac>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>μ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mo>−</mml:mo>
<mml:mo>∇</mml:mo>
<mml:mi>Φ</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula18-0954411911427506" xlink:href="10.1177_0954411911427506-eq18.tif"/>
</disp-formula>
</p>
</sec>
</sec>
<sec id="section7-0954411911427506">
<title>Experimental set-up</title>
<p>In the current study, FEM was implemented in Multiphysics® (COMSOL, Stockholm, Sweden). The sample is assumed to be homogeneous and immersed in a tank of CuSO<sub>4</sub> solution (χ<sub>solution</sub> = −9.04 × 10<sup>−6</sup>), which has a susceptibility close to that of human tissue. A single model with two regions was introduced with permeability µ<sub><italic>r,mat</italic></sub> for the sample and µ<sub><italic>r,sol</italic></sub> for the surrounding CuSO<sub>4</sub> solution. After creating the model geometry, the model was meshed into 63,540 tetrahedral elements, and the magnetic field (B) was computed. Boundary conditions were specified as shown in <xref ref-type="fig" rid="fig1-0954411911427506">Figure 1</xref>.</p>
<fig id="fig1-0954411911427506" position="float">
<label>Figure 1.</label>
<caption>
<p>FEM domains and boundary conditions.</p>
</caption>
<graphic xlink:href="10.1177_0954411911427506-fig1.tif"/>
</fig>
<p>With the information of magnetic field distribution calculated by the FEM, a program for simulation of the image distortions was implemented in MATLAB. The images generated were then compared using experimental MR image data. Two sample geometries were studied: (i) a rectangular extrusion, with width and height of 40 × 40 mm and 10 mm thickness, and (ii) a cylindrical rod of 50 mm length and 10 mm diameter. The simulations were performed for sample geometries made of alumina (χ<sub>alumina</sub> = −18.195 × 10<sup>−6</sup>), lead (χ<sub>lead</sub> = −15.763 × 10<sup>−6</sup>) and titanium (χ<sub>titanium</sub> = 178.625 ×10<sup>−6</sup>). These materials were chosen among those shown by Tse et al.<sup><xref ref-type="bibr" rid="bibr13-0954411911427506">13</xref></sup>, and their susceptibility values are commonly found in literature. The two sample geometries were scanned in a 1.5 T Siemens Magnetom Vision MRI scanner. Scans were taken using gradient echo image sequence with 32 kHz bandwidth, 256 × 256 matrix size, 5/3 mm slice thickness, 100–500 ms repetition time, 15 ms time to echo, and 30 ° flip angle. Head-to-foot and posterior-to-anterior readout directions of the samples were both considered for each scan and simulation. The experimental procedure is described in greater detail by Tse et al.<sup><xref ref-type="bibr" rid="bibr13-0954411911427506">13</xref></sup></p>
</sec>
<sec id="section8-0954411911427506" sec-type="results">
<title>Results</title>
<p><xref ref-type="fig" rid="fig2-0954411911427506">Figures 2</xref> and <xref ref-type="fig" rid="fig3-0954411911427506">3</xref> show the simulation and experimental results for the titanium sample block, respectively. <xref ref-type="fig" rid="fig2-0954411911427506">Figure 2</xref> presents the simulated field distortion in both readout directions, with its simulated image distortion results compared with their experimental counterpart in <xref ref-type="fig" rid="fig3-0954411911427506">Figure 3</xref>. <xref ref-type="fig" rid="fig3-0954411911427506">Figure 3(a)</xref> and <xref ref-type="fig" rid="fig3-0954411911427506">(c)</xref>, which contains the simulated image distortions, shows good correspondence with the distortion presented in the real MR image in <xref ref-type="fig" rid="fig3-0954411911427506">Figure 3(b)</xref> and <xref ref-type="fig" rid="fig3-0954411911427506">(d)</xref> in terms of the size and geometry of the artifact. The dimensions of the artifacts based on the simulated image distortion were measured for each object. The horizontal bar plots presented in <xref ref-type="fig" rid="fig4-0954411911427506">Figure 4</xref> indicate the error in artifact size between the artifact as detected in the MRI image and that predicted in the simulation. A pixel in the MR image was considered to be part of an artifact if its signal intensity was changed by at least 30% due to the presence of the object.<sup><xref ref-type="bibr" rid="bibr16-0954411911427506">16</xref></sup> It can be seen that the simulation and experimental results match reasonable well, with a largest prediction error of &lt;20%. The only exception is found in predicting the artifact width of the lead block. The error was probably contributed by impurities in the lead block sample in manufacturing and machining processes.</p>
<fig id="fig2-0954411911427506" position="float">
<label>Figure 2.</label>
<caption>
<p>Field distortion (Δ<italic>B</italic><sub>Z</sub>) with the presence of the titanium block sample. The graphs show the value of Δ<italic>B</italic><sub>Z</sub> with the block sample in a plane (a) perpendicular and (b) parallel to the direction of the scanner main field B<sub>0</sub>.</p>
</caption>
<graphic xlink:href="10.1177_0954411911427506-fig2.tif"/>
</fig>
<fig id="fig3-0954411911427506" position="float">
<label>Figure 3.</label>
<caption>
<p>(a,c) Simulated and (b,d) experimental MRI image distortions of a titanium square block sample. The artifact size is (a) 75.78 mm (simulation) and (b) 78.90 mm (experiment) in the head-to-foot direction with a prediction error of 3.96%, and is (c) 82.22 mm (simulation) and (d) 81.25 mm (experiment) in the posterior-to-anterior readout direction with a prediction error of −1.20%.</p>
</caption>
<graphic xlink:href="10.1177_0954411911427506-fig3.tif"/>
</fig>
<fig id="fig4-0954411911427506" position="float">
<label>Figure 4.</label>
<caption>
<p>Error in predicting the artifact width and height in different readout directions. BLK and CYL denote block samples and cylindrical samples, respectively.</p>
</caption>
<graphic xlink:href="10.1177_0954411911427506-fig4.tif"/>
</fig>
</sec>
<sec id="section9-0954411911427506" sec-type="conclusions">
<title>Conclusions</title>
<p>The magnetic field distortion produced by a sample when placed in an MRI scanner can be accurately predicted given its magnetic susceptibility and geometry, the applied field strength and the field boundary conditions. The FEM-based simulation allows the study of the magnetic interactions within the MRI scanner main field, and thus can be used to simulate the image distortion for materials with geometries where analytical expressions are not available. The image distortions obtained in simulations were similar to those obtained experimentally in MRI data in terms of the artifact shape and size, demonstrating the consistency and effectiveness of the magnetic FEM model used. We envisage this tool to be used as part of a software package that can aid in designing MR compatible engineering components and devices. By simulating the field distortion and artifacts produced by components made from specific materials with defined geometries, their suitability in the scanner environment can be tested before manufacturing, and the design can be modified if necessary.</p>
</sec>
<sec id="section10-0954411911427506">
<title>Current limitations of the simulation</title>
<p>Although the proposed FEM-based simulation demonstrates consistent results with the experimental image distortion data in a range of commonly used engineering materials, this model serves as a preliminary computational tool for material selections in designing MR compatible devices and quick size estimations of the generated artifact. The designed device has to be tested in the scanner for a final evaluation of its compatibility, as its image distortion can be due to practical issues such as scanner magnetic field inhomogeneity, use of different coils and their locations, and magnetic field interference between the introduced device and the human subject. In addition, the simulation is restricted to modeling of the susceptibility artifact in static magnetic fields, and therefore effects from RF and switched gradient fields to the image distortion are neglected. Although the simulation has been tested in a range of different materials, it will be our future work to further validate the model with samples of complex geometries to ensure that the discrepancy of the simulated and experimental results is minimal.</p>
</sec>
</body>
<back>
<fn-group>
<fn fn-type="financial-disclosure">
<p>This work was supported in part by the UK Department of Health [NEAT grant G019].</p>
</fn>
</fn-group>
<ref-list>
<title>References</title>
<ref id="bibr1-0954411911427506">
<label>1.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Schenck</surname><given-names>JF</given-names></name>
</person-group>. <article-title>The role of magnetic susceptibility in magnetic resonance imaging: MRI magnetic compatibility of the first and second kinds</article-title>. <source>Med Phys</source> <year>1996</year>; <volume>23</volume>(<issue>6</issue>):<fpage>815</fpage>–<lpage>850</lpage>.</citation>
</ref>
<ref id="bibr2-0954411911427506">
<label>2.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Elhawary</surname><given-names>H</given-names></name>
<name><surname>Tse</surname><given-names>ZTH</given-names></name>
<name><surname>Hamed</surname><given-names>A</given-names></name>
<name><surname>Rea</surname><given-names>M</given-names></name>
<name><surname>Davies</surname><given-names>BL</given-names></name>
<name><surname>Lamperth</surname><given-names>MU</given-names></name>
</person-group>. <article-title>The case for MR-compatible robotics: a review of the state of the art</article-title>. <source>International Journal of Medical Robotics and Computer Assisted Surgery</source>, <year>2008</year>; <volume>4</volume>(<issue>2</issue>): pp. <fpage>105</fpage>–<lpage>113</lpage>.</citation>
</ref>
<ref id="bibr3-0954411911427506">
<label>3.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Gassert</surname><given-names>R</given-names></name>
</person-group>. <article-title>MRI-compatible robotics</article-title>. <source>IEEE Eng Med Biol Mag</source> <year>2008</year>; <volume>27</volume>(<issue>3</issue>): <fpage>12</fpage>–<lpage>14</lpage>.</citation>
</ref>
<ref id="bibr4-0954411911427506">
<label>4.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Shellock</surname><given-names>FG</given-names></name>
</person-group>. <article-title>Magnetic resonance safety update 2002: implants and devices</article-title>. <source>J Mag Res Imag</source> <year>2002</year>; <volume>16</volume>(<issue>5</issue>): <fpage>485</fpage>–<lpage>496</lpage>.</citation>
</ref>
<ref id="bibr5-0954411911427506">
<label>5.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Schaefers</surname><given-names>G</given-names></name>
</person-group>. <article-title>Testing MR safety and compatibility</article-title>. <source>IEEE Eng Med Biol Mag</source> <year>2008</year>; <volume>27</volume>(<issue>3</issue>): <fpage>23</fpage>–<lpage>27</lpage>.</citation>
</ref>
<ref id="bibr6-0954411911427506">
<label>6.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Gassert</surname><given-names>R</given-names></name>
<name><surname>Burdet</surname><given-names>E</given-names></name>
<name><surname>Chinzei</surname><given-names>K</given-names></name>
</person-group>. <article-title>MRI-compatible robotics</article-title>. <source>IEEE Eng Med Biol Mag</source> <year>2008</year>; <volume>27</volume>(<issue>3</issue>): <fpage>12</fpage>–<lpage>14</lpage>.</citation>
</ref>
<ref id="bibr7-0954411911427506">
<label>7.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Gassert</surname><given-names>R</given-names></name>
<name><surname>Yamamoto</surname><given-names>A</given-names></name>
<name><surname>Chapuis</surname><given-names>D</given-names></name>
<name><surname>Dovat</surname><given-names>L</given-names></name>
<name><surname>Bleuler</surname><given-names>H</given-names></name>
<name><surname>Burdet</surname><given-names>E</given-names></name>
</person-group>. <article-title>Actuation methods for applications in MR environments</article-title>. <source>Concep Mag Res B: Mag Res Eng</source> <year>2006</year>; <volume>29</volume>(<issue>4</issue>): <fpage>191</fpage>–<lpage>209</lpage>.</citation>
</ref>
<ref id="bibr8-0954411911427506">
<label>8.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Durrant</surname><given-names>CJ</given-names></name>
<name><surname>Hertzberg</surname><given-names>MP</given-names></name>
<name><surname>Kuchel</surname><given-names>PW</given-names></name>
</person-group>. <article-title>Magnetic susceptibility: further insights into macroscopic and microscopic fields and the sphere of Lorentz</article-title>. <source>Concep Mag Res A</source> <year>2003</year>; <volume>18A</volume>(<issue>1</issue>): <fpage>72</fpage>–<lpage>95</lpage>.</citation>
</ref>
<ref id="bibr9-0954411911427506">
<label>9.</label>
<citation citation-type="book">
<person-group person-group-type="author">
<name><surname>Lorentz</surname><given-names>HA</given-names></name>
</person-group>. <source>The theory of electrons and its applications to the phenomena of light and radiant heat</source>. <edition>2nd ed.</edition> <publisher-name>Columbia University</publisher-name>, <year>1916</year>.</citation>
</ref>
<ref id="bibr10-0954411911427506">
<label>10.</label>
<citation citation-type="book">
<person-group person-group-type="author">
<name><surname>Wijn</surname><given-names>HPJ</given-names></name>
</person-group>. <source>Magnetic properties of metals: d-elements, alloys and compound</source>. <publisher-name>Springer-Verlag</publisher-name>, <year>1991</year>.</citation>
</ref>
<ref id="bibr11-0954411911427506">
<label>11.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Li</surname><given-names>S</given-names></name>
<name><surname>Dardzinski</surname><given-names>BJ</given-names></name>
<name><surname>Collins</surname><given-names>CK</given-names></name>
<name><surname>Yang</surname><given-names>QX</given-names></name>
<name><surname>Smith</surname><given-names>MB</given-names></name>
</person-group>. <article-title>Three-dimensional mapping of the static magnetic field inside the human head</article-title>. <source>Mag Res Med</source> <year>1996</year>; <volume>36</volume>(<issue>5</issue>): <fpage>705</fpage>–<lpage>714</lpage>.</citation>
</ref>
<ref id="bibr12-0954411911427506">
<label>12.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Yoder</surname><given-names>DA</given-names></name>
<name><surname>Zhao</surname><given-names>Y</given-names></name>
<name><surname>Paschal</surname><given-names>CB</given-names></name>
<name><surname>Fitzpatrick</surname><given-names>JM</given-names></name>
</person-group>. <article-title>MRI simulator with object-specific field map calculations</article-title>. <source>Mag Res Imag</source> <year>2004</year>; <volume>22</volume>(<issue>3</issue>): <fpage>315</fpage>–<lpage>328</lpage>.</citation>
</ref>
<ref id="bibr13-0954411911427506">
<label>13.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Tse</surname><given-names>ZTH</given-names></name>
<name><surname>Elhawary</surname><given-names>H</given-names></name>
<name><surname>Montesinos</surname><given-names>CAF</given-names></name>
<name><surname>Rea</surname><given-names>M</given-names></name>
<name><surname>Young</surname><given-names>I</given-names></name>
<name><surname>Lamperth</surname><given-names>M</given-names></name>
</person-group>. <article-title>Testing MR image artifacts generated by engineering materials</article-title>. <source>Concep Mag Res B, Mag Res Eng</source> <year>2011</year>; <volume>38B</volume>(<issue>2</issue>): <fpage>109</fpage>–<lpage>117</lpage>.</citation>
</ref>
<ref id="bibr14-0954411911427506">
<label>14.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Kuchel</surname><given-names>PW</given-names></name>
<name><surname>Chapman</surname><given-names>BE</given-names></name>
<name><surname>Bubb</surname><given-names>WA</given-names></name>
<name><surname>Hansen</surname><given-names>PE</given-names></name>
<name><surname>Durrant</surname><given-names>CJ</given-names></name>
<name><surname>Hertzberg</surname><given-names>MP</given-names></name>
</person-group>. <article-title>Magnetic susceptibility: solutions, emulsions and cells</article-title>. <source>Concep Mag Res A</source> <year>2003</year>; <volume>18A</volume>(<issue>1</issue>): <fpage>56</fpage>–<lpage>71</lpage>.</citation>
</ref>
<ref id="bibr15-0954411911427506">
<label>15.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Collins</surname><given-names>CM</given-names></name>
<name><surname>Yang</surname><given-names>B</given-names></name>
<name><surname>Yang</surname><given-names>QX</given-names></name>
<name><surname>Smith</surname><given-names>MB</given-names></name>
</person-group>. <article-title>Numerical calculations of the static magnetic field in three-dimensional multi-tissue models of the human head</article-title>. <source>Mag Res Imag</source> <year>2002</year>; <volume>20</volume>(<issue>5</issue>): <fpage>413</fpage>–<lpage>424</lpage>.</citation>
</ref>
<ref id="bibr16-0954411911427506">
<label>16.</label>
<citation citation-type="book">
<comment>ASTM-F2119</comment>. <source>Standard test method for evaluation of MR image artifacts from passive implants designation F2119</source>. <publisher-name>American Society for Testing and Materials</publisher-name>, <year>2007</year>.</citation>
</ref>
</ref-list>
</back>
</article>