<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v2.3 20070202//EN" "journalpublishing.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">PIC</journal-id>
<journal-id journal-id-type="hwp">sppic</journal-id>
<journal-title>Proceedings of the Institution of Mechanical Engineers, Part C: Journal of Mechanical Engineering Science</journal-title>
<issn pub-type="ppub">0954-4062</issn>
<issn pub-type="epub">2041-2983</issn>
<publisher>
<publisher-name>SAGE Publications</publisher-name>
<publisher-loc>Sage UK: London, England</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1177/0954406211435195</article-id>
<article-id pub-id-type="publisher-id">10.1177_0954406211435195</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Bio-Medical Engineering</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Interactive retinal blood flow estimation from fluorescein angiograms</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name><surname>Cañas</surname><given-names>Rubiel Vargas</given-names></name>
<xref ref-type="aff" rid="aff1-0954406211435195">1</xref>
<xref ref-type="aff" rid="aff2-0954406211435195">2</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name><surname>Liatsis</surname><given-names>Panos</given-names></name>
<xref ref-type="aff" rid="aff1-0954406211435195">1</xref>
<xref ref-type="corresp" rid="corresp1-0954406211435195"/>
</contrib>
</contrib-group>
<aff id="aff1-0954406211435195"><label>1</label>Information Engineering and Medical Imaging Group, School of Engineering and Mathematical Sciences, City University, UK</aff>
<aff id="aff2-0954406211435195"><label>2</label>Department of Physics, Cauca University, Colombia</aff>
<author-notes>
<corresp id="corresp1-0954406211435195">Panos Liatsis, Information Engineering and Medical Imaging Group, School of Engineering and Mathematical Sciences, City University, Northampton Square, London EC1V 0HB, UK. Email: <email>p.liatsis@city.ac.uk</email></corresp>
</author-notes>
<pub-date pub-type="epub-ppub">
<month>10</month>
<year>2012</year>
</pub-date>
<volume>226</volume>
<issue>10</issue>
<fpage>2521</fpage>
<lpage>2537</lpage>
<history>
<date date-type="received"><day>19</day><month>8</month><year>2011</year></date>
<date date-type="accepted"><day>15</day><month>12</month><year>2011</year></date>
</history>
<permissions>
<copyright-statement>© IMechE 2012</copyright-statement>
<copyright-year>2012</copyright-year>
<copyright-holder content-type="society">Institution of Mechanical Engineers</copyright-holder>
</permissions>
<abstract>
<p>It is well-known that age-related macular degeneration is the main cause of visual impairment in industrialised countries affecting around 239,000 people in UK while demonstrating an increasing trend. Fluorescein angiography is the most widely used technique in the diagnosis, prognosis and in following up the development of the disease. The interpretation of fluorescein angiograms depends upon the detection of abnormal fluorescence and clinical assessment of the functional integrity of retinal circulation, which is primarily based on subjective evaluation of the dye transit-time. This study presents a prototype system for quantitative analysis of the retinal haemodynamics. It analyses retinal blood flow based on the estimation of parameters such as mean transit-time, arteriovenous passage time and mean dye velocity. These parameters are estimated using densitometry and analysis of the vascular response. The prototype system consists of three main stages: vessel segmentation, image registration and blood flow estimation. The performance of the system is demonstrated on a comprehensive dataset, which contains images of normal retinas and retinas with pathologies such as wet age-related macular degeneration and branch retinal vein occlusion. The presented framework aims to demonstrate the technical feasibility for automated extraction of retinal blood flow parameters and contributes towards the development of a clinically proven computer vision system for quantitative analysis of fluorescein angiograms to assist NHS clinicians in the early diagnosis of age-related macular degeneration.</p>
</abstract>
<kwd-group>
<kwd>Fluorescein retinal vessel segmentation</kwd>
<kwd>retinal registration</kwd>
<kwd>retinal blood transit-time estimation</kwd>
<kwd>retinal blood flow estimation</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="sec1-0954406211435195" sec-type="intro"><title>Introduction</title>
<p>The eye is the organ of sight. It is a highly specialised organ of photoreception. Its function is to convert light into electrical signals that are transmitted to the brain where they are processed and appreciated as vision. When the eye is properly focused, light from an external object is imaged onto the retina, a light-sensitive layer on the back of the eye. The retinal cells collect the light signals directed onto them and send them, as electrical signals, to the brain through the optic nerve. The macula is a specialised area at the centre of the retina with the highest population of photosensitive cells, which enables colour vision and detailed seeing, i.e. reading, watching television and recognising faces. There are different conditions which can cause damage to the cells of the macula; among them, macular degeneration (age-related macular degeneration, AMD), which is the main cause of blindness in the UK and the western world. There are two main forms of the disease: dry or atrophic (geographical atrophy, GA) and wet or disciform.<sup><xref ref-type="bibr" rid="bibr1-0954406211435195">1</xref>,<xref ref-type="bibr" rid="bibr2-0954406211435195">2</xref></sup> GA is the most common form and there is no medical treatment for this type of AMD, whereas disciform macular degeneration causes earlier, more rapid and severe visual loss.<sup><xref ref-type="bibr" rid="bibr1-0954406211435195">1</xref></sup> However, it can be treated if detected at an early stage. Such treatments include anti-vascular endothelial growth factor drugs, photodynamic therapy and laser photocoagulation.</p>
<p>There are several reasons for focussing attention to AMD. First, it affects around 239,000 people in the UK<sup><xref ref-type="bibr" rid="bibr2-0954406211435195">2</xref></sup> and approximately 2.5 m people in Europe,<sup><xref ref-type="bibr" rid="bibr3-0954406211435195">3</xref></sup> with proportions increasing.<sup><xref ref-type="bibr" rid="bibr2-0954406211435195">2</xref>,<xref ref-type="bibr" rid="bibr4-0954406211435195">4</xref></sup> Second, functional and social effects can be devastating, particularly to elderly people.<sup><xref ref-type="bibr" rid="bibr1-0954406211435195">1</xref></sup> To date, AMD is incurable, causing significant impairment in the quality of life and functional independence. Third, communities are affected due to the implications for future levels of health and social care provision. It is estimated that the annual cost of AMD in the UK is approximately £860 m and one billion pounds in the rest of the EU<sup><xref ref-type="bibr" rid="bibr5-0954406211435195">5</xref></sup> with approximately 25,000 new cases in the UK every year.<sup><xref ref-type="bibr" rid="bibr6-0954406211435195">6</xref></sup> Therefore, early diagnosis of AMD could allow suitable treatment, improve the quality of living of people affected by such condition, and alleviate the pressure on health services.</p>
<p>Currently, a common method for diagnosis of AMD is fluorescein angiography (FA).<sup><xref ref-type="bibr" rid="bibr7-0954406211435195">7</xref></sup> It involves the injection of a special dye into the systemic circulation and taking a series of rapid photographs of the retina. These photographs provide an accurate spatial and temporal map of the circulatory changes, occurring in the macula. The interpretation of fluorescein angiograms depends upon the detection of abnormal fluorescence and clinical assessment of the functional integrity of retinal circulation, which is primarily based on subjective evaluation of the dye transit-time. As part of a research project, which aims to develop an automated computer vision system for quantitative analysis of fluorescein angiograms to assist NHS clinicians in early diagnosis of AMD, the study presented here reports a method for estimation of macular blood flow, since the rapidity with which blood circulates through the retina is an indicator of the adequacy of supply of nutrients and transport of waste products<sup><xref ref-type="bibr" rid="bibr8-0954406211435195">8</xref>,<xref ref-type="bibr" rid="bibr9-0954406211435195">9</xref></sup> and hence an indicator of the overall retinal health.</p>
<p>The rest of this article is organised as follows. Background section presents an overview of retinal blood flow estimation. Methodology section details the proposed approach, which can be summarised in terms of the main processes of vascular vessel network segmentation, illumination correction, image registration, and densitometric analysis for blood flow estimation. Then, the results achieved with the proposed methodology are discussed. Finally, the conclusions of this study and discussions for future directions are outlined.</p>
</sec>
<sec id="sec2-0954406211435195"><title>Background</title>
<p>The ocular micro-vascular circulatory system is made up of arterioles, capillaries and venules. It is divided into the retinal and choroidal circulatory systems, whose main functions are to provide nutrients to the cells and tissues and to remove waste products from them.<sup><xref ref-type="bibr" rid="bibr10-0954406211435195">10</xref></sup> These tasks are accomplished because of consistent blood flow. Blood is supplied by the ophthalmic artery which enters the orbit through the optic disk (OD) and branches into four retinal vessel arcades. The superior and inferior temporal arcades continue branching, except into the fovea.<sup><xref ref-type="bibr" rid="bibr10-0954406211435195">10</xref></sup> The central retinal vein acts as drainage completing the circulatory cycle.</p>
<p>Basically, the blood flow, <italic>Q</italic>, is the volume of blood flowing through a certain point during a specified period of time. It is driven by the ocular perfusion pressure and is regulated by the vascular resistance, i.e. the volume of the vascular bed. Therefore, blood flow quantification implies the measurement of both blood velocity and volume. A variety of techniques have been used to measure ocular blood flow. Among them are the analysis of temporal changes of vessel calibre,<sup><xref ref-type="bibr" rid="bibr11-0954406211435195">11</xref></sup> measurement of pulsatile ocular blood flow (POBF) changes,<sup><xref ref-type="bibr" rid="bibr12-0954406211435195">12</xref><xref ref-type="bibr" rid="bibr13-0954406211435195"/><xref ref-type="bibr" rid="bibr14-0954406211435195"/>–<xref ref-type="bibr" rid="bibr15-0954406211435195">15</xref></sup> analysis of the varying speckle interference patterns,<sup><xref ref-type="bibr" rid="bibr16-0954406211435195">16</xref></sup> techniques based on the Doppler shift principle, namely, colour Doppler optical coherence tomography, laser Doppler velocimetry (LDV)<sup><xref ref-type="bibr" rid="bibr17-0954406211435195">17</xref><xref ref-type="bibr" rid="bibr18-0954406211435195"/><xref ref-type="bibr" rid="bibr19-0954406211435195"/>–<xref ref-type="bibr" rid="bibr20-0954406211435195">20</xref></sup> bi-directional LDV,<sup><xref ref-type="bibr" rid="bibr12-0954406211435195">12</xref></sup> flowmetres<sup><xref ref-type="bibr" rid="bibr17-0954406211435195">17</xref>,<xref ref-type="bibr" rid="bibr20-0954406211435195">20</xref></sup> and angiographic techniques.<sup><xref ref-type="bibr" rid="bibr7-0954406211435195">7</xref></sup></p>
<p>To date, the preferred method for visualisation of ocular blood perfusion in the clinic is FA,<sup><xref ref-type="bibr" rid="bibr7-0954406211435195">7</xref></sup> whereas Doppler-based techniques are preferred for measurement of blood velocity in ‘in vitro’ experimental settings. However, there is currently no widely accepted consensus regarding which technique should be used to evaluate blood flow.<sup><xref ref-type="bibr" rid="bibr21-0954406211435195">21</xref>,<xref ref-type="bibr" rid="bibr22-0954406211435195">22</xref></sup> Nevertheless, FA has some advantages in comparison to other techniques: it is more sensitivity to small changes in retinal haemodynamics,<sup><xref ref-type="bibr" rid="bibr8-0954406211435195">8</xref></sup> it samples the blood flow along both the cross-section and the length of the vessel providing information regarding both the slower flows near the vessel walls and the more rapid ones in the centre of the vessel, its wider field of view provides access to the ‘entire’ vascular network and it is less sensitive to eye movements.</p>
<p>Analysis of blood flow using FA is based on the estimation of the retinal circulation time or mean transit-time (MTT). MTT is defined as the average time that fluorescein stays in a given vascular bed.<sup><xref ref-type="bibr" rid="bibr22-0954406211435195">22</xref><xref ref-type="bibr" rid="bibr23-0954406211435195"/>–<xref ref-type="bibr" rid="bibr24-0954406211435195">24</xref></sup> MTT measurements involve the use of dye dilution curves, which represent the changes in dye intensity/concentration with time. To create those curves, regions of interest are identified on the major retinal vessels that are located in the surrounding area of the OD, and the data are then fitted to a specified model.<sup><xref ref-type="bibr" rid="bibr23-0954406211435195">23</xref>,<xref ref-type="bibr" rid="bibr25-0954406211435195">25</xref>,<xref ref-type="bibr" rid="bibr26-0954406211435195">26</xref></sup> Haemodynamics parameters are then calculated from the fitted curve.</p>
<p>Another common parameter is the arteriovenous passage time (AVP), which is the time taken for fluorescein, from its appearance in an artery, until its corresponding appearance in the equivalent vein.<sup><xref ref-type="bibr" rid="bibr27-0954406211435195">27</xref></sup> It is a rough estimation of MTT<sup><xref ref-type="bibr" rid="bibr28-0954406211435195">28</xref></sup> and is used as alternative, when it is difficult to construct the dilution curve. It can be measured by placing a measuring point on a designated vein and its corresponding artery, and estimating the time difference between the arrivals of the dye to such measuring points.<sup><xref ref-type="bibr" rid="bibr12-0954406211435195">12</xref>,<xref ref-type="bibr" rid="bibr13-0954406211435195">13</xref></sup> Another popular parameter used to describe retinal circulation is the mean dye velocity (MDV), which is the time taken for fluorescein to travel a certain distance along an arteriole.<sup><xref ref-type="bibr" rid="bibr8-0954406211435195">8</xref>,<xref ref-type="bibr" rid="bibr13-0954406211435195">13</xref>,<xref ref-type="bibr" rid="bibr27-0954406211435195">27</xref></sup> This can be computed by placing two measuring points, on the same vessel with no branches, at known distances and measuring the time taken for the dye to reach these points.<sup><xref ref-type="bibr" rid="bibr12-0954406211435195">12</xref>,<xref ref-type="bibr" rid="bibr13-0954406211435195">13</xref></sup></p>
<p>In order to compute retinal transit-times from dye dilution curves, various approaches have been developed. Hickam and Frayser<sup><xref ref-type="bibr" rid="bibr24-0954406211435195">24</xref></sup> and Bulpitt and Dollery<sup><xref ref-type="bibr" rid="bibr25-0954406211435195">25</xref></sup> use semi-logarithmic extrapolation of the downward slope, which provides the mean arterial and venous circulation times. MTT is then obtained as the difference between the centres of gravity of the resulting arterial and venous curves. The volume of the vascular bed is approximated by the sum of the squares of the arterial and venous diameters. Bursell et al.<sup><xref ref-type="bibr" rid="bibr23-0954406211435195">23</xref></sup> fit the data to a log-normal distribution using a least-squares algorithm. Vessel diameters are calculated as the average of the half-heights of the cross-sectional profile on images recorded before fluorescein injection. MTT is measured as in the previous case. Zhu et al.<sup><xref ref-type="bibr" rid="bibr29-0954406211435195">29</xref></sup> assumes that the total emission received by the camera is proportional to the amount of dye in the blood vessel when it passes through the measuring window. This intensity is a function of the dye concentration at a time, the absorption of the tissue, the blood flow velocity and the vessel cross-sectional area. This information is incorporated in a model, which fits the dye dilution curve to a lagged normal model.</p>
<p>Apart from the MTT, various parameters have been included in the study of dye dilution curves such as the difference of arterial and venous times of maximum intensity,<sup><xref ref-type="bibr" rid="bibr30-0954406211435195">30</xref></sup> the arriving time,<sup><xref ref-type="bibr" rid="bibr26-0954406211435195">26</xref></sup> the time of maximum intensity,<sup><xref ref-type="bibr" rid="bibr31-0954406211435195">31</xref></sup> the rising time<sup><xref ref-type="bibr" rid="bibr26-0954406211435195">26</xref></sup> and the time to <italic>x</italic>% of maximum intensity.<sup><xref ref-type="bibr" rid="bibr30-0954406211435195">30</xref></sup> Jagoe et al.<sup><xref ref-type="bibr" rid="bibr31-0954406211435195">31</xref></sup> estimate the time of maximum filling and generate colour-coded parametric macular images showing this parameter at each point of the vascular structure. To do so, third-order polynomial functions are used to fit the data. Hipwell et al.<sup><xref ref-type="bibr" rid="bibr26-0954406211435195">26</xref></sup> model the initial circulation of the dye as a gamma variate curve and the recirculation phase as a second-order polynomial, which crosses the time axis at the maximum of the gamma variate function. The model is fitted at every point in the angiogram, using the Levenberg–Marquardt least-squares algorithm. The parameters of time of arrival, (<italic>t</italic><sub>0</sub>), time of maximum intensity, (<italic>t</italic><sub>100</sub>) and rise time, (<italic>t<sub>r</sub></italic> = <italic>t</italic><sub>100</sub> − <italic>t</italic><sub>0</sub>) are calculated from the fitted curves. <xref ref-type="fig" rid="fig1-0954406211435195">Figure 1</xref> shows an example of a dye dilution curve and illustrates some of the aforementioned parameters.
<fig id="fig1-0954406211435195" position="float"><label>Figure 1.</label><caption><p>Example of a dilution curve. The data were fitted to a gamma variate curve and a second-order polynomial.<sup><xref ref-type="bibr" rid="bibr26-0954406211435195">26</xref></sup> The gamma variate curve represents the initial passage of the dye while the second-order polynomial corresponds to the re-circulation time. The down slope is influenced by early recirculation of the dye.</p></caption><graphic xlink:href="10.1177_0954406211435195-fig1.tif"/></fig></p>
<p>On the other hand, Sperber and Alm<sup><xref ref-type="bibr" rid="bibr32-0954406211435195">32</xref></sup> argue that, even in normal individuals, it is not always possible to obtain suitable dilution curves, due to the fact that recirculation influences the shape of the down slope curve, complicating the estimation of the MTT. Therefore, they evaluate a technique for determining the MTT based on impulse–response analysis. In this approach, the arterial concentration is regarded as a square-wave impulse and the resulting venous curve is considered as the sum of the responses to a series of arterial square-wave impulses shifted in time. The impulse–response is obtained using a fitting procedure, which yields a simulated venous curve, close to the recorded one and the MTT is then calculated as the centre of gravity of the impulse–response. Bjärnhall et al.<sup><xref ref-type="bibr" rid="bibr28-0954406211435195">28</xref></sup> evaluated the impulse–response analysis method and compared it to the conventional extrapolation, reporting similar results from both techniques on well-defined dilution curves and better results for the impulse–response analysis on badly defined curves. Tomic et al.,<sup><xref ref-type="bibr" rid="bibr33-0954406211435195">33</xref></sup> use the aforementioned technique to investigate the effects of oxygen and carbon dioxide on human retinal circulation.</p>
<p>Estimation of the aforementioned parameters is based upon three main assumptions. First, the volume of the vascular bed is related to the circular cross-sectional area of the supplying artery and the draining vein, which may not be true always<sup><xref ref-type="bibr" rid="bibr8-0954406211435195">8</xref>,<xref ref-type="bibr" rid="bibr22-0954406211435195">22</xref></sup> due to the fact that an artery is not always completely drained by a corresponding vein, leakage and areas of non-perfusion occur during some retinopathies. Second, the concentration of the dye in the blood is linearly related to the vessel intensity; however, mixing or leaking may dilute the bolus and eliminate the sharpness of the wave front. Finally, the velocity of the dye within the vessel cross-section is uniform, which is limited due to technical problems such as the speed at which images are acquired, the noise introduced by auto-fluorescence and variations in the rapidity of injection.<sup><xref ref-type="bibr" rid="bibr9-0954406211435195">9</xref>,<xref ref-type="bibr" rid="bibr34-0954406211435195">34</xref></sup></p>
</sec>
<sec id="sec3-0954406211435195" sec-type="methods"><title>Methodology</title>
<p>Automated analysis of fluorescein angiograms is a challenging task due to the wide range of lesions, homogeneous nonvascular/textureless regions, unpredictable patterns, when the dye circulates, and large image intensity variability. Furthermore, spatial anatomical correspondence and illumination relationships between and within images have to be preserved. We propose an approach to quantify volumetric retinal blood flow, which copes with the aforementioned limitations and is illustrated in <xref ref-type="fig" rid="fig2-0954406211435195">Figure 2</xref>.
<fig id="fig2-0954406211435195" position="float"><label>Figure 2.</label><caption><p>Block diagram representation of the proposed approach.</p></caption><graphic xlink:href="10.1177_0954406211435195-fig2.tif"/></fig></p>
<p>The proposed methodology starts by segmenting the vascular network in two steps: estimation of vessel regions and detection of the vessel edges. Following vessel segmentation, the images are registered to ensure anatomical correspondence between different frames. Finally, haemodynamics parameters are computed from the aligned images; blood transit-time is computed using both the dye dilution technique and the analysis of the micro-vascular response. In the present approach, vessel segmentation and image registration stages are fully automated, whereas retinal haemodynamics estimation requires user intervention, in order to establish the location of the measurement points.</p>
<sec id="sec4-0954406211435195"><title>Vessel segmentation</title>
<p>Retinal vessel segmentation is a key task for automated analysis of FAs, because the vessel network provides information regarding not only the blood flow, but also the location of the main constituent parts of the retina. Segmentation of retinal vessels in FA is particularly challenging due to the intrinsic characteristics of the angiogram, uneven illumination of the background, large vessels brightness variation, according to the phase of the angiogram,<sup><xref ref-type="bibr" rid="bibr35-0954406211435195">35</xref></sup> and low vessel contrast, which is common in the late phases of the angiogram. Among them, combinations of dark and light vessels in the same image and streams in the same vein (tram-line effect) make the application of traditional vessel segmentation approaches challenging for extraction of vessels in fluorescein angiogram images.</p>
<p>Our vessel segmentation approach considers retinal vessels as ridges and valleys, as illustrated in <xref ref-type="fig" rid="fig3-0954406211435195">Figure 3</xref>. Here, bright vessels can be thought of as ridges, dark vessels as valleys and the tram-line effect as a valley bounded by two ridges. The segmentation approach is formulated in two main steps: estimation of vessel regions and detection of the vessel boundaries. To do so, information regarding the maximum curvature<sup><xref ref-type="bibr" rid="bibr36-0954406211435195">36</xref></sup> and phase congruency<sup><xref ref-type="bibr" rid="bibr37-0954406211435195">37</xref></sup> is obtained and analysed as explained below.
<fig id="fig3-0954406211435195" position="float"><label>Figure 3.</label><caption><p>Retinal vessels are shown as ridges and valleys. Topographic representation of (a) a bright vessel, (b) the so-called tram-line effect and (c) a dark vessel.</p></caption><graphic xlink:href="10.1177_0954406211435195-fig3.tif"/></fig></p>
<p>The vessel regions are estimated using a combination of morphological operations and using information about the maximum curvature. First, only dark structures are selected using the top-hat filter, which is defined as the difference between the original image and its closing operation, i.e.
<disp-formula id="disp-formula1-0954406211435195"><label>(1)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block" id="mml-disp1-0954406211435195"><mml:mrow><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mi>I</mml:mi><mml:mo>-</mml:mo><mml:mi>I</mml:mi><mml:mo>•</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:math><graphic alternate-form-of="disp-formula1-0954406211435195" xlink:href="10.1177_0954406211435195-eq1.tif"/></disp-formula>
where <italic>G</italic> is the filtered image, <italic>I</italic> the original one, <italic>B</italic> the structuring element, i.e. a disk with diameter slightly larger than the largest vessel diameter and (•) the closing operation. This step merges bright vessels and background, and reduces the variance of the background. Second, dark structures are enhanced by analysing the eigen-decomposition of the Hessian matrix, which provides information regarding vessel location, orientation and boundaries. The Hessian matrix of a function <italic>f</italic>(<italic>x</italic>) with <italic>x</italic> = (<italic>x</italic><sub>1</sub>, <italic>x</italic><sub>2</sub>) is defined as
<disp-formula id="disp-formula2-0954406211435195"><label>(2)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block" id="mml-disp2-0954406211435195"><mml:mrow><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msup><mml:mi/><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∂</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:math><graphic alternate-form-of="disp-formula2-0954406211435195" xlink:href="10.1177_0954406211435195-eq2.tif"/></disp-formula>
where <italic>i, j Є</italic>{1,2}, and <italic>∂x<sub>i</sub></italic> and <italic>∂x<sub>j</sub></italic> are the partial derivatives along <italic>x<sup>i</sup></italic> and <italic>x<sup>j</sup></italic> directions, respectively. The Hessian, <italic>H<sub>σ</sub></italic>, is computed using derivative filters at different scales <italic>σ</italic>, and its eigenvalues, <inline-formula id="ilm1-0954406211435195"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math1-0954406211435195"><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, are used to decide whether a particular location belongs to a vessel pixel or not. Next, information regarding the sign and magnitude of the eigenvalues can be used as a signature to identify the type of structure,<sup><xref ref-type="bibr" rid="bibr36-0954406211435195">36</xref></sup> as given in <xref ref-type="table" rid="table1-0954406211435195">Table 1</xref>.
<table-wrap id="table1-0954406211435195" position="float"><label>Table 1.</label><caption><p>Signatures of possible 2D structures.</p></caption>
<graphic alternate-form-of="table1-0954406211435195" xlink:href="10.1177_0954406211435195-table1.tif"/>
<table frame="hsides"><thead align="left">
<tr><th><italic>λ</italic><sub>2</sub></th>
<th><italic>λ</italic><sub>1</sub></th>
<th>Structure</th></tr></thead>
<tbody align="left">
<tr>
<td>−H</td>
<td>L</td>
<td>Bright line</td></tr>
<tr>
<td>+H</td>
<td>L</td>
<td>Dark line</td></tr>
<tr>
<td>−H</td>
<td>−H</td>
<td>Bright blob</td></tr>
<tr>
<td>+H</td>
<td>+H</td>
<td>Dark blob</td></tr>
</tbody>
</table>
<table-wrap-foot>
<fn id="table-fn1-0954406211435195"><p>Note: H, high; L, low; and +/− indicates the sign of the eigenvalue.</p></fn></table-wrap-foot>
</table-wrap></p>
<p>Moreover, the eigenvector <inline-formula id="ilm2-0954406211435195"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math2-0954406211435195"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> corresponding to <italic>λ</italic><sub>2</sub> indicates the direction of maximum variation, the vessel cross-section, and the eigenvector <inline-formula id="ilm3-0954406211435195"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math3-0954406211435195"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> corresponding to <italic>λ</italic><sub>1</sub> indicates the vessel direction, i.e. the direction of minor variation. Third, bright structures are also enhanced following the same procedure. The Hessian is computed in scale space and normalised so that the responses can be combined by taking the maximum across all scales. Finally, the enhanced images are combined and thresholded, using hysteresis thresholding. The resulting image defines the region where the most prominent retinal vessels are located irrespective of their intensity.</p>
<p>Following the vessel region estimation, vessel boundaries and centrelines, and hence vessel diameter, are calculated using a set of rules, based on features which provide information of the maximum curvature and symmetry, namely, first directional derivative, second directional derivative and phase congruency. These rules define the vessel centreline and boundaries, which then are traced using a Kalman filter. Similar approaches based on the use of Kalman filters have been previously reported by Chutatape et al.<sup><xref ref-type="bibr" rid="bibr38-0954406211435195">38</xref></sup> and Can et al.<sup><xref ref-type="bibr" rid="bibr39-0954406211435195">39</xref></sup> Alternative methodologies for vessel tracing include the use of predictive scheduling algorithms,<sup><xref ref-type="bibr" rid="bibr40-0954406211435195">40</xref></sup> sequential techniques for wave propagation and traceback<sup><xref ref-type="bibr" rid="bibr41-0954406211435195">41</xref></sup> and maze-tracing algorithms.<sup><xref ref-type="bibr" rid="bibr42-0954406211435195">42</xref></sup> The first directional derivative along the vessel cross-section is defined as
<disp-formula id="disp-formula3-0954406211435195"><label>(3)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block" id="mml-disp3-0954406211435195"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mo>∇</mml:mo><mml:mi>I</mml:mi><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math><graphic alternate-form-of="disp-formula3-0954406211435195" xlink:href="10.1177_0954406211435195-eq3.tif"/></disp-formula>
</p>
<p>The second directional derivative is given by <italic>λ</italic><sub>2</sub>. According to Kovesi,<sup><xref ref-type="bibr" rid="bibr37-0954406211435195">37</xref></sup> vessel profiles can be thought of as being formed by a Fourier series, where its components are in phase at the vessel borders and at the peaks. Therefore, the local energy model postulates that features are perceived at points in an image, where the Fourier components are maximally in phase. Thus, phase congruency is given by<sup><xref ref-type="bibr" rid="bibr37-0954406211435195">37</xref></sup>
<disp-formula id="disp-formula4-0954406211435195"><label>(4)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block" id="mml-disp4-0954406211435195"><mml:mrow><mml:mi>PC</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mtable align="left"><mml:mtr><mml:mtd columnalign="center"><mml:mtr><mml:mtd columnalign="center" columnspan="1"><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munder><mml:mi>W</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo> </mml:mo><mml:mo>⌊</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo> </mml:mo><mml:mo>(</mml:mo></mml:mrow><mml:mi>cos</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mover><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center" columnspan="1"><mml:mrow><mml:mi>   </mml:mi><mml:mo>-</mml:mo><mml:mrow><mml:mo> </mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:mi>sin</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mover><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo> </mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>T</mml:mi><mml:mrow><mml:mo> </mml:mo><mml:mo>⌋</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtd></mml:mtr></mml:mtable><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>ɛ</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic alternate-form-of="disp-formula4-0954406211435195" xlink:href="10.1177_0954406211435195-eq4.tif"/></disp-formula>
where the term <italic>W</italic>(<italic>x</italic>) is the weight for frequency spread, <italic>A<sub>n</sub></italic> and <italic>ϕ<sub>n</sub></italic> the amplitude and phase of the <italic>n</italic>th component, respectively, <italic>ε</italic> a small constant, incorporated to avoid division by zero and <italic>T</italic> a given energy thresholding. The symbol └ ┘ denotes that the enclosed quantity is equal to itself, when its value is positive, and zero otherwise. The phase angle lies in the range −π to π and indicates the feature type: an angle of 0 indicates an upward going step, π a bright line feature, 3π/2 a downward going step and −π a dark line feature. Therefore, vessel centreline and borders can be detected as summarised in <xref ref-type="table" rid="table2-0954406211435195">Table 2</xref>.
<table-wrap id="table2-0954406211435195" position="float"><label>Table 2.</label><caption><p>Rules for determination of vessel centreline and borders.</p></caption>
<graphic alternate-form-of="table2-0954406211435195" xlink:href="10.1177_0954406211435195-table2.tif"/>
<table frame="hsides"><thead align="left">
<tr><th>Structure</th>
<th><italic>D<sub>v</sub>I</italic></th>
<th><italic>λ</italic><sub>2</sub></th>
<th><italic>λ</italic><sub>1</sub></th>
<th>PC</th></tr></thead>
<tbody align="left">
<tr>
<td>Bright centreline</td>
<td>0(− to+)</td>
<td>H−</td>
<td>L</td>
<td>π</td></tr>
<tr>
<td>Dark centreline</td>
<td>0(+ to−)</td>
<td>H+</td>
<td>L</td>
<td>−π</td></tr>
<tr>
<td>Border (edge)</td>
<td>H</td>
<td>0</td>
<td>L</td>
<td>[−π/6, π/6]</td></tr>
</tbody>
</table>
<table-wrap-foot>
<fn id="table-fn2-0954406211435195"><p>Note: H, high; L, low; and +/− indicates the sign of the eigenvalue.</p></fn></table-wrap-foot>
</table-wrap></p>
</sec>
<sec id="sec5-0954406211435195"><title>Macular identification</title>
<p>The macula is the part of the posterior retina, which extends 5 to 6 disk diameters (6.0–7.5 mm) temporally from the edge of the OD and is limited vertically by the inferior and superior retinal vessel arcades.<sup><xref ref-type="bibr" rid="bibr1-0954406211435195">1</xref></sup> The centre of the macula is the fovea. Therefore, correct macular identification depends upon the extraction of the OD, major blood vessels and the fovea. The OD and fovea were located using a probabilistic approach, which incorporates information about the image intensity, shape features and the geometry of the vascular tree. This information allows the identification of the macula, which is described using the Wisconsin template.<sup><xref ref-type="bibr" rid="bibr43-0954406211435195">43</xref></sup> Details of this method are published elsewhere.<sup><xref ref-type="bibr" rid="bibr44-0954406211435195">44</xref></sup></p>
</sec>
<sec id="sec6-0954406211435195"><title>Illumination correction</title>
<p>Various factors cause degradation in retinal imaging, for example, lens edge artefacts and non-uniform illumination. These sources of noise are usually modelled together as an optical aberration, called vignetting,<sup><xref ref-type="bibr" rid="bibr45-0954406211435195">45</xref></sup> which reduces the brightness at the periphery of the image compared to the centre of the image. This brightness reduction adds low-frequency spatial variations on top of the retinal structures.<sup><xref ref-type="bibr" rid="bibr46-0954406211435195">46</xref>,<xref ref-type="bibr" rid="bibr47-0954406211435195">47</xref></sup></p>
<p>The OD, vasculature and lesions are specular, hence the Lambertian model of reflectance does not hold.<sup><xref ref-type="bibr" rid="bibr48-0954406211435195">48</xref></sup> Thus, the restoration process is posed as the convolution between the two functions. The illumination component is approximated by a homomorphic surface fitting algorithm, which fits the background to a fourth-order polynomial and estimates the coefficients using background samples and weighted least squares. The underlying function is obtained by image deconvolution, which is implemented through the pseudo-inverse method in the frequency domain.<sup><xref ref-type="bibr" rid="bibr49-0954406211435195">49</xref></sup></p>
</sec>
<sec id="sec7-0954406211435195"><title>Image registration</title>
<p>Eye movements during the image capture procedure complicate correspondence between structuring elements of the retina. Therefore, registration is required to ensure that all features are accurately superimposed on all frames. Registration of fluorescein angiograms is not an easy task due to several factors, e.g. spherical geometry of the retina, large intensity variability and uncertainly overlapping areas. Thus, FA registration is considered as a type of multimodal registration.<sup><xref ref-type="bibr" rid="bibr50-0954406211435195">50</xref><xref ref-type="bibr" rid="bibr51-0954406211435195"/>–<xref ref-type="bibr" rid="bibr52-0954406211435195">52</xref></sup></p>
<p>We follow a two-step approach to image registration, i.e. a rigid pre-registration stage and a non-rigid registration stage. The pre-registration assumes a constrained global affine transformation and accounts for large translations and rotation, while the non-rigid registration is a curved elastic registration stage, which is initialised by the pre-registration stage and recovers local elastic distortions, i.e. projective scaling and small translations and rotation. The pre-registration stage uses the correlation theorem in the frequency domain and the so-called Fourier–Mellin method, while the elastic registration is a parametric estimation technique, based on the gradient of the quadratic error function and iterative least-squares computation. Such optimisation methods need good initialisation to ensure appropriate convergence; this initialisation is carried out at the affine pre-registration stage.</p>
<sec id="sec8-0954406211435195"><title>Global affine pre-registration</title>
<p>Let <italic>f<sub>t</sub></italic>(<italic>x,y</italic>) and <italic>f</italic><sub><italic>r</italic></sub>(<italic>x,y</italic>) be two images related by a translation vector <bold><italic>t</italic></bold> = [<italic>x</italic><sub>0</sub>,<italic>y</italic><sub>0</sub>]<sup><italic>T</italic></sup> as
<disp-formula id="disp-formula5-0954406211435195"><label>(5)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block" id="mml-disp5-0954406211435195"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><graphic alternate-form-of="disp-formula5-0954406211435195" xlink:href="10.1177_0954406211435195-eq5.tif"/></disp-formula>
and let <italic>F<sub>t</sub>(u,v)</italic> and <italic>F<sub>r</sub>(u,v)</italic> be their Fourier transform, respectively. According to the shift theorem, <italic>F<sub>t</sub>(u,v)</italic> and <italic>F<sub>r</sub>(u,v)</italic> are related by
<disp-formula id="disp-formula6-0954406211435195"><label>(6)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block" id="mml-disp6-0954406211435195"><mml:mrow><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>j</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>ux</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>vy</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math><graphic alternate-form-of="disp-formula6-0954406211435195" xlink:href="10.1177_0954406211435195-eq6.tif"/></disp-formula>
</p>
<p>From equation (<xref ref-type="disp-formula" rid="disp-formula6-0954406211435195">6</xref>), it can be seen that <inline-formula id="ilm4-0954406211435195"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math4-0954406211435195"><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, that is, both spectra have the same magnitude, but different phases. This means that any translation in the space/image domain becomes a phase difference in the frequency domain. Equation (<xref ref-type="disp-formula" rid="disp-formula6-0954406211435195">6</xref>) can be rewritten and normalised as the ratio
<disp-formula id="disp-formula7-0954406211435195"><label>(7)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block" id="mml-disp7-0954406211435195"><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi> </mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi> </mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>j</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>ux</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>vy</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math><graphic alternate-form-of="disp-formula7-0954406211435195" xlink:href="10.1177_0954406211435195-eq7.tif"/></disp-formula>
</p>
<p>which is known as the cross-power spectrum, where (*) represents the complex conjugate. Taking the inverse Fourier transform of equation (<xref ref-type="disp-formula" rid="disp-formula7-0954406211435195">7</xref>), the result is a Dirac delta function centred at <bold><italic>t</italic></bold>, i.e. the location of the translation vector.
<disp-formula id="disp-formula8-0954406211435195"><label>(8)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block" id="mml-disp8-0954406211435195"><mml:mrow><mml:mo>ℜ</mml:mo><mml:msup><mml:mi/><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">{</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">}</mml:mo><mml:mo>=</mml:mo><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><graphic alternate-form-of="disp-formula8-0954406211435195" xlink:href="10.1177_0954406211435195-eq8.tif"/></disp-formula>
</p>
<p>The Fourier–Mellin transformation consists of mapping the spectral magnitudes of both test and reference images onto log-polar coordinates, and utilising them as inputs to perform a second POC. It allows the recovery of the rotation and scaling parameters of the transformation model. To do so, the rotation and scaling properties of the Fourier transform are exploited. If <italic>f<sub>t</sub>(x,y)</italic> is a replica of <italic>f<sub>r</sub>(x,y)</italic> but scaled and rotated, their Fourier spectra, expressed in log-polar coordinates, are related by
<disp-formula id="disp-formula9-0954406211435195"><label>(9)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block" id="mml-disp9-0954406211435195"><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>log</mml:mi><mml:mi>ρ</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>log</mml:mi><mml:mi>ρ</mml:mi><mml:mo>-</mml:mo><mml:mi>log</mml:mi><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:math><graphic alternate-form-of="disp-formula9-0954406211435195" xlink:href="10.1177_0954406211435195-eq9.tif"/></disp-formula>
</p>
</sec>
<sec id="sec9-0954406211435195"><title>Non-rigid registration</title>
<p>Let <italic>f(x,y)</italic> be a reference image and <italic>g(x′,y′)</italic> a test image, and <italic>(x,y)</italic> is related to <italic>(x′,y′)</italic> by an affine transformation. <italic>g(x′,y′)</italic> can be approximated with a truncated first-order Taylor expansion as
<disp-formula id="disp-formula10-0954406211435195"><label>(10)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block" id="mml-disp10-0954406211435195"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>xa</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ya</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:mi>   </mml:mi><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>xa</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ya</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic alternate-form-of="disp-formula10-0954406211435195" xlink:href="10.1177_0954406211435195-eq10.tif"/></disp-formula>
where <italic>g<sub>x</sub></italic> represents the partial derivative of <italic>g</italic> with respect to <italic>x</italic> and <italic>g<sub>y</sub></italic> the partial derivative with respect to <italic>y.</italic> The choice of the first-order model guarantees smoothness, thus alleviating the need for regularisation of the solution. Let <inline-formula id="ilm5-0954406211435195"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math5-0954406211435195"><mml:mrow><mml:mover><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> = [<italic>a</italic><sub>1</sub>, <italic>a</italic><sub>2</sub>, <italic>a</italic><sub>3</sub>, <italic>a</italic><sub>4</sub>] be the vector of parameters and Ω is the size of the image. The corresponding least-squares criterion<sup><xref ref-type="bibr" rid="bibr53-0954406211435195">53</xref></sup>
<disp-formula id="disp-formula11-0954406211435195"><label>(11)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block" id="mml-disp11-0954406211435195"><mml:mrow><mml:mi>J</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mover><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>∈</mml:mo><mml:mi>Ω</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><graphic alternate-form-of="disp-formula11-0954406211435195" xlink:href="10.1177_0954406211435195-eq11.tif"/></disp-formula>
can be re-written as
<disp-formula id="disp-formula12-0954406211435195"><label>(12)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block" id="mml-disp12-0954406211435195"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:mi>J</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mover><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>∈</mml:mo><mml:mi>Ω</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo> </mml:mo><mml:mo>[</mml:mo></mml:mrow><mml:mi>f</mml:mi><mml:mo>-</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>xa</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ya</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:mi>   </mml:mi><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>xa</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ya</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mrow><mml:mo> </mml:mo><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic alternate-form-of="disp-formula12-0954406211435195" xlink:href="10.1177_0954406211435195-eq12.tif"/></disp-formula>
</p>
<p>Now, the problem consists of finding the values of <inline-formula id="ilm6-0954406211435195"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math6-0954406211435195"><mml:mrow><mml:mover><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> that minimise <italic>J</italic>. Using
<disp-formula id="disp-formula13-0954406211435195"><label>(13)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block" id="mml-disp13-0954406211435195"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo>-</mml:mo><mml:mi>g</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>xg</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>yg</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:mi>χ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable align="left"><mml:mtr><mml:mtd columnalign="center"><mml:mtr><mml:mtd columnalign="center" columnspan="1"><mml:mrow><mml:msub><mml:mrow><mml:mi>xg</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:msub><mml:mrow><mml:mi>yg</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:msub><mml:mrow><mml:mi>xg</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:msub><mml:mrow><mml:mi>yg</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mtable align="left"><mml:mtr><mml:mtd columnalign="center"><mml:mtr><mml:mtd columnalign="center" columnspan="1"><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic alternate-form-of="disp-formula13-0954406211435195" xlink:href="10.1177_0954406211435195-eq13.tif"/></disp-formula>
where matrices <italic>x</italic>, <italic>g<sub>x</sub></italic> and <italic>g<sub>y</sub></italic> are of the same dimension as the image. Next, equation (<xref ref-type="disp-formula" rid="disp-formula12-0954406211435195">12</xref>) can be written as
<disp-formula id="disp-formula14-0954406211435195"><label>(14)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block" id="mml-disp14-0954406211435195"><mml:mrow><mml:mi>J</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>Y</mml:mi><mml:mo>-</mml:mo><mml:mi>χ</mml:mi><mml:mi>θ</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:msup><mml:mi/><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><graphic alternate-form-of="disp-formula14-0954406211435195" xlink:href="10.1177_0954406211435195-eq14.tif"/></disp-formula>
differentiating with respect to <italic>θ</italic> and setting to zero, the least-squares estimate is
<disp-formula id="disp-formula15-0954406211435195"><label>(15)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block" id="mml-disp15-0954406211435195"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>χ</mml:mi><mml:msup><mml:mrow><mml:mi>χ</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi/><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi>χ</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi>Y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><graphic alternate-form-of="disp-formula15-0954406211435195" xlink:href="10.1177_0954406211435195-eq15.tif"/></disp-formula>
where <inline-formula id="ilm7-0954406211435195"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math7-0954406211435195"><mml:mrow><mml:mi>χ</mml:mi><mml:msup><mml:mrow><mml:mi>χ</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is the Gramian matrix.</p>
</sec>
</sec>
<sec id="sec10-0954406211435195"><title>Blood flow estimation</title>
<p>As mentioned earlier, blood flow can be estimated only if it is possible to make an estimate of the blood volume in the vascular bed and the time which the blood stays in the vascular bed. An estimate of vascular volume could be inferred by measuring the diameter of the feeding and draining vessels and assuming that their diameters are related to those of all the vessels in the area.<sup><xref ref-type="bibr" rid="bibr25-0954406211435195">25</xref></sup> To estimate the retinal circulation time, two parameters are computed: MTT and MDV; these parameters are estimated using fluorometry and analysis of the micro-vascular response. This section provides the details for retinal blood flow estimation from FA using the aforementioned procedures.</p>
<sec id="sec11-0954406211435195"><title>Dye dilution technique</title>
<p>Dye dilution curves represent the measurement of fluorescence at a particular location and its changes with time. Assuming that the volume of blood per unit area is constant and the vessel intensity is related to the concentration of the dye within it, dilution curves are constructed at corresponding locations on the supplying artery and draining vein, and then fitted to a mathematical model. In this case, the initial circulation of the dye is fitted to a Weibull model as
<disp-formula id="disp-formula16-0954406211435195"><label>(16)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block" id="mml-disp16-0954406211435195"><mml:mrow><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>K</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>β</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>exp</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><graphic alternate-form-of="disp-formula16-0954406211435195" xlink:href="10.1177_0954406211435195-eq16.tif"/></disp-formula>
where <italic>K</italic> scales the curve along the vertical axis, <italic>t</italic><sub>0</sub> represents the arrival time, <italic>α</italic> scales the curve along the horizontal axis and <italic>β</italic> defines the shape of the curve. The model is fitted, at interactively selected measurement locations, using the least-squares algorithm. From the resulting curves, the venous transit-time, <inline-formula id="ilm8-0954406211435195"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math8-0954406211435195"><mml:mrow><mml:mover><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>, and arterial transit-time, <inline-formula id="ilm9-0954406211435195"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math9-0954406211435195"><mml:mrow><mml:mover><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>, are then calculated as
<disp-formula id="disp-formula17-0954406211435195"><label>(17)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block" id="mml-disp17-0954406211435195"><mml:mrow><mml:mover><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mtable align="left"><mml:mtr><mml:mtd columnalign="center"><mml:mtr><mml:mtd columnalign="center" columnspan="1"><mml:mrow><mml:mo>;</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mover><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic alternate-form-of="disp-formula17-0954406211435195" xlink:href="10.1177_0954406211435195-eq17.tif"/></disp-formula>
where <italic>I<sub>v</sub></italic>(<italic>t</italic>) and <italic>I<sub>a</sub></italic>(<italic>t</italic>) correspond to the intensity profiles during the venous and arterial phases, respectively. The mean retinal transit-time, MTT, is computed as the difference between the venous and arterial transit-times
<disp-formula id="disp-formula18-0954406211435195"><label>(18)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block" id="mml-disp18-0954406211435195"><mml:mrow><mml:mtext>MTT</mml:mtext><mml:mo>=</mml:mo><mml:mover><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>-</mml:mo><mml:mover><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow></mml:math><graphic alternate-form-of="disp-formula18-0954406211435195" xlink:href="10.1177_0954406211435195-eq18.tif"/></disp-formula>
</p>
<p>Furthermore, additional parameters can be extracted from the fitted curves. These parameters include the time of arrival, which indicates the time taken for the dye to arrive at a specific point in the retina and is calculated from the fitted parameters, the time of maximum intensity, <italic>t</italic><sub>100</sub><italic>,</italic> which indicates the time taken by the bolus as a whole to reach a specific point in the retina<sup><xref ref-type="bibr" rid="bibr31-0954406211435195">31</xref></sup> and is calculated by finding the roots of the fitted curve via the Newton–Raphson method, the rise time, <italic>t<sub>r</sub></italic> = <italic>t</italic><sub>100</sub> − <italic>t</italic><sub>0</sub>, which indicates how the bolus has become dispersed by the time it reaches a specified point in the retina and is calculated as the difference between time of maximum intensity and arrival time, and the MDV in a vessel segment of known length, which is calculated as the vessel segment length divided by the difference between the arrival times at its two.</p>
<p>Even though, this technique provides good transit-time estimation, early recirculation of the dye or vascular abnormalities influence the downward curve shape, which represents the draining of the vein; this situation significantly influences the fitting procedure. Analysis of the vascular response to the impulse copes with this limitation.</p>
</sec>
<sec id="sec12-0954406211435195"><title>Analysis of the micro-vascular response</title>
<p>The acquired angiogram sequence depends on a combination of optical characteristics, namely, optics of the eye ball and camera. Therefore, to characterise the micro-vascular retinal system, it is necessary to compute its response to the impulse, that is, the vessel intensity is considered as the convolution between the micro-vascular transfer function and a known input
<disp-formula id="disp-formula19-0954406211435195"><label>(19)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block" id="mml-disp19-0954406211435195"><mml:mrow><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>h</mml:mi><mml:mo>*</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><graphic alternate-form-of="disp-formula19-0954406211435195" xlink:href="10.1177_0954406211435195-eq19.tif"/></disp-formula>
</p>
<p>Assuming <italic>u</italic>(<italic>t</italic>) = <italic>δ</italic>(<italic>t</italic>), <italic>h</italic>(<italic>t</italic>) takes the shape of <italic>I</italic>(<italic>t</italic>) but scaled along the vertical axis and shifted in time. Regarding the arterial concentration as the input of the system and the venous concentration as its output, venous concentration is given by
<disp-formula id="disp-formula20-0954406211435195"><label>(20)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block" id="mml-disp20-0954406211435195"><mml:mrow><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn> </mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munderover><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><graphic alternate-form-of="disp-formula20-0954406211435195" xlink:href="10.1177_0954406211435195-eq20.tif"/></disp-formula>
where <italic>v</italic>(<italic>i</italic>) and <italic>a</italic>(<italic>i</italic> − <italic>j</italic>) represent the venous and arterial concentrations at a time <italic>i</italic> and <italic>i</italic> − <italic>j</italic>, respectively. The deconvolution process can be performed iteratively in a least-squares fashion. This consists of finding the function <italic>h</italic> that minimises
<disp-formula id="disp-formula21-0954406211435195"><label>(21)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block" id="mml-disp21-0954406211435195"><mml:mrow><mml:mi>J</mml:mi><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn> </mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn> </mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munderover><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><graphic alternate-form-of="disp-formula21-0954406211435195" xlink:href="10.1177_0954406211435195-eq21.tif"/></disp-formula>
where <italic>h</italic> is restricted to a function of the form
<disp-formula id="disp-formula22-0954406211435195"><label>(22)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block" id="mml-disp22-0954406211435195"><mml:mrow><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>K</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>β</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>exp</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><graphic alternate-form-of="disp-formula22-0954406211435195" xlink:href="10.1177_0954406211435195-eq22.tif"/></disp-formula>
and <italic>a</italic> and <italic>v</italic> contain the initial passage of the dye. The MTT of the micro-vascular bed is given by τ. Moreover, the area under the resulting curve represents the fractional volume of the micro-vascular bed. Therefore, the blood flow, <italic>Q</italic>, can be calculated by dividing the area under the curve by τ.</p>
</sec>
</sec>
</sec>
<sec id="sec13-0954406211435195" sec-type="results"><title>Results</title>
<p>This section presents the results achieved by following the proposed approach. First, the results of the vessel segmentation stage are presented, followed by the results of the image registration. Finally, the estimation of the haemodynamics parameters obtained with both the dye dilution and analysis of the vascular response methods are tabulated and compared with previous results reported in literature. The performance of the proposed approach is demonstrated using a dataset, which was provided by the Chelsea and Westminster Hospital, London. The dataset contains retinal angiograms of control patients, and pathologies such as wet AMD and branch retinal vein occlusion (BRVO). Retinal images are black and white, 1032 × 1320 pixels and were acquired using a single field of view protocol centred in the macula. The dataset contains two angiograms of control patients with 35 images each one, three angiograms of patients affected by wet AMD with 52 images each and two angiograms of patients with BRVO with 46 images each.</p>
<sec id="sec14-0954406211435195"><title>Vessel segmentation</title>
<p>The first step in order to extract the vascular network is vessel regions estimation which, as mentioned earlier, is based on mathematical morphology operations and vessel enhancement. <xref ref-type="fig" rid="fig4-0954406211435195">Figure 4</xref> shows an angiogram frame containing bright and dark vessels, uneven background and also the so-called tram-line effect. It also shows the estimated vessel regions. From this image, it is easy to perceive the robustness of the method in detection of vascular structures.
<fig id="fig4-0954406211435195" position="float"><label>Figure 4.</label><caption><p>Initial segmentation results for an image with bright and dark vessels, and in the presence of the tram-line effect: (a) original image and (b) original image with initial segmentation superimposed.</p></caption><graphic xlink:href="10.1177_0954406211435195-fig4.tif"/></fig></p>
<p>After vessel regions estimation, cross-sectional profiles are computed and the centrelines and edges are traced using the first- and second-order directional derivatives, and phase congruency information. <xref ref-type="fig" rid="fig5-0954406211435195">Figure 5</xref> shows a segment of a vessel with the tram-line effect, the location of computation of a cross-sectional profile and the features involved in the computation of the centreline and vessel borders.
<fig id="fig5-0954406211435195" position="float"><label>Figure 5.</label><caption><p>Computation of centreline and borders for a vessel with the tram-line effect: (a) location of interest, (b) features involved in the computation and (c) computed centreline and vessel borders.</p></caption><graphic xlink:href="10.1177_0954406211435195-fig5.tif"/></fig></p>
<p>From the features shown in <xref ref-type="fig" rid="fig5-0954406211435195">Figure 5</xref>(b), it is possible to identify the tram-line effect as composed of three consecutive vessels, i.e. two bright vessels bounding a dark one. The outermost edges of the bright vessels are assumed to be vessel edges, with the centreline defined in the middle of these edges. Each vessel segment is represented by a list of nodes, which contains the spatial coordinates of the centreline and edges, and the grey level vessel profile. Centrelines are smoothed using b-splines and the vessel edges are adjusted accordingly. <xref ref-type="fig" rid="fig6-0954406211435195">Figure 6</xref> shows the spline interpolation of the centreline, the adjusted edges and the extracted vessel segment.
<fig id="fig6-0954406211435195" position="float"><label>Figure 6.</label><caption><p>Vessel centreline and border calculation: (a) smoothing of the centreline (blue points correspond to the vessel edges, green points to the centreline points, while the blue line to the smoothed centreline), (b) adjustment of edge location following centreline smoothing and (c) extracted vessel segment.</p></caption><graphic xlink:href="10.1177_0954406211435195-fig6.tif"/></fig></p>
</sec>
<sec id="sec15-0954406211435195"><title>Image registration</title>
<p>Following vessel segmentation, extracted vessels are used as input features for the image registration algorithm, which establishes the base image, the image taken before dye injection, as reference image and aligns subsequent images to this reference. There are two main reasons for selecting the aforementioned image as reference. First, prior to dye injection, there is no patient discomfort and hence the angiographer can focus, appropriately, on the macula, including the most relevant features in the fundus image. Second, there are no areas of abnormal fluorescence, which can mislead the registration procedure. <xref ref-type="fig" rid="fig7-0954406211435195">Figure 7</xref> shows the extracted vessels corresponding to the reference image and a test image; dark vessels represent the test image and bright vessels the reference one. It also shows the result of the registration when the test image was warped so as to match the reference one. The corresponding grey level images are shown in <xref ref-type="fig" rid="fig8-0954406211435195">Figure 8</xref>.
<fig id="fig7-0954406211435195" position="float"><label>Figure 7.</label><caption><p>Results of the image registration stage. Vessels from the test and reference images, characterised by dark and bright vessels, respectively, (a) prior to registration and (b) after registration.</p></caption><graphic xlink:href="10.1177_0954406211435195-fig7.tif"/></fig>
<fig id="fig8-0954406211435195" position="float"><label>Figure 8.</label><caption><p>Results of the image registration stage, using the checkerboard representation of images. (a) Target image, (b) test image, (c) prior to registration and (d) after registration.</p></caption><graphic xlink:href="10.1177_0954406211435195-fig8.tif"/></fig></p>
<p>From Figures <xref ref-type="fig" rid="fig7-0954406211435195">7</xref> and <xref ref-type="fig" rid="fig8-0954406211435195">8</xref>, it is possible to visually appreciate the robustness of the registration algorithm, which ensures anatomical correspondence between consecutive frames of the angiogram and allows sequential intensity analysis. The target image is the base image, the image prior to dye injection, and the test image is an image from the early venous phase, which contains bright and dark vessels as well as the so-called tram-line effect. From <xref ref-type="fig" rid="fig7-0954406211435195">Figures 7</xref>(a) and <xref ref-type="fig" rid="fig8-0954406211435195">8</xref>(c), it is easy to perceive that there is no correspondence between anatomic features, i.e. OD, vasculature and fovea, of the involved FA frames. However, retinal feature correspondence is assured by the registration stage, as shown in <xref ref-type="fig" rid="fig7-0954406211435195">Figures 7</xref>(b) and <xref ref-type="fig" rid="fig8-0954406211435195">8</xref>(d), where the OD, vasculature and fovea have been placed at the same location in both frames.</p>
</sec>
<sec id="sec16-0954406211435195"><title>Blood flow quantification</title>
<p>After image registration, measurement points are interactively selected, one on the supplying artery and one on the corresponding draining vein. Then, the intensity cross-sectional profiles are computed perpendicularly to the vessel orientation at the location of the measurement points and subsequently the mean intensity for each measurement point at a specific time instant is calculated. With this information, dye dilution curves are then constructed by fitting the data to a Weibull function, corresponding to the initial passage of the dye. The resulting curves are then utilised to compute retinal haemodynamics. <xref ref-type="fig" rid="fig9-0954406211435195">Figure 9</xref> shows the results of the fitting procedure for the control, wet AMD and BRVO angiograms.
<fig id="fig9-0954406211435195" position="float"><label>Figure 9.</label><caption><p>MTT estimation using dye dilution curves. Data corresponding to the initial passage of the dye were fitted to a Weibull function. Data from (a) control, (b) wet AMD and (c) branch retinal vein occlusion angiograms.</p></caption><graphic xlink:href="10.1177_0954406211435195-fig9.tif"/></fig></p>
<p>As it can be seen in <xref ref-type="fig" rid="fig9-0954406211435195">Figure 9</xref>, there is a very short delay in the arrival time of the vein, when compared to the artery. However, as time passes by the time difference increases particularly for the group of patients with BRVO. In addition, larger arrival times occur for the wet AMD group (14.27 s) and even larger for the BRVO group (20.73 s). Nevertheless, this delay can be a result of arterial blood pressure, rather than an ocular disease.</p>
<p>Venous and arterial transit-times are calculated from the time coordinates of the centroid of the corresponding curve and the MTT, as the difference between the venous and arterial transit-times. <xref ref-type="table" rid="table3-0954406211435195">Table 3</xref> provides the values obtained from the aforementioned curves, along with the estimated vein and arterial diameters.
<table-wrap id="table3-0954406211435195" position="float"><label>Table 3.</label><caption><p>MTT and blood flow computed from the curves shown in <xref ref-type="fig" rid="fig9-0954406211435195">Figure 9</xref>.</p></caption>
<graphic alternate-form-of="table3-0954406211435195" xlink:href="10.1177_0954406211435195-table3.tif"/>
<table frame="hsides"><thead align="left">
<tr><th rowspan="2"/><th align="center" colspan="2">Diameter (pixel)<hr/></th>
<th align="center" colspan="2">Transit time (s)<hr/></th>
<th rowspan="2">MTT (s)</th>
<th rowspan="2">Flow (AU)</th>
<th rowspan="2">MSE</th></tr>
<tr><th>Artery</th>
<th>Vein</th>
<th>Artery</th>
<th>Vein</th></tr></thead>
<tbody align="left">
<tr>
<td>Control</td>
<td>5.6 ± 0.2</td>
<td>7.5 ± 0.25</td>
<td>31.82</td>
<td>34.65</td>
<td>2.82 ± 1.12</td>
<td>31.03 ± 1.34</td>
<td>0.07</td></tr>
<tr>
<td>AMD</td>
<td>7.27 ± 2.29</td>
<td>8.79 ± 2.44</td>
<td>47.26</td>
<td>52.09</td>
<td>4.83 ± 1.77</td>
<td>26.91 ± 1.73</td>
<td>0.10</td></tr>
<tr>
<td>BRVO</td>
<td>7.52 ± 1.72</td>
<td>9.14 ± 2.17</td>
<td>76.87</td>
<td>84.13</td>
<td>7.26 ± 3.74</td>
<td>19.29 ± 3.69</td>
<td>0.11</td></tr>
</tbody>
</table>
</table-wrap></p>
<p>As expected, MTT increased for AMD and BRVO, in relation to the control group. In the same way, blood flow decreased noticeably, particularly in the BRVO case. However, variability between data also increased, demonstrating how complex this analysis becomes. It is interesting to note changes in the vessel diameters, which may be related to a mechanism of the eye to supply the required blood demand, when blood flow decreases.</p>
<p>Additional haemodynamics parameters are also computed from those curves, namely, arrival time, time of max intensity, rising time and AVP time. <xref ref-type="table" rid="table4-0954406211435195">Table 4</xref> gives the computed values for these parameters.
<table-wrap id="table4-0954406211435195" position="float"><label>Table 4.</label><caption><p>Additional haemodynamics parameters computed from the curves shown in <xref ref-type="fig" rid="fig9-0954406211435195">Figure 9</xref>.</p></caption>
<graphic alternate-form-of="table4-0954406211435195" xlink:href="10.1177_0954406211435195-table4.tif"/>
<table frame="hsides"><thead align="left">
<tr><th rowspan="2"/><th align="center" colspan="2"><italic>t</italic><sub>0</sub> (s)<hr/></th>
<th align="center" colspan="2"><italic>t</italic><sub>100</sub> (s)<hr/></th>
<th align="center" colspan="2"><italic>t<sub>r</sub></italic> (s)<hr/></th>
<th rowspan="2">AVP (s)</th></tr>
<tr><th>Artery</th>
<th>Vein</th>
<th>Artery</th>
<th>Vein</th>
<th>Artery</th>
<th>Vein</th></tr></thead>
<tbody align="left">
<tr>
<td>Normal</td>
<td>12.53</td>
<td>13.83</td>
<td>25.25</td>
<td>26.30</td>
<td>12.73</td>
<td>12.47</td>
<td>1.31</td></tr>
<tr>
<td>AMD</td>
<td>14.27</td>
<td>17.03</td>
<td>42.71</td>
<td>45.77</td>
<td>28.44</td>
<td>28.73</td>
<td>2.76</td></tr>
<tr>
<td>BRVO</td>
<td>20.73</td>
<td>29.84</td>
<td>54.12</td>
<td>63.22</td>
<td>33.39</td>
<td>33.38</td>
<td>9.11</td></tr>
</tbody>
</table>
<table-wrap-foot>
<fn id="table-fn3-0954406211435195"><p>Note: <italic>t</italic><sub>0</sub>, arrival time; <italic>t</italic><sub>100</sub>, time of maximum intensity; <italic>t<sub>r</sub></italic> , rising time; and AVP, arteriovenous passage time.</p></fn></table-wrap-foot>
</table-wrap></p>
<p>On the other hand, identification of the micro-vascular transfer function is carried out from the arterial input and venous output using linear least-squares estimation. In the identification procedure, the shape of the transfer function is restricted to a Weibull function. <xref ref-type="fig" rid="fig10-0954406211435195">Figure 10</xref> illustrates the micro-vascular responses obtained from the original data.
<fig id="fig10-0954406211435195" position="float"><label>Figure 10.</label><caption><p>Micro-vascular response for (a) control, (b) wet AMD and (c) branch retinal vein occlusion.</p></caption><graphic xlink:href="10.1177_0954406211435195-fig10.tif"/></fig></p>
<p>Numerical analysis of these responses provides the MTT, differential blood volume and flow. The MTT and blood flow values are given in <xref ref-type="table" rid="table5-0954406211435195">Table 5</xref>.
<table-wrap id="table5-0954406211435195" position="float"><label>Table 5.</label><caption><p>MTT and blood flow computed from the curves shown in <xref ref-type="fig" rid="fig10-0954406211435195">Figure 10</xref>.</p></caption>
<graphic alternate-form-of="table5-0954406211435195" xlink:href="10.1177_0954406211435195-table5.tif"/>
<table frame="hsides"><thead align="left">
<tr><th/>
<th>MTT (s)</th>
<th>Flow (AU)</th></tr></thead>
<tbody align="left">
<tr>
<td>Control</td>
<td>2.36 ± 0.06</td>
<td>30.00 ± 0.13</td></tr>
<tr>
<td>AMD</td>
<td>5.53 ± 2.16</td>
<td>28.02 ± 2.17</td></tr>
<tr>
<td>BRVO</td>
<td>6.64 ± 3.89</td>
<td>24.38 ± 3.94</td></tr>
</tbody>
</table>
</table-wrap></p>
<p>By comparing the data in <xref ref-type="table" rid="table3-0954406211435195">Table 3</xref> with the data in <xref ref-type="table" rid="table5-0954406211435195">Table 5</xref>, for the case of the control group, it can be seen that the estimates of MTT and blood flow computed with both methodologies are close to each other. However, these parameters appear increased, in <xref ref-type="table" rid="table5-0954406211435195">Table 5</xref>, for both the cases of wet AMD and BRVO. Nevertheless, accounting for the variability in the dye dilution estimation, the calculated parameters are comparable and consistent with the ones reported in literature, which range from 2.69<sup><xref ref-type="bibr" rid="bibr54-0954406211435195">54</xref></sup> to 4.7 s<sup><xref ref-type="bibr" rid="bibr24-0954406211435195">24</xref></sup> for MTT of normal patients. Reported values for AVP range from 1.45<sup><xref ref-type="bibr" rid="bibr2-0954406211435195">2</xref><xref ref-type="bibr" rid="bibr7-0954406211435195">7</xref></sup> to 2.01 s,<sup><xref ref-type="bibr" rid="bibr30-0954406211435195">30</xref></sup> which are close to the results obtained in this study.</p>
<p>By comparing the data in <xref ref-type="table" rid="table3-0954406211435195">Table 3</xref> with those in <xref ref-type="table" rid="table5-0954406211435195">Table 5</xref>, for the case of the control group, it can be seen that the estimates of MTT and blood flow computed with both methodologies are close to each other. However, these parameters appear increased, in <xref ref-type="table" rid="table5-0954406211435195">Table 5</xref>, for both the cases of wet AMD and BRVO. Nevertheless, accounting for the variability in the dye dilution estimation, the calculated parameters are comparable and consistent with the ones reported in literature, which range from 2.69<sup><xref ref-type="bibr" rid="bibr54-0954406211435195">54</xref></sup> to 4.7 s<sup><xref ref-type="bibr" rid="bibr24-0954406211435195">24</xref></sup> for MTT of normal patients. Reported values for AVP range from 1.45<sup><xref ref-type="bibr" rid="bibr2-0954406211435195">2</xref><xref ref-type="bibr" rid="bibr7-0954406211435195">7</xref></sup> to 2.01 s,<sup><xref ref-type="bibr" rid="bibr30-0954406211435195">30</xref></sup> which are close to the results obtained in this study.</p>
</sec>
</sec>
<sec id="sec17-0954406211435195" sec-type="conclusions"><title>Conclusions</title>
<p>This article presented a methodology for measurement of haemodynamics parameters of the human retina from FA. The methodology consist of vessel segmentation, retinal image registration and transit-time estimation. The estimated parameters included MTT, AVP, arrival time, rising time, time of maximum intensity and blood flow. The data used to demonstrate the performance of the aforementioned methodology contains angiograms of control patients and patients with pathologies such as wet AMD and BRVO. The results achieved herein are comparable with those reported in literature.</p>
<p>The segmentation stage consists of two steps: initial vasculature segmentation and vessel boundary calculation. This analysis includes features such as the first- and second-order directional derivatives, and phase congruency, along with some morphological operations. This method allows simultaneous detection of dark and bright vessels when applied to fluorescein angiograms of the human retina. The results indicate that the method overcomes a defect of previous methods, which are primarily based on the vesselness measure, the presence of the tram-line effect. In addition, the proposed approach is able to localise vessels of varying intensities.</p>
<p>The registration strategy first performs a rigid global alignment, which accounts for large translations and rotation, followed by a non-rigid registration based upon an iterative least-squares algorithm, which performs projective scaling and small translations and rotation. This methodology showed robustness and accuracy in registration of images of the human retina. Its main disadvantage is the increased computational times.</p>
<p>The blood transit-time estimation was calculated using fluorometry and analysis of the micro-vascular response. In the former case, changes in intensity with time were illustrated as curves, which were then fitted to a Weibull distribution. The difference between the centroids of the resulting curves provided the MTT. In the latter case, identification of micro-vascular response was performed using a least-squares algorithm and a fitting procedure. Haemodynamic factors were calculated from the fitted parameters.</p>
<p>The presented methodology is a step forward in the development of an automated computer vision system for quantitative analysis of fluorescein angiograms to assist NHS clinicians in early diagnosis of AMD. Additional work will involve the evaluation of the automated system on a large dataset consisting of patients with normal retinas, as well as ones affected by wet AMD and BRVO. A further research direction is to compare the results of the proposed system to the microsphere blood flow studies in animals, which are considered to be the gold standard.</p>
</sec>
</body>
<back>
<sec id="sec18-0954406211435195"><title>Funding</title>
<p>This study is supported by the Programme AlBan, the European Union Programme of High Level Scholarships for Latin America, scholarship no. [07D403130CO], Cauca University-Colombia and Colombia’s National Department of Science, Technology and Innovation – COLCIENCIAS.</p>
</sec>
<ack><title>Acknowledgement</title>
<p>The authors thank Dr Nigel Jones from Chelsea and Westminster Hospital, London, UK for the provision of the angiography datasets.</p></ack>
<ref-list>
<title>References</title>
<ref id="bibr1-0954406211435195"><label>1</label><citation citation-type="book"><person-group person-group-type="author"><name><surname>Lovie-Kitchin</surname><given-names>JE</given-names></name><name><surname>Bowman</surname><given-names>KJ</given-names></name></person-group>. <source>Senile macular degeneration: management and rehabilitation</source>. <publisher-loc>London</publisher-loc>: <publisher-name>Butterworth Publishers</publisher-name>, <year>1985</year>.</citation></ref>
<ref id="bibr2-0954406211435195"><label>2</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Owen</surname><given-names>CG</given-names></name><name><surname>Fletcher</surname><given-names>AE</given-names></name><name><surname>Donoghue</surname><given-names>M</given-names></name><etal/></person-group>. <article-title>How big is the burden of visual loss caused by age related macular degeneration in the United Kingdom?</article-title>. <source>Br J Ophthalmol</source> <year>2003</year>; <volume>87</volume>: <fpage>312</fpage>–<lpage>317</lpage>.</citation></ref>
<ref id="bibr3-0954406211435195"><label>3</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Bressler Neil</surname><given-names>M</given-names></name><name><surname>Bressler Susan</surname><given-names>B</given-names></name><name><surname>West Sheila</surname><given-names>K</given-names></name><etal/></person-group>. <article-title>The grading and prevalence of macular degeneration in chesapeake bay watermen</article-title>. <source>Arch Ophthalmol</source> <year>1989</year>; <volume>107</volume>(<issue>6</issue>): <fpage>847</fpage>–<lpage>852</lpage>.</citation></ref>
<ref id="bibr4-0954406211435195"><label>4</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Charles</surname><given-names>N</given-names></name></person-group>. <article-title>Estimates of the number of older people with a visual impairment in the UK</article-title>. <source>Br J Vis Impair</source> <year>2007</year>; <volume>25</volume>: <fpage>199</fpage>–<lpage>215</lpage>.</citation></ref>
<ref id="bibr5-0954406211435195"><label>5</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Azad</surname><given-names>R</given-names></name><name><surname>Chandra</surname><given-names>P</given-names></name><name><surname>Gupta</surname><given-names>R</given-names></name></person-group>. <article-title>The economic implications of the use of anti-vascular endothelial growth factor drugs in age-related macular degeneration</article-title>. <source>Indian J Ophthalmol</source> <year>2007</year>; <volume>55</volume>(<issue>6</issue>): <fpage>441</fpage>–<lpage>443</lpage>.</citation></ref>
<ref id="bibr6-0954406211435195"><label>6</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>AF</given-names></name></person-group>. <article-title>The growing importance of pharmacoeconomics: the case of age-related macular degeneration</article-title>. <source>Br J Ophthalmol</source> <year>2010</year>; <volume>94</volume>(<issue>9</issue>): <fpage>1116</fpage>–<lpage>1117</lpage>.</citation></ref>
<ref id="bibr7-0954406211435195"><label>7</label><citation citation-type="other"><comment>Wang R, An L and Wilson D. Visualizing ocular perfusion with optical microangiography. <italic>Biomed Opt Med Imaging</italic> 2010; DOI: 10.1117/2.1201002.002571. SPIE Newsroom</comment>.</citation></ref>
<ref id="bibr8-0954406211435195"><label>8</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Rechtman</surname><given-names>E</given-names></name><name><surname>Harris</surname><given-names>A</given-names></name><name><surname>Kumar</surname><given-names>R</given-names></name><etal/></person-group>. <article-title>An update on retinal circulation assessment technologies</article-title>. <source>Curr Eye Res</source> <year>2003</year>; <volume>27</volume>(<issue>6</issue>): <fpage>329</fpage>–<lpage>343</lpage>.</citation></ref>
<ref id="bibr9-0954406211435195"><label>9</label><citation citation-type="book"><person-group person-group-type="author"><name><surname>Spaeth</surname><given-names>GL</given-names></name></person-group>. <source>The pathogenesis of nerve damage in glaucoma: contributions of fluorescein angiography</source>. <publisher-loc>London</publisher-loc>: <publisher-name>Grune &amp; Stratton</publisher-name>, <year>1977</year>.</citation></ref>
<ref id="bibr10-0954406211435195"><label>10</label><citation citation-type="other"><comment>Gilmore ED. <italic>Retinal blood flow and vascular reactivity in diabetic retinopathy</italic>. A thesis presented to the University of Waterloo in fulfillment of the thesis requirement for the degree of Doctor of Philosophy in Vision Science, Waterloo, ON, Canada, 2006</comment>.</citation></ref>
<ref id="bibr11-0954406211435195"><label>11</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Tikellis</surname><given-names>GJ</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>Tapp</surname><given-names>R</given-names></name><etal/></person-group>. <article-title>The relationship of retinal vascular calibre to diabetes and retinopathy: the Australian Diabetes, Obesity and Lifestyle (AusDiab) study</article-title>. <source>Diabetologia</source> <year>2007</year>; <volume>50</volume>: <fpage>2263</fpage>–<lpage>2271</lpage>.</citation></ref>
<ref id="bibr12-0954406211435195"><label>12</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Garzozi</surname><given-names>HJ</given-names></name><name><surname>Shoham</surname><given-names>N</given-names></name><name><surname>Chung</surname><given-names>HS</given-names></name><etal/></person-group>. <article-title>Ocular blood flow measurements and their importance in glaucoma and age-related macular degeneration</article-title>. <source>IMAJ</source> <year>2001</year>; <volume>3</volume>: <fpage>443</fpage>–<lpage>448</lpage>.</citation></ref>
<ref id="bibr13-0954406211435195"><label>13</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Harris</surname><given-names>A</given-names></name><name><surname>Chung</surname><given-names>HS</given-names></name><name><surname>Ciulla</surname><given-names>TA</given-names></name><etal/></person-group>. <article-title>Progress in measurement of ocular blood flow and relevance to our understanding of glaucoma and age-related macular degeneration</article-title>. <source>Prog Retin Eye Res</source> <year>1999</year>; <volume>18</volume>(<issue>5</issue>): <fpage>669</fpage>–<lpage>687</lpage>.</citation></ref>
<ref id="bibr14-0954406211435195"><label>14</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Silver</surname><given-names>DM</given-names></name><name><surname>Farrell</surname><given-names>RA</given-names></name><name><surname>Langham</surname><given-names>ME</given-names></name><etal/></person-group>. <article-title>Estimation of pulsatile ocular blood flow from intraocular pressure</article-title>. <source>Acta Ophthalmol</source> <year>1989</year>; <volume>191</volume>: <fpage>25</fpage>–<lpage>29</lpage>.</citation></ref>
<ref id="bibr15-0954406211435195"><label>15</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Silver</surname><given-names>DM</given-names></name><name><surname>Geyer</surname><given-names>O</given-names></name></person-group>. <article-title>Pressure-volume relation for the living human eye</article-title>. <source>Curr Eye Res</source> <year>2000</year>; <volume>20</volume>: <fpage>115</fpage>–<lpage>120</lpage>.</citation></ref>
<ref id="bibr16-0954406211435195"><label>16</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Schmetterer</surname><given-names>LF</given-names></name><name><surname>Lexer</surname><given-names>F</given-names></name><name><surname>Unfried</surname><given-names>CJ</given-names></name><etal/></person-group>. <article-title>Topical measurement of fundus pulsations</article-title>. <source>Opt Eng</source> <year>1995</year>; <volume>34</volume>: <fpage>711</fpage>–<lpage>716</lpage>.</citation></ref>
<ref id="bibr17-0954406211435195"><label>17</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Garcia</surname><given-names>JP</given-names><suffix>Jr</suffix></name><name><surname>Garcia</surname><given-names>PT</given-names></name><name><surname>Rosen</surname><given-names>RB</given-names></name></person-group>. <article-title>Retinal blood flow in the normal human eye using the canon laser blood flowmeter</article-title>. <source>Ophthalmic Res</source> <year>2002</year>; <volume>34</volume>: <fpage>295</fpage>–<lpage>299</lpage>.</citation></ref>
<ref id="bibr18-0954406211435195"><label>18</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Grunwald</surname><given-names>JE</given-names></name><name><surname>Metelitsina</surname><given-names>TI</given-names></name><name><surname>DuPont</surname><given-names>JC</given-names></name><etal/></person-group>. <article-title>Reduced foveolar choroidal blood flow in eyes with increasing AMD severity</article-title>. <source>Invest Ophthalmol Vis Sci</source> <year>2005</year>; <volume>46</volume>(<issue>3</issue>): <fpage>1033</fpage>–<lpage>1038</lpage>.</citation></ref>
<ref id="bibr19-0954406211435195"><label>19</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Rao</surname><given-names>B</given-names></name><name><surname>Yu</surname><given-names>L</given-names></name><name><surname>Chiang</surname><given-names>HK</given-names></name><etal/></person-group>. <article-title>Imaging pulsatile retinal blood flow in human eye</article-title>. <source>J Biomed Opt</source> <year>2008</year>; <volume>13</volume>(<issue>4</issue>): <fpage>040505</fpage>–<lpage>040505</lpage>.</citation></ref>
<ref id="bibr20-0954406211435195"><label>20</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Venkataraman</surname><given-names>ST</given-names></name><name><surname>Hudson</surname><given-names>C</given-names></name><name><surname>Fisher</surname><given-names>JA</given-names></name><etal/></person-group>. <article-title>The impact of hypercapnia on retinal capillary blood flow assessed by scanning laser Doppler flowmetry</article-title>. <source>Microvasc Res</source> <year>2005</year>; <volume>69</volume>: <fpage>149</fpage>–<lpage>155</lpage>.</citation></ref>
<ref id="bibr21-0954406211435195"><label>21</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Caprioli</surname><given-names>J</given-names></name><name><surname>Coleman</surname><given-names>AL.</given-names></name></person-group><collab>Blood Flow in Glaucoma Discussion</collab>. <article-title>Blood pressure, perfusion pressure, and glaucoma</article-title>. <source>Am J Ophthalmol</source> <year>2010</year>; <volume>149</volume>(<issue>5</issue>): <fpage>704</fpage>–<lpage>712</lpage>.</citation></ref>
<ref id="bibr22-0954406211435195"><label>22</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Schmetterer</surname><given-names>L</given-names></name><name><surname>Garhofer</surname><given-names>G</given-names></name></person-group>. <article-title>How can blood flow be measured?</article-title>. <source>Surv Ophthalmol</source> <year>2007</year>; <volume>52</volume>(<issue>Suppl. 2</issue>): <fpage>S132</fpage>–<lpage>S138</lpage>. (<comment>Elsevier Inc</comment>).</citation></ref>
<ref id="bibr23-0954406211435195"><label>23</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Bursell</surname><given-names>S-E</given-names></name><name><surname>Clermont</surname><given-names>AC</given-names></name><name><surname>Kinsley</surname><given-names>BT</given-names></name><etal/></person-group>. <article-title>Retinal blood flow changes in patients with insulin-dependent diabetes mellitus and no diabetic retinopathy. A video fluorescein angiography study</article-title>. <source>Invest Ophthalmol Vis Sci</source> <year>1996</year>; <volume>37</volume>(<issue>5</issue>): <fpage>886</fpage>–<lpage>897</lpage>.</citation></ref>
<ref id="bibr24-0954406211435195"><label>24</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hickam</surname><given-names>JB</given-names></name><name><surname>Frayser</surname><given-names>R</given-names></name></person-group>. <article-title>A photographic method for measuring the mean retinal circulation time using fluorescein</article-title>. <source>Invest Ophthalmol</source> <year>1965</year>; <volume>4</volume>(<issue>5</issue>): <fpage>876</fpage>–<lpage>884</lpage>.</citation></ref>
<ref id="bibr25-0954406211435195"><label>25</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Bulpitt</surname><given-names>CJ</given-names></name><name><surname>Dollery</surname><given-names>CT</given-names></name></person-group>. <article-title>Estimation of retinal blood flow by measurement of the mean circulation time</article-title>. <source>Cardiovasc Res</source> <year>1971</year>; <volume>5</volume>: <fpage>406</fpage>–<lpage>412</lpage>.</citation></ref>
<ref id="bibr26-0954406211435195"><label>26</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hipwell</surname><given-names>JH</given-names></name><name><surname>Manivannan</surname><given-names>A</given-names></name><name><surname>Viera</surname><given-names>P</given-names></name><etal/></person-group>. <article-title>Quantifying changes in retinal circulation: the generation of parametric images from fluorescein angiograms</article-title>. <source>Physiol Meas</source> <year>1998</year>; <volume>19</volume>: <fpage>165</fpage>–<lpage>180</lpage>.</citation></ref>
<ref id="bibr27-0954406211435195"><label>27</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wolf</surname><given-names>S</given-names></name><name><surname>Jung</surname><given-names>F</given-names></name><name><surname>Kiesewetter</surname><given-names>H</given-names></name><etal/></person-group>. <article-title>Video fluorescein angiography: method and clinical application</article-title>. <source>Graefes Arch Clin Exp Ophthalmol</source> <year>1989</year>; <volume>227</volume>: <fpage>145</fpage>–<lpage>151</lpage>.</citation></ref>
<ref id="bibr28-0954406211435195"><label>28</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Bjärnhall</surname><given-names>G</given-names></name><name><surname>Mäepea</surname><given-names>O</given-names></name><name><surname>Sperber</surname><given-names>GO</given-names></name><etal/></person-group>. <article-title>Analysis of mean retinal transit time from fluorescein angiography in human eyes: normal values and reproducibility</article-title>. <source>Acta Ophthalmol Scand</source> <year>2002</year>; <volume>80</volume>: <fpage>652</fpage>–<lpage>655</lpage>.</citation></ref>
<ref id="bibr29-0954406211435195"><label>29</label><citation citation-type="other"><comment>Zhu L, Huang F, von Kerczek CH, et al. Extraction of flow information in choriocapillaris in human eyes from IGC dye angiography images. In: <italic>Proceedings of the IEEE 28th annual northeast bioengineering conference</italic>, Philadelphia, PA, 20–21 April 2002, pp.3–4. Piscataway, NJ: IEEE</comment>.</citation></ref>
<ref id="bibr30-0954406211435195"><label>30</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Koyama</surname><given-names>T</given-names></name><name><surname>Matsuo</surname><given-names>N</given-names></name><name><surname>Shimizu</surname><given-names>K</given-names></name><etal/></person-group>. <article-title>Retinal circulation times in quantitative fluorescein angiography</article-title>. <source>Graefes Arch Clin Exp Ophthalmol</source> <year>1990</year>; <volume>228</volume>(<issue>5</issue>): <fpage>442</fpage>–<lpage>446</lpage>.</citation></ref>
<ref id="bibr31-0954406211435195"><label>31</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Jagoe</surname><given-names>R</given-names></name><name><surname>Arnold</surname><given-names>J</given-names></name><name><surname>Blauth</surname><given-names>C</given-names></name><etal/></person-group>. <article-title>Retinal vessel circulation patterns visualized from a sequence of computer-aligned angiograms</article-title>. <source>Invest Ophthalmol Vis Sci</source> <year>1993</year>; <volume>34</volume>(<issue>10</issue>): <fpage>2881</fpage>–<lpage>2887</lpage>.</citation></ref>
<ref id="bibr32-0954406211435195"><label>32</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Sperber</surname><given-names>GO</given-names></name><name><surname>Alm</surname><given-names>A</given-names></name></person-group>. <article-title>Retinal mean transit time determined with and impulse-response analysis from video fluoresceing angiograms</article-title>. <source>Acta Ophtahlmol Scand</source> <year>1997</year>; <volume>75</volume>(<issue>5</issue>): <fpage>532</fpage>–<lpage>536</lpage>.</citation></ref>
<ref id="bibr33-0954406211435195"><label>33</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Tomic</surname><given-names>L</given-names></name><name><surname>Bjärnhall</surname><given-names>G</given-names></name><name><surname>Mäepea</surname><given-names>O</given-names></name><etal/></person-group>. <article-title>Effects of oxygen and carbon dioxide on human retinal circulation: an investigation using blue field simulation and scanning laser ophthalmoscopy</article-title>. <source>Acta Ophthalmol Scand</source> <year>2005</year>; <volume>83</volume>: <fpage>705</fpage>–<lpage>710</lpage>.</citation></ref>
<ref id="bibr34-0954406211435195"><label>34</label><citation citation-type="other"><comment>Yanuzzi LA, Schatz H and Gitter KA. Interpretation of fluorescein angiograms. In: <italic>The macula a comprehensive text and atlas</italic>. Baltimore, MD: Williams &amp; Wilkins, 1979; pp.31–67</comment>.</citation></ref>
<ref id="bibr35-0954406211435195"><label>35</label><citation citation-type="other"><comment>Vargas R and Liatsis P. Vessel extraction in fluorescein angiograms of the human retina using a supervised classifier. In: <italic>Proceedings of the Developments in E-systems Engineering (DESE)</italic>, London, 6–8 September 2010, pp.23–28. Piscataway, NJ: IEEE</comment>.</citation></ref>
<ref id="bibr36-0954406211435195"><label>36</label><citation citation-type="other"><comment>Frangi A, Niessen WJ, Vincken KL, et al. Multiscale vessel enhancement filtering. In: <italic>Proceedings of the 1st international conference of Medical Image Computing and Computer-Assisted Intervention (MICCAI 1998)</italic>, Cambridge, MA, 11–13 October 1998. Lecture Notes in Computer Science, Vol. 1496, Berlin: Springer Verlag, pp.130–137</comment>.</citation></ref>
<ref id="bibr37-0954406211435195"><label>37</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kovesi</surname><given-names>P</given-names></name></person-group>. <article-title>Image features from phase congruency videre</article-title>. <source>J Comput Vis Res</source> <year>1999</year>; <volume>1</volume>(<issue>3</issue>): <fpage>1</fpage>–<lpage>26</lpage>. (<comment>MIT Press</comment>).</citation></ref>
<ref id="bibr38-0954406211435195"><label>38</label><citation citation-type="other"><comment>Chutatape O, Zheng L and Krishnan S. Retinal blood vessel detection and tracking by matched Gaussian and Kalman filters. In: <italic>Proceedings of the IEEE Engineering in medicine and biology society</italic>, Hong Kong, 29 October–1 November 1998, Vol. 20, pp.3144–3149. Piscataway, NJ: IEEE</comment>.</citation></ref>
<ref id="bibr39-0954406211435195"><label>39</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Can</surname><given-names>A</given-names></name><name><surname>Shen</surname><given-names>H</given-names></name><name><surname>Taylor</surname><given-names>J</given-names></name><etal/></person-group>. <article-title>Rapid automated tracing and feature extraction from retinal fundus images using direct exploratory algorithms</article-title>. <source>IEEE Trans Inf Technol Biomed</source> <year>1999</year>; <volume>3</volume>(<issue>2</issue>): <fpage>125</fpage>–<lpage>138</lpage>.</citation></ref>
<ref id="bibr40-0954406211435195"><label>40</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Gang</surname><given-names>L</given-names></name><name><surname>Stewart</surname><given-names>CV</given-names></name><name><surname>Roysam</surname><given-names>B</given-names></name><etal/></person-group>. <article-title>Predictive scheduling algorithms for real-time feature extraction and spatial referencing: application to retinal image sequences</article-title>. <source>IEEE Trans Biomed Eng</source> <year>2004</year>; <volume>51</volume>(<issue>1</issue>): <fpage>115</fpage>–<lpage>125</lpage>.</citation></ref>
<ref id="bibr41-0954406211435195"><label>41</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Quek</surname><given-names>FKH</given-names></name><name><surname>Kirbas</surname><given-names>C</given-names></name></person-group>. <article-title>Vessel extraction in medical images by wave-propagation and traceback</article-title>. <source>IEEE Trans Med Imaging</source> <year>2001</year>; <volume>20</volume>(<issue>2</issue>): <fpage>117</fpage>–<lpage>131</lpage>.</citation></ref>
<ref id="bibr42-0954406211435195"><label>42</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kurokawa</surname><given-names>T</given-names></name><name><surname>Kondoh</surname><given-names>M</given-names></name><name><surname>Lee</surname><given-names>SC</given-names></name><etal/></person-group>. <article-title>Maze-tracing algorithm applied to eye fundus blood vessels</article-title>. <source>Electron Lett</source> <year>1998</year>; <volume>34</volume>(<issue>10</issue>): <fpage>976</fpage>–<lpage>977</lpage>.</citation></ref>
<ref id="bibr43-0954406211435195"><label>43</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Klein</surname><given-names>R</given-names></name><name><surname>Davis</surname><given-names>MD</given-names></name><name><surname>Magli</surname><given-names>YL</given-names></name><etal/></person-group>. <article-title>The Wisconsin age-related maculopathy grading system</article-title>. <source>Ophthalmology</source> <year>1991</year>; <volume>98</volume>(<issue>7</issue>): <fpage>1128</fpage>–<lpage>1134</lpage>.</citation></ref>
<ref id="bibr44-0954406211435195"><label>44</label><citation citation-type="other"><comment>Vargas R and Liatsis P. Localization of optic disc in fluorescein angiography images. In: <italic>Proceedings of the 18th international conference on systems, signals and image processing</italic>, Sarajevo, 16–18 June 2011, pp.1–4. Piscataway, NJ: IEEE</comment>.</citation></ref>
<ref id="bibr45-0954406211435195"><label>45</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hoover</surname><given-names>A</given-names></name><name><surname>Goldbaum</surname><given-names>M</given-names></name></person-group>. <article-title>Locating the optic nerve in a retinal image using the fuzzy convergence of the blood vessels</article-title>. <source>IEEE Trans Med Imaging</source> <year>2003</year>; <volume>22</volume>(<issue>8</issue>): <fpage>951</fpage>–<lpage>958</lpage>.</citation></ref>
<ref id="bibr46-0954406211435195"><label>46</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Shin</surname><given-names>DS</given-names></name><name><surname>Javornik</surname><given-names>NB</given-names></name><name><surname>Berger</surname><given-names>JW</given-names></name></person-group>. <article-title>Computer-assisted, interactive fundus image processing for macular drusen quantitation</article-title>. <source>Ophthalmology</source> <year>1999</year>; <volume>106</volume>(<issue>6</issue>): <fpage>1119</fpage>–<lpage>1125</lpage>.</citation></ref>
<ref id="bibr47-0954406211435195"><label>47</label><citation citation-type="other"><comment>Takerkart S, Fenouil R, Piovano J, et al. A quantification framework for post-lesion neo-vascularization in retinal angiography. In: <italic>Proceedings of the ISBI’2008</italic>, Paris, 14–17 May 2008, pp.1457–1460. Piscataway, NJ: IEEE</comment>.</citation></ref>
<ref id="bibr48-0954406211435195"><label>48</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Narasimha-Iyer</surname><given-names>H</given-names></name><name><surname>Can</surname><given-names>A</given-names></name><name><surname>Roysam</surname><given-names>B</given-names></name><etal/></person-group>. <article-title>Robust detection and classification of longitudinal changes in color retinal fundus images for monitoring diabetic retinopathy</article-title>. <source>IEEE Trans Biomed Eng</source> <year>2006</year>; <volume>53</volume>(<issue>6</issue>): <fpage>1084</fpage>–<lpage>1098</lpage>.</citation></ref>
<ref id="bibr49-0954406211435195"><label>49</label><citation citation-type="other"><comment>Mengko TR, Handayani A, Valindria VV, et al. Image processing in retinal angiography: extracting angiographical features without the requirement of contrast agents. In: <italic>Proceedings of the 9th IAPR conference on machine vision applications 2009</italic>, Yokohama, Japan, 20–22 May 2009; pp.451–454. Available at: <ext-link ext-link-type="uri" xlink:href="http://www.mva-org.jp/Proceedings/2009CD/">http://www.mva-org.jp/Proceedings/2009CD/</ext-link> (accessed on 18 January 2012)</comment>.</citation></ref>
<ref id="bibr50-0954406211435195"><label>50</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>J</given-names></name><name><surname>Tian</surname><given-names>J</given-names></name><name><surname>Lee</surname><given-names>N</given-names></name><etal/></person-group>. <article-title>A partial intensity invariant feature descriptor for multimodal retinal image registration</article-title>. <source>IEEE Trans Biomed Eng</source> <year>2010</year>; <volume>57</volume>(<issue>7</issue>): <fpage>1707</fpage>–<lpage>1718</lpage>.</citation></ref>
<ref id="bibr51-0954406211435195"><label>51</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Choe</surname><given-names>TE</given-names></name><name><surname>Medioni</surname><given-names>G</given-names></name><name><surname>Cohen</surname><given-names>I</given-names></name><etal/></person-group>. <article-title>2-D registration and 3-D shape inference of the retinal fundus from fluorescein images</article-title>. <source>Med Image Anal</source> <year>2008</year>; <volume>12</volume>(<issue>2</issue>): <fpage>174</fpage>–<lpage>190</lpage>.</citation></ref>
<ref id="bibr52-0954406211435195"><label>52</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Tsai</surname><given-names>CL</given-names></name><name><surname>Li</surname><given-names>CY</given-names></name><name><surname>Yang</surname><given-names>G</given-names></name><etal/></person-group>. <article-title>The edge-driven dual-bootstrap iterative closest point algorithm for registration of multimodal fluorescein angiogram sequence</article-title>. <source>IEEE Trans Med Imaging</source> <year>2010</year>; <volume>29</volume>(<issue>3</issue>): <fpage>636</fpage>–<lpage>649</lpage>.</citation></ref>
<ref id="bibr53-0954406211435195"><label>53</label><citation citation-type="other"><comment>Montoliu R and Pla F. Generalized least squared-based parametric motion estimation under non-uniform illumination changes. In: <italic>Proceedings of the ICIAR08</italic>, Portugal, 25–27 June 2008. Lecture Notes in Computer Science 5112. Berlin: Springer-Verlag, 2008, pp.660–669</comment>.</citation></ref>
<ref id="bibr54-0954406211435195"><label>54</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Jung</surname><given-names>F</given-names></name><name><surname>Kiesewetter</surname><given-names>H</given-names></name><name><surname>Koerber</surname><given-names>N</given-names></name><etal/></person-group>. <article-title>Quantification of characteristic blood-flow parameters in the vessels of the retina with a picture analysis system for video-fluorescence angiograms: initial findings</article-title>. <source>Graefes Arch Clin Exp Ophthalmol</source> <year>1983</year>; <volume>221</volume>: <fpage>133</fpage>–<lpage>136</lpage>.</citation></ref>
</ref-list>
</back>
</article>