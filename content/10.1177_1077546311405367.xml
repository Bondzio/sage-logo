<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v2.3 20070202//EN" "journalpublishing.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">JVC</journal-id>
<journal-id journal-id-type="hwp">spjvc</journal-id>
<journal-title>Journal of Vibration and Control</journal-title>
<issn pub-type="ppub">1077-5463</issn>
<issn pub-type="epub">1741-2986</issn>
<publisher>
<publisher-name>SAGE Publications</publisher-name>
<publisher-loc>Sage UK: London, England</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1177/1077546311405367</article-id>
<article-id pub-id-type="publisher-id">10.1177_1077546311405367</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Articles</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>A novel method of designing stable feedback controllers for local control of sound</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<name><surname>Tseng</surname><given-names>Wen-Kung</given-names></name>
<xref ref-type="aff" rid="aff1-1077546311405367">1</xref>
<xref ref-type="corresp" rid="corresp1-1077546311405367"/>
</contrib>
<contrib contrib-type="author">
<name><surname>Rafaely</surname><given-names>Boaz</given-names></name>
<xref ref-type="aff" rid="aff2-1077546311405367">2</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Elliott</surname><given-names>Steve</given-names></name>
<xref ref-type="aff" rid="aff3-1077546311405367">3</xref>
</contrib>
</contrib-group>
<aff id="aff1-1077546311405367"><label>1</label>Graduate Institute of Vehicle Engineering, National Changhua University of Education, Taiwan, China</aff>
<aff id="aff2-1077546311405367"><label>2</label>Department of Electrical and Computer Engineering, Ben-Gurion University of the Negev, Israel</aff>
<aff id="aff3-1077546311405367"><label>3</label>Institute of Sound and Vibration Research, University of Southampton, Southampton, UK</aff>
<author-notes>
<corresp id="corresp1-1077546311405367">Wen-Kung Tseng, Graduate Institute of Vehicle Engineering, National Changhua University of Education, No.1, Jin-De Road, Changhua City, Taiwan, People’s Republic of China Email: <email>andy007@cc.ncue.edu.tw</email></corresp>
</author-notes>
<pub-date pub-type="epub-ppub">
<month>4</month>
<year>2012</year>
</pub-date>
<volume>18</volume>
<issue>5</issue>
<fpage>651</fpage>
<lpage>658</lpage>
<history>
<date date-type="received"><day>21</day><month>7</month><year>2009</year></date>
<date date-type="accepted"><day>17</day><month>2</month><year>2011</year></date>
</history>
<permissions>
<copyright-statement>© The Author(s) 2011 Reprints and permissions: sagepub.co.uk/journalsPermissions.nav</copyright-statement>
<copyright-year>2011</copyright-year>
<copyright-holder content-type="sage">SAGE Publications</copyright-holder>
</permissions>
<abstract>
<p>This paper investigates the performance and stability of a virtual microphone feedback controller for local control of sound through theoretical analysis, simulations and real-time implementation. In real-time implementation of practical systems we usually need to measure the frequency response of the controller before the controller is implemented, in order to ensure that the expected performance is achieved. If an unstable controller is used, we will not be able to measure the frequency response of the controller, which will make the implementation and maintenance of the controller more difficult. Therefore a novel method to design a stable feedback controller for a local control system is presented in this paper. The local control system is designed to attenuate a broadband disturbance at a point near the listener's ear, i.e. the virtual microphone, rather than at the control microphone, i.e. the physical microphone. The results showed that if a good performance was to be achieved the controller would be unstable. This is because the magnitude of the response of the virtual plant is lower than that of the physical plant. The feedback controller in this work is designed to minimize the noise at the virtual microphone, with a virtual plant response used in the performance objective. However the physical plant is used in the stability constraint. Therefore there is a trade-off between the performance and controller stability. The main contributions of the paper are to propose a novel method to design a stable feedback controller and analyze the performance and stability of a virtual microphone feedback controller for the local control of sound through simulations and real-time implementation.</p>
</abstract>
<kwd-group>
<kwd>A virtual microphone feedback controller</kwd>
<kwd>local control of sound</kwd>
<kwd>broadband disturbance</kwd>
<kwd>stability constraint</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="sec1-1077546311405367"><title>1. Introduction</title>
<p>The aim of local control of sound is to cancel the noise at points around listeners’ ears. Previous work on local control has shown that if a virtual microphone approach was used the performance would be better (<xref ref-type="bibr" rid="bibr3-1077546311405367">Pawelczyk, 2004</xref>; <xref ref-type="bibr" rid="bibr4-1077546311405367">Rafaely, 1997</xref>; <xref ref-type="bibr" rid="bibr5-1077546311405367">Rafaely and Elliott, 1999</xref>). However there was no stability analysis on such an arrangement. The aims of the work presented in this paper are to investigate through simulations and real-time implementation the limitation on performance of a local control system due to the use of virtual microphone feedback controllers and to introduce a novel method of designing stable feedback controllers. The performance and stability of a feedback controller with internal model control (IMC) configuration (<xref ref-type="bibr" rid="bibr1-1077546311405367">Elliott, 1996</xref>; <xref ref-type="bibr" rid="bibr2-1077546311405367">Morari and Zafiriou, 1989</xref>; <xref ref-type="bibr" rid="bibr6-1077546311405367">Skogestad and Postlethwaite, 1996</xref>; <xref ref-type="bibr" rid="bibr7-1077546311405367">Tseng, 2001</xref>; <xref ref-type="bibr" rid="bibr8-1077546311405367">Tseng et. al., 2002</xref>) to cancel the noise at a virtual microphone are analyzed. The attenuation using an open-loop stable feedback controller is also compared with attenuation using an open-loop unstable feedback controller. The results show that the controller which is open-loop unstable gives the best performance. Therefore there is a trade-off between the performance and controller open-loop stability. This is found to be due to the fact that the magnitude of the response of the virtual plant is lower than that of the physical plant. The virtual plant response is used in the performance objective, while the physical plant response is used in the stability constraint. This results in conflicting requirements from the control filter, and good performance is only achieved with an unstable feedback controller. The paper is organized as follows. We first describe the arrangement of a local control system. Second, the performance and stability of a local control system are analyzed. Next a novel method of designing open-loop stable feedback controllers is introduced. Then, results and discussions are presented. Finally, the conclusions are presented.</p>
</sec>
<sec id="sec2-1077546311405367"><title>2. Arrangement of a local control system</title>
<p>The arrangement of the local control system is described in this section. <xref ref-type="fig" rid="fig1-1077546311405367">Figure 1</xref> shows the arrangement of the local control system, which includes primary and secondary loudspeakers, a physical microphone, a virtual microphone and a manikin head (listener). The distance between the physical and virtual microphone is about 10 cm. The physical microphone and the secondary loudspeaker are connected via a feedback controller. The local control system is designed to attenuate the acoustic noise at the virtual microphone, which is used in the design process only. However the physical microphone is used to detect the error signal, which is filtered by the feedback controller and then fed to the secondary loudspeaker (<xref ref-type="bibr" rid="bibr4-1077546311405367">Rafaely, 1997</xref>; <xref ref-type="bibr" rid="bibr5-1077546311405367">Rafaely and Elliott, 1999</xref>). In this work the physical and virtual plants were measured and used to design the controller. The physical plant is the response from the input of the secondary loudspeaker to the output of the physical microphone and the virtual plant is the response from the input of the secondary loudspeaker to the output of the virtual microphone.
<fig id="fig1-1077546311405367" position="float"><label>Figure 1.</label><caption><p>The local control system with physical and virtual microphones arrangement.</p></caption><graphic xlink:href="10.1177_1077546311405367-fig1.tif"/></fig></p>
<p>An equivalent block diagram of this feedback control system using internal model control can be drawn in <xref ref-type="fig" rid="fig2-1077546311405367">Figure 2</xref>, where <italic>C</italic> is the feedback controller, <italic>P<sub>mic</sub></italic> is the physical plant, <italic>P<sub>vir</sub></italic> is the virtual plant, <italic>e<sub>mic</sub></italic> is the error signal from the physical microphone output, <italic>e<sub>vir</sub></italic> is the error signal from the virtual microphone output, <italic>d<sub>mic</sub></italic> is the disturbance at the physical microphone, <italic>d<sub>vir</sub></italic> is the disturbance at the virtual microphone and is equivalent to filtering <italic>d<sub>mic</sub></italic> with <italic>F</italic>, which is the response between the physical and virtual microphones. This represents the relation between the primary signals at the two microphone locations and will depend on the acoustic environment. If the microphones are located closely enough, then <italic>F</italic> ≅ 1. The feedback controller consists of a control filter and a model of the physical plant which is driven by the same signal as the physicalplant, as shown in <xref ref-type="fig" rid="fig2-1077546311405367">Figure 2</xref>, where <italic>W</italic> is the control filter and <italic>P<sub>mic0</sub></italic> is the model of the nominal physical plant. If the model of the physical plant is perfect so that <italic>P<sub>mic0</sub></italic> = <italic>P<sub>mic</sub></italic>, then the input to <italic>W</italic> is equal to <italic>d<sub>mic</sub></italic>, and the controller configuration of the internal model control reduces to a pure feedforward system. We assume that the system is linear and time-invariant, and so the position of the control filter and the virtual plant can be exchanged. Although in a practical system <italic>P<sub>mic0</sub></italic> ≠ <italic>P<sub>mic</sub></italic>, the controller is designed with the nominal plant, so the assumption that <italic>P<sub>mico</sub></italic> = <italic>P<sub>mic</sub></italic> holds for the design phase only. The controller is also designed to be robustly stable for the measured variation of <italic>P<sub>mic</sub></italic> around <italic>P<sub>mic0</sub></italic> due to head movements (<xref ref-type="bibr" rid="bibr5-1077546311405367">Rafaely and Elliott, 1999</xref>).
<fig id="fig2-1077546311405367" position="float"><label>Figure 2.</label><caption><p>Configuration of an internal model control system.</p></caption><graphic xlink:href="10.1177_1077546311405367-fig2.tif"/></fig></p>
</sec>
<sec id="sec3-1077546311405367"><title>3. Performance and stability of a local control system</title>
<p>In this section we discuss the performance and stability problem of a virtual microphone feedback controller with an internal model control configuration using an H<sub>2</sub>/H<sub>∞</sub> design method. <xref ref-type="fig" rid="fig3-1077546311405367">Figure 3</xref> shows the power spectral density of the disturbance used in the design process. The disturbance is created by filtering the white noise via a shaping filter which is modeled by an 8-pole Butterworth low-pass filter with a cut-off frequency of 400 Hz, combined with an 8-pole Butterworth high-pass filter with a cut-off frequency of 200 Hz. We chose 200 Hz for the bandwidth of the disturbance, because when the bandwidth of the disturbance was increased the performance was found to be too poor. <xref ref-type="fig" rid="fig4-1077546311405367">Figures 4</xref> and <xref ref-type="fig" rid="fig5-1077546311405367">5</xref> show the frequency responses of the physical and virtual plants respectively. It can be seen that the magnitude of the frequency response of the physical plant is about 10 dB higher than that of the virtual plant. The reason for this is because the virtual microphone is about 10 cm further away from the secondary loudspeaker than the physical microphone. Therefore the acoustic pressure at the virtual microphone is lower than that at the physical microphone.
<fig id="fig3-1077546311405367" position="float"><label>Figure 3.</label><caption><p>The power spectrum of the random disturbance.</p></caption><graphic xlink:href="10.1177_1077546311405367-fig3.tif"/></fig>
<fig id="fig4-1077546311405367" position="float"><label>Figure 4.</label><caption><p>Frequency response of the physical plant.</p></caption><graphic xlink:href="10.1177_1077546311405367-fig4.tif"/></fig>
<fig id="fig5-1077546311405367" position="float"><label>Figure 5.</label><caption><p>Frequency response of the virtual plant.</p></caption><graphic xlink:href="10.1177_1077546311405367-fig5.tif"/></fig></p>
<p>In this work we design the controller to minimize the acoustic pressure at the virtual microphone and subject to stability and enhancement constraints. We assume that the primary field at the physical and virtual microphones is equal, since the distance between the two microphones is small compared to the wavelength in this frequency range. Therefore, <italic>F</italic>, the response between the physical and virtual microphones, is assumed to be unity. The H<sub>2</sub>/H<sub>∞</sub> formulation for performance, stability and enhancement constraints can now be written as follows (<xref ref-type="bibr" rid="bibr5-1077546311405367">Rafaely and Elliott,1999</xref>).
<disp-formula id="disp-formula11-1077546311405367"><graphic xlink:href="10.1177_1077546311405367-eq11.tif"/></disp-formula>
<disp-formula id="disp-formula12-1077546311405367"><graphic xlink:href="10.1177_1077546311405367-eq12.tif"/></disp-formula>
<disp-formula id="disp-formula1-1077546311405367"><label>(1)</label><graphic xlink:href="10.1177_1077546311405367-eq1.tif"/></disp-formula>
where <italic>W</italic> is the control filter, <italic>P<sub>vir0</sub></italic> is the nominal virtual plant, <inline-formula id="ilm1-1077546311405367"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math1-1077546311405367"><mml:mrow><mml:msqrt><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>ddvir</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula> is the square root of the power spectral density of the disturbance pressure at the virtual microphone, <italic>P<sub>mic0</sub></italic> is the response of the nominal physical plant, <italic>B</italic> is the plant uncertainty bound, and 1/<italic>D</italic> is the desired enhancement bounds. In <xref ref-type="disp-formula" rid="disp-formula1-1077546311405367">equation (1)</xref> the constraints only guarantee the stability of the closed-loop system and do not guarantee the stability of the feedback controller itself. The transfer function of thefeedback controller as shown in <xref ref-type="fig" rid="fig2-1077546311405367">Figure 2</xref> can be written as
<disp-formula id="disp-formula2-1077546311405367"><label>(2)</label><graphic xlink:href="10.1177_1077546311405367-eq2.tif"/></disp-formula>
</p>
<p>For controller stability the Nyquist plot of (<italic>WP<sub>mico</sub></italic>) must not enclose the (−1, 0) point. We should notice that the virtual plant is used in the performance objective; however, the physical plant is used in the stability constraint. For good performance the following condition must be satisfied.
<disp-formula id="disp-formula3-1077546311405367"><label>(3)</label><graphic xlink:href="10.1177_1077546311405367-eq3.tif"/></disp-formula>
</p>
<p>However the magnitude of the physical plant is about 10 dB higher than that of the virtual plant, i.e.
<disp-formula id="disp-formula4-1077546311405367"><label>(4)</label><graphic xlink:href="10.1177_1077546311405367-eq4.tif"/></disp-formula>
so that
<disp-formula id="disp-formula5-1077546311405367"><label>(5)</label><graphic xlink:href="10.1177_1077546311405367-eq5.tif"/></disp-formula>
</p>
<p>This result has important consequences on the open-loop stability of the controller <italic>C</italic> in <xref ref-type="disp-formula" rid="disp-formula2-1077546311405367">equation (2)</xref>. The stability of this controller is determined by the Nyquist plot of <italic>WP<sub>mic0</sub></italic>.</p>
<p>If the Nyquist plot of <italic>WP<sub>mic0</sub></italic> passes near the point (−3,0), as required for good performance in <xref ref-type="disp-formula" rid="disp-formula5-1077546311405367">equation (5)</xref>, the controller is likely to be unstable as shown in <xref ref-type="fig" rid="fig6-1077546311405367">Figure 6</xref>(a). In order to obtain a stable controller <italic>C</italic>, the gain of <italic>W</italic> must generally be reduced by a factor of 3 in this case to achieve the following condition.
<disp-formula id="disp-formula6-1077546311405367"><label>(6)</label><graphic xlink:href="10.1177_1077546311405367-eq6.tif"/></disp-formula>
in which case
<disp-formula id="disp-formula7-1077546311405367"><label>(7)</label><graphic xlink:href="10.1177_1077546311405367-eq7.tif"/></disp-formula>
which can be represented as in <xref ref-type="fig" rid="fig6-1077546311405367">Figure 6</xref>(b).
<fig id="fig6-1077546311405367" position="float"><label>Figure 6.</label><caption><p>Performance and controller stability condition. (a)Good performance with an unstable controller <italic>C</italic>; (b) poor performance with a stable controller.</p></caption><graphic xlink:href="10.1177_1077546311405367-fig6.tif"/></fig></p>
<p>This will result in poor performance because <xref ref-type="disp-formula" rid="disp-formula3-1077546311405367">equation (3)</xref> cannot be satisfied. Therefore there is a trade-off between the performance and the stability of the feedback controller <italic>C</italic> in the case of using a virtual microphone. In real-time implementation of practical systems we usually need to measure the frequency response of the controller before the controller is implemented, in order to ensure that the expected performance is achieved. If an unstable controller is used, we will not be able to measure the frequency response of the controller, which will make the implementation and maintenance of the controller more difficult. In the next section we will discuss how to design stable controllers by using another constraint for the controller stability in the design process.</p>
</sec>
<sec id="sec4-1077546311405367"><title>4. Design of stable feedback controllers</title>
<p>In this section we present the design method of open-loop stable feedback controllers. The performance of stable and unstable controllers will be compared in the next section. For a ‘fair’ comparison, the best attenuation with a stable controller is required. This can be achieved by adding a controller stability constraint in the design process. If Nyquist stability criterion, which ensures that the frequency response of (<italic>WP<sub>mic0</sub></italic>) does not encircle the point (−1,0) on the Nyquist plane, is applied directly to the design process, the formulation might not be simple, in particular if a convex formulation is required. Another method of designing a stable controller is to apply the small gain theory, which ensures that all the entire frequency response (<italic>WP<sub>mic0</sub></italic>) is inside the unit circle. This is a very conservative method. In order to obtain better performance the magnitude of <italic>WP<sub>vir</sub><sub>0</sub></italic> should be as high as possible, as discussed in the previous section. Thus, a slightly less conservative criterion, which is to avoid any response on the left hand side of the parabolic curve <italic>x</italic> + <italic>y</italic><sup>2 </sup>=−0.98 on the Nyquist plane, is introduced. Therefore another constraint could be added into the design process to ensure that the controller is stable as follows.
<disp-formula id="disp-formula8-1077546311405367"><label>(8)</label><graphic xlink:href="10.1177_1077546311405367-eq8.tif"/></disp-formula>
</p>
<p>This constraint will guarantee that the Nyquist plot of the frequency response of (<italic>WP<sub>mic0</sub></italic>) is on the right hand side of the parabolic curve <italic>x</italic> + <italic>y</italic><sup>2 </sup>= −0.98, which results in the stable controller. This is less conservative than the small gain theory and appears to be a novel formulation of the design process to ensure open-loop stability. The reason for choosing this method rather than other methods to guarantee the controller stability is because it is more efficient and integrates well into the optimisation process. Therefore the H<sub>2</sub>/H<sub>∞</sub> formulation can now be written as follows.
<disp-formula id="disp-formula13-1077546311405367"><graphic xlink:href="10.1177_1077546311405367-eq13.tif"/></disp-formula>
<disp-formula id="disp-formula14-1077546311405367"><graphic xlink:href="10.1177_1077546311405367-eq14.tif"/></disp-formula>
<disp-formula id="disp-formula15-1077546311405367"><graphic xlink:href="10.1177_1077546311405367-eq15.tif"/></disp-formula>
<disp-formula id="disp-formula9-1077546311405367"><label>(9)</label><graphic xlink:href="10.1177_1077546311405367-eq9.tif"/></disp-formula>
</p>
<p>The design method presented above will be used to perform some design examples presented in the next section.</p>
</sec>
<sec id="sec5-1077546311405367"><title>5. Results and discussions</title>
<p>In this section the performance of the feedback control system using stable and unstable controllers will be compared through simulations. Also the real-time implementation of the feedback control system will be carried out to validate the simulation results. <xref ref-type="fig" rid="fig7-1077546311405367">Figure 7</xref> shows the simulation result of the power spectrum of the random disturbance before control and after control by using the H<sub>2</sub>/H<sub>∞</sub> method without the constraint of the controller stability. <xref ref-type="fig" rid="fig8-1077546311405367">Figure 8</xref> shows the simulation result of the power spectrum of the random disturbance before control and after control by using the H<sub>2</sub>/H<sub>∞</sub> method with the constraint of the controller stability. It can be seen that the performance without the constraint of the controller stability is better than that with the constraint of the controller stability. This is because the gain of the control filter <italic>W</italic> without the constraint of the controller stability can be higher than that with the constraint of the controller stability, as explained in <xref ref-type="sec" rid="sec3-1077546311405367">Section 3</xref>. However, the controller is open-loop unstable in the case without the constraint of the controller stability as seen in <xref ref-type="fig" rid="fig9-1077546311405367">Figure 9</xref> which shows the Nyquist plot of the frequency responses of (<italic>WP<sub>mic0</sub></italic>) without the constraint of the controller stability. <xref ref-type="fig" rid="fig10-1077546311405367">Figure 10</xref> shows the Nyquist plot of the frequency responses of (<italic>WP<sub>mic0</sub></italic>) with the constraint of the controller stability. As can be seen from this figure the controller is open-loop stable. It should be remembered that since the response of the internal model controller has the form given by <xref ref-type="disp-formula" rid="disp-formula2-1077546311405367">equation (2)</xref>, then the stability of the controller is determined by the Nyquist plot of (<italic>WP<sub>mic0</sub></italic>). In this case the controller stability constraint is set to greater than –0.98 rather than –1 in order to keep the Nyquist plot of the response of (<italic>WP<sub>mic0</sub></italic>) away from the stability critical point (−1,0). The controller is unstable if the constraint of the controller stability is not included in the design process. <xref ref-type="fig" rid="fig10-1077546311405367">Figure 10</xref> shows that the controller stability is maintained, as expected, because the constraint in <xref ref-type="disp-formula" rid="disp-formula8-1077546311405367">equation (8)</xref> is maintained.
<fig id="fig7-1077546311405367" position="float"><label>Figure 7.</label><caption><p>The power spectrum of the random disturbance before control (-.-.-.) and after control () by using H<sub>2</sub>/H<sub>∞</sub> method without the constraint of the controller stability (simulation results).</p></caption><graphic xlink:href="10.1177_1077546311405367-fig7.tif"/></fig>
<fig id="fig8-1077546311405367" position="float"><label>Figure 8.</label><caption><p>The power spectrum of the random disturbance before control (-.-.-.) and after control (—) by using H<sub>2</sub>/H<sub>∞</sub> method with the constraint of the controller stability (simulation results).</p></caption><graphic xlink:href="10.1177_1077546311405367-fig8.tif"/></fig>
<fig id="fig9-1077546311405367" position="float"><label>Figure 9.</label><caption><p>Nyquist plot of the frequency response of (<italic>WP<sub>mic0</sub></italic>) without the constraint of the controller stability.</p></caption><graphic xlink:href="10.1177_1077546311405367-fig9.tif"/></fig>
<fig id="fig10-1077546311405367" position="float"><label>Figure 10.</label><caption><p>Nyquist plot of the frequency response of (<italic>WP<sub>mic0</sub></italic>) with the constraint of the controller stability.</p></caption><graphic xlink:href="10.1177_1077546311405367-fig10.tif"/></fig></p>
<p><xref ref-type="fig" rid="fig11-1077546311405367">Figures 11</xref> and <xref ref-type="fig" rid="fig12-1077546311405367">12</xref> show the Nyquist plot of the frequency response of (<italic>WP<sub>vic0</sub></italic>) without and with the constraint of the controller stability, where the solid line represents the response of (<italic>WP<sub>vir0</sub></italic>) between 200 Hz and 400 Hz. As can be seen, the magnitude of (<italic>WP<sub>vir0</sub></italic>) with the controller stability constraint is further away from the point (−1,0) than that without the controller stability constraint at the frequency range from 200 Hz to 400 Hz. Therefore the performance with the controller stability constraint is poor, as expected.
<fig id="fig11-1077546311405367" position="float"><label>Figure 11.</label><caption><p>Nyquist plot of the frequency response of (<italic>WP<sub>vir</sub><sub>0</sub></italic>) without the constraint of the controller stability.</p></caption><graphic xlink:href="10.1177_1077546311405367-fig11.tif"/></fig>
<fig id="fig12-1077546311405367" position="float"><label>Figure 12.</label><caption><p>Nyquist plot of the frequency response of (<italic>WP<sub>vir</sub><sub>0</sub></italic>) with the constraint of the controller stability.</p></caption><graphic xlink:href="10.1177_1077546311405367-fig12.tif"/></fig></p>
<p>In this work single channel real-time implementation for the control system has also been carried out to validate the simulation results presented above. We investigate the feasibility of implementing the H<sub>2</sub>/H<sub>∞</sub> feedback controller to minimize the acoustic pressure at a virtual microphone. A digital control system was connected to the control system for the real-time control experiment. The digital control system includes a power amplifier to drive the loudspeaker, a microphone amplifier to enhance the error signal, low-pass filters to prevent aliasing, and a Texas Instrument TMS320C6711 DSP board as shown in <xref ref-type="fig" rid="fig13-1077546311405367">Figure 13</xref>. A sampling frequency of 20 kHz was used in the implementation. An FIR control filter, <italic>W</italic>, with 200 coefficients was used. After the controller design, a real-time controller was implemented on a DSP system, to control the experimental system. The formulation for H<sub>2</sub>/H<sub>∞</sub> feedback controller design is the same as in <xref ref-type="disp-formula" rid="disp-formula9-1077546311405367">equation (9)</xref>. We notice that the plant responses used here include the elements of a digital controller, such as low-pass filters and the one sample filtering delay. In this work the frequency responses <italic>P<sub>mic0</sub></italic>, <italic>P<sub>vir0</sub></italic>, <italic>F</italic> and <italic>B</italic> were first measured, and then these responses were modeled using IIR filters. The frequency response functions of the models were then evaluated on the unit circle. The nominal physical and virtual plants were modeled by an IIR filter with 18 moving-average (MA) coefficients, and 20 auto-regressive (AR) coefficients by using the function <italic>invfreqz</italic>() in MATLAB.
<fig id="fig13-1077546311405367" position="float"><label>Figure 13.</label><caption><p>The experimental setup of a feedback control system, which includes a loudspeaker, two microphones, amplifiers, low-pass filters and a digital controller.</p></caption><graphic xlink:href="10.1177_1077546311405367-fig13.tif"/></fig></p>
<p>The plant uncertainty bound <italic>B</italic> is calculated from:
<disp-formula id="disp-formula10-1077546311405367"><label>(10)</label><graphic xlink:href="10.1177_1077546311405367-eq10.tif"/></disp-formula>
where <italic>P<sub>mic</sub></italic> is the frequency response of the true physical plant, <italic>P<sub>mic0</sub></italic> is the response of the nominal physical plant with the central manikin position, <inline-formula id="ilm2-1077546311405367"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math2-1077546311405367"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mi>~</mml:mi></mml:mover></mml:mrow><mml:mrow><mml:mi>mic</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the set of physical plants with the various manikin positions, which simulates the head movements indicated in <xref ref-type="fig" rid="fig14-1077546311405367">Figure 14</xref>. The frequency response of <italic>B</italic> was determined from the data measured in a laboratory. In this work the H<sub>2</sub>/H<sub>∞</sub> controller was designed to minimize the acoustic pressure at a virtual microphone at manikin position 3 as shown in <xref ref-type="fig" rid="fig14-1077546311405367">Figure 14</xref>. The virtual microphone is attached to the manikin's ear. <xref ref-type="fig" rid="fig15-1077546311405367">Figures 15</xref> and <xref ref-type="fig" rid="fig16-1077546311405367">16</xref> show the attenuation at the virtual microphone without and with the constraint of the controller stability respectively. It can be seen that the attenuation without the constraint of the controller stability is better than that with the constraint of the controller stability as expected from the simulations.
<fig id="fig14-1077546311405367" position="float"><label>Figure 14.</label><caption><p>The arrangement of the manikin, which was moved to various positions.</p></caption><graphic xlink:href="10.1177_1077546311405367-fig14.tif"/></fig>
<fig id="fig15-1077546311405367" position="float"><label>Figure 15.</label><caption><p>The power spectrum of the random disturbance before control (-.-.-.) and after control () by using H<sub>2</sub>/H<sub>∞</sub> method without the constraint of the controller stability (real-time implementation).</p></caption><graphic xlink:href="10.1177_1077546311405367-fig15.tif"/></fig>
<fig id="fig16-1077546311405367" position="float"><label>Figure 16.</label><caption><p>The power spectrum of the random disturbance before control (-.-.-.) and after control (—) by using H<sub>2</sub>/H<sub>∞</sub> method with the constraint of the controller stability (real-time implementation).</p></caption><graphic xlink:href="10.1177_1077546311405367-fig16.tif"/></fig></p>
</sec>
<sec id="sec6-1077546311405367"><title>6. Conclusions</title>
<p>In this paper a novel analysis of the stability issue of the internal model feedback controller designed to minimize the acoustic pressure at a virtual microphone has been introduced. The results showed that if good performance was to be achieved the controller would be unstable. Therefore there is a trade-off between performance and controller stability. Also, a novel method has been developed to design a stable feedback controller which was used in the design of a virtual microphone controller. The real-time implementation for the feedback control system has also been presented in this work. H<sub>2</sub>/H<sub>∞</sub> feedback controllers have been implemented on a TMS320C6711 DSP system to control the experimental feedback control system. The results showed that good attenuation was achieved at the location of the virtual microphone without the constraint of the controller stability. However, the attenuation decreased as the constraint of the controller stability was included in the design process. The method presented in the paper could be used in the design of feedback controllers with internal model control configuration for other control systems.</p>
</sec>
</body>
<back>
<sec id="sec7-1077546311405367"><title>Funding</title>
<p>The study was supported by the National Science Council of Taiwan, the Republic of China, under project number NSC-96-2622-E-018-004-CC3.</p></sec>
<ref-list>
<title>References</title>
<ref id="bibr1-1077546311405367"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Elliott</surname><given-names>SJ</given-names></name></person-group> (<year>1996</year>) <article-title>Performance of feedforward and feedback systems for active control</article-title>. <source>IEEE Transaction on Speech and Audio Processing</source> <volume>4</volume>(<issue>3</issue>): <fpage>214</fpage>–<lpage>223</lpage>.</citation></ref>
<ref id="bibr2-1077546311405367"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Morari</surname><given-names>M</given-names></name><name><surname>Zafiriou</surname><given-names>E</given-names></name></person-group> (<year>1989</year>) <source><italic>Robust </italic>Process <italic>Control</italic></source>. <publisher-loc>Prentice-Hall</publisher-loc>: <publisher-name>New Jersey</publisher-name>.</citation></ref>
<ref id="bibr3-1077546311405367"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pawelczyk</surname><given-names>M</given-names></name></person-group> (<year>2004</year>) <article-title>Adaptive noise control algorithms for active headrest system.l</article-title>. <source>Control Engineering Practice</source> <volume>12</volume>: <fpage>1101</fpage>–<lpage>1112</lpage>.</citation></ref>
<ref id="bibr4-1077546311405367"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Rafaely</surname><given-names>B</given-names></name></person-group> (<year>1997</year>) <source>Feedback control of sound</source>. <publisher-loc>UK</publisher-loc>: <publisher-name>Dr. Thesis, University of Southampton</publisher-name>.</citation></ref>
<ref id="bibr5-1077546311405367"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Rafaely</surname><given-names>B</given-names></name><name><surname>Elliott</surname><given-names>SJ</given-names></name></person-group> (<year>1999</year>) <article-title>H<sub>2</sub>/H<sub>∞</sub> active control of sound in a headrest: design and implementation</article-title>. <source>IEEE Transactions on Control Systems Technology</source> <volume>7</volume>(<issue>1</issue>): <fpage>79</fpage>–<lpage>84</lpage>.</citation></ref>
<ref id="bibr6-1077546311405367"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Skogestad</surname><given-names>S</given-names></name><name><surname>Postlethwaite</surname><given-names>I</given-names></name></person-group> (<year>1996</year>) <source>Multivariable Feedback Control</source>. <publisher-loc>Wiley</publisher-loc>: <publisher-name>Chichester</publisher-name>.</citation></ref>
<ref id="bibr7-1077546311405367"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Tseng</surname><given-names>Wen-Kung</given-names></name></person-group> (<year>2001</year>) <source>Sound minimisation for local active control</source>. <publisher-loc>UK</publisher-loc>: <publisher-name>Dr. Thesis, University of Southampton</publisher-name>.</citation></ref>
<ref id="bibr8-1077546311405367"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Tseng</surname><given-names>Wen-Kung</given-names></name><name><surname>Rafaely</surname><given-names>B</given-names></name><name><surname>Elliott</surname><given-names>SJ</given-names></name></person-group> (<year>2002</year>) <article-title>Performance limits and real-time implementation of a virtual microphone active headrest system</article-title>. <source>ACTIVE2002</source> <fpage>1231</fpage>–<lpage>1242</lpage>.</citation></ref>
</ref-list>
</back>
</article>