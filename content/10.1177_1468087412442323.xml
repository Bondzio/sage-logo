<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v2.3 20070202//EN" "journalpublishing.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">JER</journal-id>
<journal-id journal-id-type="hwp">spjer</journal-id>
<journal-title>International Journal of Engine Research</journal-title>
<issn pub-type="ppub">1468-0874</issn>
<issn pub-type="epub">2041-3149</issn>
<publisher>
<publisher-name>SAGE Publications</publisher-name>
<publisher-loc>Sage UK: London, England</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1177/1468087412442323</article-id>
<article-id pub-id-type="publisher-id">10.1177_1468087412442323</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Original Articles</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Control of diesel engines using NO<sub>x</sub>-emission feedback</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<name><surname>Tschanz</surname><given-names>Frédéric</given-names></name>
</contrib>
<contrib contrib-type="author">
<name><surname>Amstutz</surname><given-names>Alois</given-names></name>
</contrib>
<contrib contrib-type="author">
<name><surname>Onder</surname><given-names>Christopher H</given-names></name>
</contrib>
<contrib contrib-type="author">
<name><surname>Guzzella</surname><given-names>Lino</given-names></name>
</contrib>
<aff id="aff1-1468087412442323">Institute for Dynamic Systems and Control, ETH Zürich, Switzerland</aff>
</contrib-group>
<author-notes>
<corresp id="corresp1-1468087412442323">Frédéric Tschanz, Institute for Dynamic Systems and Control, ETH Zürich, Sonneggstrasse 3, 8092 Zürich, Switzerland. Email: <email>tschanzf@ethz.ch</email></corresp>
</author-notes>
<pub-date pub-type="epub-ppub">
<month>2</month>
<year>2013</year>
</pub-date>
<volume>14</volume>
<issue>1</issue>
<fpage>45</fpage>
<lpage>56</lpage>
<history>
<date date-type="received">
<day>2</day>
<month>3</month>
<year>2011</year>
</date>
<date date-type="accepted">
<day>24</day>
<month>2</month>
<year>2012</year>
</date>
</history>
<permissions>
<copyright-statement>© Swiss Federal Institute of Technology, ETH Zürich 2013</copyright-statement>
<copyright-year>2013</copyright-year>
<copyright-holder content-type="society">Institution of Mechanical Engineers</copyright-holder>
</permissions>
<abstract>
<p>Variations of engine-out emissions due to ageing, component drift or production tolerances pose serious problems to meet legislative restrictions on exhaust tailpipe pollutant emissions. This paper addresses feedback of the raw emissions for improved control of diesel engines. A discussion of issues regarding the inclusion of raw-emission feedback into the engine control structure is provided, and a novel control structure for combined feedback control of the air-path variables boost pressure and exhaust gas recirculation rate and of the NO<sub>x</sub> emissions is presented. The proposed control structure basically consists of an optimal linear output feedback controller and a setpoint-adaption loop on the exhaust gas recirculation rate. With this approach, a simple control structure is available requiring a marginal calibration effort to meet desired NO<sub>x</sub>-emission values. Unfavourable injection timing in connection with NO<sub>x</sub> control is minimized by adapting the exhaust gas recirculation rate setpoint. The performance of the proposed approach is demonstrated by experimental results.</p>
</abstract>
<kwd-group>
<kwd>Diesel engines</kwd>
<kwd>automotive emissions</kwd>
<kwd>NO<sub>x</sub> control</kwd>
<kwd>engine management</kwd>
<kwd>feedback control</kwd>
<kwd>multivariable control</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="section1-1468087412442323" sec-type="intro">
<title>Introduction</title>
<p>Diesel engines have experienced a significant technological development in combination with a broadening towards light-duty applications. The technological development has been driven by relatively high emissions of NO<sub>x</sub> and particulate matter (PM) compared to spark-ignition engines with three-way catalysts. From a control point of view, this development has led to a highly coupled plant with many inputs to be controlled.</p>
<p>An overview of the control of diesel engines has been given by Guzzella and Amstutz.<sup><xref ref-type="bibr" rid="bibr1-1468087412442323">1</xref></sup> Additionally, a large number of publications have appeared on specific control issues such as air-path control,<sup><xref ref-type="bibr" rid="bibr2-1468087412442323">2</xref><xref ref-type="bibr" rid="bibr3-1468087412442323"/>–<xref ref-type="bibr" rid="bibr4-1468087412442323">4</xref></sup> combustion investigation<sup><xref ref-type="bibr" rid="bibr5-1468087412442323">5</xref>,<xref ref-type="bibr" rid="bibr6-1468087412442323">6</xref></sup> and emissions,<sup><xref ref-type="bibr" rid="bibr7-1468087412442323">7</xref>,<xref ref-type="bibr" rid="bibr8-1468087412442323">8</xref></sup> for example. But apart from very few exceptions, no concepts that include feedback of the pollutant raw emissions have been published. Reasons for this are not only the unavailability of emission signals in production-type systems, but also the alternative of keeping within the limits set by legislation by controlling ‘emission-coupled’ variables instead of the emissions themselves. However, progress in sensor technology and increasingly strict legislative emission requirements will allow and favour (or even require) the integration of emission feedback into the engine control structure in the near future.</p>
<p>The intentions of this paper are the discussion of issues regarding the control of diesel engines with emission feedback and the demonstration of such a controller. The controlled variables of this novel multivariable control structure are the boost pressure, the exhaust gas recirculation (EGR) rate and the NO<sub>x</sub> raw emissions. The focus in this paper is on light-duty applications. However, a coherent extension of this approach to heavy-duty applications can be expected.</p>
<p>In the following, the term ‘emissions’ is generally related to the raw emissions. Furthermore, the term ‘control’ is related to feedback control rather than to ‘emissions reduction’ or ‘aftertreatment’, as often seen in the literature.</p>
<sec id="section2-1468087412442323">
<title>Emission feedback control</title>
<p>The most important requirements on automotive diesel systems (including aftertreatment) are the compliance with legislative emission limits, a low fuel consumption and a fast dynamic response of the engine. An improvement potential with respect to these requirements has been made accessible due to the technological developments. However, this potential cannot be exploited entirely as yet. This is due to the fact that emission-relevant systems, such as the injection with its high degree of freedom and the air path, either do not include feedback at all or are feedback controlled via representative variables for the emissions, e.g. the EGR rate. As a consequence, emission phenomena such as peaks in transients remain uncontrolled. The most important drawback, however, is found in the fact that due to ageing and production tolerances, the engines exhibit a significant variability in emissions, as indicated schematically in <xref ref-type="fig" rid="fig1-1468087412442323">Figure 1</xref>. Keeping in mind that the limits set by emission legislation must not be violated over the engine lifetime and under varying environmental conditions, the calibration of the engine must include sufficient safety margins on the emissions. As a consequence, the calibration is not optimal regarding the potential of the system. To limit these drift influences on the emissions, a variety of compensation functions and nested control loops have been implemented. Such solutions have resulted in an increased calibration complexity. Last but not least, without raw-emission information, aftertreatment devices such as selective catalytic reduction devices or diesel particulate filters (DPFs) cannot be operated optimally, regarding urea injection or regeneration.</p>
<fig id="fig1-1468087412442323" position="float">
<label>Figure 1.</label>
<caption>
<p>Ageing, production tolerances and environmental variations influence the engine emissions. As a result, the cycle emissions are also influenced, as shown schematically.</p>
</caption>
<graphic xlink:href="10.1177_1468087412442323-fig1.tif"/>
</fig>
<p>In a nutshell, the drawbacks with respect to the emissions of current engines can be summarized as follows:</p>
<list id="list1-1468087412442323" list-type="alpha-lower">
<list-item><p>the feasible design range within the legislative emission limits is substantially reduced in order to cope with emission influences resulting from variations in environmental and hardware conditions (drift);</p></list-item>
<list-item><p>a good deal of additional calibration work is required for the limitation of drift influences on the emissions;</p></list-item>
<list-item><p>raw-emission information for optimized aftertreatment operation is missing.</p></list-item>
</list>
<p>The basic approach to overcome these drawbacks is the integration of real-time emission information into appropriate engine control structures.</p>
<sec id="section3-1468087412442323">
<title>Review</title>
<p>First steps in the field of emission control for diesel engines were published by Alfieri.<sup><xref ref-type="bibr" rid="bibr9-1468087412442323">9</xref></sup> A control structure was proposed to jointly control the NO<sub>x</sub> emissions and the oxygen content of the exhaust. A model predictive approach with the torque, the centre of heat release, the maximum heat-release rate, the NO<sub>x</sub> and the PM (opacity) as controlled variables has been given by Karlsson et al.<sup><xref ref-type="bibr" rid="bibr10-1468087412442323">10</xref></sup> Furthermore, a model predictive approach for controlling the air path while limiting the NO<sub>x</sub> emissions has been proposed by Stewart and Borrelli.<sup><xref ref-type="bibr" rid="bibr11-1468087412442323">11</xref></sup> For a further advancement of emission control, however, a global definition of the objectives and issues of the integration of emission feedback is important for identifying trade-offs and for deducing an appropriate concept regarding the controlled variables, their setpoints and the manipulated variables.</p>
</sec>
<sec id="section4-1468087412442323">
<title>Control objectives and issues</title>
<p>Besides the provision of the required torque, the compliance with the legislative emission limits is a necessary requirement of a diesel engine system (including the aftertreatment). Competitive requirements are the minimization of the fuel consumption and a fast dynamic response of the system, where the former will gain importance with upcoming limitations on the emissions of <inline-formula id="inline-formula1-1468087412442323"><mml:math display="inline" id="math1-1468087412442323"><mml:mrow><mml:mtext>C</mml:mtext><mml:msub><mml:mrow><mml:mtext>O</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>.</p>
<p>To comply with future legislative emissions limits, aftertreatment devices for both NO<sub>x</sub> and PM are assumed to be unavoidable. Nevertheless, due to the limited conversion efficiency of the NO<sub>x</sub> aftertreatment device, the mandatory legislation on exhaust tailpipe emissions is coupled to the raw emissions of NO<sub>x</sub>.<sup><xref ref-type="bibr" rid="bibr12-1468087412442323">12</xref>,<xref ref-type="bibr" rid="bibr13-1468087412442323">13</xref></sup> As a consequence of the thermodynamic relations (i.e. Carnot cycle) and the NO<sub>x</sub> generation in a combustion process, a trade-off exists between fuel consumption and NO<sub>x</sub> emissions. The thermodynamic efficiency is maximized with high combustion temperatures, while, in contrast, the NO<sub>x</sub> formation principles require a low combustion temperature for low levels of NO<sub>x</sub>. The PM exhaust tailpipe emissions for a system with a DPF are not critical due to the high PM-removal efficiency (more than 95%) of a DPF.<sup><xref ref-type="bibr" rid="bibr14-1468087412442323">14</xref></sup> However, filter regeneration and increased back pressure can result in a fuel penalty of up to 3%,<sup><xref ref-type="bibr" rid="bibr15-1468087412442323">15</xref></sup> which results in a coupling of the PM emissions to the fuel-consumption requirement.</p>
<p>The most important trade-off regarding the emissions, however, is the PM–NO<sub>x</sub> trade-off that results from the NO<sub>x</sub> and PM formation principles. Generally, for low PM emissions, a high temperature and oxygen availability are required, while these conditions simultaneously lead to high levels of NO<sub>x</sub> emission.</p>
<p>A trade-off also exists between the requirements dynamic response and compliance with legislative emission limits. The limiting factor for rapid torque delivery are mainly the raw-emission peaks due to unbalanced gas composition. This means that a high-performance control of the air path is crucial for fast torque delivery with limited emission peaks. An overview of further issues, trade-offs and the development of diesel aftertreatment systems can be found in Zhao.<sup><xref ref-type="bibr" rid="bibr16-1468087412442323">16</xref></sup></p>
</sec>
<sec id="section5-1468087412442323">
<title>Concepts for emission control</title>
<p>For the integration of raw-emission feedback, two general concepts are proposed. The <italic>drift-adjustment concept</italic>, which is shown in <xref ref-type="fig" rid="fig2-1468087412442323">Figure 2</xref>, applies the emissions feedback to compensate for drift without using it directly as controlled variable. Engine actuation <inline-formula id="inline-formula2-1468087412442323"><mml:math display="inline" id="math2-1468087412442323"><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow></mml:math></inline-formula> is based on possibly drift-afflicted controlled variables <inline-formula id="inline-formula3-1468087412442323"><mml:math display="inline" id="math3-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>c</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. The corresponding reference values <inline-formula id="inline-formula4-1468087412442323"><mml:math display="inline" id="math4-1468087412442323"><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow></mml:math></inline-formula> are obtained from the governor (gov) position and the signals <inline-formula id="inline-formula5-1468087412442323"><mml:math display="inline" id="math5-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>r</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. The controlled variables <inline-formula id="inline-formula6-1468087412442323"><mml:math display="inline" id="math6-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>c</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> denote common controlled variables such as the boost pressure and the EGR rate. Examples for setpoint-generation signals <inline-formula id="inline-formula7-1468087412442323"><mml:math display="inline" id="math7-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>r</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are the speed of the engine, temperatures, etc. The emission feedback allows the adjustment of emission variations resulting from environmental or component drift by adapting setpoints and parameters in a relatively slow manner. The advantages of this concept are its integrability into existing control structures and the simplification of on-board diagnosis and engine calibration. A method to detect and classify drift for compensation has been provided by Schilling et al.<sup><xref ref-type="bibr" rid="bibr17-1468087412442323">17</xref></sup></p>
<fig id="fig2-1468087412442323" position="float">
<label>Figure 2.</label>
<caption>
<p>In the drift-adjustment concept, the emission feedback <inline-formula id="inline-formula8-1468087412442323"><mml:math display="inline" id="math8-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mrow><mml:mtext>emis</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is used to adapt reference-value parameters <inline-formula id="inline-formula9-1468087412442323"><mml:math display="inline" id="math9-1468087412442323"><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow></mml:math></inline-formula> that are obtained by interpolation on reference maps. As a consequence, emission influences resulting from drift on controlled variables <inline-formula id="inline-formula10-1468087412442323"><mml:math display="inline" id="math10-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>c</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and on signals <inline-formula id="inline-formula11-1468087412442323"><mml:math display="inline" id="math11-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>r</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> used for setpoint generation can be adjusted. <bold>e</bold> and <bold>u</bold> represent the error variable and the manipulated variable of the control loop, respectively.</p>
</caption>
<graphic xlink:href="10.1177_1468087412442323-fig2.tif"/>
</fig>
<p>In the <italic>emission-control concept</italic>, as outlined in <xref ref-type="fig" rid="fig3-1468087412442323">Figure 3</xref>, the emission feedback <inline-formula id="inline-formula12-1468087412442323"><mml:math display="inline" id="math12-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mrow><mml:mtext>emis</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is directly integrated into the control loop. Additional controlled variables <inline-formula id="inline-formula13-1468087412442323"><mml:math display="inline" id="math13-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>c</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are required to meet the other requirements on the system. In this concept, the setpoint-generation signals <inline-formula id="inline-formula14-1468087412442323"><mml:math display="inline" id="math14-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mrow><mml:mtext>r</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> contain the engine speed and, for example, aftertreatment information to enable emission-setpoint adaption, as proposed by Stewart and Borrelli.<sup><xref ref-type="bibr" rid="bibr11-1468087412442323">11</xref></sup> With direct feedback control of the raw emissions, the range of feasible engine actuation is increased as the emissions are known and feedback controlled. Therefore, such a concept offers the opportunity to shift the focus away from the emissions to requirements such as the brake-specific fuel consumption (BSFC) for example.</p>
<fig id="fig3-1468087412442323" position="float">
<label>Figure 3.</label>
<caption>
<p>The emission-control concept includes the emissions feedback <inline-formula id="inline-formula15-1468087412442323"><mml:math display="inline" id="math15-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mrow><mml:mtext>emis</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> directly into the control loop, together with additional controlled variables <inline-formula id="inline-formula16-1468087412442323"><mml:math display="inline" id="math16-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>c</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> that still might be drift-afflicted. The vector of reference values <bold>r</bold> is extended with the emission reference <bold>y</bold><sub>emis</sub>. <bold>e</bold> and <bold>u</bold> represent the error variable and the manipulated variable of the control loop, respectively.</p>
</caption>
<graphic xlink:href="10.1177_1468087412442323-fig3.tif"/>
</fig>
<p>As a consequence of integrating the emissions into control loops, the task of defining useful setpoints for the emissions arises. A detailed examination of adequate setpoints is beyond the scope of this paper. However, generally, a high-NO<sub>x</sub> setpoint strategy is recommendable, since in this case, due to the trade-offs stated above, the fuel consumption is minimized together with the PM emissions.</p>
</sec>
<sec id="section6-1468087412442323">
<title>Controlled and manipulated variables</title>
<p>Raw-emission feedback in this article is related to the emissions of NO<sub>x</sub> and particulates. Other species such as <inline-formula id="inline-formula17-1468087412442323"><mml:math display="inline" id="math17-1468087412442323"><mml:mrow><mml:mtext>CO</mml:mtext></mml:mrow></mml:math></inline-formula> or unburned hydrocarbons, which in systems with a diesel oxidation catalyst are an issue only during cold start, are not taken into account here. When only one of the signals is considered for control, the NO<sub>x</sub> signal is given priority over the signal of the PM. This choice is due to the characteristics of the respective emissions. The PM emissions are influenced in a highly nonlinear and hardly predictable manner by variations in the in-cylinder conditions and in the injection parameters. In contrast, the influence of in-cylinder conditions and injection parameters on the NO<sub>x</sub> emissions in the relevant operating range is monotonic and of the same order of magnitude.<sup><xref ref-type="bibr" rid="bibr18-1468087412442323">18</xref></sup></p>
<p>Aside from the air-path actuators, which are controlled in any case, the choice of appropriate actuators from fuel injection is also an issue. The most straightforward choice is to use the start of injection (SOI) since the main injection always occurs, and its influence on the emissions and the BSFC corresponds well with the trade-offs relevant for emission control. Regarding the many degrees of freedom of the fuel-injection system, a scheduling of the control action on multiple injection parameters would offer the potential of a higher control performance. However, a suitable scheduling solution would require an increased calibration effort or real-time combustion information. As such a solution is not within the scope of this work, it is not further discussed here. Readers interested in the potential and influences of injection features regarding the emissions are referred to Chryssakis et al.<sup><xref ref-type="bibr" rid="bibr6-1468087412442323">6</xref></sup></p>
</sec>
</sec>
</sec>
<sec id="section7-1468087412442323">
<title>Test facility and modelling</title>
<sec id="section8-1468087412442323">
<title>Engine test bench</title>
<p>Experiments have been carried out on a production-type diesel engine provided by Daimler AG, which is integrated on a test bench with a stationary eddy-current brake with a maximum brake power of 130 kW. The relevant characteristics of the engine are listed in <xref ref-type="table" rid="table1-1468087412442323">Table 1</xref>. For bypassing and data acquisition, the engine control unit (ECU) is accessed with an ES910 rapid prototyping module by ETAS. Aside from the standard sensors of the engine, several additional sensors have been integrated. The most relevant one is the NO<sub>x</sub> sensor by Continental (Uninox24V) located downstream of the turbine.</p>
<table-wrap id="table1-1468087412442323" position="float">
<label>Table 1.</label>
<caption>
<p>Engine characteristics.</p>
</caption>
<graphic alternate-form-of="table1-1468087412442323" xlink:href="10.1177_1468087412442323-table1.tif"/>
<table>
<colgroup>
<col align="left"/>
<col align="left"/>
</colgroup>
<tbody>
<tr>
<td align="left">Type</td>
<td align="left">OM 642</td>
</tr>
<tr>
<td>Technical data</td>
<td>3000cm<sup>3</sup>, six cylinders</td>
</tr>
<tr>
<td/>
<td>four valves/cylinder</td>
</tr>
<tr>
<td>Power</td>
<td>165 kW @ 3800 r/min</td>
</tr>
<tr>
<td>Torque (limited)</td>
<td>400 Nm</td>
</tr>
<tr>
<td>Features</td>
<td>cooled EGR, VGT, IPSO</td>
</tr>
<tr>
<td>Injection parameters</td>
<td>1800 bar maximum fuel pressure</td>
</tr>
<tr>
<td>Compression ratio</td>
<td>16.5</td>
</tr>
</tbody>
</table>
</table-wrap>
</sec>
<sec id="section9-1468087412442323">
<title>Modelling of the engine</title>
<p>For controller design, a simplified model has been deduced from a detailed mean-value model based on the principles described by Eriksson,<sup><xref ref-type="bibr" rid="bibr19-1468087412442323">19</xref></sup> and Guzzella and Onder.<sup><xref ref-type="bibr" rid="bibr20-1468087412442323">20</xref></sup> Due to its intended use for controller design, a high importance has been given to the low order of the model. Accordingly, it covers only the most important dynamics of the process. The model is composed of the following submodels: intake and exhaust manifolds, compressor and variable geometry turbine (VGT), turbocharger rotor inertia, mass flows through the EGR valve and engine, and the NO<sub>x</sub> emissions. A listing of the model variables and their definitions is given in <xref ref-type="app" rid="app1-1468087412442323">Appendix 1</xref>.</p>
<p>The model’s state <inline-formula id="inline-formula18-1468087412442323"><mml:math display="inline" id="math18-1468087412442323"><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow></mml:math></inline-formula> (1) is composed of six variables, namely the mass of air and of burned gas (BG) in the intake manifold (index <italic>im</italic>) and in the exhaust manifold (index <italic>em</italic>), the turbocharger kinetic energy represented by its speed <inline-formula id="inline-formula19-1468087412442323"><mml:math display="inline" id="math19-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mtext>tc</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and the NO<sub>x</sub> sensor state <inline-formula id="inline-formula20-1468087412442323"><mml:math display="inline" id="math20-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext>nox</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>,</p>
<p>
<disp-formula id="disp-formula1-1468087412442323">
<label>(1)</label>
<mml:math display="block" id="math21-1468087412442323">
<mml:mrow>
<mml:mi mathvariant="bold">z</mml:mi>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mspace width="0.25em"/>
<mml:msup>
<mml:mrow>
<mml:mo>[</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>air</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>im</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.25em"/>
<mml:msub>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>bg</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>im</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.25em"/>
<mml:msub>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>air</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>em</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.25em"/>
<mml:msub>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>bg</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>em</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.25em"/>
<mml:msub>
<mml:mrow>
<mml:mi>ω</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>tc</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.25em"/>
<mml:msub>
<mml:mrow>
<mml:mi>y</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>nox</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>]</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula1-1468087412442323" xlink:href="10.1177_1468087412442323-eq1.tif"/>
</disp-formula>
</p>
<p>where BG refers to the part of the exhaust gas, which corresponds to the product of a stoichiometric reaction of fuel and air. The recirculated exhaust gas, accordingly, is composed of BG and air.</p>
<p>The vector <inline-formula id="inline-formula21-1468087412442323"><mml:math display="inline" id="math22-1468087412442323"><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow></mml:math></inline-formula> (2) of the model inputs is composed of the positions of the EGR valve <inline-formula id="inline-formula22-1468087412442323"><mml:math display="inline" id="math23-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mtext>egr</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and VGT actuator <inline-formula id="inline-formula23-1468087412442323"><mml:math display="inline" id="math24-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mtext>vgt</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and of the SOI crank angle <inline-formula id="inline-formula24-1468087412442323"><mml:math display="inline" id="math25-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mtext>soi</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>.</p>
<p>
<disp-formula id="disp-formula2-1468087412442323">
<label>(2)</label>
<mml:math display="block" id="math26-1468087412442323">
<mml:mrow>
<mml:mi mathvariant="bold">v</mml:mi>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mspace width="0.25em"/>
<mml:msup>
<mml:mrow>
<mml:mo>[</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>u</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>egr</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.25em"/>
<mml:msub>
<mml:mrow>
<mml:mi>u</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>vgt</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.25em"/>
<mml:msub>
<mml:mrow>
<mml:mi>ϕ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>soi</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>]</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula2-1468087412442323" xlink:href="10.1177_1468087412442323-eq2.tif"/>
</disp-formula>
</p>
<p>The fuel mass flow <inline-formula id="inline-formula25-1468087412442323"><mml:math display="inline" id="math27-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>·</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and the engine speed <inline-formula id="inline-formula26-1468087412442323"><mml:math display="inline" id="math28-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mtext>e</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are not included in the vector of model inputs <inline-formula id="inline-formula27-1468087412442323"><mml:math display="inline" id="math29-1468087412442323"><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow></mml:math></inline-formula>. This is justified with the intention of deducing a model for the controller synthesis with the manipulated variables according to the section on controller design. The influence of variations in those two variables is thus considered as a disturbance on the plant.</p>
<p>The model outputs <inline-formula id="inline-formula28-1468087412442323"><mml:math display="inline" id="math30-1468087412442323"><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow></mml:math></inline-formula> (3) are the BG ratio <inline-formula id="inline-formula29-1468087412442323"><mml:math display="inline" id="math31-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>im</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and pressure <inline-formula id="inline-formula30-1468087412442323"><mml:math display="inline" id="math32-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>im</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> in the intake manifold and the NO<sub>x</sub> sensor signal <inline-formula id="inline-formula31-1468087412442323"><mml:math display="inline" id="math33-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext>nox</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, which is equal to its state,</p>
<p>
<disp-formula id="disp-formula3-1468087412442323">
<label>(3)</label>
<mml:math display="block" id="math34-1468087412442323">
<mml:mrow>
<mml:mi mathvariant="bold">w</mml:mi>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mspace width="0.25em"/>
<mml:msup>
<mml:mrow>
<mml:mo>[</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>im</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.25em"/>
<mml:msub>
<mml:mrow>
<mml:mi>p</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>im</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.25em"/>
<mml:msub>
<mml:mrow>
<mml:mi>y</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>nox</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>]</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula3-1468087412442323" xlink:href="10.1177_1468087412442323-eq3.tif"/>
</disp-formula>
</p>
<p>The resulting nonlinear model can be written as</p>
<p>
<disp-formula id="disp-formula4-1468087412442323">
<label>(4)</label>
<mml:math display="block" id="math35-1468087412442323">
<mml:mrow>
<mml:mtable align="left">
<mml:mtr>
<mml:mtd columnalign="center">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold">z</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mspace width="0.25em"/>
<mml:mi mathvariant="bold">f</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mi mathvariant="bold">z</mml:mi>
<mml:mo>,</mml:mo>
<mml:mspace width="0.25em"/>
<mml:mi mathvariant="bold">v</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="center" columnspan="1">
<mml:mrow>
<mml:mi mathvariant="bold">w</mml:mi>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mspace width="0.25em"/>
<mml:mi mathvariant="bold">g</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mi mathvariant="bold">z</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula4-1468087412442323" xlink:href="10.1177_1468087412442323-eq4.tif"/>
</disp-formula>
</p>
<p>A detailed description of the nonlinear model is given in <xref ref-type="app" rid="app2-1468087412442323">Appendix 2</xref>. The linearized and normalized analogue of (4) around an operating point (OP) can be written as</p>
<p>
<disp-formula id="disp-formula5-1468087412442323">
<label>(5)</label>
<mml:math display="block" id="math36-1468087412442323">
<mml:mrow>
<mml:mtable align="left">
<mml:mtr>
<mml:mtd columnalign="center">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold">x</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mspace width="0.25em"/>
<mml:mi mathvariant="bold">Ax</mml:mi>
<mml:mo>+</mml:mo>
<mml:mi mathvariant="bold">Bu</mml:mi>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="center" columnspan="1">
<mml:mrow>
<mml:mi mathvariant="bold">y</mml:mi>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mspace width="0.25em"/>
<mml:mi mathvariant="bold">Cx</mml:mi>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula5-1468087412442323" xlink:href="10.1177_1468087412442323-eq5.tif"/>
</disp-formula>
</p>
<p>where the variables <inline-formula id="inline-formula32-1468087412442323"><mml:math display="inline" id="math37-1468087412442323"><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula id="inline-formula33-1468087412442323"><mml:math display="inline" id="math38-1468087412442323"><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula id="inline-formula34-1468087412442323"><mml:math display="inline" id="math39-1468087412442323"><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow></mml:math></inline-formula> are the normalized deviations from the physical steady-state values at the OP <inline-formula id="inline-formula35-1468087412442323"><mml:math display="inline" id="math40-1468087412442323"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mtext>op</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mrow><mml:mtext>op</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mrow><mml:mtext>op</mml:mtext></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="inline-formula36-1468087412442323"><mml:math display="inline" id="math41-1468087412442323"><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula id="inline-formula37-1468087412442323"><mml:math display="inline" id="math42-1468087412442323"><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula id="inline-formula38-1468087412442323"><mml:math display="inline" id="math43-1468087412442323"><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow></mml:math></inline-formula> are the corresponding Jacobi matrices. <xref ref-type="fig" rid="fig4-1468087412442323">Figure 4</xref> shows a validation example of the nonlinear model (4) for the intake and exhaust manifold pressures and the exhaust air-fuel ratio <inline-formula id="inline-formula39-1468087412442323"><mml:math display="inline" id="math44-1468087412442323"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:math></inline-formula>, respectively.</p>
<fig id="fig4-1468087412442323" position="float">
<label>Figure 4.</label>
<caption>
<p>Modelled and measured (dotted) signals for load steps around 2800 r/min and 180 Nm. The left plot shows the pressures in the exhaust (grey) and intake manifolds, respectively. The right plot shows the exhaust air-to-fuel ratio.</p>
</caption>
<graphic xlink:href="10.1177_1468087412442323-fig4.tif"/>
</fig>
<p>The controlled variable <inline-formula id="inline-formula40-1468087412442323"><mml:math display="inline" id="math45-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>im</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> cannot be measured directly. However, it can be estimated from the fresh-air mass flow <inline-formula id="inline-formula41-1468087412442323"><mml:math display="inline" id="math46-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>·</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>hfm</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, the EGR mass flow <inline-formula id="inline-formula42-1468087412442323"><mml:math display="inline" id="math47-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>·</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>egr</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and the exhaust BG ratio <inline-formula id="inline-formula43-1468087412442323"><mml:math display="inline" id="math48-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>em</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, which is based on the exhaust air-to-fuel ratio <inline-formula id="inline-formula44-1468087412442323"><mml:math display="inline" id="math49-1468087412442323"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:math></inline-formula> (<xref ref-type="app" rid="app2-1468087412442323">Appendix 2</xref>). An estimate for <inline-formula id="inline-formula45-1468087412442323"><mml:math display="inline" id="math50-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>·</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>egr</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is available in the ECU</p>
<p>
<disp-formula id="disp-formula6-1468087412442323">
<label>(6)</label>
<mml:math display="block" id="math51-1468087412442323">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>im</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mspace width="0.25em"/>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mtext>egr</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>em</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mtext>egr</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mtext>hfm</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula6-1468087412442323" xlink:href="10.1177_1468087412442323-eq6.tif"/>
</disp-formula>
</p>
</sec>
</sec>
<sec id="section10-1468087412442323">
<title>Controller design</title>
<p>In this section, a control structure with the combined control of the air path and the NO<sub>x</sub> emissions is presented. This novel structure handles issues regarding air-path control and emissions with one single controller in an appropriate manner. The choice of the controlled and manipulated variables (particularly of NO<sub>x</sub> as a controlled variable) is in accordance with the discussion in the section on controlled and manipulated variables.</p>
<p>An analysis of the system shows that the influence of injection features on the air path is small. In the model, this influence is thus neglected. In contrast, the air-path actuators have a strong influence on all outputs of interest and, additionally, the air-path dynamics show non-minimum phase behaviour and strong multiple-input multiple-output (MIMO) characteristics.<sup><xref ref-type="bibr" rid="bibr21-1468087412442323">21</xref></sup> The couplings of the entire system thus can be sketched as shown in the block ‘Engine &amp; Sensors’ in <xref ref-type="fig" rid="fig5-1468087412442323">Figure 5</xref>.</p>
<fig id="fig5-1468087412442323" position="float">
<label>Figure 5.</label>
<caption>
<p>Basic structure of the novel controller with the multivariable NO<sub>x</sub> and air-path controller and the setpoint-adaption loop which multiplies the intake-BG reference value <inline-formula id="inline-formula46-1468087412442323"><mml:math display="inline" id="math52-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>x</mml:mtext><mml:mo>,</mml:mo><mml:mtext>im</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> with the adaption factor that is obtained with the deviation of the SOI manipulated variable <inline-formula id="inline-formula47-1468087412442323"><mml:math display="inline" id="math53-1468087412442323"><mml:mrow><mml:mi>δ</mml:mi><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mtext>soi</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. The couplings of the plant are indicated by dashed lines. For simplicity reasons, the feedforward path and anti-reset windup are not included in this figure. <italic>r</italic><sub>i</sub>, <italic>e</italic><sub>i</sub> and <italic>u</italic><sub>i</sub> represent the corresponding reference values, error variables, and manipulated variables, respectively. The controlled variables are the intake BG-rate <inline-formula id="inline-formula48-1468087412442323"><mml:math display="inline" id="math54-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>im</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, the boost pressure <inline-formula id="inline-formula49-1468087412442323"><mml:math display="inline" id="math55-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>im</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, and the <inline-formula id="inline-formula50-1468087412442323"><mml:math display="inline" id="math56-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mtext>NO</mml:mtext></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> level <inline-formula id="inline-formula51-1468087412442323"><mml:math display="inline" id="math57-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext>NOx</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. <inline-formula id="inline-formula52-1468087412442323"><mml:math display="inline" id="math58-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mtext>I</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="inline-formula53-1468087412442323"><mml:math display="inline" id="math59-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mtext>D</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are tuning parameters of the setpoint adaption loop.</p>
</caption>
<graphic xlink:href="10.1177_1468087412442323-fig5.tif"/>
</fig>
<p>Based on this analysis and on the statements in the section on control objectives and issues, the following preconditions for the controller design can be derived:</p>
<list id="list2-1468087412442323" list-type="alpha-lower">
<list-item><p>a MIMO controller for the air path is preferable for good performance;</p></list-item>
<list-item><p>using injection parameters as manipulated variables permits the NO<sub>x</sub> emissions to be controlled cycle by cycle with a negligible influence on the air path;</p></list-item>
<list-item><p>control of the NO<sub>x</sub>-emission levels solely via fuel-injection parameters may result in increased consumption due to unfavourable combustion timing with respect to the thermal efficiency.</p></list-item>
</list>
<p>In accordance with these observations, the new controller unites both concepts derived in the section on control objectives and issues. Its structure is shown in <xref ref-type="fig" rid="fig5-1468087412442323">Figure 5</xref>. It has the following key attributes:</p>
<list id="list3-1468087412442323" list-type="alpha-lower">
<list-item><p>a 3 × 3 multivariable controller for the <inline-formula id="inline-formula54-1468087412442323"><mml:math display="inline" id="math60-1468087412442323"><mml:mrow><mml:mtext>NOx</mml:mtext></mml:mrow></mml:math></inline-formula> and air path with the manipulated variables <inline-formula id="inline-formula55-1468087412442323"><mml:math display="inline" id="math61-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mtext>egr</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula id="inline-formula56-1468087412442323"><mml:math display="inline" id="math62-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mtext>vgt</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="inline-formula57-1468087412442323"><mml:math display="inline" id="math63-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mtext>soi</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> ;</p></list-item>
<list-item><p>a (slow) setpoint-adaption loop from the manipulated variable <inline-formula id="inline-formula58-1468087412442323"><mml:math display="inline" id="math64-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mtext>soi</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> to the intake-BG reference <inline-formula id="inline-formula59-1468087412442323"><mml:math display="inline" id="math65-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>x</mml:mtext><mml:mo>,</mml:mo><mml:mtext>im</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> to minimize increased consumption in steady state that can result from a prolonged actuation of the SOI (i.e. a deviation of the SOI from its calibration value).</p></list-item>
</list>
<p>The setpoint-adaption loop on the BG reference is explained in more detail in the section on controller tuning. It offers the opportunity to relax the issues related to drift in the air path and to the calibration of the BG rate. This is due to the fact that the intake-BG rate is adapted such that it automatically meets the NO<sub>x</sub> requirement, while the injection (in steady state) remains at the calibration value. Actually, the setpoint value of the BG rate is not of high interest when the NO<sub>x</sub> emissions are controlled in parallel. However, for a high-bandwidth air-path control, which is crucial for low emissions, direct control of the BG rate is indispensable.</p>
<p>A gain-scheduling technique<sup><xref ref-type="bibr" rid="bibr4-1468087412442323">4</xref></sup> could improve the performance for the operation of the controller over the entire operating range. This issue, however, is beyond the scope of this paper.</p>
<sec id="section11-1468087412442323">
<title>Controller tuning</title>
<p>The multivariable controller is designed as an optimal linear output feedback controller derived with the Linear-Quadratic-Gaussian method with Loop-Transfer-Recovery (LQG/LTR) according to Kwakernaak,<sup><xref ref-type="bibr" rid="bibr22-1468087412442323">22</xref></sup> Geering<sup><xref ref-type="bibr" rid="bibr23-1468087412442323">23</xref></sup> and Skogestadt and Postlethwaite.<sup><xref ref-type="bibr" rid="bibr24-1468087412442323">24</xref></sup> The choice of this method is motivated by its good performance and simplicity and by the low order of the resulting controller. Robustness issues of the controlled system are discussed in the section on robustness and anti reset-windup. The controller synthesis is based on the plant (5). To eliminate steady-state offset, the plant output is extended with proportional-integral (PI) elements (state <inline-formula id="inline-formula60-1468087412442323"><mml:math display="inline" id="math66-1468087412442323"><mml:mrow><mml:mi mathvariant="bold">ν</mml:mi></mml:mrow></mml:math></inline-formula>) for the controller synthesis</p>
<p>
<disp-formula id="disp-formula7-1468087412442323">
<label>(7)</label>
<mml:math display="block" id="math67-1468087412442323">
<mml:mrow>
<mml:mtable align="left">
<mml:mtr>
<mml:mtd columnalign="center">
<mml:mrow>
<mml:mrow>
<mml:mo>[</mml:mo>
<mml:mtable align="left">
<mml:mtr>
<mml:mtd columnalign="center">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold">x</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="center" columnspan="1">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>ν</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
<mml:mo>]</mml:mo>
</mml:mrow>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mspace width="0.25em"/>
<mml:mrow>
<mml:mo>[</mml:mo>
<mml:mtable align="left">
<mml:mtr>
<mml:mtd columnalign="center">
<mml:mrow>
<mml:mi mathvariant="bold">A</mml:mi>
</mml:mrow>
</mml:mtd>
<mml:mtd columnalign="center">
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="center" columnspan="1">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi mathvariant="bold">B</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>I</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mi mathvariant="bold">C</mml:mi>
</mml:mrow>
</mml:mtd>
<mml:mtd columnalign="center">
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
<mml:mo>]</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mo>[</mml:mo>
<mml:mtable align="left">
<mml:mtr>
<mml:mtd columnalign="center">
<mml:mrow>
<mml:mi mathvariant="bold">x</mml:mi>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="center" columnspan="1">
<mml:mrow>
<mml:mi mathvariant="bold">ν</mml:mi>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
<mml:mo>]</mml:mo>
</mml:mrow>
<mml:mo>+</mml:mo>
<mml:mrow>
<mml:mo>[</mml:mo>
<mml:mtable align="left">
<mml:mtr>
<mml:mtd columnalign="center">
<mml:mrow>
<mml:mi mathvariant="bold">B</mml:mi>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="center" columnspan="1">
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
<mml:mo>]</mml:mo>
</mml:mrow>
<mml:mi mathvariant="bold">u</mml:mi>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="center" columnspan="1">
<mml:mrow>
<mml:mi mathvariant="bold">y</mml:mi>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mspace width="0.25em"/>
<mml:mrow>
<mml:mo>[</mml:mo>
<mml:mtable align="left">
<mml:mtr>
<mml:mtd columnalign="center">
<mml:mrow>
<mml:mi mathvariant="bold">C</mml:mi>
</mml:mrow>
</mml:mtd>
<mml:mtd columnalign="center">
<mml:mrow>
<mml:mi mathvariant="bold">I</mml:mi>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
<mml:mo>]</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mo>[</mml:mo>
<mml:mtable align="left">
<mml:mtr>
<mml:mtd columnalign="center">
<mml:mrow>
<mml:mi mathvariant="bold">x</mml:mi>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="center" columnspan="1">
<mml:mrow>
<mml:mi mathvariant="bold">ν</mml:mi>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
<mml:mo>]</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula7-1468087412442323" xlink:href="10.1177_1468087412442323-eq7.tif"/>
</disp-formula>
</p>
<p>where <inline-formula id="inline-formula61-1468087412442323"><mml:math display="inline" id="math68-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mtext>I</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is a diagonal matrix defining the time constants of the PI elements. The values of these time constants need to be chosen in accordance with the plant characteristics and the specifications of the control system. The values used here are <inline-formula id="inline-formula62-1468087412442323"><mml:math display="inline" id="math69-1468087412442323"><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>1</mml:mn><mml:mtext>s</mml:mtext></mml:mrow></mml:math></inline-formula> for <inline-formula id="inline-formula63-1468087412442323"><mml:math display="inline" id="math70-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>im</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula id="inline-formula64-1468087412442323"><mml:math display="inline" id="math71-1468087412442323"><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>2</mml:mn><mml:mtext>s</mml:mtext></mml:mrow></mml:math></inline-formula> for <inline-formula id="inline-formula65-1468087412442323"><mml:math display="inline" id="math72-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>im</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="inline-formula66-1468087412442323"><mml:math display="inline" id="math73-1468087412442323"><mml:mrow><mml:mn>1</mml:mn><mml:mtext>s</mml:mtext></mml:mrow></mml:math></inline-formula> for <inline-formula id="inline-formula67-1468087412442323"><mml:math display="inline" id="math74-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext>nox</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. The value of the time constant on the NO<sub>x</sub> is motivated by the relatively slow dynamics of the sensor.</p>
<p>The weighting matrices of the regulator (<inline-formula id="inline-formula68-1468087412442323"><mml:math display="inline" id="math75-1468087412442323"><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula id="inline-formula69-1468087412442323"><mml:math display="inline" id="math76-1468087412442323"><mml:mrow><mml:mi mathvariant="bold">R</mml:mi></mml:mrow></mml:math></inline-formula>) and of the observer (<inline-formula id="inline-formula70-1468087412442323"><mml:math display="inline" id="math77-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mrow><mml:mtext>o</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="inline-formula71-1468087412442323"><mml:math display="inline" id="math78-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">R</mml:mi></mml:mrow><mml:mrow><mml:mtext>o</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) are obtained as</p>
<p>
<disp-formula id="disp-formula8-1468087412442323">
<label>(8)</label>
<mml:math display="block" id="math79-1468087412442323">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi mathvariant="bold">Q</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>o</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mspace width="0.25em"/>
<mml:mi mathvariant="bold">B</mml:mi>
<mml:msup>
<mml:mrow>
<mml:mi mathvariant="bold">B</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula8-1468087412442323" xlink:href="10.1177_1468087412442323-eq8.tif"/>
</disp-formula>
</p>
<p>
<disp-formula id="disp-formula9-1468087412442323">
<label>(9)</label>
<mml:math display="block" id="math80-1468087412442323">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi mathvariant="bold">R</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>o</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mspace width="0.25em"/>
<mml:mi>μ</mml:mi>
<mml:mo>·</mml:mo>
<mml:mi mathvariant="bold">I</mml:mi>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula9-1468087412442323" xlink:href="10.1177_1468087412442323-eq9.tif"/>
</disp-formula>
</p>
<p>
<disp-formula id="disp-formula10-1468087412442323">
<label>(10)</label>
<mml:math display="block" id="math81-1468087412442323">
<mml:mrow>
<mml:mi mathvariant="bold">Q</mml:mi>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mspace width="0.25em"/>
<mml:msup>
<mml:mrow>
<mml:mo>[</mml:mo>
<mml:mtable align="left">
<mml:mtr>
<mml:mtd columnalign="center">
<mml:mrow>
<mml:mi mathvariant="bold">C</mml:mi>
</mml:mrow>
</mml:mtd>
<mml:mtd columnalign="center">
<mml:mrow>
<mml:mi mathvariant="bold">I</mml:mi>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
<mml:mo>]</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
<mml:mrow>
<mml:mo>[</mml:mo>
<mml:mtable align="left">
<mml:mtr>
<mml:mtd columnalign="center">
<mml:mrow>
<mml:mi mathvariant="bold">C</mml:mi>
</mml:mrow>
</mml:mtd>
<mml:mtd columnalign="center">
<mml:mrow>
<mml:mi mathvariant="bold">I</mml:mi>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
<mml:mo>]</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula10-1468087412442323" xlink:href="10.1177_1468087412442323-eq10.tif"/>
</disp-formula>
</p>
<p>
<disp-formula id="disp-formula11-1468087412442323">
<label>(11)</label>
<mml:math display="block" id="math82-1468087412442323">
<mml:mrow>
<mml:mi mathvariant="bold">R</mml:mi>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mspace width="0.25em"/>
<mml:mi>ρ</mml:mi>
<mml:mo>·</mml:mo>
<mml:mi mathvariant="bold">I</mml:mi>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula11-1468087412442323" xlink:href="10.1177_1468087412442323-eq11.tif"/>
</disp-formula>
</p>
<p>where the parameters <inline-formula id="inline-formula72-1468087412442323"><mml:math display="inline" id="math83-1468087412442323"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="inline-formula73-1468087412442323"><mml:math display="inline" id="math84-1468087412442323"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula> are used to tune the observer and regulator of the controller, respectively. The adequate tuning with <inline-formula id="inline-formula74-1468087412442323"><mml:math display="inline" id="math85-1468087412442323"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula id="inline-formula75-1468087412442323"><mml:math display="inline" id="math86-1468087412442323"><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow></mml:math></inline-formula> is crucial for defining the robustness and bandwidth of the controlled system.</p>
<p>The controller gain <inline-formula id="inline-formula76-1468087412442323"><mml:math display="inline" id="math87-1468087412442323"><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">K</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is obtained the solution to the LQR problem for the extended plant (7) and contains the state feedback gains <inline-formula id="inline-formula77-1468087412442323"><mml:math display="inline" id="math88-1468087412442323"><mml:mrow><mml:mi mathvariant="bold">K</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula id="inline-formula78-1468087412442323"><mml:math display="inline" id="math89-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">K</mml:mi></mml:mrow><mml:mrow><mml:mtext>I</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> on the observed state of the plant <inline-formula id="inline-formula79-1468087412442323"><mml:math display="inline" id="math90-1468087412442323"><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> and on the integrator state <inline-formula id="inline-formula80-1468087412442323"><mml:math display="inline" id="math91-1468087412442323"><mml:mrow><mml:mi mathvariant="bold">ν</mml:mi></mml:mrow></mml:math></inline-formula>, respectively,</p>
<p>
<disp-formula id="disp-formula12-1468087412442323">
<label>(12)</label>
<mml:math display="block" id="math92-1468087412442323">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold">K</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mspace width="0.25em"/>
<mml:mrow>
<mml:mo>[</mml:mo>
<mml:mtable align="left">
<mml:mtr>
<mml:mtd columnalign="center">
<mml:mrow>
<mml:mi mathvariant="bold">K</mml:mi>
</mml:mrow>
</mml:mtd>
<mml:mtd columnalign="center">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi mathvariant="bold">K</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>I</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
<mml:mo>]</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula12-1468087412442323" xlink:href="10.1177_1468087412442323-eq12.tif"/>
</disp-formula>
</p>
<p>The observer gain matrix <inline-formula id="inline-formula81-1468087412442323"><mml:math display="inline" id="math93-1468087412442323"><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow></mml:math></inline-formula> is obtained as the solution to the dual problem. Additionally, a static feedforward path <inline-formula id="inline-formula82-1468087412442323"><mml:math display="inline" id="math94-1468087412442323"><mml:mrow><mml:mi mathvariant="bold">Λ</mml:mi></mml:mrow></mml:math></inline-formula> is implemented, which is calculated from the plant (5) and the state feedback gain <inline-formula id="inline-formula83-1468087412442323"><mml:math display="inline" id="math95-1468087412442323"><mml:mrow><mml:mi mathvariant="bold">K</mml:mi></mml:mrow></mml:math></inline-formula> as</p>
<p>
<disp-formula id="disp-formula13-1468087412442323">
<label>(13)</label>
<mml:math display="block" id="math96-1468087412442323">
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mi mathvariant="bold">Λ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mo>−</mml:mo>
<mml:mi>δ</mml:mi>
<mml:mo>·</mml:mo>
<mml:mi mathvariant="bold">C</mml:mi>
<mml:msup>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mi mathvariant="bold">A</mml:mi>
<mml:mo>−</mml:mo>
<mml:mi mathvariant="bold">BK</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
<mml:mi mathvariant="bold">B</mml:mi>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula13-1468087412442323" xlink:href="10.1177_1468087412442323-eq13.tif"/>
</disp-formula>
</p>
<p>The additional tuning parameter <inline-formula id="inline-formula84-1468087412442323"><mml:math display="inline" id="math97-1468087412442323"><mml:mrow><mml:mi>δ</mml:mi></mml:mrow></mml:math></inline-formula> can be used to limit the feedforward gain to avoid overshooting, which can result from the conjoint control action of the feedforward path and of the integrator extension in the case of reference steps. In this work, a value of <inline-formula id="inline-formula85-1468087412442323"><mml:math display="inline" id="math98-1468087412442323"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> has been chosen.</p>
<p>The setpoint-adaption loop basically consists of the integrator with time constant <inline-formula id="inline-formula86-1468087412442323"><mml:math display="inline" id="math99-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mtext>I</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mtext>I</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> for adaption of the BG reference <inline-formula id="inline-formula87-1468087412442323"><mml:math display="inline" id="math100-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>x</mml:mtext><mml:mo>,</mml:mo><mml:mtext>im</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig5-1468087412442323">Figure 5</xref>). The setpoint-adaption integrator is coupled via the plant with the integrator within the MIMO controller on the NO<sub>x</sub> deviation. To avoid oscillation of the coupled integrators, the additional ‘damping’ element <inline-formula id="inline-formula88-1468087412442323"><mml:math display="inline" id="math101-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mtext>D</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is required. With <inline-formula id="inline-formula89-1468087412442323"><mml:math display="inline" id="math102-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mtext>D</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, the NO<sub>x</sub> deviation is temporarily adapted such that the corresponding integrator in the MIMO controller is driven towards zero. Without this damping, the level of the integrator on the NO<sub>x</sub> deviation could be reduced solely by an appropriately signed deviation of the NO<sub>x</sub> emissions. This would result in slight oscillations around the NO<sub>x</sub> reference. For the experiments shown in the results and discussion section, a time constant of <inline-formula id="inline-formula90-1468087412442323"><mml:math display="inline" id="math103-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mtext>I</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>40</mml:mn><mml:mtext>s</mml:mtext></mml:mrow></mml:math></inline-formula> and a damping of <inline-formula id="inline-formula91-1468087412442323"><mml:math display="inline" id="math104-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mtext>D</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> have been chosen.</p>
<p>To minimize an inappropriate adaption of the intake-BG reference during transients (i.e. for temporarily high values of <inline-formula id="inline-formula92-1468087412442323"><mml:math display="inline" id="math105-1468087412442323"><mml:mrow><mml:mi>δ</mml:mi><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mtext>soi</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>), the input to the setpoint-adaption loop is limited (see <xref ref-type="fig" rid="fig5-1468087412442323">Figure 5</xref>). To avoid permanent setpoint adaption for varying operating points, the value of the setpoint-adaption integrator can be stored dependent on the OP.</p>
<p>It is also possible to integrate the setpoint-adaption loop directly into the MIMO controller with an appropriate plant extension. However, such an approach is less intuitive regarding the calibration, and thus is not in the focus of this work.</p>
</sec>
<sec id="section12-1468087412442323">
<title>Robustness and anti reset-windup</title>
<p>The robustness of a controller derived with the LQG/LTR method is not guaranteed for non-minimum phase plants.<sup><xref ref-type="bibr" rid="bibr22-1468087412442323">22</xref></sup> However, if the bandwidth of the controlled system is sufficiently small with respect to the non-minimum phase zero with the lowest frequency, the robustness specifications of the controlled system can be met.<sup><xref ref-type="bibr" rid="bibr23-1468087412442323">23</xref></sup><xref ref-type="fig" rid="fig6-1468087412442323">Figure 6</xref> shows the loop gain <inline-formula id="inline-formula93-1468087412442323"><mml:math display="inline" id="math106-1468087412442323"><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and the sensitivities <inline-formula id="inline-formula94-1468087412442323"><mml:math display="inline" id="math107-1468087412442323"><mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="inline-formula95-1468087412442323"><mml:math display="inline" id="math108-1468087412442323"><mml:mrow><mml:mi>T</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of the controlled system without the setpoint-adaption loop. Clearly, the crossover frequency is slightly more than one octave lower than the frequency of the non-minimum phase zero (indicated by a diamond). This is a compromise between robustness<sup><xref ref-type="bibr" rid="bibr23-1468087412442323">23</xref></sup> and a high bandwidth of the closed loop. The robustness is indicated in the lower plot in <xref ref-type="fig" rid="fig6-1468087412442323">Figure 6</xref>, which shows the return difference <inline-formula id="inline-formula96-1468087412442323"><mml:math display="inline" id="math109-1468087412442323"><mml:mrow><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of the loop. The 0 dB line is slightly undercut in the crossover frequency range. The robustness in this critical frequency range is thus met. The considerable differences between the minimum and the maximum singular-value trajectories are unavoidable due to the relatively slow sensor dynamics of the NO<sub>x</sub> sensor.</p>
<fig id="fig6-1468087412442323" position="float">
<label>Figure 6.</label>
<caption>
<p>Singular values of the loop gain <inline-formula id="inline-formula97-1468087412442323"><mml:math display="inline" id="math110-1468087412442323"><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>, the sensitivity <inline-formula id="inline-formula98-1468087412442323"><mml:math display="inline" id="math111-1468087412442323"><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:math></inline-formula> and the complementary sensitivity <inline-formula id="inline-formula99-1468087412442323"><mml:math display="inline" id="math112-1468087412442323"><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> (upper plot) and the return difference <inline-formula id="inline-formula100-1468087412442323"><mml:math display="inline" id="math113-1468087412442323"><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:math></inline-formula> (lower plot) of the controlled system. The diamond indicates the frequency of the non-minimum phase zero of the plant.</p>
</caption>
<graphic xlink:href="10.1177_1468087412442323-fig6.tif"/>
</fig>
<p>
<xref ref-type="fig" rid="fig7-1468087412442323">Figure 7</xref> shows the loop gain, sensitivity and complementary sensitivity of the controlled system with the setpoint-adaption loop. The controlled value <inline-formula id="inline-formula101-1468087412442323"><mml:math display="inline" id="math114-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>im</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is not an input/output of the loop in this case, since it is controlled on a lower level.</p>
<fig id="fig7-1468087412442323" position="float">
<label>Figure 7.</label>
<caption>
<p>Singular values of loop gain, the sensitivity and the complementary sensitivity (upper plot) and the return difference (lower plot) of the controlled system with the setpoint-adaption loop.</p>
</caption>
<graphic xlink:href="10.1177_1468087412442323-fig7.tif"/>
</fig>
<sec id="section13-1468087412442323">
<title>Anti reset-windup</title>
<p>Due to the characteristics of the system (no poles on the imaginary axis), integrators are required to attain the reference values without steady-state offset. As a result, anti reset-windup and bumpless transfer (AWBT) is indispensable to avoid significant overshoot or even instability in case of actuator saturation or switching from a different control mode. Furthermore, for the same cases, poor estimates of the observer state <inline-formula id="inline-formula102-1468087412442323"><mml:math display="inline" id="math115-1468087412442323"><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> have to be avoided. The latter issue can be solved by feeding back the actual manipulated variable after saturation <inline-formula id="inline-formula103-1468087412442323"><mml:math display="inline" id="math116-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mrow><mml:mtext>sat</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, as shown in <xref ref-type="fig" rid="fig8-1468087412442323">Figure 8</xref> and as proposed by Kothare et al.<sup><xref ref-type="bibr" rid="bibr25-1468087412442323">25</xref></sup> The AWBT solution for the integrator extension is based on a rather simple, but very effective trick. The integrator state <inline-formula id="inline-formula104-1468087412442323"><mml:math display="inline" id="math117-1468087412442323"><mml:mrow><mml:mi>ν</mml:mi></mml:mrow></mml:math></inline-formula> of the controller is adapted for AWBT with a coordinate transformation with the integrator state feedback <inline-formula id="inline-formula105-1468087412442323"><mml:math display="inline" id="math118-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">K</mml:mi></mml:mrow><mml:mrow><mml:mtext>I</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> as</p>
<fig id="fig8-1468087412442323" position="float">
<label>Figure 8.</label>
<caption>
<p>The output feedback controller with integrator, AWBT and the feedforward path with gain <inline-formula id="inline-formula106-1468087412442323"><mml:math display="inline" id="math119-1468087412442323"><mml:mrow><mml:mi mathvariant="bold">Λ</mml:mi></mml:mrow></mml:math></inline-formula>. Note that the setpoint-adaption loop is not shown. <bold>I</bold> is the identity matrix and <bold>k</bold><sub>aw</sub> is a diagonal matrix to avoid windup on each channel of the saturated manipulated variable <bold>u</bold><sub>sat</sub>. <bold>r</bold>, <bold>y</bold>, and <bold>e</bold> represent the reference, the controlled variable, and the error variable, respectively.</p>
</caption>
<graphic xlink:href="10.1177_1468087412442323-fig8.tif"/>
</fig>
<p>
<disp-formula id="disp-formula14-1468087412442323">
<label>(14)</label>
<mml:math display="block" id="math120-1468087412442323">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>ν</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mspace width="0.25em"/>
<mml:msub>
<mml:mrow>
<mml:mi mathvariant="bold">K</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>I</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mi mathvariant="bold">ν</mml:mi>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula14-1468087412442323" xlink:href="10.1177_1468087412442323-eq14.tif"/>
</disp-formula>
</p>
<p>As a result of this transformation, each state variable <inline-formula id="inline-formula107-1468087412442323"><mml:math display="inline" id="math121-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi>ν</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>i</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> of the integrator influences just one manipulated variable and therefore can be halted in case of saturation of the corresponding actuator,</p>
<p>
<disp-formula id="disp-formula15-1468087412442323">
<label>(15)</label>
<mml:math display="block" id="math122-1468087412442323">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi mathvariant="bold">u</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>I</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mspace width="0.25em"/>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi mathvariant="bold">K</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>I</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mi>ν</mml:mi>
<mml:mo>=</mml:mo>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi mathvariant="bold">K</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>I</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:msubsup>
<mml:mrow>
<mml:mi mathvariant="bold">K</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>I</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msubsup>
<mml:mover>
<mml:mrow>
<mml:mi>ν</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula15-1468087412442323" xlink:href="10.1177_1468087412442323-eq15.tif"/>
</disp-formula>
</p>
<p>
<disp-formula id="disp-formula16-1468087412442323">
<label>(16)</label>
<mml:math display="block" id="math123-1468087412442323">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold">ν</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mspace width="0.25em"/>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi mathvariant="bold">K</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>I</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mrow>
<mml:mi mathvariant="bold">B</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>I</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mi mathvariant="bold">e</mml:mi>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula16-1468087412442323" xlink:href="10.1177_1468087412442323-eq16.tif"/>
</disp-formula>
</p>
<p>
<xref ref-type="fig" rid="fig8-1468087412442323">Figure 8</xref> shows the structure of the multivariable controller with AWBT, the feedforward path and the saturation. The setpoint-adaption loop is not shown in this figure.</p>
<p>To avoid excessive smoke, the intake-BG ratio needs to be limited. Therefore, the implementation of AWBT is required also on the setpoint-adaption loop to the intake-BG rate, which is trivial.</p>
</sec>
</sec>
</sec>
<sec id="section14-1468087412442323" sec-type="results|discussion">
<title>Results and discussion</title>
<sec id="section15-1468087412442323">
<title>Experimental testing of the control structure</title>
<p>The performance of the control structure presented has been tested with steps in the controlled variables at various operating points. <xref ref-type="fig" rid="fig9-1468087412442323">Figure 9</xref> shows reference-tracking results for a step in the boost-pressure reference <inline-formula id="inline-formula108-1468087412442323"><mml:math display="inline" id="math124-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>p</mml:mtext><mml:mo>,</mml:mo><mml:mtext>im</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> at 2500 r/min, 160 Nm. Clearly, the boost-pressure tracking performance is good. The deviations in NO<sub>x</sub> and in the intake-BG rate resulting from this significant boost-pressure step are small. Analogously to the reference tracking of the boost pressure, the tracking performance of the intake-BG step shown in <xref ref-type="fig" rid="fig10-1468087412442323">Figure 10</xref> is also quite satisfactory. For this major step in <inline-formula id="inline-formula109-1468087412442323"><mml:math display="inline" id="math125-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>x</mml:mtext><mml:mo>,</mml:mo><mml:mtext>im</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, the deviation in the NO<sub>x</sub> trajectory is remarkably small. Clearly, the setpoint-adaption loop on the intake-BG lowers the value of <inline-formula id="inline-formula110-1468087412442323"><mml:math display="inline" id="math126-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>x</mml:mtext><mml:mo>,</mml:mo><mml:mtext>im</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> to avoid increased fuel consumption due to the suboptimal combustion timing resulting from SOI actuation. As a result, the intake-BG is adapted such that the NO<sub>x</sub>-emission reference is met without unfavourable injection timing. The experiment shown in <xref ref-type="fig" rid="fig10-1468087412442323">Figure 10</xref> also corresponds to the case where drift occurs in an engine component resulting in deviated NO<sub>x</sub> emissions. In that case, too, the intake-BG rate is adapted such that the emissions meet the reference without unfavourable injection timing.</p>
<fig id="fig9-1468087412442323" position="float">
<label>Figure 9.</label>
<caption>
<p>Boost-pressure step response at 2500 r/min, 160 Nm. The reference trajectories are drawn in grey. The lower right plot shows the EGR (grey) and VGT actuator trajectories.</p>
</caption>
<graphic xlink:href="10.1177_1468087412442323-fig9.tif"/>
</fig>
<fig id="fig10-1468087412442323" position="float">
<label>Figure 10.</label>
<caption>
<p>Intake-BG step response at 2300 r/min, 130 Nm. The reference trajectories are drawn in grey. The SOI trajectory shown in the lower right plot compensates the <inline-formula id="inline-formula111-1468087412442323"><mml:math display="inline" id="math127-1468087412442323"><mml:mrow><mml:mtext>N</mml:mtext><mml:msub><mml:mrow><mml:mtext>O</mml:mtext></mml:mrow><mml:mrow><mml:mtext>x</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> influence resulting from BG variation. The operating point SOI is shown in grey. The reduction of the BG reference is due to the setpoint-adaption loop as a result of the SOI actuation.</p>
</caption>
<graphic xlink:href="10.1177_1468087412442323-fig10.tif"/>
</fig>
<p>Reference tracking for NO<sub>x</sub> steps is shown in <xref ref-type="fig" rid="fig11-1468087412442323">Figure 11</xref>. The tracking performance is good. In this case, too, the adaption of the BG reference <inline-formula id="inline-formula112-1468087412442323"><mml:math display="inline" id="math128-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mtext>x</mml:mtext><mml:mo>,</mml:mo><mml:mtext>im</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> to avoid unfavourable SOI variation is clearly visible. At first, the reference step is tracked with SOI actuation, which results in an adaption of the BG reference and decreasing SOI actuation. <xref ref-type="fig" rid="fig12-1468087412442323">Figures 12</xref> and 13 show the performance of the control structure presented for load steps at 2500 r/min around 160 Nm and for speed steps at 130 Nm, respectively. Again, the control performance is quite satisfactory, even though for the harsh load steps, the intake-BG rate and boost pressure tend to overshoot. In <xref ref-type="fig" rid="fig13-1468087412442323">Figure 13</xref>, the deviations from the reference trajectories are fairly small, except for the overshoot in the boost pressure, which is observed after the acceleration.</p>
<fig id="fig11-1468087412442323" position="float">
<label>Figure 11.</label>
<caption>
<p>
<inline-formula id="inline-formula113-1468087412442323">
<mml:math display="block" id="math129-1468087412442323">
<mml:mrow>
<mml:mtext>N</mml:mtext>
<mml:msub>
<mml:mrow>
<mml:mtext>O</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mtext>x</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> step response at 2700 r/min, 180 Nm. The reference trajectories are drawn in grey. The SOI trajectory and its operating point value (grey) are shown in the lower right plot.</p>
</caption>
<graphic xlink:href="10.1177_1468087412442323-fig11.tif"/>
</fig>
<fig id="fig12-1468087412442323" position="float">
<label>Figure 12.</label>
<caption>
<p>Controller performance for load steps at2500 /min around 160 Nm. The reference values are drawn in grey. In the centre right plot, the trajectories of the EGR (grey) and VGT actuators are shown. The lower right plot shows the engine load (governor position).</p>
</caption>
<graphic xlink:href="10.1177_1468087412442323-fig12.tif"/>
</fig>
<fig id="fig13-1468087412442323" position="float">
<label>Figure 13.</label>
<caption>
<p>Controller performance for speed transients at 130 Nm. The reference values are drawn in grey. The lower right plot shows the engine speed.</p>
</caption>
<graphic xlink:href="10.1177_1468087412442323-fig13.tif"/>
</fig>
<p>
<xref ref-type="fig" rid="fig14-1468087412442323">Figure 14</xref> shows a comparison of the presented control structure and the conventional production-type controller (in grey) for the same experiment as that shown in <xref ref-type="fig" rid="fig12-1468087412442323">Figure 12</xref>. While the NO<sub>x</sub> emissions are limited at a lower value in the case of the controller presented, the fuel consumption remains approximately the same. The particulate emissions, measured with an AVL micro soot sensor, are also slightly better and with reduced peaks compared to the production-type controller. <xref ref-type="fig" rid="fig14-1468087412442323">Figure 14</xref> thus demonstrates that the performance of the proposed controller is competitive with regard to the production-type controller, while it offers the benefit of setting the NO<sub>x</sub>-emission level at a desired value with a minimum of unfavourable control action on the SOI.</p>
<fig id="fig14-1468087412442323" position="float">
<label>Figure 14.</label>
<caption>
<p>Emissions and SOI trajectories for the controller presented in comparison with the production-type controller (grey) for load steps at 2500 r/min around 160 Nm. The bottom plots show the cumulated fuel consumption and the brake torque trajectories for both measurements.</p>
</caption>
<graphic xlink:href="10.1177_1468087412442323-fig14.tif"/>
</fig>
</sec>
</sec>
<sec id="section16-1468087412442323">
<title>Conclusion and outlook</title>
<p>The provision of raw-emission feedback control for diesel engines is one of the next consistent steps in the technological development of such systems. As a contribution to this development, this work has provided a discussion about the issues arising in context with raw-emission feedback and proposes a novel structure for controlling the air path and the NO<sub>x</sub> emissions simultaneously.</p>
<p>The section on emission feedback control shows that the availability of raw-emission feedback offers the possibility to eliminate drawbacks of current production-type engines. As a result, the engine performance regarding its various and coupled requirements can be improved. Additionally, with raw-emission feedback, the number of compensation functions can be reduced since the emission variability is minimized, which results in a simplified engine calibration.</p>
<p>In accordance with the issues in the context of emission feedback control that are described in the section on control objectives and issues, a novel control structure has been derived that comprises feedback of the NO<sub>x</sub> emissions. The core of the presented structure consists of an optimal linear output feedback controller that is fairly simple, yet well adapted to the complexity of the plant. Compared to the tuning of common controllers with multiple single-input-single-output loops, the tuning of this controller is effortless due to its model-based synthesis. The windup problem in connection with the integrator extension of the presented controller has been solved. To avoid unfavourable injection timing associated with the combined control of the EGR and the NO<sub>x</sub>, a setpoint-adaption loop has been implemented that shifts the BG rate reference such that the emission requirements are met while maintaining a low fuel consumption.</p>
<p>Experiments conducted on the engine test bench have shown that the controller presented has a good reference-tracking performance for all controlled variables. Furthermore, any deviations in the NO<sub>x</sub> emissions resulting from component drift or environmental variability can be eliminated effectively. Due to the relatively slow sensor, NO<sub>x</sub> control in the timescale of engine transients is mainly based on feedforward action. A comparison between the production-type and the proposed control structure has shown that despite a reduced calibration effort, the latter is able to meet the NO<sub>x</sub>-emission reference without increasing fuel consumption.</p>
<p>With respect to the drawbacks of current engine control structures listed in the section on emission feedback control, the advantages of the proposed controller can be summarized.</p>
<list id="list4-1468087412442323" list-type="order">
<list-item><p>Control of influences on the NO<sub>x</sub> emissions in the short (limited), medium and long timescale, resulting in a substantially reduced emission variability due to drift. The timescales correspond to transients, variations in environmental conditions and component ageing, respectively.</p></list-item>
<list-item><p>Low-effort calibration of the controller due to the very few tuning parameters.</p></list-item>
<list-item><p>Synchronizable control of the engine and the aftertreatment due to feedback control of the emissions.</p>
<p>Furthermore,</p></list-item>
<list-item><p>Minimization of the fuel penalty resulting from unfavourable injection timing in association with NO<sub>x</sub> control due to adaption of the BG-rate setpoint.</p></list-item>
<list-item><p>Control of the air path in combination with the NO<sub>x</sub> emissions with a controller that is well adapted to the coupled plant and its requirements.</p></list-item>
</list>
<p>Issues that need to be resolved to implement such a control structure in production-type applications are the determination of appropriate setpoints for the NO<sub>x</sub> raw emissions within the operating range in connection with the characteristics of aftertreatment devices and certification driving cycles. Furthermore, a gain-scheduling technique is required for adequate control in the entire operating range.</p>
</sec>
</body>
<back>
<app-group>
<app id="app1-1468087412442323">
<title>Appendix 1</title>
<sec id="section17-1468087412442323">
<title>Notation</title>
<p>
<inline-formula id="inline-formula114-1468087412442323">
<mml:math display="block" id="math130-1468087412442323">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>p</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> specific heat capacity at constant pressure</p>
<p>
<inline-formula id="inline-formula115-1468087412442323">
<mml:math display="block" id="math131-1468087412442323">
<mml:mrow>
<mml:mi mathvariant="bold">e</mml:mi>
</mml:mrow>
</mml:math>
</inline-formula> vector of error variables</p>
<p>
<inline-formula id="inline-formula116-1468087412442323">
<mml:math display="block" id="math132-1468087412442323">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>H</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>l</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> lower heating value of the fuel</p>
<p>
<inline-formula id="inline-formula117-1468087412442323">
<mml:math display="block" id="math133-1468087412442323">
<mml:mrow>
<mml:mi mathvariant="bold">I</mml:mi>
</mml:mrow>
</mml:math>
</inline-formula> identity matrix</p>
<p>
<inline-formula id="inline-formula118-1468087412442323">
<mml:math display="block" id="math134-1468087412442323">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>i</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> controller parameter i</p>
<p>
<inline-formula id="inline-formula119-1468087412442323">
<mml:math display="block" id="math135-1468087412442323">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mtext>φ</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> fuel flow into the engine</p>
<p>
<inline-formula id="inline-formula120-1468087412442323">
<mml:math display="block" id="math136-1468087412442323">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>air</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>i</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> air mass in receiver i</p>
<p>
<inline-formula id="inline-formula121-1468087412442323">
<mml:math display="block" id="math137-1468087412442323">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>bg</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>i</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> BG mass in receiver i</p>
<p>
<inline-formula id="inline-formula122-1468087412442323">
<mml:math display="block" id="math138-1468087412442323">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mtext>c</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> mass flow through the compressor</p>
<p>
<inline-formula id="inline-formula123-1468087412442323">
<mml:math display="block" id="math139-1468087412442323">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mtext>e</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> mass flow through the engine</p>
<p>
<inline-formula id="inline-formula124-1468087412442323">
<mml:math display="block" id="math140-1468087412442323">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mtext>egr</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> mass flow through the EGR valve</p>
<p>
<inline-formula id="inline-formula125-1468087412442323">
<mml:math display="block" id="math141-1468087412442323">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mtext>hfm</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> fresh air mass flow</p>
<p>
<inline-formula id="inline-formula126-1468087412442323">
<mml:math display="block" id="math142-1468087412442323">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mtext>t</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> mass flow through the VGT</p>
<p>
<inline-formula id="inline-formula127-1468087412442323">
<mml:math display="block" id="math143-1468087412442323">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>p</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>i</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> pressure within a receiver</p>
<p>
<inline-formula id="inline-formula128-1468087412442323">
<mml:math display="block" id="math144-1468087412442323">
<mml:mrow>
<mml:mi>R</mml:mi>
</mml:mrow>
</mml:math>
</inline-formula> specific gas constant</p>
<p>
<inline-formula id="inline-formula129-1468087412442323">
<mml:math display="block" id="math145-1468087412442323">
<mml:mrow>
<mml:mi mathvariant="bold">r</mml:mi>
</mml:mrow>
</mml:math>
</inline-formula> vector of reference values</p>
<p>
<inline-formula id="inline-formula130-1468087412442323">
<mml:math display="block" id="math146-1468087412442323">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>i</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> torque of device i</p>
<p>
<inline-formula id="inline-formula131-1468087412442323">
<mml:math display="block" id="math147-1468087412442323">
<mml:mrow>
<mml:mi mathvariant="bold">u</mml:mi>
</mml:mrow>
</mml:math>
</inline-formula> vector of manipulated variables</p>
<p>
<inline-formula id="inline-formula132-1468087412442323">
<mml:math display="block" id="math148-1468087412442323">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>u</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>egr</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> position of the EGR valve</p>
<p>
<inline-formula id="inline-formula133-1468087412442323">
<mml:math display="block" id="math149-1468087412442323">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>u</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>vgt</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> position of the VGT actuator</p>
<p>
<inline-formula id="inline-formula134-1468087412442323">
<mml:math display="block" id="math150-1468087412442323">
<mml:mrow>
<mml:mi mathvariant="bold">v</mml:mi>
</mml:mrow>
</mml:math>
</inline-formula> vector of physical model inputs</p>
<p>
<inline-formula id="inline-formula135-1468087412442323">
<mml:math display="block" id="math151-1468087412442323">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>V</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>d</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> displaced volume of the engine</p>
<p>
<inline-formula id="inline-formula136-1468087412442323">
<mml:math display="block" id="math152-1468087412442323">
<mml:mrow>
<mml:mi mathvariant="bold">w</mml:mi>
</mml:mrow>
</mml:math>
</inline-formula> vector of physical model outputs</p>
<p>
<inline-formula id="inline-formula137-1468087412442323">
<mml:math display="block" id="math153-1468087412442323">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>i</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> BG ratio in receiver i</p>
<p>
<inline-formula id="inline-formula138-1468087412442323">
<mml:math display="block" id="math154-1468087412442323">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>y</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>nox</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> signal of the <inline-formula id="inline-formula139-1468087412442323"><mml:math display="inline" id="math155-1468087412442323"><mml:mrow><mml:mtext>N</mml:mtext><mml:msub><mml:mrow><mml:mtext>O</mml:mtext></mml:mrow><mml:mrow><mml:mtext>x</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> sensor</p>
<p>
<inline-formula id="inline-formula140-1468087412442323">
<mml:math display="block" id="math156-1468087412442323">
<mml:mrow>
<mml:mi mathvariant="bold">y</mml:mi>
</mml:mrow>
</mml:math>
</inline-formula> vector of controlled variables</p>
<p>
<inline-formula id="inline-formula141-1468087412442323">
<mml:math display="block" id="math157-1468087412442323">
<mml:mrow>
<mml:mi mathvariant="bold">z</mml:mi>
</mml:mrow>
</mml:math>
</inline-formula> vector of physical model state variables</p>
<p>
<inline-formula id="inline-formula142-1468087412442323">
<mml:math display="block" id="math158-1468087412442323">
<mml:mrow>
<mml:mi>ϵ</mml:mi>
</mml:mrow>
</mml:math>
</inline-formula> compression ratio</p>
<p>
<inline-formula id="inline-formula143-1468087412442323">
<mml:math display="block" id="math159-1468087412442323">
<mml:mrow>
<mml:mi>κ</mml:mi>
</mml:mrow>
</mml:math>
</inline-formula> ratio of specific heats</p>
<p>
<inline-formula id="inline-formula144-1468087412442323">
<mml:math display="block" id="math160-1468087412442323">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>λ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>lp</mml:mtext>
<mml:mo stretchy="false">/</mml:mo>
<mml:mtext>l</mml:mtext>
<mml:mi>ω</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> volumetric efficiency coefficients</p>
<p>
<inline-formula id="inline-formula145-1468087412442323">
<mml:math display="block" id="math161-1468087412442323">
<mml:mrow>
<mml:mi>λ</mml:mi>
</mml:mrow>
</mml:math>
</inline-formula> air-to-fuel ratio</p>
<p>
<inline-formula id="inline-formula146-1468087412442323">
<mml:math display="block" id="math162-1468087412442323">
<mml:mrow>
<mml:mi>Λ</mml:mi>
</mml:mrow>
</mml:math>
</inline-formula> controller feedforward gain</p>
<p>
<inline-formula id="inline-formula147-1468087412442323">
<mml:math display="block" id="math163-1468087412442323">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>ω</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>e</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> engine speed</p>
<p>
<inline-formula id="inline-formula148-1468087412442323">
<mml:math display="block" id="math164-1468087412442323">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>ω</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>tc</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> turbocharger speed</p>
<p>
<inline-formula id="inline-formula149-1468087412442323">
<mml:math display="block" id="math165-1468087412442323">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>ϕ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>soi</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> SOI crank angle</p>
<p>
<inline-formula id="inline-formula150-1468087412442323">
<mml:math display="block" id="math166-1468087412442323">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>σ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>st</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> stoichiometric air-to-fuel ratio</p>
<p>
<inline-formula id="inline-formula151-1468087412442323">
<mml:math display="block" id="math167-1468087412442323">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>ϑ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>i</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> gas temperature in receiver i</p>
<p> </p>
<p><italic>Abbreviations</italic> </p>
<p>AWBT anti reset-windup and bumpless transfer</p>
<p>BG burned gas</p>
<p>BSFC brake-specific fuel consumption</p>
<p>BTDC before top dead centre</p>
<p>DPF diesel particulate filter</p>
<p>ECU electronic control unit</p>
<p>EGR exhaust gas recirculation</p>
<p>GOV governor position</p>
<p>IPSO intake port shut-off</p>
<p>MIMO multiple-input multiple-output</p>
<p>OP operating point</p>
<p>PM particulate matter</p>
<p>SOI start of injection</p>
<p>VGT variable geometry turbine</p>
</sec>
</app>
<app id="app2-1468087412442323">
<title>Appendix 2</title>
<sec id="section18-1468087412442323">
<title>Modelling</title>
<p>The submodels described are intended for controller synthesis. Therefore, only the most relevant dynamic phenomena are included in the model.</p>
</sec>
<sec id="section19-1468087412442323">
<title>Manifolds</title>
<p>The manifolds are modelled as isothermal receivers for air and BG. With the fuel flow into the cylinders <inline-formula id="inline-formula152-1468087412442323"><mml:math display="inline" id="math168-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>·</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and the BG ratio as defined in (21), the mass balances for the receivers are obtained as shown in <xref ref-type="disp-formula" rid="disp-formula17-1468087412442323">equations (17)</xref><xref ref-type="disp-formula" rid="disp-formula18-1468087412442323"/><xref ref-type="disp-formula" rid="disp-formula20-1468087412442323"/>–<xref ref-type="disp-formula" rid="disp-formula21-1468087412442323">(20)</xref>,</p>
<p>
<disp-formula id="disp-formula17-1468087412442323">
<label>(17)</label>
<mml:math display="block" id="math169-1468087412442323">
<mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:mi>d</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>dt</mml:mi>
</mml:mrow>
</mml:mfrac>
<mml:msub>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>air</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>im</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mspace width="0.25em"/>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mtext>c</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>em</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mtext>egr</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>im</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mtext>e</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula17-1468087412442323" xlink:href="10.1177_1468087412442323-eq17.tif"/>
</disp-formula>
</p>
<p>
<disp-formula id="disp-formula18-1468087412442323">
<label>(18)</label>
<mml:math display="block" id="math170-1468087412442323">
<mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:mi>d</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>dt</mml:mi>
</mml:mrow>
</mml:mfrac>
<mml:msub>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>bg</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>im</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mspace width="0.25em"/>
<mml:msub>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>em</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mtext>egr</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>im</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mtext>e</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula18-1468087412442323" xlink:href="10.1177_1468087412442323-eq18.tif"/>
</disp-formula>
</p>
<p>
<disp-formula id="disp-formula19-1468087412442323">
<mml:math display="block" id="math171-1468087412442323">
<mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:mi>d</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>dt</mml:mi>
</mml:mrow>
</mml:mfrac>
<mml:msub>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>air</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>em</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>im</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mtext>e</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mtext>φ</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mrow>
<mml:mi>σ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>st</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula19-1468087412442323" xlink:href="10.1177_1468087412442323-eq19.tif"/>
</disp-formula>
</p>
<p>
<disp-formula id="disp-formula20-1468087412442323">
<label>(19)</label>
<mml:math display="block" id="math172-1468087412442323">
<mml:mrow>
<mml:mspace width="0.25em"/>
<mml:mspace width="0.25em"/>
<mml:mspace width="0.25em"/>
<mml:mspace width="0.25em"/>
<mml:mspace width="0.25em"/>
<mml:mspace width="0.25em"/>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>em</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mtext>egr</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mtext>t</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula20-1468087412442323" xlink:href="10.1177_1468087412442323-eq20.tif"/>
</disp-formula>
</p>
<p>
<disp-formula id="disp-formula21-1468087412442323">
<label>(20)</label>
<mml:math display="block" id="math173-1468087412442323">
<mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:mi>d</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>dt</mml:mi>
</mml:mrow>
</mml:mfrac>
<mml:msub>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>bg</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>em</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mspace width="0.25em"/>
<mml:msub>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>im</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mtext>e</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mtext>φ</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>σ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>st</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>em</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mtext>egr</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mtext>t</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula21-1468087412442323" xlink:href="10.1177_1468087412442323-eq21.tif"/>
</disp-formula>
</p>
<p>The BG ratio in the receivers is defined as</p>
<p>
<disp-formula id="disp-formula22-1468087412442323">
<label>(21)</label>
<mml:math display="block" id="math174-1468087412442323">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>i</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mspace width="0.25em"/>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>bg</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>i</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>bg</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>i</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>air</mml:mtext>
<mml:mo>,</mml:mo>
<mml:mtext>i</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula22-1468087412442323" xlink:href="10.1177_1468087412442323-eq22.tif"/>
</disp-formula>
</p>
<p>The exhaust manifold BG rate is related to the measured air-to-fuel ratio <inline-formula id="inline-formula153-1468087412442323"><mml:math display="inline" id="math175-1468087412442323"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:math></inline-formula> as</p>
<p>
<disp-formula id="disp-formula23-1468087412442323">
<label>(22)</label>
<mml:math display="block" id="math176-1468087412442323">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>em</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mspace width="0.25em"/>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>+</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>σ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>st</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>·</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>λ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula23-1468087412442323" xlink:href="10.1177_1468087412442323-eq23.tif"/>
</disp-formula>
</p>
<p>The pressure in the receivers is obtained with the perfect-gas assumption and the receiver volume <inline-formula id="inline-formula154-1468087412442323"><mml:math display="inline" id="math177-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mtext>i</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p>
<p>
<disp-formula id="disp-formula24-1468087412442323">
<label>(23)</label>
<mml:math display="block" id="math178-1468087412442323">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>p</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>i</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mspace width="0.25em"/>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>i</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mi>R</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mi>ϑ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>i</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>V</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>i</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula24-1468087412442323" xlink:href="10.1177_1468087412442323-eq24.tif"/>
</disp-formula>
</p>
</sec>
<sec id="section20-1468087412442323">
<title>Turbocharger</title>
<p>For the compressor mass flow, the model from Jensen et al.<sup><xref ref-type="bibr" rid="bibr26-1468087412442323">26</xref></sup> is adopted. The mass flow is obtained empirically from the intake manifold pressure <inline-formula id="inline-formula155-1468087412442323"><mml:math display="inline" id="math179-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>im</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and the compressor speed <inline-formula id="inline-formula156-1468087412442323"><mml:math display="inline" id="math180-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mtext>tc</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p>
<p>
<disp-formula id="disp-formula25-1468087412442323">
<label>(24)</label>
<mml:math display="block" id="math181-1468087412442323">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mtext>c</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mspace width="0.25em"/>
<mml:mi>f</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>p</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>im</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>,</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>ω</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>tc</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula25-1468087412442323" xlink:href="10.1177_1468087412442323-eq25.tif"/>
</disp-formula>
</p>
<p>The compressor torque is obtained as</p>
<p>
<disp-formula id="disp-formula26-1468087412442323">
<label>(25)</label>
<mml:math display="block" id="math182-1468087412442323">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>c</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mspace width="0.25em"/>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mtext>c</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>p</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mrow>
<mml:mi>ϑ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>us</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>[</mml:mo>
<mml:msubsup>
<mml:mrow>
<mml:mi>Π</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>c</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:mi>κ</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>κ</mml:mi>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:msubsup>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>]</mml:mo>
</mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>η</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>c</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mrow>
<mml:mi>ω</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>tc</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula26-1468087412442323" xlink:href="10.1177_1468087412442323-eq26.tif"/>
</disp-formula>
</p>
<p>where <inline-formula id="inline-formula157-1468087412442323"><mml:math display="inline" id="math183-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>Π</mml:mi></mml:mrow><mml:mrow><mml:mtext>c</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the pressure ratio over the compressor, <inline-formula id="inline-formula158-1468087412442323"><mml:math display="inline" id="math184-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mtext>us</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the upstream temperature and <inline-formula id="inline-formula159-1468087412442323"><mml:math display="inline" id="math185-1468087412442323"><mml:mrow><mml:mi>κ</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula id="inline-formula160-1468087412442323"><mml:math display="inline" id="math186-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mtext>p</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> represent the ratio of specific heat capacities and the specific heat capacity at constant pressure, respectively.</p>
<p>The VGT mass flow and torque models are adapted from Guzzella and Onder.<sup><xref ref-type="bibr" rid="bibr20-1468087412442323">20</xref></sup> The parameters <inline-formula id="inline-formula161-1468087412442323"><mml:math display="inline" id="math187-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mtext>t</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="inline-formula162-1468087412442323"><mml:math display="inline" id="math188-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mtext>t</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are third-order polynomials in <inline-formula id="inline-formula163-1468087412442323"><mml:math display="inline" id="math189-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mtext>vgt</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p>
<p>
<disp-formula id="disp-formula27-1468087412442323">
<label>(26)</label>
<mml:math display="block" id="math190-1468087412442323">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mtext>t</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mspace width="0.25em"/>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>p</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>em</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:msqrt>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>ϑ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>em</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:msqrt>
</mml:mrow>
</mml:mfrac>
<mml:msub>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>t</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:msqrt>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:msubsup>
<mml:mrow>
<mml:mi>Π</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>t</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>t</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:msubsup>
</mml:mrow>
</mml:msqrt>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula27-1468087412442323" xlink:href="10.1177_1468087412442323-eq27.tif"/>
</disp-formula>
</p>
<p>where <inline-formula id="inline-formula164-1468087412442323"><mml:math display="inline" id="math191-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>Π</mml:mi></mml:mrow><mml:mrow><mml:mtext>t</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the pressure ratio over the VGT. With the turbine efficiency <inline-formula id="inline-formula165-1468087412442323"><mml:math display="inline" id="math192-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mtext>t</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>em</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mtext>tc</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mtext>vgt</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, the turbine torque is obtained as</p>
<p>
<disp-formula id="disp-formula28-1468087412442323">
<label>(27)</label>
<mml:math display="block" id="math193-1468087412442323">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>t</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mspace width="0.25em"/>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mtext>t</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>p</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mrow>
<mml:mi>ϑ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>im</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>[</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:mi>Π</mml:mi>
<mml:msup>
<mml:mrow>
<mml:mtext>t</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:mi>κ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>κ</mml:mi>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:msup>
<mml:mo>]</mml:mo>
</mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>η</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>t</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>ω</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>tc</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula28-1468087412442323" xlink:href="10.1177_1468087412442323-eq28.tif"/>
</disp-formula>
</p>
<p>With the turbocharger inertia <inline-formula id="inline-formula166-1468087412442323"><mml:math display="inline" id="math194-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>Θ</mml:mi></mml:mrow><mml:mrow><mml:mtext>tc</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, the differential equation for <inline-formula id="inline-formula167-1468087412442323"><mml:math display="inline" id="math195-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mtext>tc</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is given as</p>
<p>
<disp-formula id="disp-formula29-1468087412442323">
<label>(28)</label>
<mml:math display="block" id="math196-1468087412442323">
<mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:mi>d</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>dt</mml:mi>
</mml:mrow>
</mml:mfrac>
<mml:msub>
<mml:mrow>
<mml:mi>ω</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>tc</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mspace width="0.25em"/>
<mml:mfrac>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>Θ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>tc</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>t</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>c</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula29-1468087412442323" xlink:href="10.1177_1468087412442323-eq29.tif"/>
</disp-formula>
</p>
</sec>
<sec id="section21-1468087412442323">
<title>Exhaust gas recirculation</title>
<p>The EGR valve is modelled as an isothermal orifice with flow area <inline-formula id="inline-formula168-1468087412442323"><mml:math display="inline" id="math197-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mtext>eff</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, which is a function of the EGR-valve position <inline-formula id="inline-formula169-1468087412442323"><mml:math display="inline" id="math198-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mtext>egr</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p>
<p>
<disp-formula id="disp-formula30-1468087412442323">
<label>(29)</label>
<mml:math display="block" id="math199-1468087412442323">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mtext>egr</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mspace width="0.25em"/>
<mml:msub>
<mml:mrow>
<mml:mi>A</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>eff</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>p</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>em</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:msqrt>
<mml:mrow>
<mml:mi>R</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mi>ϑ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>em</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:msqrt>
</mml:mrow>
</mml:mfrac>
<mml:mspace width="0.25em"/>
<mml:mi>Ψ</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>p</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>im</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>p</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>em</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula30-1468087412442323" xlink:href="10.1177_1468087412442323-eq30.tif"/>
</disp-formula>
</p>
<p>With critical pressure ratio <inline-formula id="inline-formula170-1468087412442323"><mml:math display="inline" id="math200-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>Π</mml:mi></mml:mrow><mml:mrow><mml:mtext>cr</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, the flow function <inline-formula id="inline-formula171-1468087412442323"><mml:math display="inline" id="math201-1468087412442323"><mml:mrow><mml:mi>Ψ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>Π</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is defined as</p>
<p>
<disp-formula id="disp-formula31-1468087412442323">
<label>(30)</label>
<mml:math display="block" id="math202-1468087412442323">
<mml:mrow>
<mml:mi>Ψ</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mi>Π</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mrow>
<mml:mo>{</mml:mo>
<mml:mtable align="left">
<mml:mtr>
<mml:mtd columnalign="center">
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mi>Π</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo stretchy="false">/</mml:mo>
<mml:mi>κ</mml:mi>
</mml:mrow>
</mml:msup>
<mml:msqrt>
<mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:mn>2</mml:mn>
<mml:mi>κ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>κ</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:mfrac>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>Π</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:mi>κ</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>κ</mml:mi>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:msup>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:msqrt>
</mml:mrow>
</mml:mtd>
<mml:mtd columnalign="center">
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>&gt;</mml:mo>
<mml:mi>Π</mml:mi>
<mml:mo>≥</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>Π</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>cr</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="center" columnspan="1">
<mml:mrow>
<mml:msqrt>
<mml:mrow>
<mml:mi>κ</mml:mi>
<mml:msup>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>κ</mml:mi>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:mfrac>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:mi>κ</mml:mi>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>κ</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:msup>
</mml:mrow>
</mml:msqrt>
</mml:mrow>
</mml:mtd>
<mml:mtd columnalign="center">
<mml:mrow>
<mml:mi>Π</mml:mi>
<mml:mo>&lt;</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>Π</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>cr</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula31-1468087412442323" xlink:href="10.1177_1468087412442323-eq31.tif"/>
</disp-formula>
</p>
</sec>
<sec id="section22-1468087412442323">
<title>Engine mass flow</title>
<p>The engine mass flow <inline-formula id="inline-formula172-1468087412442323"><mml:math display="inline" id="math203-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>·</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>e</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is obtained with the volumetric efficiency coefficients <inline-formula id="inline-formula173-1468087412442323"><mml:math display="inline" id="math204-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mtext>lw</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="inline-formula174-1468087412442323"><mml:math display="inline" id="math205-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mtext>lp</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula><sup><xref ref-type="bibr" rid="bibr20-1468087412442323">20</xref></sup></p>
<p>
<disp-formula id="disp-formula32-1468087412442323">
<label>(31)</label>
<mml:math display="block" id="math206-1468087412442323">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mtext>e</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mspace width="0.25em"/>
<mml:msub>
<mml:mrow>
<mml:mi>λ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>l</mml:mtext>
<mml:mi>ω</mml:mi>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mrow>
<mml:mi>λ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>lp</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>ω</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>e</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mrow>
<mml:mi>V</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>d</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:mn>4</mml:mn>
<mml:mi>π</mml:mi>
</mml:mrow>
</mml:mfrac>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>p</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>im</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:mi>R</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mi>ϑ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>im</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula32-1468087412442323" xlink:href="10.1177_1468087412442323-eq32.tif"/>
</disp-formula>
</p>
<p>The volumetric efficiency coefficients <inline-formula id="inline-formula175-1468087412442323"><mml:math display="inline" id="math207-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mtext>l</mml:mtext><mml:mi>ω</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mtext>e</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="inline-formula176-1468087412442323"><mml:math display="inline" id="math208-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mtext>lp</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> take into account the influences from the engine speed <inline-formula id="inline-formula177-1468087412442323"><mml:math display="inline" id="math209-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mtext>e</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and from the residual gas <inline-formula id="inline-formula178-1468087412442323"><mml:math display="inline" id="math210-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mtext>lp</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p>
<p>
<disp-formula id="disp-formula33-1468087412442323">
<label>(32)</label>
<mml:math display="block" id="math211-1468087412442323">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>λ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>lp</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mspace width="0.25em"/>
<mml:mfrac>
<mml:mrow>
<mml:mi>ϵ</mml:mi>
<mml:mo>−</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>p</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>em</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>p</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>im</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>κ</mml:mi>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:msup>
</mml:mrow>
<mml:mrow>
<mml:mi>ϵ</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula33-1468087412442323" xlink:href="10.1177_1468087412442323-eq33.tif"/>
</disp-formula>
</p>
</sec>
<sec id="section23-1468087412442323">
<title>NO<sub>x</sub> emissions and sensor</title>
<p>The model of the <inline-formula id="inline-formula179-1468087412442323"><mml:math display="inline" id="math212-1468087412442323"><mml:mrow><mml:mtext>N</mml:mtext><mml:msub><mml:mrow><mml:mtext>O</mml:mtext></mml:mrow><mml:mrow><mml:mtext>x</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> emissions is based on the model described by Schilling et al.<sup><xref ref-type="bibr" rid="bibr18-1468087412442323">18</xref></sup> It yields the instantaneous <inline-formula id="inline-formula180-1468087412442323"><mml:math display="inline" id="math213-1468087412442323"><mml:mrow><mml:mtext>N</mml:mtext><mml:msub><mml:mrow><mml:mtext>O</mml:mtext></mml:mrow><mml:mrow><mml:mtext>x</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> raw emissions <inline-formula id="inline-formula181-1468087412442323"><mml:math display="inline" id="math214-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi>υ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>nox</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> based on a stationary map <inline-formula id="inline-formula182-1468087412442323"><mml:math display="inline" id="math215-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi>υ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>nox</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and its relative deviation <inline-formula id="inline-formula183-1468087412442323"><mml:math display="inline" id="math216-1468087412442323"><mml:mrow><mml:mi>δ</mml:mi><mml:msub><mml:mrow><mml:mi>υ</mml:mi></mml:mrow><mml:mrow><mml:mtext>nox</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p>
<p>
<disp-formula id="disp-formula34-1468087412442323">
<label>(33)</label>
<mml:math display="block" id="math217-1468087412442323">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>υ</mml:mi>
</mml:mrow>
<mml:mo>^</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mtext>nox</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mspace width="0.25em"/>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>υ</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mtext>nox</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>+</mml:mo>
<mml:mi>δ</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mi>υ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>nox</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula34-1468087412442323" xlink:href="10.1177_1468087412442323-eq34.tif"/>
</disp-formula>
</p>
<p>The relative deviation <inline-formula id="inline-formula184-1468087412442323"><mml:math display="inline" id="math218-1468087412442323"><mml:mrow><mml:mi>δ</mml:mi><mml:msub><mml:mrow><mml:mi>υ</mml:mi></mml:mrow><mml:mrow><mml:mtext>nox</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is obtained from the relative deviation of the relevant inputs <inline-formula id="inline-formula185-1468087412442323"><mml:math display="inline" id="math219-1468087412442323"><mml:mrow><mml:mi>δ</mml:mi><mml:mi mathvariant="bold">γ</mml:mi></mml:mrow></mml:math></inline-formula>. It is modelled as a linear function of the input deviation with OP-dependent coefficients <inline-formula id="inline-formula186-1468087412442323"><mml:math display="inline" id="math220-1468087412442323"><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow></mml:math></inline-formula></p>
<p>
<disp-formula id="disp-formula35-1468087412442323">
<label>(34)</label>
<mml:math display="block" id="math221-1468087412442323">
<mml:mrow>
<mml:mi>δ</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mi>υ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>nox</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mspace width="0.25em"/>
<mml:msup>
<mml:mrow>
<mml:mi mathvariant="bold">θ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
<mml:mi>δ</mml:mi>
<mml:mi mathvariant="bold">γ</mml:mi>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula35-1468087412442323" xlink:href="10.1177_1468087412442323-eq35.tif"/>
</disp-formula>
</p>
<p>The relative deviation of each element <inline-formula id="inline-formula187-1468087412442323"><mml:math display="inline" id="math222-1468087412442323"><mml:mrow><mml:mi>δ</mml:mi><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mtext>i</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> of the input vector is obtained with its stationary OP-dependent value <inline-formula id="inline-formula188-1468087412442323"><mml:math display="inline" id="math223-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>i</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and the actual value <inline-formula id="inline-formula189-1468087412442323"><mml:math display="inline" id="math224-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mtext>i</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p>
<p>
<disp-formula id="disp-formula36-1468087412442323">
<label>(35)</label>
<mml:math display="block" id="math225-1468087412442323">
<mml:mrow>
<mml:mi>δ</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mi>γ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>i</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mspace width="0.25em"/>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>γ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>i</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>γ</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mtext>i</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>γ</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mtext>i</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula36-1468087412442323" xlink:href="10.1177_1468087412442323-eq36.tif"/>
</disp-formula>
</p>
<p>The relevant input variables are the intake BG ratio <inline-formula id="inline-formula190-1468087412442323"><mml:math display="inline" id="math226-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>im</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, the gas mass in the cylinder (which is nearly proportional to the boost pressure) <inline-formula id="inline-formula191-1468087412442323"><mml:math display="inline" id="math227-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mtext>cyl</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, the SOI <inline-formula id="inline-formula192-1468087412442323"><mml:math display="inline" id="math228-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mtext>soi</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and the rail pressure <inline-formula id="inline-formula193-1468087412442323"><mml:math display="inline" id="math229-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>rail</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p>
<p>
<disp-formula id="disp-formula37-1468087412442323">
<label>(36)</label>
<mml:math display="block" id="math230-1468087412442323">
<mml:mrow>
<mml:mi mathvariant="bold">γ</mml:mi>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mspace width="0.25em"/>
<mml:msup>
<mml:mrow>
<mml:mo>[</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>im</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.25em"/>
<mml:msub>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>cyl</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.25em"/>
<mml:msub>
<mml:mrow>
<mml:mi>ϕ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>soi</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.25em"/>
<mml:msub>
<mml:mrow>
<mml:mi>p</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>rail</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>]</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula37-1468087412442323" xlink:href="10.1177_1468087412442323-eq37.tif"/>
</disp-formula>
</p>
<p>Other influences such as the intake air temperature resulting from the intercooler performance, for example, are regarded as disturbances. To take into account the dynamic behaviour of the sensor, the instantaneous <inline-formula id="inline-formula194-1468087412442323"><mml:math display="inline" id="math231-1468087412442323"><mml:mrow><mml:mtext>N</mml:mtext><mml:msub><mml:mrow><mml:mtext>O</mml:mtext></mml:mrow><mml:mrow><mml:mtext>x</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> signal <inline-formula id="inline-formula195-1468087412442323"><mml:math display="inline" id="math232-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi>υ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>nox</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is filtered with a first-order lag element with time constant <inline-formula id="inline-formula196-1468087412442323"><mml:math display="inline" id="math233-1468087412442323"><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mtext>nox</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p>
<p>
<disp-formula id="disp-formula38-1468087412442323">
<label>(37)</label>
<mml:math display="block" id="math234-1468087412442323">
<mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:mi>d</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>dt</mml:mi>
</mml:mrow>
</mml:mfrac>
<mml:msub>
<mml:mrow>
<mml:mi>y</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>nox</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mspace width="0.25em"/>
<mml:mo>−</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>τ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>nox</mml:mtext>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>y</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>nox</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>υ</mml:mi>
</mml:mrow>
<mml:mo>^</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mtext>nox</mml:mtext>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula38-1468087412442323" xlink:href="10.1177_1468087412442323-eq38.tif"/>
</disp-formula>
</p>
</sec>
</app>
</app-group>
<ack><p>We thank Dr Josef Steuer, Mr Christian Dengler and Mr Johan Eldh of Daimler AG for their support on engine issues.</p></ack>
<fn-group>
<fn fn-type="financial-disclosure">
<label>Funding</label>
<p>This work was supported by Forschungsvereinigung Verbrennungskraftmaschinen e.V. [grant number 609861] and the Swiss Federal Office for the Environment [grant number A2111.0239].</p>
</fn>
</fn-group>
<ref-list>
<title>References</title>
<ref id="bibr1-1468087412442323">
<label>1.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Guzzella</surname><given-names>L</given-names></name>
<name><surname>Amstutz</surname><given-names>A</given-names></name>
</person-group>. <article-title>Control of diesel engines</article-title>. <source>IEEE Control Syst Mag</source> <year>1998</year>, <volume>18</volume>(<issue>5</issue>): <fpage>53</fpage>–<lpage>71</lpage>.</citation>
</ref>
<ref id="bibr2-1468087412442323">
<label>2.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Jankovic</surname><given-names>M</given-names></name>
<name><surname>Kolmanovsky</surname><given-names>I</given-names></name>
</person-group>. <article-title>Constructive Lyapunov control design for turbocharged diesel engines</article-title>. <source>IEEE Trans Control Syst Technol</source> <year>2000</year>, <volume>8</volume>(<issue>2</issue>): <fpage>288</fpage>–<lpage>299</lpage>.</citation>
</ref>
<ref id="bibr3-1468087412442323">
<label>3.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Wahlstroem</surname><given-names>J</given-names></name>
<name><surname>Eriksson</surname><given-names>L</given-names></name>
<name><surname>Nielsen</surname><given-names>L</given-names></name>
</person-group>. <article-title>EGR-VGT control and tuning for pumping work minimization and emission control</article-title>. <source>IEEE Trans Control Syst Technol</source> <year>2009</year>, <volume>18</volume>(<issue>4</issue>): <fpage>993</fpage>–<lpage>1003</lpage>.</citation>
</ref>
<ref id="bibr4-1468087412442323">
<label>4.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Wei</surname><given-names>X</given-names></name>
<name><surname>L</surname><given-names>del Re</given-names></name>
</person-group>. <article-title>Gain scheduled H-infinity control for air path systems of diesel engines using LPV techniques</article-title>. <source>IEEE Trans Control Syst Technol</source> <year>2007</year>, <volume>15</volume>(<issue>3</issue>): <fpage>406</fpage>–<lpage>415</lpage>.</citation>
</ref>
<ref id="bibr5-1468087412442323">
<label>5.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Assanis</surname><given-names>DN</given-names></name>
<name><surname>Filipi</surname><given-names>ZS</given-names></name>
<name><surname>Fiveland</surname><given-names>SB</given-names></name>
<name><surname>Syrimis</surname><given-names>M</given-names></name>
</person-group>. <article-title>A predictive ignition delay correlation under steady-state and transient operation of a direct injection diesel engine</article-title>. <source>J Eng Gas Turbines Power</source> <year>2003</year>, <volume>125</volume>(<issue>2</issue>): <fpage>450</fpage>–<lpage>457</lpage>.</citation>
</ref>
<ref id="bibr6-1468087412442323">
<label>6.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Chryssakis</surname><given-names>C</given-names></name>
<name><surname>Hagena</surname><given-names>J</given-names></name>
<name><surname>Knafl</surname><given-names>A</given-names></name><etal/>
</person-group>. <article-title>In-cylinder reduction of PM and NOx emissions from diesel combustion with advanced injection strategies</article-title>. <source>Int J Veh Des</source> <year>2006</year>, <volume>41</volume>(<issue>1–4</issue>): <fpage>83</fpage>–<lpage>102</lpage>.</citation>
</ref>
<ref id="bibr7-1468087412442323">
<label>7.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Kirchen</surname><given-names>P</given-names></name>
<name><surname>Obrecht</surname><given-names>P</given-names></name>
<name><surname>Boulouchos</surname><given-names>K</given-names></name>
</person-group>. <article-title>Soot emission measurements and validation of a mean value soot model for common-rail diesel engines during transient operation</article-title>. <source>SAE Int J Engines</source> <year>2009</year>, <volume>2</volume>(<issue>2009-01-1904</issue>): <fpage>1663</fpage>–<lpage>1678</lpage>.</citation>
</ref>
<ref id="bibr8-1468087412442323">
<label>8.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Bertola</surname><given-names>A</given-names></name>
<name><surname>Schubiger</surname><given-names>R</given-names></name>
<name><surname>Kasper</surname><given-names>A</given-names></name><etal/>
</person-group>. <article-title>Characterization of diesel particulate emissions in heavy-duty DI diesel engines with common-rail fuel injection: influence of injection parameters and fuel composition</article-title>. <source>SAE Int J Fuels Lubr</source> <year>2001</year>, <volume>110</volume>(<issue>2001-01-3573</issue>): <fpage>1925</fpage>–<lpage>1937</lpage>.</citation>
</ref>
<ref id="bibr9-1468087412442323">
<label>9.</label>
<citation citation-type="thesis">
<person-group person-group-type="author">
<name><surname>Alfieri</surname><given-names>E</given-names></name>
</person-group>. <source>Emissions-controlled diesel engine</source>. PhD Thesis, <publisher-name>ETH Zürich</publisher-name>, <year>2009</year>,. no. 18214.</citation>
</ref>
<ref id="bibr10-1468087412442323">
<label>10.</label>
<citation citation-type="book">
<person-group person-group-type="author">
<name><surname>Karlsson</surname><given-names>M</given-names></name>
<name><surname>Ekholm</surname><given-names>K</given-names></name>
<name><surname>Strandh</surname><given-names>P</given-names></name><etal/>
</person-group>. <article-title>Multiple-input multiple-output model predictive control of a diesel engine</article-title>. In: <source>Advances in Automotive Control</source>. <publisher-name>IFAC</publisher-name>, <publisher-loc>Munich</publisher-loc> <year>2010</year>, <fpage>P</fpage>–<lpage>11</lpage>.</citation>
</ref>
<ref id="bibr11-1468087412442323">
<label>11.</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Stewart</surname><given-names>G</given-names></name>
<name><surname>Borrelli</surname><given-names>F</given-names></name>
</person-group>. <article-title>A model predictive control framework for industrial turbodiesel engine control</article-title>. In: <conf-name>47th IEEE Conference on Decision and Control</conf-name>. <conf-loc>Cancun</conf-loc> <year>2008</year>, <fpage>5704</fpage>–<lpage>5711</lpage>.</citation>
</ref>
<ref id="bibr12-1468087412442323">
<label>12.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Koebel</surname><given-names>M</given-names></name>
<name><surname>Elsener</surname><given-names>M</given-names></name>
<name><surname>Kleemann</surname><given-names>M</given-names></name>
</person-group>. <article-title>Urea-SCR: a promising technique to reduce NOx emissions from automotive diesel engines</article-title>. <source>Catal Today</source> <year>2000</year>, <volume>59</volume>(<issue>3–4</issue>): <fpage>335</fpage>–<lpage>345</lpage>.</citation>
</ref>
<ref id="bibr13-1468087412442323">
<label>13.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Johnson</surname><given-names>T</given-names></name>
</person-group>. <article-title>Review of diesel emissions and control</article-title>. <source>Int J Engine Res</source> <year>2009</year>, <volume>10</volume>(<issue>5</issue>): <fpage>275</fpage>–<lpage>285</lpage>.</citation>
</ref>
<ref id="bibr14-1468087412442323">
<label>14.</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Jeuland</surname><given-names>N.</given-names></name>
<name><surname>Dementhon</surname><given-names>J.</given-names></name>
<name><surname>Gagnepain</surname><given-names>L.</given-names></name>
<name><surname>Plassat</surname><given-names>G.</given-names></name><etal/>
</person-group>., <article-title>Performances and Durability of DPF (Diesel Particulate Filter) Tested on a Fleet of Peugeot 607 Taxis: Final results</article-title>. In: <conf-name>SAE World Congress</conf-name>. <conf-loc>Detroit, MI</conf-loc> <year>2004</year>, 2004-01-0073.</citation>
</ref>
<ref id="bibr15-1468087412442323">
<label>15.</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Salvat</surname><given-names>O</given-names></name>
<name><surname>Marez</surname><given-names>P</given-names></name>
<name><surname>Belot</surname><given-names>G</given-names></name>
</person-group>. <article-title>Passenger car serial application of a particulate filter system on a common-rail, direct-injection diesel engine</article-title>. In: <conf-name>SAE World Congress</conf-name>. <conf-loc>Detroit, MI</conf-loc> <year>2000</year>; 2000-01-0473.</citation>
</ref>
<ref id="bibr16-1468087412442323">
<label>16.</label>
<citation citation-type="book">
<person-group person-group-type="editor">
<name><surname>Zhao</surname><given-names>H</given-names></name>
</person-group> (editor). <source>Advanced direct injection combustion engine techniologies and development: volume 2: diesel engines</source>. <publisher-name>Woodhead Publishing Ltd.</publisher-name>, <publisher-loc>Cambridge, UK</publisher-loc>, <year>2010</year>.</citation>
</ref>
<ref id="bibr17-1468087412442323">
<label>17.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Schilling</surname><given-names>A</given-names></name>
<name><surname>Amstutz</surname><given-names>A</given-names></name>
<name><surname>Guzzella</surname><given-names>L</given-names></name>
</person-group>. <article-title>Model-based detection and isolation of faults due to ageing in the air and fuel paths of common-rail direct injection diesel engines equipped with a lambda and a nitrogen oxides sensor</article-title>. <source>Proc IMechEng, Part D: J Automobile Engineering</source> <year>2008</year>, <volume>222</volume>(<issue>1</issue>): <fpage>101</fpage>–<lpage>117</lpage>.</citation>
</ref>
<ref id="bibr18-1468087412442323">
<label>18.</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Schilling</surname><given-names>A</given-names></name>
<name><surname>Amstutz</surname><given-names>A</given-names></name>
<name><surname>Onder</surname><given-names>C</given-names></name>
<name><surname>Guzzella</surname><given-names>L</given-names></name>
</person-group>. <article-title>A real-time model for the prediction of the NOx emissions in DI diesel engines</article-title>. In: <conf-name>IEEE International Conference on Control Applications</conf-name>. <conf-loc>Munich</conf-loc> <year>2006</year>, <fpage>2042</fpage>–<lpage>2047</lpage>.</citation>
</ref>
<ref id="bibr19-1468087412442323">
<label>19.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Eriksson</surname><given-names>L</given-names></name>
</person-group>. <article-title>Modeling and control of turbocharged SI and DI engines</article-title>. <source>Oil Gas Sci Technol - Rev IFP Energ Nouv</source> <year>2007</year>, <volume>62</volume>(<issue>4</issue>): <fpage>523</fpage>–<lpage>538</lpage>.</citation>
</ref>
<ref id="bibr20-1468087412442323">
<label>20.</label>
<citation citation-type="book">
<person-group person-group-type="author">
<name><surname>Guzzella</surname><given-names>L</given-names></name>
<name><surname>Onder</surname><given-names>CH</given-names></name>
</person-group>. <source>Introduction to modeling and control of internal combustion engine systems</source>. <publisher-loc>Berlin</publisher-loc>: <publisher-name>Springer-Verlag</publisher-name>, <year>2010</year>.</citation>
</ref>
<ref id="bibr21-1468087412442323">
<label>21.</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Kolmanovsky</surname><given-names>I</given-names></name>
<name><surname>Moraal</surname><given-names>P</given-names></name>
<name><surname>Van Nieuwstadt</surname><given-names>M</given-names></name>
<name><surname>Stefanopoulou</surname><given-names>A</given-names></name>
</person-group>. <article-title>Issues in modelling and control of intake flow in variable geometry turbocharged engines</article-title>. In: <conf-name>Proceedings of the 18th IFIP Conference on System Modelling and Optimization</conf-name>, volume 396 of <series>Chapman &amp; Hall/CRC Research Notes in Mathematics Series</series>. <conf-loc>Detroit, MI</conf-loc> <year>1997</year>, <fpage>436</fpage>–<lpage>445</lpage>.</citation>
</ref>
<ref id="bibr22-1468087412442323">
<label>22.</label>
<citation citation-type="book">
<person-group person-group-type="author">
<name><surname>Kwakernaak</surname><given-names>H</given-names></name>
</person-group>. <source>Linear optimal control systems</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>John Wiley &amp; Sons Inc</publisher-name>., <year>1972</year>.</citation>
</ref>
<ref id="bibr23-1468087412442323">
<label>23.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Geering</surname><given-names>HP</given-names></name>
</person-group>. <article-title>Entwurf robuster Regler mit Hilfe von Singularwerten: Anwendung auf Automobilmotoren</article-title>. <source>VDI/VDE-Gesellschaft Mess- und Automatisierungstechnik, Düsseldorf</source> <year>1986</year>, <volume>11</volume>: <fpage>125</fpage>–<lpage>145</lpage>. In German.</citation>
</ref>
<ref id="bibr24-1468087412442323">
<label>24.</label>
<citation citation-type="book">
<person-group person-group-type="author">
<name><surname>Skogestad</surname><given-names>S</given-names></name>
<name><surname>Postlethwaite</surname><given-names>I</given-names></name>
</person-group>. <source>Multivariable feedback control: analysis and design</source>. <publisher-loc>Chichester</publisher-loc>: <publisher-name>John Wiley &amp; Sons Inc</publisher-name>., <year>2005</year>.</citation>
</ref>
<ref id="bibr25-1468087412442323">
<label>25.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Kothare</surname><given-names>MV</given-names></name>
<name><surname>Campo</surname><given-names>PJ</given-names></name>
<name><surname>Morari</surname><given-names>M</given-names></name>
<name><surname>Nett</surname><given-names>CN</given-names></name>
</person-group>. <article-title>A unified framework for the study of anti-windup designs</article-title>. <source>Automatica</source> <year>1994</year>, <volume>30</volume>(<issue>12</issue>): <fpage>1869</fpage>–<lpage>1883</lpage>.</citation>
</ref>
<ref id="bibr26-1468087412442323">
<label>26.</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Jensen</surname><given-names>JP</given-names></name>
<name><surname>Kristensen</surname><given-names>AF</given-names></name>
<name><surname>Sorenson</surname><given-names>SC</given-names></name><etal/>
</person-group>. <article-title>Mean value modeling of a small turbocharged diesel engine</article-title>. In: <conf-name>SAE International Congress and Exposition</conf-name>. <conf-loc>Detroit, MI</conf-loc> <year>1991</year>, <fpage>910070</fpage>.</citation>
</ref>
</ref-list>
</back>
</article>