<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v2.3 20070202//EN" "journalpublishing.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">CTJ</journal-id>
<journal-id journal-id-type="hwp">spctj</journal-id>
<journal-id journal-id-type="nlm-ta">Clin Trials</journal-id>
<journal-title>Clinical Trials</journal-title>
<issn pub-type="ppub">1740-7745</issn>
<issn pub-type="epub">1740-7753</issn>
<publisher>
<publisher-name>SAGE Publications</publisher-name>
<publisher-loc>Sage UK: London, England</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1177/1740774512455370</article-id>
<article-id pub-id-type="publisher-id">10.1177_1740774512455370</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Articles</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>The issue of multiplicity in noninferiority studies</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name><surname>Ke</surname><given-names>Chunlei</given-names></name>
</contrib>
<contrib contrib-type="author">
<name><surname>Ding</surname><given-names>Beiying</given-names></name>
</contrib>
<contrib contrib-type="author">
<name><surname>Jiang</surname><given-names>Qi</given-names></name>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name><surname>Snapinn</surname><given-names>Steven M</given-names></name>
</contrib>
<aff id="aff1-1740774512455370">Amgen Inc., Thousand Oaks, CA, USA</aff>
</contrib-group>
<author-notes>
<corresp id="corresp1-1740774512455370">Steven M Snapinn, Amgen Inc., One Amgen Center Drive, 24-2-C, Thousand Oaks, CA 91320, USA. Email: <email>ssnapinn@amgen.com</email></corresp>
</author-notes>
<pub-date pub-type="epub-ppub">
<month>12</month>
<year>2012</year>
</pub-date>
<volume>9</volume>
<issue>6</issue>
<issue-title>University of Pennsylvania Conference on Statistical Issues in Clinical Trials: Emerging statistical issues in the conduct and monitoring of clinical trials</issue-title>
<fpage>730</fpage>
<lpage>735</lpage>
<permissions>
<copyright-statement>© The Author(s), 2012</copyright-statement>
<copyright-year>2012</copyright-year>
<copyright-holder content-type="sage">The Society for Clinical Trials</copyright-holder>
</permissions>
<abstract>
<sec id="section1-1740774512455370">
<title>Background</title>
<p>In a clinical study to evaluate noninferiority (NI) of an experimental drug relative to an established therapy, it is common to further test superiority of the experimental drug after NI is established. It has been shown that no multiplicity issue exists between NI and superiority tests of the primary endpoint. However, when there is an additional, or secondary, endpoint that will be tested for superiority in a hierarchical fashion to the NI testing of the primary endpoint, it is not clear whether the overall type I error rate is strictly controlled among all the tests.</p>
</sec>
<sec id="section2-1740774512455370">
<title>Purpose</title>
<p>In this article, our goal is to evaluate if the family-wise type I error rate is strictly controlled in this setting. We also evaluate a multiplicity adjustment procedure based on the Hochberg procedure.</p>
</sec>
<sec id="section3-1740774512455370">
<title>Methods</title>
<p>We use the closed testing principle to evaluate the family-wise type I error rate. Some simulations are performed to appreciate the magnitude of the potential inflation of the type I error rate.</p>
</sec>
<sec id="section4-1740774512455370">
<title>Results</title>
<p>It is demonstrated that the family-wise type I error rate is not controlled and an appropriate multiplicity adjustment procedure must take into account the NI and superiority tests of the two endpoints. When the test statistic used for superiority testing of the primary endpoint is the same as that for the NI testing, a multiplicity adjustment method using the popular Hochberg procedure is shown to be potentially conservative.</p>
</sec>
<sec id="section5-1740774512455370">
<title>Limitation</title>
<p>The assessment is based on a simplified set-up where there is only one secondary endpoint tested for superiority in addition to the primary endpoint.</p>
</sec>
<sec id="section6-1740774512455370">
<title>Conclusion</title>
<p>It is necessary to evaluate the issue of multiplicity in non-inferiority studies to assure strict control of the family-wise type I error rate.</p>
</sec>
</abstract>
</article-meta>
</front>
<body>
<sec id="section7-1740774512455370" sec-type="intro">
<title>Introduction</title>
<p>Much progress has been made regarding the statistical aspects of clinical trials to evaluate noninferiority (NI) of an experimental drug relative to an established therapy. A US Food and Drug Administration (FDA) draft guidance [<xref ref-type="bibr" rid="bibr1-1740774512455370">1</xref>] provides a comprehensive review of the issues with NI studies (see also references therein).</p>
<p>In NI studies, it is common to further evaluate superiority of the experimental drug (i.e., the experimental drug is better than the active control) after rejecting the null hypothesis for NI. It has been shown that such switching from NI to superiority falls under a closed testing procedure, and there is no impact on the type I error rate for the superiority test [<xref ref-type="bibr" rid="bibr2-1740774512455370">2</xref><xref ref-type="bibr" rid="bibr3-1740774512455370"/>–<xref ref-type="bibr" rid="bibr4-1740774512455370">4</xref>]. Therefore, a claim of superiority after NI can be made without multiplicity adjustment. However, if there are multiple superiority tests subsequent to a single NI test, for example, additional endpoints and/or comparisons of multiple (&gt;2) treatment arms, the family-wise type I error rate may not be strictly controlled. In view of this, the FDA draft guidance states that ‘it is imperative to evaluate the overall [family-wise] type I error rate for all comparisons involved in the testing and make appropriate statistical adjustments’. Hung and Wang [<xref ref-type="bibr" rid="bibr5-1740774512455370">5</xref>,<xref ref-type="bibr" rid="bibr6-1740774512455370">6</xref>] discussed, among several challenges to multiple testing in clinical trials, the issue in testing for NI and (if possible) superiority with respect to primary and secondary endpoints. However, this multiplicity issue is complex, and there exists some confusion among clinical trial practitioners on whether there is a need to make adjustment. Motivated by a real clinical study where the primary endpoint was tested for both NI and superiority and the secondary endpoint only for superiority, this article aims to add further clarification to this issue and demonstrate the existence of inflation of the type 1 error rate in this specific setting. Once the issue of multiplicity is recognized, it can be addressed within the general framework of multiple comparisons; however, that is not the focus of this article.</p>
<p>Based on a NI study with two endpoints where one endpoint is tested for both NI and superiority and the other is tested only for superiority, we first show that the family-wise type I error rate is not automatically strictly controlled. Some simulations are performed to illustrate the magnitude of the inflation of the family-wise type I error rate. We then will evaluate a testing strategy that uses the popular Hochberg procedure in this setting. Lastly, discussions and conclusions are presented.</p>
</sec>
<sec id="section8-1740774512455370">
<title>Type I error rate in NI studies</title>
<p>For simplicity, we consider an NI study with two treatment arms, treatment versus active control, and two endpoints, <italic>E</italic><sub><italic>1</italic></sub> (primary) and <italic>E</italic><sub><italic>2</italic></sub> (secondary). The primary endpoint is tested for NI and, if successful, then tested for superiority. Let θ<sub><italic>T</italic></sub> and θ<sub><italic>C</italic></sub> be the mean values of <italic>E</italic><sub><italic>1</italic></sub>, and η<sub><italic>T</italic></sub> and η<sub><italic>C</italic></sub> the mean values of <italic>E</italic><sub><italic>2</italic></sub> for the treatment and control arms, respectively. Assume that a larger value indicates a more favorable outcome for both endpoints. Let <italic>M</italic> (&lt;0) be the fixed margin chosen for NI of the primary endpoint, that is, inferiority will be rejected if the confidence lower bound of θ<sub><italic>T</italic></sub> − θ<sub><italic>C</italic></sub> is greater than <italic>M</italic>. We wish to test the following null hypotheses in this study at a prespecified α level (e.g., 0.025 for one-sided test)</p>
<list id="list1-1740774512455370" list-type="simple">
<list-item><p><italic>H</italic><sub>01</sub>: θ<sub><italic>T</italic></sub> − θ<sub><italic>C</italic></sub> ≤ <italic>M</italic> (NI for <italic>E</italic><sub><italic>1</italic></sub>)</p></list-item>
<list-item><p><italic>H</italic><sub>02</sub>: θ<sub><italic>T</italic></sub> − θ<sub><italic>C</italic></sub> ≤ 0 (superiority for <italic>E</italic><sub><italic>1</italic></sub>)</p></list-item>
<list-item><p><italic>H</italic><sub>03</sub>: η<sub><italic>T</italic></sub> − η<sub><italic>C</italic></sub> ≤ 0 (superiority for <italic>E</italic><sub><italic>2</italic></sub>)</p></list-item>
</list>
<p>The testing strategy is to test <italic>H</italic><sub>01</sub> first and, if <italic>H</italic><sub>01</sub> is rejected, then test <italic>H</italic><sub>02</sub> and <italic>H</italic><sub>03</sub> simultaneously.</p>
<sec id="section9-1740774512455370">
<title>Result</title>
<p>The family-wise type I error rate in the above testing strategy is not strongly controlled if no multiplicity adjustment is made between <italic>H</italic><sub>02</sub> and <italic>H</italic><sub>03</sub> when <italic>H</italic><sub>01</sub> is rejected at α.</p>
<sec id="section10-1740774512455370">
<title>Proof</title>
<p>Let <italic>A</italic><sub><italic>i</italic></sub> be the rejection region for <italic>H</italic><sub>0<italic>i</italic></sub>, and <italic>P</italic><sub><italic>H</italic>0<italic>i</italic></sub>(<italic>A</italic>
<sub><italic>i</italic></sub>) = α, <italic>i</italic> = 1, 2, 3. In order to assess the family-wise type I error rate, we need to evaluate the type I error rate for rejecting any combination of <italic>H</italic><sub>01</sub>, <italic>H</italic><sub>02</sub>, and <italic>H</italic><sub>03</sub>.</p>
<p>First, it is trivial to show that the type I error rate of rejecting each of <italic>H</italic><sub>01</sub>, <italic>H</italic><sub>02</sub>, and <italic>H</italic><sub>03</sub> is bounded by α.</p>
<p>As A<sub>1</sub>⊃ A<sub>2</sub>, the type I error rate for rejecting <italic>H</italic><sub>01</sub> or <italic>H</italic><sub>02</sub> is <italic>P</italic><sub><italic>H</italic>01<italic>H</italic>02</sub>(<italic>A</italic><sub>1</sub>∪<italic>A</italic><sub>2</sub>)=<italic>P</italic><sub><italic>H</italic>01</sub>(<italic>A</italic><sub>1</sub>)=α.</p>
<p>As <italic>H</italic><sub>03</sub> is tested only after <italic>H</italic><sub>01</sub> is rejected, the type I error for rejecting <italic>H</italic><sub>01</sub> or <italic>H</italic><sub>03</sub> is</p>
<p><disp-formula id="disp-formula1-1740774512455370">
<mml:math display="block" id="math1-1740774512455370">
<mml:mrow>
<mml:msub>
<mml:mi>P</mml:mi>
<mml:mrow>
<mml:msub>
<mml:mi>H</mml:mi>
<mml:mrow>
<mml:mn>01</mml:mn>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mi>H</mml:mi>
<mml:mrow>
<mml:mn>03</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>A</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo>∪</mml:mo>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>A</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo>∩</mml:mo>
<mml:msub>
<mml:mi>A</mml:mi>
<mml:mn>3</mml:mn>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>≤</mml:mo>
<mml:msub>
<mml:mi>P</mml:mi>
<mml:mrow>
<mml:msub>
<mml:mi>H</mml:mi>
<mml:mrow>
<mml:mn>01</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>A</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mi>α</mml:mi>
<mml:mo>.</mml:mo>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula1-1740774512455370" xlink:href="10.1177_1740774512455370-eq1.tif"/>
</disp-formula></p>
<p>Under <italic>H</italic><sub>02</sub> and <italic>H</italic><sub>03</sub>, the type I error rate for rejecting <italic>H</italic><sub>02</sub> or <italic>H</italic><sub>03</sub> is</p>
<p><disp-formula id="disp-formula2-1740774512455370">
<mml:math display="block" id="math2-1740774512455370">
<mml:mrow>
<mml:msub>
<mml:mi>P</mml:mi>
<mml:mrow>
<mml:msub>
<mml:mi>H</mml:mi>
<mml:mrow>
<mml:mn>02</mml:mn>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mi>H</mml:mi>
<mml:mrow>
<mml:mn>03</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>A</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo>∩</mml:mo>
<mml:msub>
<mml:mi>A</mml:mi>
<mml:mn>2</mml:mn>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>∪</mml:mo>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>A</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo>∩</mml:mo>
<mml:msub>
<mml:mi>A</mml:mi>
<mml:mn>3</mml:mn>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mi>P</mml:mi>
<mml:mrow>
<mml:msub>
<mml:mi>H</mml:mi>
<mml:mrow>
<mml:mn>02</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>A</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo>∩</mml:mo>
<mml:msub>
<mml:mi>A</mml:mi>
<mml:mn>2</mml:mn>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mi>P</mml:mi>
<mml:mrow>
<mml:msub>
<mml:mi>H</mml:mi>
<mml:mrow>
<mml:mn>02</mml:mn>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mi>H</mml:mi>
<mml:mrow>
<mml:mn>03</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>A</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo>∩</mml:mo>
<mml:msub>
<mml:mover accent="true">
<mml:mi>A</mml:mi>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mn>2</mml:mn>
</mml:msub>
<mml:mo>∩</mml:mo>
<mml:msub>
<mml:mi>A</mml:mi>
<mml:mn>3</mml:mn>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mtext> </mml:mtext>
<mml:mo>=</mml:mo>
<mml:mtext> </mml:mtext>
<mml:mi>α</mml:mi>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mi>P</mml:mi>
<mml:mrow>
<mml:msub>
<mml:mi>H</mml:mi>
<mml:mrow>
<mml:mn>02</mml:mn>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mi>H</mml:mi>
<mml:mrow>
<mml:mn>03</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>A</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo>∩</mml:mo>
<mml:msub>
<mml:mover accent="true">
<mml:mi>A</mml:mi>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mn>2</mml:mn>
</mml:msub>
<mml:mo>∩</mml:mo>
<mml:msub>
<mml:mi>A</mml:mi>
<mml:mn>3</mml:mn>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula2-1740774512455370" xlink:href="10.1177_1740774512455370-eq2.tif"/>
</disp-formula></p>
<p>Under the condition that the null hypotheses <italic>H</italic><sub>01</sub>, <italic>H</italic><sub>02</sub>, and <italic>H</italic><sub>03</sub> are all true, the type I error rate for rejecting any of them is</p>
<p><disp-formula id="disp-formula3-1740774512455370">
<mml:math display="block" id="math3-1740774512455370">
<mml:mrow>
<mml:msub>
<mml:mi>P</mml:mi>
<mml:mrow>
<mml:msub>
<mml:mi>H</mml:mi>
<mml:mrow>
<mml:mn>01</mml:mn>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mi>H</mml:mi>
<mml:mrow>
<mml:mn>02</mml:mn>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mi>H</mml:mi>
<mml:mrow>
<mml:mn>03</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>A</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo>∪</mml:mo>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>A</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo>∩</mml:mo>
<mml:msub>
<mml:mi>A</mml:mi>
<mml:mn>2</mml:mn>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>∪</mml:mo>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>A</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo>∩</mml:mo>
<mml:msub>
<mml:mi>A</mml:mi>
<mml:mn>3</mml:mn>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>≤</mml:mo>
<mml:msub>
<mml:mi>P</mml:mi>
<mml:mrow>
<mml:msub>
<mml:mi>H</mml:mi>
<mml:mrow>
<mml:mn>01</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>A</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mi>α</mml:mi>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula3-1740774512455370" xlink:href="10.1177_1740774512455370-eq3.tif"/>
</disp-formula></p>
<p>Therefore, based on the closed testing principle [<xref ref-type="bibr" rid="bibr7-1740774512455370">7</xref>], the family-wise Type I error rate of the above testing procedure is strongly controlled only if</p>
<p><disp-formula id="disp-formula4-1740774512455370">
<label>(1)</label>
<mml:math display="block" id="math4-1740774512455370">
<mml:mrow>
<mml:msub>
<mml:mi>P</mml:mi>
<mml:mrow>
<mml:msub>
<mml:mi>H</mml:mi>
<mml:mrow>
<mml:mn>02</mml:mn>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mi>H</mml:mi>
<mml:mrow>
<mml:mn>03</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>A</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo>∩</mml:mo>
<mml:msub>
<mml:mover accent="true">
<mml:mi>A</mml:mi>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mn>2</mml:mn>
</mml:msub>
<mml:mo>∩</mml:mo>
<mml:msub>
<mml:mi>A</mml:mi>
<mml:mn>3</mml:mn>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula4-1740774512455370" xlink:href="10.1177_1740774512455370-eq4.tif"/>
</disp-formula></p>
<p>Condition <xref ref-type="disp-formula" rid="disp-formula1-1740774512455370">(1)</xref> does not always hold. For example, if <italic>E</italic><sub>2</sub> is independent of <italic>E</italic><sub>1</sub>, that is, <italic>A</italic><sub>3</sub> is independent of <italic>A</italic><sub>1</sub> and <italic>A</italic><sub>2</sub>, then</p>
<p><disp-formula id="disp-formula5-1740774512455370">
<mml:math display="block" id="math5-1740774512455370">
<mml:mrow>
<mml:msub>
<mml:mi>P</mml:mi>
<mml:mrow>
<mml:msub>
<mml:mi>H</mml:mi>
<mml:mrow>
<mml:mn>02</mml:mn>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mi>H</mml:mi>
<mml:mrow>
<mml:mn>03</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>A</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo>∩</mml:mo>
<mml:msub>
<mml:mover accent="true">
<mml:mi>A</mml:mi>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mn>2</mml:mn>
</mml:msub>
<mml:mo>∩</mml:mo>
<mml:msub>
<mml:mi>A</mml:mi>
<mml:mn>3</mml:mn>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mi>P</mml:mi>
<mml:mrow>
<mml:msub>
<mml:mi>H</mml:mi>
<mml:mrow>
<mml:mn>02</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>A</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo>∩</mml:mo>
<mml:msub>
<mml:mover accent="true">
<mml:mi>A</mml:mi>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mn>2</mml:mn>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:msub>
<mml:mi>P</mml:mi>
<mml:mrow>
<mml:msub>
<mml:mi>H</mml:mi>
<mml:mrow>
<mml:mn>03</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>A</mml:mi>
<mml:mn>3</mml:mn>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mi>P</mml:mi>
<mml:mrow>
<mml:msub>
<mml:mi>H</mml:mi>
<mml:mrow>
<mml:mn>02</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>A</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo>∩</mml:mo>
<mml:msub>
<mml:mover accent="true">
<mml:mi>A</mml:mi>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mn>2</mml:mn>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>×</mml:mo>
<mml:mi>α</mml:mi>
<mml:mo>&gt;</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula5-1740774512455370" xlink:href="10.1177_1740774512455370-eq5.tif"/>
</disp-formula></p>
<p>Therefore, the family-wise type I error rate is not strictly controlled at α if <italic>H</italic><sub>02</sub> and <italic>H</italic><sub>03</sub> are tested simultaneously without adjustment.</p>
<p>Some remarks on this result are as follows:</p>
<list id="list2-1740774512455370" list-type="order">
<list-item><p>The family-wise type I error rate is strictly controlled provided any closed testing or multiplicity control procedure is employed to control multiplicity for testing <italic>H</italic><sub>02</sub> and <italic>H</italic><sub>03</sub>, which can be seen by the following equation:</p>
<p><disp-formula id="disp-formula6-1740774512455370">
<mml:math display="block" id="math6-1740774512455370">
<mml:mrow>
<mml:msub>
<mml:mi>P</mml:mi>
<mml:mrow>
<mml:msub>
<mml:mi>H</mml:mi>
<mml:mrow>
<mml:mn>02</mml:mn>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mi>H</mml:mi>
<mml:mrow>
<mml:mn>03</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>A</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo>∩</mml:mo>
<mml:msub>
<mml:mi>A</mml:mi>
<mml:mn>2</mml:mn>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>∪</mml:mo>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>A</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo>∩</mml:mo>
<mml:msub>
<mml:mi>A</mml:mi>
<mml:mn>3</mml:mn>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mi>P</mml:mi>
<mml:mrow>
<mml:msub>
<mml:mi>H</mml:mi>
<mml:mrow>
<mml:mn>02</mml:mn>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mi>H</mml:mi>
<mml:mrow>
<mml:mn>03</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>A</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo>∩</mml:mo>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>A</mml:mi>
<mml:mn>2</mml:mn>
</mml:msub>
<mml:mo>∪</mml:mo>
<mml:msub>
<mml:mi>A</mml:mi>
<mml:mn>3</mml:mn>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>≤</mml:mo>
<mml:msub>
<mml:mi>P</mml:mi>
<mml:mrow>
<mml:msub>
<mml:mi>H</mml:mi>
<mml:mrow>
<mml:mn>02</mml:mn>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mi>H</mml:mi>
<mml:mrow>
<mml:mn>03</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>A</mml:mi>
<mml:mn>2</mml:mn>
</mml:msub>
<mml:mo>∪</mml:mo>
<mml:msub>
<mml:mi>A</mml:mi>
<mml:mn>3</mml:mn>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>≤</mml:mo>
<mml:mi>α</mml:mi>
<mml:mo>.</mml:mo>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula6-1740774512455370" xlink:href="10.1177_1740774512455370-eq6.tif"/>
</disp-formula></p>
<p>A special case is when <italic>H</italic><sub>01</sub>, <italic>H</italic><sub>02</sub>, and <italic>H</italic><sub>03</sub> are tested strictly sequentially.</p></list-item>
<list-item><p>It is known that a single test or confidence interval of the treatment effect can be used to rule out both NI and superiority. However, based on this result, both NI and superiority testing of the primary endpoint will impact the type I error rate for the testing of subsequent endpoint(s). Therefore, any multiplicity adjustment procedure should take into account both NI and superiority tests of the primary endpoint.</p></list-item>
<list-item><p>This result also applies to a NI study of more than two treatment arms and/or more than one endpoint tested for non-inferiority. For example, suppose a study is designed to test NI for both endpoints of <italic>E</italic><sub><italic>1</italic></sub> and <italic>E</italic><sub><italic>2</italic></sub>. If subsequent superiority testing of both endpoints is performed without further type I error rate control, multiplicity issue will arise for the superiority testing of <italic>E</italic><sub><italic>1</italic></sub> and NI and superiority testing of <italic>E</italic><sub><italic>2</italic></sub> [<xref ref-type="bibr" rid="bibr5-1740774512455370">5</xref>,<xref ref-type="bibr" rid="bibr6-1740774512455370">6</xref>].</p></list-item>
<list-item><p>In the case where one endpoint is tested for both NI and superiority, because the superiority testing is nested under the NI testing, there is no multiplicity issue between superiority and NI testing of this endpoint. Therefore, the order of the testing for NI and superiority does not matter as long as the NI margin is prespecified. For some practical and nonstatistical considerations, it may be preferred to state superiority test first, and if failed, then to test NI, although the reverse is more logically appealing. Both strategies have the family-wise type I error controlled between the NI and superiority testing. However, it is problematic if the NI test and NI margin are not prespecified [<xref ref-type="bibr" rid="bibr8-1740774512455370">8</xref>].</p></list-item>
</list>
<p>Some simulations were preformed in the following to illustrate the magnitude of the family-wise type I error rate inflation and to explore factors that impact such inflation in the testing strategy mentioned above. Data were generated from a bivariate normal distribution (<italic>Y</italic><sub>1</sub>, <italic>Y</italic><sub>2</sub>) ~ MVN((θ, η), (σ<sub>1</sub><sup>2</sup>, σ<sub>2</sub><sup>2</sup>, ρ)) in the NI study for endpoints <italic>E</italic><sub><italic>1</italic></sub> and <italic>E</italic><sub><italic>2</italic></sub> (where MVN stands for multivariate normal distribution) and both treatment groups under <italic>H</italic><sub>02</sub> and <italic>H</italic><sub>03</sub> with θ = η = 0. The correlation coefficient ρ ranged from −1 to 1. The historical estimates (upper 95% confidence limit) for θ<sub><italic>p</italic></sub> – θ<sub><italic>C</italic></sub> ranged from −0.69 to −0.18. The NI margin was set equal to half the value of historical estimates of θ<sub><italic>p</italic></sub> – θ<sub><italic>C</italic></sub>, that is, ranging from −0.35 to −0.09. The sample size was <italic>N</italic> = 1000 for each treatment group, and 5000 replications were performed. Assuming σ<sub>1</sub>= σ<sub>2</sub> = 2, a two-sample <italic>Z</italic>-test was used to test the null hypotheses based on a one-sided significance level of α = 0.025.</p>
<p>The surface plot in <xref ref-type="fig" rid="fig1-1740774512455370">Figure 1</xref> shows the relationship between the family-wise Type I error and the correlation coefficient ρ and NI margin. As seen, the family-wise type I error is inflated in general except when ρ is very close to −1 and 1. Such inflation increases with the magnitude of the NI margin, and is larger when ρ is moderately positive.</p>
<fig id="fig1-1740774512455370" position="float">
<label>Figure 1.</label>
<caption>
<p>Simulated family-wise type I error rate.</p>
</caption>
<graphic xlink:href="10.1177_1740774512455370-fig1.tif"/>
</fig>
</sec>
</sec>
</sec>
<sec id="section11-1740774512455370">
<title>Hochberg procedure</title>
<p>Consider the NI study where the primary endpoint <italic>E</italic><sub><italic>1</italic></sub> is tested for NI and superiority and the secondary endpoint <italic>E</italic><sub><italic>2</italic></sub> is tested for superiority. As shown in ‘Type I error rate in NI studies’ section, multiplicity adjustment is needed between <italic>H</italic><sub>02</sub> and <italic>H</italic><sub>03</sub> to ensure that the family-wise type I error is maintained at the prespecified level of α. If superiority for <italic>E</italic>
<sub><italic>1</italic></sub> is preferred over superiority for <italic>E</italic><sub><italic>2</italic></sub>, a hierarchical testing procedure can be used. However, sometimes it may not be completely clear which is preferable between superiority testing of <italic>E</italic><sub><italic>1</italic></sub> and <italic>E</italic>
<sub><italic>2</italic></sub>. For example, in a study of skeletal related events (SRE) for patients with bone metastases associated with advanced cancer, the primary endpoint is time to first SRE, and one secondary endpoint is recurrent SREs. The power for recurrent SREs may be larger, so it is of interest to test superiority of first SRE and recurrent SREs simultaneously. Hochberg is a popular procedure to control multiplicity for endpoints tested simultaneously without priority [<xref ref-type="bibr" rid="bibr9-1740774512455370">9</xref>]. By use of the Hochberg procedure, the following testing strategy can be constructed naturally for the NI study considered in ‘Type I error rate in NI studies’ section:</p>
<list id="list3-1740774512455370" list-type="bullet">
<list-item><p>Test for <italic>H</italic><sub>01</sub> (NI) first</p></list-item>
<list-item><p>If <italic>H</italic><sub>01</sub> is rejected at α, <italic>H</italic><sub>02</sub> and <italic>H</italic><sub>03</sub> will be tested simultaneously using the Hochberg procedure.</p></list-item>
</list>
<p>As shown in ‘Type I error rate in NI studies’ section, this testing strategy controls the family-wise type I error rate. In this section, we will evaluate the performance of this testing strategy.</p>
<p>Consider a Wald-type test statistic <inline-formula id="inline-formula1-1740774512455370">
<mml:math display="inline" id="math7-1740774512455370">
<mml:mrow>
<mml:msub>
<mml:mi>T</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mover accent="true">
<mml:mi>μ</mml:mi>
<mml:mo>^</mml:mo>
</mml:mover>
<mml:mi>θ</mml:mi>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mover accent="true">
<mml:mi>σ</mml:mi>
<mml:mo>^</mml:mo>
</mml:mover>
<mml:mi>θ</mml:mi>
</mml:msub>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
</inline-formula> with <italic>µ</italic><sub>θ</sub>=θ<sub><italic>T</italic></sub>-θ<sub><italic>C</italic></sub> and <inline-formula id="inline-formula2-1740774512455370">
<mml:math display="inline" id="math8-1740774512455370">
<mml:mrow>
<mml:msub>
<mml:mi>T</mml:mi>
<mml:mn>2</mml:mn>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mover accent="true">
<mml:mi>μ</mml:mi>
<mml:mo>^</mml:mo>
</mml:mover>
<mml:mi>η</mml:mi>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mover accent="true">
<mml:mi>σ</mml:mi>
<mml:mo>^</mml:mo>
</mml:mover>
<mml:mi>η</mml:mi>
</mml:msub>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
</inline-formula> with <italic>µ</italic><sub>η</sub>=η<sub><italic>T</italic></sub>-η<sub><italic>C</italic></sub>. Denote <inline-formula id="inline-formula3-1740774512455370">
<mml:math display="inline" id="math9-1740774512455370">
<mml:mrow>
<mml:msub>
<mml:mi>M</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mi>M</mml:mi>
<mml:mrow>
<mml:msub>
<mml:mover accent="true">
<mml:mi>σ</mml:mi>
<mml:mo>^</mml:mo>
</mml:mover>
<mml:mi>θ</mml:mi>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mi>Z</mml:mi>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:mi>α</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula>. <italic>M</italic><sub>0</sub> &lt; 0 when the NI study is designed to have adequate power for <italic>µ</italic><sub>θ</sub>&lt;0. When T<sub>1</sub>&gt;M<sub>0</sub>, the null hypothesis for NI is rejected. The rejection region for <italic>H</italic><sub>02</sub> and <italic>H</italic><sub>03</sub> is</p>
<p><disp-formula id="disp-formula7-1740774512455370">
<mml:math display="block" id="math10-1740774512455370">
<mml:mtable columnalign="left">
<mml:mtr>
<mml:mtd>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>T</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo>&gt;</mml:mo>
<mml:msub>
<mml:mi>M</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>∩</mml:mo>
<mml:mrow>
<mml:mo>{</mml:mo>
<mml:mrow>
<mml:mo stretchy="false">(</mml:mo>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>T</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo>&gt;</mml:mo>
<mml:msub>
<mml:mi>Z</mml:mi>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:mi>α</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>∩</mml:mo>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>T</mml:mi>
<mml:mn>2</mml:mn>
</mml:msub>
<mml:mo>&gt;</mml:mo>
<mml:msub>
<mml:mi>Z</mml:mi>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:mi>α</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>∪</mml:mo>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>T</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo>&gt;</mml:mo>
<mml:msub>
<mml:mi>Z</mml:mi>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:mi>α</mml:mi>
<mml:mo>/</mml:mo>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>∪</mml:mo>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>T</mml:mi>
<mml:mn>2</mml:mn>
</mml:msub>
<mml:mo>&gt;</mml:mo>
<mml:msub>
<mml:mi>Z</mml:mi>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:mi>α</mml:mi>
<mml:mo>/</mml:mo>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
<mml:mo>}</mml:mo>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd>
<mml:mo>=</mml:mo>
<mml:mo stretchy="false">(</mml:mo>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>T</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo>&gt;</mml:mo>
<mml:msub>
<mml:mi>Z</mml:mi>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:mi>α</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>∩</mml:mo>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>T</mml:mi>
<mml:mn>2</mml:mn>
</mml:msub>
<mml:mo>&gt;</mml:mo>
<mml:msub>
<mml:mi>Z</mml:mi>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:mi>α</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>∪</mml:mo>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>T</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo>&gt;</mml:mo>
<mml:msub>
<mml:mi>Z</mml:mi>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:mi>α</mml:mi>
<mml:mo>/</mml:mo>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>∪</mml:mo>
<mml:mo stretchy="false">(</mml:mo>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>T</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo>&gt;</mml:mo>
<mml:msub>
<mml:mi>M</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>∩</mml:mo>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>T</mml:mi>
<mml:mn>2</mml:mn>
</mml:msub>
<mml:mo>&gt;</mml:mo>
<mml:msub>
<mml:mi>Z</mml:mi>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:mi>α</mml:mi>
<mml:mo>/</mml:mo>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>.</mml:mo>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:math>
<graphic alternate-form-of="disp-formula7-1740774512455370" xlink:href="10.1177_1740774512455370-eq7.tif"/>
</disp-formula></p>
<p>Since NI has to be met first for <italic>E</italic><sub>1</sub>, the rejection region is truncated and excludes the following region:</p>
<p><disp-formula id="disp-formula8-1740774512455370">
<mml:math display="block" id="math11-1740774512455370">
<mml:mrow>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>T</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo>≤</mml:mo>
<mml:msub>
<mml:mi>M</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>∩</mml:mo>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>T</mml:mi>
<mml:mn>2</mml:mn>
</mml:msub>
<mml:mo>&gt;</mml:mo>
<mml:msub>
<mml:mi>Z</mml:mi>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:mi>α</mml:mi>
<mml:mo>/</mml:mo>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>.</mml:mo>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula8-1740774512455370" xlink:href="10.1177_1740774512455370-eq8.tif"/>
</disp-formula></p>
<p>Therefore, the Hochberg procedure is likely to be conservative.</p>
<p>The probability of the excluded rejection region, that is, the decrease in the family-wise type I error rate, is</p>
<p><disp-formula id="disp-formula9-1740774512455370">
<mml:math display="block" id="math12-1740774512455370">
<mml:mrow>
<mml:mi>L</mml:mi>
<mml:mo>=</mml:mo>
<mml:mstyle displaystyle="true">
<mml:mrow>
<mml:munderover>
<mml:mo>∫</mml:mo>
<mml:mrow>
<mml:mo>−</mml:mo>
<mml:mi>∞</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mi>M</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
</mml:mrow>
</mml:munderover>
<mml:mrow>
<mml:mstyle displaystyle="true">
<mml:mrow>
<mml:munderover>
<mml:mo>∫</mml:mo>
<mml:mrow>
<mml:msub>
<mml:mi>Z</mml:mi>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:mi>α</mml:mi>
<mml:mo>/</mml:mo>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mi>∞</mml:mi>
</mml:munderover>
<mml:mrow>
<mml:mi>φ</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>y</mml:mi>
<mml:mo>;</mml:mo>
<mml:mi>ρ</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mi>d</mml:mi>
<mml:mi>x</mml:mi>
<mml:mi>d</mml:mi>
<mml:mi>y</mml:mi>
<mml:mo>,</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:mstyle>
</mml:mrow>
</mml:mrow>
</mml:mstyle>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula9-1740774512455370" xlink:href="10.1177_1740774512455370-eq9.tif"/>
</disp-formula></p>
<p>where ϕ(<italic>x,y</italic>;ρ) is the density function of the bivariate standard normal distribution with a correlation coefficient of ρ. <italic>L</italic> increases as <italic>M</italic>
<sub>0</sub> increases, and so the Hochberg procedure is more conservative for a smaller absolute value of the NI margin. It can be shown that <italic>L</italic> is monotonically decreasing with ρ. <italic>L</italic> can be as high as α/2 and is small for moderate-to-high positive correlation between the two endpoints.</p>
<p>A direct modification of the above procedure could be made by claiming back the probability mass of <italic>L</italic> to the rejection region of the Hochberg procedure. However, as <italic>L</italic> is very sensitive to ρ, there are no simple ways of doing this for all ρ. For example, <italic>L</italic> can be added into the rejection region for <italic>H</italic><sub>02</sub>, that is, to find <italic>D</italic> such that</p>
<p><disp-formula id="disp-formula10-1740774512455370">
<mml:math display="block" id="math13-1740774512455370">
<mml:mrow>
<mml:mstyle displaystyle="true">
<mml:mrow>
<mml:munderover>
<mml:mo>∫</mml:mo>
<mml:mi>D</mml:mi>
<mml:mrow>
<mml:msub>
<mml:mi>Z</mml:mi>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:mi>α</mml:mi>
<mml:mo>/</mml:mo>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:munderover>
<mml:mrow>
<mml:mstyle displaystyle="true">
<mml:mrow>
<mml:munderover>
<mml:mo>∫</mml:mo>
<mml:mrow>
<mml:mo>−</mml:mo>
<mml:mi>∞</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mi>Z</mml:mi>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:mi>α</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:munderover>
<mml:mrow>
<mml:mi>φ</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>y</mml:mi>
<mml:mo>;</mml:mo>
<mml:mi>ρ</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mi>d</mml:mi>
<mml:mi>x</mml:mi>
<mml:mi>d</mml:mi>
<mml:mi>y</mml:mi>
</mml:mrow>
</mml:mrow>
</mml:mstyle>
</mml:mrow>
</mml:mrow>
</mml:mstyle>
<mml:mo>=</mml:mo>
<mml:mstyle displaystyle="true">
<mml:mrow>
<mml:munderover>
<mml:mo>∫</mml:mo>
<mml:mrow>
<mml:mo>−</mml:mo>
<mml:mi>∞</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mi>M</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
</mml:mrow>
</mml:munderover>
<mml:mrow>
<mml:mstyle displaystyle="true">
<mml:mrow>
<mml:munderover>
<mml:mo>∫</mml:mo>
<mml:mrow>
<mml:msub>
<mml:mi>Z</mml:mi>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:mi>α</mml:mi>
<mml:mo>/</mml:mo>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mi>∞</mml:mi>
</mml:munderover>
<mml:mrow>
<mml:mi>φ</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>y</mml:mi>
<mml:mo>;</mml:mo>
<mml:mi>ρ</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mi>d</mml:mi>
<mml:mi>x</mml:mi>
<mml:mi>d</mml:mi>
<mml:mi>y</mml:mi>
</mml:mrow>
</mml:mrow>
</mml:mstyle>
</mml:mrow>
</mml:mrow>
</mml:mstyle>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula10-1740774512455370" xlink:href="10.1177_1740774512455370-eq10.tif"/>
</disp-formula></p>
<p>Then, <italic>H</italic><sub>02</sub> will be rejected if the p-value is less than Φ<sup>−1</sup>(<italic>D</italic>). The solution depends on ρ and varies greatly. <xref ref-type="table" rid="table1-1740774512455370">Table 1</xref> presents values of <italic>D</italic> for <italic>M</italic><sub>0</sub> = 0, α = 0.025, and selected correlation coefficient ρ.</p>
<table-wrap id="table1-1740774512455370" position="float">
<label>Table 1.</label>
<caption>
<p>Values of <italic>D</italic> for selected correlation coefficient ρ</p>
</caption>
<graphic alternate-form-of="table1-1740774512455370" xlink:href="10.1177_1740774512455370-table1.tif"/>
<table>
<colgroup>
<col align="left"/>
<col align="char" char="."/>
<col align="char" char="."/>
<col align="char" char="."/>
<col align="char" char="."/>
<col align="char" char="."/>
</colgroup>
<thead>
<tr>
<th align="left">ρ</th>
<th align="left">−0.5</th>
<th align="left">−0.25</th>
<th align="left">0</th>
<th align="left">0.25</th>
<th align="left">0.5</th>
</tr>
</thead>
<tbody>
<tr>
<td><italic>L</italic></td>
<td>0.0117</td>
<td>0.0094</td>
<td>0.0063</td>
<td>0.0032</td>
<td>0.0009</td>
</tr>
<tr>
<td><italic>D</italic></td>
<td>1.974</td>
<td>2.0145</td>
<td>2.075</td>
<td>2.145</td>
<td>2.208</td>
</tr>
</tbody>
</table>
</table-wrap>
<p>The decrease in type I error rate is minor if the correlation between the two endpoints is moderately or highly positive, and the absolute NI margin is not small. When the absolute value of NI margin is small and the correlation between the two endpoints is weak or negative, the Hochberg procedure may be quite conservative.</p>
<p>In addition, one can incorporate the resampling-based procedure [<xref ref-type="bibr" rid="bibr10-1740774512455370">10</xref>] to account for the underlying correlations. The general tree-structured gatekeeping procedures may also be used [<xref ref-type="bibr" rid="bibr11-1740774512455370">11</xref>,<xref ref-type="bibr" rid="bibr12-1740774512455370">12</xref>]. A graphical approach to sequentially rejective multiple testing procedures can also be considered [<xref ref-type="bibr" rid="bibr6-1740774512455370">6</xref>,<xref ref-type="bibr" rid="bibr13-1740774512455370">13</xref>].</p>
</sec>
<sec id="section12-1740774512455370" sec-type="discussion|conclusions">
<title>Discussion and conclusions</title>
<p>In this article, we demonstrated that in an NI study where the primary endpoint is tested for both NI and superiority and another endpoint is tested for superiority, a multiplicity issue exists in general. In the absence of a multiplicity adjustment, the type I error rate increases as the NI margin gets larger and inflation is more severe for moderately positive correlation between the two endpoints. Appropriate multiplicity adjustment is necessary to ensure a strict control of the family-wise type I error. Although the discussion was based on the fixed margin approach, the conclusion should also apply to the synthesis approach [<xref ref-type="bibr" rid="bibr14-1740774512455370">14</xref>] and the two-step approach in the FDA draft guidance document [<xref ref-type="bibr" rid="bibr1-1740774512455370">1</xref>].</p>
<p>Any multiplicity control procedure can be applied to gain control of the family-wise type I error. However, NI studies have a unique feature that the same analysis result is used in tests for both NI and superiority. Some authors have pointed out that the using intention-to-treat (ITT) analysis set may be anti-conservative in the NI setting [<xref ref-type="bibr" rid="bibr15-1740774512455370">15</xref><xref ref-type="bibr" rid="bibr16-1740774512455370"/>–<xref ref-type="bibr" rid="bibr17-1740774512455370">17</xref>], leading some investigators to choose a per protocol analysis set for NI, and that different imputation techniques for missing data may be applied in the two settings [<xref ref-type="bibr" rid="bibr18-1740774512455370">18</xref>,<xref ref-type="bibr" rid="bibr19-1740774512455370">19</xref>]. However, high correlation is expected from these analysis results and the discussion here should also apply. Based on the popular Hochberg procedure, we investigated the impact of this feature on the family-wise type I error rate. We showed that it leads to a conservative adjustment procedure in general. When the absolute NI margin is small and the correlation between the two endpoints is weak or negative, the Hochberg procedure may be very conservative. It is possible but complex to refine the procedure to increase the study power. Many general and flexible multiplicity adjustment methods have been developed recently [<xref ref-type="bibr" rid="bibr11-1740774512455370">11</xref><xref ref-type="bibr" rid="bibr12-1740774512455370"/>–<xref ref-type="bibr" rid="bibr13-1740774512455370">13</xref>,<xref ref-type="bibr" rid="bibr20-1740774512455370">20</xref>]. Future work is needed in further adapting the Hochberg procedure to NI studies and in exploring and evaluating other multiplicity adjustment methods and extensions to complex NI studies with multiple endpoints and treatment arms.</p>
</sec>
</body>
<back>
<ack>
<p>We thank the reviewers and editors for their careful reading of the manuscript and helpful comments.</p>
</ack>
<fn-group>
<fn fn-type="financial-disclosure">
<label>Funding</label>
<p>This research received no specific grant from any funding agency in the public, commercial, or not-for-profit sectors.</p>
</fn>
<fn fn-type="conflict">
<label>Conflict of interest</label>
<p>None declared.</p>
</fn>
</fn-group>
<ref-list>
<title>References</title>
<ref id="bibr1-1740774512455370">
<label>1.</label>
<citation citation-type="book">
<collab>US Food and Drug Administration (FDA)</collab>. <source>Guidance for Industry: Non-Inferiority Clinical Trials</source>. <publisher-name>FDA, Silver Spring</publisher-name>, <publisher-loc>MD</publisher-loc>, <year>2010</year>.</citation>
</ref>
<ref id="bibr2-1740774512455370">
<label>2.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Morikawa</surname><given-names>T</given-names></name>
<name><surname>Yoshida</surname><given-names>M</given-names></name>
</person-group>. <article-title>A useful testing strategy in phase III trials: Combined test of superiority and test of equivalence</article-title>. <source>J Biopharm Stat</source> <year>1995</year>; <volume>5</volume>: <fpage>297</fpage>–<lpage>306</lpage>.</citation>
</ref>
<ref id="bibr3-1740774512455370">
<label>3.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Dunnett</surname><given-names>CW</given-names></name>
<name><surname>Gent</surname><given-names>M</given-names></name>
</person-group>. <article-title>Significance testing to establish equivalence between treatments with special reference to data in the form of 2 × 2 tables</article-title>. <source>Biometrics</source> <year>1997</year>; <volume>33</volume>: <fpage>593</fpage>–<lpage>602</lpage>.</citation>
</ref>
<ref id="bibr4-1740774512455370">
<label>4.</label>
<citation citation-type="book">
<collab>CPMP/EWP/482/99</collab>. <source>Points to Consider on Switching from Non-Inferiority and Superiority</source>. <publisher-name>EMEA</publisher-name>, <publisher-loc>London</publisher-loc>, <year>2000</year>.</citation>
</ref>
<ref id="bibr5-1740774512455370">
<label>5.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Hung</surname><given-names>HM</given-names></name>
<name><surname>Wang</surname><given-names>SJ</given-names></name>
</person-group>. <article-title>Some controversial multiple testing problems in regulatory application</article-title>. <source>J Biopharm Stat</source> <year>2009</year>; <volume>19</volume>: <fpage>1</fpage>–<lpage>11</lpage>.</citation>
</ref>
<ref id="bibr6-1740774512455370">
<label>6.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Hung</surname><given-names>HM</given-names></name>
<name><surname>Wang</surname><given-names>SJ</given-names></name>
</person-group>. <article-title>Challenges to multiple testing in clinical trials</article-title>. <source>Biometrical J</source> <year>2010</year>; <volume>52</volume>: <fpage>747</fpage>–<lpage>56</lpage>.</citation>
</ref>
<ref id="bibr7-1740774512455370">
<label>7.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Marcus</surname><given-names>R</given-names></name>
<name><surname>Peritz</surname><given-names>E</given-names></name>
<name><surname>Gabriel</surname><given-names>KR</given-names></name>
</person-group>. <article-title>On closed testing procedure with special reference to ordered analysis of variance</article-title>. <source>Biometrika</source> <year>1976</year>; <volume>63</volume>: <fpage>655</fpage>–<lpage>60</lpage>.</citation>
</ref>
<ref id="bibr8-1740774512455370">
<label>8.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Freidlin</surname><given-names>B</given-names></name>
<name><surname>Korn</surname><given-names>EL</given-names></name>
<name><surname>George</surname><given-names>SL</given-names></name>
<name><surname>Gray</surname><given-names>R</given-names></name>
</person-group>. <article-title>Randomized clinical trial design for assessing noninferiority when superiority is expected</article-title>. <source>J Clin Oncol</source> <year>2007</year>; <volume>25</volume>: <fpage>5019</fpage>–<lpage>23</lpage>.</citation>
</ref>
<ref id="bibr9-1740774512455370">
<label>9.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Hochberg</surname><given-names>Y</given-names></name>
</person-group>. <article-title>A sharper Bonferroni procedure for multiple significance testing</article-title>. <source>Biometrika</source> <year>1988</year>; <volume>75</volume>: <fpage>800</fpage>–<lpage>3</lpage>.</citation>
</ref>
<ref id="bibr10-1740774512455370">
<label>10.</label>
<citation citation-type="book">
<person-group person-group-type="author">
<name><surname>Westfall</surname><given-names>PH</given-names></name>
<name><surname>Young</surname><given-names>SS</given-names></name>
</person-group>. <source>Resampling-Based Multiple Testing: Examples and Methods for p-Value Adjustment</source>. <publisher-name>Wiley</publisher-name>, <publisher-loc>New York</publisher-loc>, <year>1993</year>.</citation>
</ref>
<ref id="bibr11-1740774512455370">
<label>11.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Dmitrienko</surname><given-names>A</given-names></name>
<name><surname>Wiens</surname><given-names>BL</given-names></name>
<name><surname>Tamhane</surname><given-names>AC</given-names></name>
<name><surname>Wang</surname><given-names>X</given-names></name>
</person-group>. <article-title>Tree-structured gatekeeping tests in clinical trials with hierarchically ordered multiple objectives</article-title>. <source>Stat Med</source> <year>2006</year>; <volume>26</volume>: <fpage>2465</fpage>–<lpage>78</lpage>.</citation>
</ref>
<ref id="bibr12-1740774512455370">
<label>12.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Dmitrienko</surname><given-names>A</given-names></name>
<name><surname>Tamhane</surname><given-names>AC</given-names></name>
<name><surname>Liu</surname><given-names>L</given-names></name>
<name><surname>Wiens</surname><given-names>BL</given-names></name>
</person-group>. <article-title>A note on tree gatekeeping procedures in clinical trials</article-title>. <source>Stat Med</source> <year>2008</year>; <volume>06</volume>: <fpage>1</fpage>–<lpage>6</lpage>.</citation>
</ref>
<ref id="bibr13-1740774512455370">
<label>13.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Guilbaud</surname><given-names>O</given-names></name>
</person-group>. <article-title>Note on simultaneous inferences about non-inferiority and superiority for a primary and a secondary endpoint</article-title>. <source>Biometrical J</source> <year>2011</year>; <volume>53</volume>: <fpage>927</fpage>–<lpage>37</lpage>.</citation>
</ref>
<ref id="bibr14-1740774512455370">
<label>14.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Hung</surname><given-names>JHM</given-names></name>
<name><surname>Wang</surname><given-names>SJ</given-names></name>
<name><surname>Tsong</surname><given-names>Y</given-names></name>
<name><surname>Lawrence</surname><given-names>J</given-names></name>
<name><surname>O’Neil</surname><given-names>RT</given-names></name>
</person-group>. <article-title>Some fundamental issues with non-inferiority testing in active controlled trials</article-title>. <source>Stat Med</source> <year>2003</year>; <volume>22</volume>: <fpage>213</fpage>–<lpage>25</lpage>.</citation>
</ref>
<ref id="bibr15-1740774512455370">
<label>15.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Snapinn</surname><given-names>SM</given-names></name>
</person-group>. <article-title>Noninferiority trials</article-title>. <source>Curr Contr Trials C</source> <year>2000</year>; <volume>1</volume>: <fpage>19</fpage>–<lpage>21</lpage>.</citation>
</ref>
<ref id="bibr16-1740774512455370">
<label>16.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>D’Agostino</surname><given-names>RB</given-names></name>
<name><surname>Massaro</surname><given-names>JM</given-names></name>
<name><surname>Sullivan</surname><given-names>LM</given-names></name>
</person-group>. <article-title>Non-inferiority trials: Design concepts and issues – the encounters of academic consultants in statistics</article-title>. <source>Stat Med</source> <year>2003</year>; <volume>22</volume>: <fpage>169</fpage>–<lpage>86</lpage>.</citation>
</ref>
<ref id="bibr17-1740774512455370">
<label>17.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Sanchez</surname><given-names>MM</given-names></name>
<name><surname>Chen</surname><given-names>X</given-names></name>
</person-group>. <article-title>Choosing the analysis population in non-inferiority studies: Per protocol or intent-to-treat</article-title>. <source>Stat Med</source> <year>2006</year>; <volume>25</volume>: <fpage>1169</fpage>–<lpage>81</lpage>.</citation>
</ref>
<ref id="bibr18-1740774512455370">
<label>18.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Wiens</surname><given-names>B</given-names></name>
</person-group>. <article-title>Something for nothing in noninferiority/superiority testing: A caution</article-title>. <source>Drug Inf J</source> <year>2001</year>; <volume>35</volume>: <fpage>241</fpage>–<lpage>5</lpage>.</citation>
</ref>
<ref id="bibr19-1740774512455370">
<label>19.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Gallo</surname><given-names>P</given-names></name>
<name><surname>Chuang-Stein</surname><given-names>C</given-names></name>
</person-group>. <article-title>A note on missing data in non-inferiority trials</article-title>. <source>Drug Inf J</source> <year>2009</year>; <volume>43</volume>: <fpage>469</fpage>–<lpage>74</lpage>.</citation>
</ref>
<ref id="bibr20-1740774512455370">
<label>20.</label>
<citation citation-type="book">
<person-group person-group-type="author">
<name><surname>Dmitrienko</surname><given-names>A</given-names></name>
<name><surname>Molenberghs</surname><given-names>G</given-names></name>
<name><surname>Chuang-Stein</surname><given-names>C</given-names></name>
<name><surname>Offen</surname><given-names>W</given-names></name>
</person-group>. <source>Analysis of Clinical Trials Using SAS: A Practical Guide</source>. <publisher-name>SAS Institute Inc.</publisher-name>, <publisher-loc>Cary, NC</publisher-loc>, <year>2005</year>.</citation>
</ref>
</ref-list>
</back>
</article>