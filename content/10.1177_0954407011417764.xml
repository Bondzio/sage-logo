<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v2.3 20070202//EN" "journalpublishing.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">PID</journal-id>
<journal-id journal-id-type="hwp">sppid</journal-id>
<journal-title>Proceedings of the Institution of Mechanical Engineers, Part D: Journal of Automobile Engineering</journal-title>
<issn pub-type="ppub">0954-4070</issn>
<issn pub-type="epub">2041-2991</issn>
<publisher>
<publisher-name>SAGE Publications</publisher-name>
<publisher-loc>Sage UK: London, England</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1177/0954407011417764</article-id>
<article-id pub-id-type="publisher-id">10.1177_0954407011417764</article-id>
<title-group>
<article-title>Development of a comprehensive and flexible forward dynamic powertrain simulation tool for various hybrid electric vehicle architectures</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name><surname>Cheng</surname><given-names>C</given-names></name>
<xref ref-type="aff" rid="aff1-0954407011417764">1</xref>
<xref ref-type="corresp" rid="corresp1-0954407011417764">*</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>McGordon</surname><given-names>A</given-names></name>
<xref ref-type="aff" rid="aff2-0954407011417764">2</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Jones</surname><given-names>R P</given-names></name>
<xref ref-type="aff" rid="aff1-0954407011417764">1</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Jennings</surname><given-names>P A</given-names></name>
<xref ref-type="aff" rid="aff2-0954407011417764">2</xref>
</contrib>
</contrib-group>
<aff id="aff1-0954407011417764"><label>1</label>School of Engineering, University of Warwick, Coventry, UK</aff>
<aff id="aff2-0954407011417764"><label>2</label>WMG, University of Warwick, Coventry, UK</aff>
<author-notes>
<corresp id="corresp1-0954407011417764"><label>*</label>School of Engineering, University of Warwick, Coventry CV4 7AL, UK. email: <email>c.cheng@warwick.ac.uk</email></corresp>
</author-notes>
<pub-date pub-type="epub-ppub">
<month>3</month>
<year>2012</year>
</pub-date>
<volume>226</volume>
<issue>3</issue>
<fpage>385</fpage>
<lpage>398</lpage>
<history>
<date date-type="received">
<day>16</day>
<month>3</month>
<year>2011</year>
</date>
<date date-type="accepted">
<day>1</day>
<month>7</month>
<year>2011</year>
</date>
</history>
<permissions>
<copyright-statement>© IMechE 2012</copyright-statement>
<copyright-year>2012</copyright-year>
<copyright-holder content-type="society">Institution of Mechanical Engineers</copyright-holder>
</permissions>
<abstract>
<p>This paper presents a comprehensive and flexible forward dynamic powertrain simulation tool, WARwick Powertrain Simulation Tool for ARchitectures 2 (WARPSTAR2), for modelling of conventional internal combustion engine, hybrid, and pure electric vehicles. WARPSTAR2 includes physical powertrain component models and their controllers, a hybrid supervisory controller, the driver, and the environment model. The physical powertrain component models are developed in Dymola, while the component controllers, the hybrid supervisory controllers, and the driver model are realized in MATLAB/Simulink. Thus the power of these two software tools is combined.</p>
<p>A generalized fuzzy-logic-based supervisory controller is proposed for all hybrid electric vehicle (HEV) architectures so that all HEVs with different architectures share the same structure of supervisory controller. The generalized formation can be used for the supervisory controllers of different HEV architectures with varied parameter settings, thus facilitating the controller design process. The rule-based supervisory controller is also developed in WARPSTAR2. Simulation is carried out for different HEVs with these two supervisory controllers in the driving cycles. The results of engine and battery power usages with these two supervisory controllers are similar and the differences of predicted engine fuel consumptions between the two supervisory controllers are within 5 per cent.</p>
</abstract>
<kwd-group>
<kwd>hybrid electric vehicle</kwd>
<kwd>forward dynamic</kwd>
<kwd>powertrain</kwd>
<kwd>modelling</kwd>
<kwd>architecture</kwd>
<kwd>generalized formation</kwd>
<kwd>fuzzy-logic-based</kwd>
<kwd>rule-based</kwd>
<kwd>supervisory control</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="section1-0954407011417764" sec-type="intro">
<title>1 Introduction</title>
<p>Hybrid electric vehicles (HEVs) contain at least two energy sources and associated power converters. They are typically equipped with an internal combustion engine (ICE) and an electric propulsion system. The introduction of an electric propulsion system in an HEV is to achieve lower fuel consumption and less air pollution than a conventional vehicle, through optimization of vehicle and engine operations.</p>
<p>Owing to the dual propulsion sources of HEVs, there are several powertrain architectures and different control strategies to manage the power sources [<xref ref-type="bibr" rid="bibr1-0954407011417764">1</xref>]. The different architectures and control strategies result in different vehicle performance and operation characteristics.</p>
<p>In order to examine rapidly the potential impact of HEV architectures on fuel consumption and emissions, many software programs have been developed for HEV powertrain modelling, e.g. ADVISOR [<xref ref-type="bibr" rid="bibr2-0954407011417764">2</xref>], VSIM [<xref ref-type="bibr" rid="bibr3-0954407011417764">3</xref>], and AMESim [<xref ref-type="bibr" rid="bibr4-0954407011417764">4</xref>]. Some of them are forward dynamic models, while others are inverse dynamic models. A forward dynamic vehicle model includes a driver model. It considers the difference between the required and the actual vehicle speeds to develop appropriate throttle and brake demands, which will be translated into engine torque and braking torque demands. The forward dynamic approach is desirable for hardware development, detailed control simulation, and the investigation of the influence of real-world driver behaviour on energy usage. The inverse dynamic vehicle model does not include a driver model. The tyre/road force required to accelerate or brake the vehicle is calculated directly from the required speed. The required force is then translated into wheel torque and passed inversely to driveline, transmission, and engine or battery, against the traction power flow direction, until the fuel consumption or battery energy usage is determined.</p>
<p>There are currently few modelling programs that compare different vehicle architectures directly with the capability to study the influence of real-world driver behaviour on energy usage. For this purpose, a comprehensive forward dynamic powertrain simulation tool for various hybrid vehicle architectures, WARwick Powertrain Simulation Tool for ARchitectures 2 (WARPSTAR2), is being developed, comprising various HEV powertrain architectures and the corresponding supervisory controllers. A generalized fuzzy-logic-based supervisory controller is proposed for all HEV architectures so that all HEVs with different architectures share the same structure of supervisory controller. The generalized formation can be used for the supervisory controllers of different HEV architectures with varied parameter settings, thus facilitating the controller design process. The rule-based supervisory controller is also developed in WARPSTAR2. In this paper, a simple driver model using appropriate throttle and brake commands with a proportional-integral (PI) controller is used to ensure that the vehicle speed follows the desired speed in driving cycles.</p>
<p>In section 2, current HEV modelling programs are reviewed and a forward dynamic HEV powertrain modelling structure is proposed. In section 3, a generalized fuzzy-logic-based supervisory controller is introduced. In section 4, the simulation results of the generalized fuzzy-logic-based controller are compared against those of a rule-based controller for various HEV architectures. Conclusions are given in section 5.</p>
</sec>
<sec id="section2-0954407011417764">
<title>2 Proposed Modelling Structure</title>
<p>In this section, the current programs available for HEV powertrain modelling and simulation are compared and a modelling structure using Dymola [<xref ref-type="bibr" rid="bibr5-0954407011417764">5</xref>] and MATLAB/Simulink is proposed for the development of the powertrain simulation tool WARPSTAR2.</p>
<sec id="section3-0954407011417764">
<title>2.1 Current modelling programs</title>
<p>There are many modelling programs available for HEV powertrain modelling. They can be grouped into the four categories shown in the following sub-sections. Refer to reference [<xref ref-type="bibr" rid="bibr6-0954407011417764">6</xref>] for more details about the comparison of the current modelling programs.</p>
<sec id="section4-0954407011417764">
<title>2.1.1 Bespoke hybrid programs</title>
<p>Examples of bespoke hybrid programs are ADVISOR [<xref ref-type="bibr" rid="bibr2-0954407011417764">2</xref>], VSIM [<xref ref-type="bibr" rid="bibr3-0954407011417764">3</xref>], PSAT [<xref ref-type="bibr" rid="bibr7-0954407011417764">7</xref>], and WARPSTAR [<xref ref-type="bibr" rid="bibr6-0954407011417764">6</xref>]. These are MATLAB/Simulink based with a block diagram approach. These offer good compatibility with other models developed in MATLAB/Simulink, but they are not flexible with causal solutions. The fidelities of these modelling programs are low since they are energy based.</p>
</sec>
<sec id="section5-0954407011417764">
<title>2.1.2 MATLAB/Simulink toolboxes</title>
<p>Examples of MATLAB/Simulink toolboxes are the Simulink physical modelling toolboxes SimDriveline [<xref ref-type="bibr" rid="bibr8-0954407011417764">8</xref>] and SimPowerSystems [<xref ref-type="bibr" rid="bibr9-0954407011417764">9</xref>], ADVANCE Powertrain [<xref ref-type="bibr" rid="bibr10-0954407011417764">10</xref>], and QSS-TB [<xref ref-type="bibr" rid="bibr11-0954407011417764">11</xref>]. The physical modelling tools in Simulink (SimDriveline and SimPowerSystems) are acausal with conservative connection points.</p>
</sec>
<sec id="section6-0954407011417764">
<title>2.1.3 Multiphysics programs</title>
<p>Examples of multiphysics programs with automotive libraries are Easy5 [<xref ref-type="bibr" rid="bibr12-0954407011417764">12</xref>], Simplorer [<xref ref-type="bibr" rid="bibr13-0954407011417764">13</xref>], Dymola [<xref ref-type="bibr" rid="bibr5-0954407011417764">5</xref>], MapleSim [<xref ref-type="bibr" rid="bibr14-0954407011417764">14</xref>], and AMESim [<xref ref-type="bibr" rid="bibr4-0954407011417764">4</xref>], and those without an automotive library are Saber [<xref ref-type="bibr" rid="bibr15-0954407011417764">15</xref>], which is focused on applications in power electronics, electric power generation/conversion/distribution, and mechatronics. The acausal approach used in multiphysical packages has the functionality of both the forward dynamic and inverse dynamic solutions by symbolic manipulation. This avoids rearranging the model when switching between forward and inverse dynamic models.</p>
</sec>
<sec id="section7-0954407011417764">
<title>2.1.4 Conventional powertrain programs</title>
<p>Examples of conventional powertrain programs are GT Drive [<xref ref-type="bibr" rid="bibr16-0954407011417764">16</xref>], which extends GT Power and includes high-fidelity models for engines and aftertreatment, AVL CRUISE [<xref ref-type="bibr" rid="bibr17-0954407011417764">17</xref>], which is a vehicle model built around high-fidelity models of the transmission, and Ricardo WAVE [<xref ref-type="bibr" rid="bibr18-0954407011417764">18</xref>], which is an engine performance and gas dynamics simulation software. These packages provide high fidelities, but they are more component specific.</p>
</sec>
</sec>
<sec id="section8-0954407011417764">
<title>2.2 Criteria for assessing the modelling structures</title>
<p>It can be seen from the previous section that many software programs have been developed for HEV powertrain modelling. In order to find out which one is suitable for this project, a set of criteria is defined based on the requirements for this project.</p>
<sec id="section9-0954407011417764">
<title>2.2.1 Forward dynamic</title>
<p>A forward dynamic modelling structure with a driver model included is needed to study the influence of real-world driver behaviour on energy usage.</p>
</sec>
<sec id="section10-0954407011417764">
<title>2.2.2 Flexibility</title>
<p>The structure should be flexible enough for modelling of any HEV powertrain architecture and easily extended from a base model to complicated ones. This also applies to the control strategies for different HEV powertrain architectures.</p>
</sec>
<sec id="section11-0954407011417764">
<title>2.2.3 Fidelity</title>
<p>The accuracy of the simulation results depends on the fidelity of the component modelling, which should be appropriate for the tasks. A library of components with different levels of fidelity applied to different tasks is required.</p>
</sec>
<sec id="section12-0954407011417764">
<title>2.2.4 Multidomain</title>
<p>It should have the capability of simulating the dynamic behaviour and complex interactions between systems of engineering fields of mechanical, electrical, and thermal systems, which can build more integrated models and have simulations results that better depict reality.</p>
</sec>
<sec id="section13-0954407011417764">
<title>2.2.5 Compatibility</title>
<p>It should easily interact with other models built in the most commonly used engineering software, such as MATLAB/Simulink.</p>
</sec>
</sec>
<sec id="section14-0954407011417764">
<title>2.3 Modelling structure</title>
<p>As described in section 2.1, the bespoke hybrid programs offer good compatibility with other models developed in MATLAB/Simulink. It is good for control design via the Stateflow tool and Real-Time Workshop from the MathWorks. Structures using MATLAB/Simulink toolboxes provide a sufficient way to create simple plant models. However, the signal-flow characteristics of MATLAB/Simulink are not well suited for multidomain physical modelling. They demand time-consuming and error-prone manual derivation of system equations considering all HEV architectures modelled with different component models at various levels of fidelities. The details associated with the complexity of HEVs require an approach with superior physical modelling [<xref ref-type="bibr" rid="bibr19-0954407011417764">19</xref>].</p>
<p>The multiphysics programs with an acausal approach provide models with both forward and inverse solution with symbolic manipulation. Thus, the models have the potential to be used for both forward and inverse solutions. Among the multiphysics program list in section 2.1, Dymola and MapleSim are developed based on Modelica [<xref ref-type="bibr" rid="bibr20-0954407011417764">20</xref>, <xref ref-type="bibr" rid="bibr21-0954407011417764">21</xref>]. Modelica is a non-proprietary, object-oriented, equation-based language developed by the Modelica Association [<xref ref-type="bibr" rid="bibr22-0954407011417764">22</xref>]. It can be used to model complex physical systems conveniently containing, for example, mechanical, electrical, electronic, hydraulic, thermal, control, electric power, or process-oriented subcomponents. Among the Modelica-based tools, Dymola is the most mature one. The capabilities of model replacement and extension in Dymola make it easy to develop various HEV architectures with different levels of component fidelities. However, they are restricted in controller design.</p>
<p>The conventional powertrain programs provide high-fidelity models for specific components. However, they are not flexible enough to include all HEV architectures. They are also restricted in multidomain modelling.</p>
<p>From the analysis above, it is clear that Dymola is the package that has the most advanced structure for the majority of physical modelling applications and MATLAB/Simulink has excellent functionality, especially for controller design, with a wide range of toolboxes. It can be seen that none of the packages discussed in section 2.1 meet all the assessment criteria. Therefore, a modelling structure is proposed to combine the capabilities of two modelling programs, Dymola and MATLAB/Simulink. The physical powertrain component model is developed in Dymola and the controllers are realized in MATLAB/Simulink. The powertrain model in Dymola can be translated into C code and exported to MATLAB/Simulink as an S-function and used on hardware-in-the-loop (HIL) platforms. Therefore the clear advantages of both modelling packages can be used.</p>
<p>To make it easy to describe the general modelling structure in more detail, a Mild Parallel hybrid vehicle is used for illustration purposes. On a Mild Parallel hybrid vehicle, an electric motor/generator operates in parallel with the internal combustion engine to provide additional drive torque as well as regenerative braking. The first manufacturer to build a system that fits into the Mild Parallel subcategory is generally considered to be Honda with its Integrated Motor Assist (IMA) system [<xref ref-type="bibr" rid="bibr23-0954407011417764">23</xref>]. The modelling structure layout of a Mild Parallel hybrid vehicle is given in <xref ref-type="fig" rid="fig1-0954407011417764">Fig. 1</xref>. It includes vehicle component models, powertrain component controllers, a hybrid supervisory controller, the environment, and the driver model. All of the vehicle components in the plant ‘box’ are modelled in Dymola, while the environment, the driver, the hybrid supervisory control, and all powertrain component controls are developed in MATLAB/Simulink.</p>
<fig id="fig1-0954407011417764" position="float">
<label>Fig. 1</label>
<caption>
<p>Modelling structure of the Mild Parallel hybrid vehicle</p>
</caption>
<graphic xlink:href="10.1177_0954407011417764-fig1.tif"/>
</fig>
<p>The vehicle powertrain model in Dymola is developed based on the VehicleInterface library [<xref ref-type="bibr" rid="bibr24-0954407011417764">24</xref>], which is written in Modelica language. Some modelling techniques in the VehicleInterface library are adopted in developing the powertrain model, such as all the signals transmitted via an expandable control bus. The components of the world, road, and atmosphere are directly from Modelica or VehicleInterface library. The other components, including accessories, engine, transmission, driveline, chassis, and brake, are developed based on the available parameters.</p>
<p>Component models with different levels of fidelities are developed to accommodate various model requirements. The symbolic manipulation technique in Dymola relieves the user from converting equations to assignment statements or block diagrams, which makes the simulation processes more efficient and robust. The unit management in Dymola ensures that the connections between blocks are correct in units and thus prevent any mistakes that happen in MATLAB/Simulink with no unit checking. For instance, the interface of rotational torque and angle in Dymola is only allowed to be connected to another interface with rotational torque and angle. The models can be easily re-used and extended to form more complex ones due to the acausal equation-oriented modelling method. There are also open and commercial libraries in Dymola that the user can easily adapt to match unique needs or build their own. All of these characteristics in Dymola will minimize the chance of making mistakes in modelling and ensure the fidelity of the complex models.</p>
<p>When all of the individual components have been modelled, the powertrain model can be easily built by connecting the components based on their relationship on a vehicle. The top-level layout of the Mild Parallel hybrid vehicle model in Dymola is given in <xref ref-type="fig" rid="fig2-0954407011417764">Fig. 2</xref>.</p>
<fig id="fig2-0954407011417764" position="float">
<label>Fig. 2</label>
<caption>
<p>Top-level layout of the Mild Parallel hybrid vehicle model in Dymola</p>
</caption>
<graphic xlink:href="10.1177_0954407011417764-fig2.tif"/>
</fig>
<p>After the vehicle powertrain model is developed, it can be exported to MATLAB/Simulink as an S-function using the Dymola–Simulink interface. The top-level layout of the Simulink model is shown in <xref ref-type="fig" rid="fig3-0954407011417764">Fig. 3</xref>, including the supervisory and component controllers, the vehicle model in Dymola, the environment, and the driver model.</p>
<fig id="fig3-0954407011417764" position="float">
<label>Fig. 3</label>
<caption>
<p>Top-level layout of the Simulink model</p>
</caption>
<graphic xlink:href="10.1177_0954407011417764-fig3.tif"/>
</fig>
<p>The Simulink models of all hybrid architectures in WARPSTAR2 share the same layout as shown in <xref ref-type="fig" rid="fig3-0954407011417764">Fig. 3</xref>. The details of the component controllers and supervisory control are varied for different architectures.</p>
</sec>
</sec>
<sec id="section15-0954407011417764">
<title>3 Generalized Supervisory Controller</title>
<p>In the literature, many studies have been found for the development of hybrid supervisory control strategies for HEVs. Generally, the control strategies can be grouped into the following four categories: rule-based strategy [<xref ref-type="bibr" rid="bibr25-0954407011417764">25</xref>, <xref ref-type="bibr" rid="bibr26-0954407011417764">26</xref>], fuzzy logic strategy [<xref ref-type="bibr" rid="bibr27-0954407011417764">27</xref>–<xref ref-type="bibr" rid="bibr30-0954407011417764">30</xref>], instantaneous optimization strategy [<xref ref-type="bibr" rid="bibr31-0954407011417764">31</xref>, <xref ref-type="bibr" rid="bibr32-0954407011417764">32</xref>], and global optimization strategy [<xref ref-type="bibr" rid="bibr33-0954407011417764">33</xref>, <xref ref-type="bibr" rid="bibr34-0954407011417764">34</xref>].</p>
<p>Firstly, the rule-based strategy is based on a heuristic approach and can be easily implemented for an in-vehicle application. Secondly, the fuzzy logic strategy is an interpolated rule-based strategy with a systematic methodology and is tolerant to imprecise measurements and to component variability. Thirdly, the instantaneous optimization strategy calculates the electrical energy consumption in terms of the equivalent fuel consumption. A static optimal power management can be obtained by minimizing the system instantaneous fuel consumption. Finally, the global optimization strategy minimizes a cost function over a predefined whole driving cycle. Usually, the global optimization algorithms are not implementable for an in-vehicle application due to the requirement for a priori knowledge of the whole driving cycle and heavy computation requirement.</p>
<p>In WARPSTAR2, rule-based and fuzzy-logic-based supervisory controllers are implemented for various hybrid architectures because they are easier to implement than the other two control strategies. The rule-based control strategy has been widely studied and commonly used for the in-vehicle applications. It is based on IF-THEN type control rules, which determine the hybrid driving mode, start the engine, or manage the power management between the engine and battery. The hybrid driving mode is defined in IF-THEN rules, which are strongly dependent on the application (drive train topology, vehicle, and drive cycle) and need to be calibrated for different driving conditions. Refer to references [<xref ref-type="bibr" rid="bibr25-0954407011417764">25</xref>] and [<xref ref-type="bibr" rid="bibr26-0954407011417764">26</xref>] for more details on the rule-based supervisory control.</p>
<p>For the fuzzy-logic-based control, common characteristics of power flow in various hybrid architectures are analysed and a generalized fuzzy-logic-based controller is proposed in this paper. This will facilitate the controller design process and the generalized development idea means that the supervisory control can be adapted easily to different HEV architectures.</p>
<sec id="section16-0954407011417764">
<title>3.1 Common characteristics of various HEV architectures</title>
<p>Based on the design mechanism, most HEVs can be roughly divided into six categories: Mild Parallel, Full Parallel, Series, Combined, Power Split, and Through-the-Road (TTR) hybrids. The corresponding functional block diagrams of each HEV architecture are shown in <xref ref-type="fig" rid="fig4-0954407011417764">Fig. 4</xref>.</p>
<fig id="fig4-0954407011417764" position="float">
<label>Fig. 4</label>
<caption>
<p>Architecture illustration of HEVs</p>
</caption>
<graphic xlink:href="10.1177_0954407011417764-fig4.tif"/>
</fig>
<p>In order to study the common characteristics of various HEV architectures, the degree-of-freedom (DoF) for each architecture is analysed compared to the conventional internal combusion engine (ICE) vehicle and the control variables are also discussed.</p>
<p>No compliance characteristics are considered in the vehicle model. The components are modelled with direct connections without spring, damping, or backlash. Therefore there is only 1 DoF in the model of a conventional ICE vehicle. However, the compliance characteristics can be added easily into the vehicle model in Dymola. This is demonstrated in reference [<xref ref-type="bibr" rid="bibr35-0954407011417764">35</xref>] to investigate the effects of torsional stiffness in the vehicle drivetrain on four-wheel-drive vehicle drivability with a 17-DoF model in Dymola.</p>
<p>On the Mild Parallel hybrid vehicle, as shown in <xref ref-type="fig" rid="fig4-0954407011417764">Fig. 4(a)</xref>, a generally compact electric motor is used to provide stop/start features and provide limited power assisting during acceleration, and regenerative braking during deceleration. The vehicle cannot be propelled with the electric motor alone. Compared to a conventional ICE vehicle, an additional 1 DoF is added on the Mild Parallel hybrid vehicle to have limited power assisting and regenerative braking. The driver’s torque demand is met by a torque combination from the ICE and motor during acceleration, and a combination from regenerative and friction braking during deceleration.</p>
<p>On the Full Parallel hybrid vehicle in <xref ref-type="fig" rid="fig4-0954407011417764">Fig. 4(b)</xref>, the ICE and motor can together or individually power the vehicle depending on the engaging status of the algorithm-controlled clutch sitting between the ICE and motor. Compared to a conventional ICE vehicle, additional 2 DoFs are added. The supervisory controller firstly determines the engaging status of the clutch. If the clutch is disengaged, the driver’s torque demand is met by the motor only. The engine is usually switched off to prevent a poor operation region. If the clutch is engaged, similar to the Mild Parallel hybrid vehicle, the driver’s torque demand is met by a torque combination from the ICE and motor during acceleration, and a combination from regenerative and friction braking during deceleration.</p>
<p>On the Series hybrid vehicle in <xref ref-type="fig" rid="fig4-0954407011417764">Fig. 4(c)</xref>, the engine is mechanically disconnected from the vehicle wheels. Compared to a conventional ICE vehicle, additional 2 DoFs are added. The engine’s torque and speed can be independently controlled to meet the driver’s demand with improved efficiency.</p>
<p>On the Combined hybrid vehicle in <xref ref-type="fig" rid="fig4-0954407011417764">Fig. 4(d)</xref>, the vehicle can operate either in parallel or series modes depending on the engaging status of the clutch. Compared to a conventional ICE vehicle, additional 3 DoFs are added. The clutch can be controlled as engaged or disengaged based on the vehicle conditions. If the clutch is disengaged, the vehicle operates in the series mode and the engine can be switched on or off. If the clutch is engaged, the vehicle operates in the parallel mode with a combination of the engine and motor.</p>
<p>On the Power Split hybrid vehicle in <xref ref-type="fig" rid="fig4-0954407011417764">Fig. 4(e)</xref>, a device of power split is used to manage the power split between the ICE and motor. Compared to a conventional ICE vehicle, additional 2 DoFs are added, but the freedom of fixed gear selection on a conventional vehicle is removed from the Power Split hybrid. The engine torque and speed can be controlled independently to meet the driver’s demand. Once the engine torque and speed are determined, the operation conditions of two motors and a battery can be determined given the torque and speed requirements at the wheels.</p>
<p>On the Through-the-Road vehicle in <xref ref-type="fig" rid="fig4-0954407011417764">Fig. 4(f)</xref>, the vehicle operates in a very similar way with a parallel HEV. However, on the TTR hybrid, the engine and the motor/generator is only connected through the road when the vehicle is moving. Compared to a conventional ICE vehicle, an additional 1 DoF is added. The motor torque is controlled to have limited power assisting and regenerative braking.</p>
<p>From the analysis above, it can be seen that the number of DoFs for each HEV architecture is different and so are the control variables. However, there is one common characteristic in all architectures. There are two energy sources in each HEV architecture, the engine and the battery with the associated motor(s). The total power from these two sources needs to meet the driver’s demand and the power split between these two are managed based on the operation characteristics of the hybrid components to improve the overall vehicle performance. Although the architectures are different, the energy management controller performs the same function in all cases.</p>
<p>When the engine is off or cranking, the power required for propelling the vehicle comes exclusively from the electric motor with the associated battery.</p>
<p>From the analysis above, all of the HEVs with two energy sources in this paper are propelled by the power either from the engine or the battery when the engine is on. This is the basis for the development of a generalized supervisory controller for all HEV architectures.</p>
</sec>
<sec id="section17-0954407011417764">
<title>3.2 Generalized formation of a supervisory controller</title>
<p>In this paper, a generalized fuzzy-logic-based controller is proposed as illustrated in <xref ref-type="fig" rid="fig5-0954407011417764">Fig. 5</xref> so that all HEVs with different architectures share the same structure of supervisory controller. The parameter settings are set differently to reflect their operation characteristics of various HEV architectures. The generalized formation can facilitate the controller design process for various HEV architectures. There are three main parts in this controller, as shown in <xref ref-type="fig" rid="fig5-0954407011417764">Fig. 5</xref>, including Power Demand, Engine State Machine, and Power Regulator.</p>
<fig id="fig5-0954407011417764" position="float">
<label>Fig. 5</label>
<caption>
<p>Algorithm of the generalized formation of supervisory control for various HEV architectures</p>
</caption>
<graphic xlink:href="10.1177_0954407011417764-fig5.tif"/>
</fig>
<p>Firstly, the driver power demand at the wheels is calculated from the driver’s accelerator and brake pedal positions and the vehicle speed. The signal from the accelerator pedal is normalized to a value between 0 and 1 (0, pedal is not pressed; 1, pedal fully pressed), while the signal from the brake pedal signal is normalized to a value between 0 and −1 (0, pedal is not pressed; −1, pedal fully pressed). The driver power demands at the wheels are generated by multiplying the driver pedal input, the current vehicle speed, and the maximum wheel torque at the current vehicle speed.</p>
<p>In Series hybrids, the maximum wheel torque is determined by the maximum motor torque at its current operation speed, multiplied by the ratio between the motor and the driven wheels. However, in all other HEV architectures, the maximum wheel torque is determined from the combination of the maximum engine torque and the maximum motor torque at their current operation speeds multiplied by the corresponding ratios.</p>
<p>Secondly, the engine state is determined from the driver power demand at the wheels, engine speed, engine temperature, vehicle speed, accelerator/brake pedal, and battery state-of-charge (SOC). A snapshot of the engine state function in a MATLAB/Stateflow chart is given in <xref ref-type="fig" rid="fig6-0954407011417764">Fig. 6</xref>. The conditions between the engine state transitions are different for each HEV powertrain architecture.</p>
<fig id="fig6-0954407011417764" position="float">
<label>Fig. 6</label>
<caption>
<p>Snapshot of the engine state function in a Stateflow chart for various HEV architectures</p>
</caption>
<graphic xlink:href="10.1177_0954407011417764-fig6.tif"/>
</fig>
<p>There are three engine states: Off, Crank, and On. At the beginning of any driving cycle, if the condition of the Crank state is satisfied, the engine is cranked by the starter motor or high-voltage electric motor. Otherwise, the engine is set in the Off state. When the engine is in the Crank state, the engine crankshaft will be spun by the starter motor or high-voltage electric motor. When the engine speed reaches a certain threshold, the cranking is complete and the engine goes to the On state. When the specified conditions are satisfied, the engine will exit the On state and enter the Off state, and then go back to the Crank and On states in a circular way.</p>
<p>Finally, the power distribution is allocated within different engine states. When the engine is in the Off and Crank states, the power can be easily determined since the power propelling the vehicle comes from one source: the high-voltage electric motor with the associated battery.</p>
</sec>
<sec id="section18-0954407011417764">
<title>3.3 Fuzzy-logic-based power regulator with the engine on</title>
<p>When the engine is in the On state, a fuzzy-logic-control (FLC) algorithm is used to allocate the powers of the engine and the electric motor to increase the operation efficiency of both energy sources and reduce the fuel consumption, while maintaining the battery SOC in a reasonable operation range. The fuzzy-logic-based power regulator is given in <xref ref-type="fig" rid="fig7-0954407011417764">Fig. 7</xref>. The common regulator algorithm is used for various HEV architectures with different parameter settings.</p>
<fig id="fig7-0954407011417764" position="float">
<label>Fig. 7</label>
<caption>
<p>Diagram of the power regulator when the engine is on for various HEV architectures</p>
</caption>
<graphic xlink:href="10.1177_0954407011417764-fig7.tif"/>
</fig>
<p>The inputs of the FLC again include the accelerator/brake pedal position [−1~1], the normalized vehicle speed [0~1], and the battery SOC [0~1]. The output of the FLC is the power split gain <inline-formula id="inline-formula1-0954407011417764">
<mml:math display="block" id="math1-0954407011417764">
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:math></inline-formula> from the contribution of the engine to the total propelling power. Then the engine and electric motor/battery power requests can be determined with the gain <inline-formula id="inline-formula2-0954407011417764">
<mml:math display="inline" id="math2-0954407011417764">
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:math></inline-formula>, the power demand at the merge point, the component power limitations, and the component efficiencies.</p>
<p>The definition of power demand at the merge point is different for various HEV architectures. In the TTR HEV, the merge point is at the front/rear axles, where the engine and electric motor power eventually merge. In the Series HEV, the merge point is the power electronics, while on all other HEVs in this paper, the merge point is at the position after the M/G (Motor/Generator), as shown in <xref ref-type="fig" rid="fig4-0954407011417764">Fig. 4</xref>.</p>
<p>If the engine is decoupled or partially decoupled from the driven wheels, the efficiency of the engine for a given power request can be optimized using an optimal speed–torque curve. This is true for both the generalized fuzzy-logic-based and the rule-based controllers.</p>
</sec>
<sec id="section19-0954407011417764">
<title>3.4 FLC algorithm</title>
<p>The FLC algorithm with the engine is on given in this section. For all HEV architectures, the inputs of the FLC are the accelerator/brake pedal position, normalized vehicle speed, and battery SOC. The output is the power split gain from the contribution of the engine to the whole propelling power.</p>
<p>Examples of the membership functions (MF) of FLC inputs are shown in <xref ref-type="fig" rid="fig8-0954407011417764">Fig. 8</xref>. The shape of the MF is generally less important than the number of curves and their placements [<xref ref-type="bibr" rid="bibr36-0954407011417764">36</xref>]. In this paper, the most common triangular shape for MFs is used for the FLC inputs. Owing to the different operations of various HEV architectures, it is very likely that the positions of the MFs need to be tuned to achieve the good performance of HEVs in terms of fuel consumption and emissions. The positions of a triangular shaped MF are described by only three points, which are easy to be tuned for various HEV architectures.</p>
<fig id="fig8-0954407011417764" position="float">
<label>Fig. 8</label>
<caption>
<p>Membership functions for FLC inputs</p>
</caption>
<graphic xlink:href="10.1177_0954407011417764-fig8.tif"/>
</fig>
<p>The fuzzy rules are designed to match the operation characteristics of each HEV architecture. There are two types of fuzzy inference methods in FLC: the Mamdani type [<xref ref-type="bibr" rid="bibr37-0954407011417764">37</xref>] and the Sugeno type [<xref ref-type="bibr" rid="bibr38-0954407011417764">38</xref>]. Because the Sugeno type is a more compact and computationally efficient representation than the Mamdani type, the Sugeno type is used for the fuzzy inference method in this paper.</p>
<p>The most commonly used zero-order Sugeno fuzzy model applies fuzzy rules in the following form:</p>
<p>IF (<inline-formula id="inline-formula3-0954407011417764">
<mml:math display="inline" id="math3-0954407011417764">
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
</mml:math></inline-formula> is A) AND (<inline-formula id="inline-formula4-0954407011417764">
<mml:math display="inline" id="math4-0954407011417764">
<mml:mrow>
<mml:mi>y</mml:mi>
</mml:mrow>
</mml:math></inline-formula> is B) THEN (<inline-formula id="inline-formula5-0954407011417764">
<mml:math display="inline" id="math5-0954407011417764">
<mml:mrow>
<mml:mi>z</mml:mi>
</mml:mrow>
</mml:math></inline-formula> is <inline-formula id="inline-formula6-0954407011417764">
<mml:math display="inline" id="math6-0954407011417764">
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:math></inline-formula>)</p>
<p>where <inline-formula id="inline-formula7-0954407011417764">
<mml:math display="inline" id="math7-0954407011417764">
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:math></inline-formula> is a constant.</p>
<p>The membership functions of FLC rule outputs are represented by singleton spikes, set as 0, 0.2, 0.4, 0.6, 0.8, 1, 1.2, and 1.4, which is shown in <xref ref-type="fig" rid="fig9-0954407011417764">Fig. 9</xref>. The output value of 1 means that the vehicle demand is met by the engine only. If the output values is smaller than 1, the vehicle demand is met by the engine and the battery together. If the output values is larger than 1, the energy from the engine not only propels the vehicle but also charges the battery.</p>
<fig id="fig9-0954407011417764" position="float">
<label>Fig. 9</label>
<caption>
<p>Membership functions for FLC output</p>
</caption>
<graphic xlink:href="10.1177_0954407011417764-fig9.tif"/>
</fig>
<p>The operational characteristics of each HEV architecture are different. Thus the FLC rules of managing the power distribution of the engine and electric motor need to be set differently to manage to operate the hybrid components in their most efficient conditions for each HEV architecture. There are 65 rules in total for each HEV. The rules listed in <xref ref-type="table" rid="table1-0954407011417764">Table 1</xref> are a small part of the rule table used in the Mild Parallel hybrid vehicle.</p>
<table-wrap id="table1-0954407011417764" position="float">
<label>Table 1</label>
<caption>
<p>Part of the FLC rules in the Mild Parallel hybrid vehicle</p>
</caption>
<graphic alternate-form-of="table1-0954407011417764" xlink:href="10.1177_0954407011417764-table1.tif"/>
<table>
<colgroup>
<col align="left"/>
<col align="left"/>
<col align="left"/>
<col align="char" char="."/>
</colgroup>
<thead>
<tr>
<th align="left">Accelerator/brake pedal</th>
<th align="left">Normalized vehicle speed</th>
<th align="left">Battery SOC</th>
<th align="left">Engine power gain <inline-formula id="inline-formula8-0954407011417764">
<mml:math display="inline" id="math8-0954407011417764">
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:math></inline-formula></th>
</tr>
</thead>
<tbody>
<tr>
<td>Negative</td>
<td>–</td>
<td>–</td>
<td>0</td>
</tr>
<tr>
<td>Zero</td>
<td>Low</td>
<td>High</td>
<td>0</td>
</tr>
<tr>
<td>Zero</td>
<td>Medium</td>
<td>Low</td>
<td>1.0</td>
</tr>
<tr>
<td>Low</td>
<td>Low</td>
<td>Very low</td>
<td>1.2</td>
</tr>
<tr>
<td>Low</td>
<td>High</td>
<td>High</td>
<td>0.8</td>
</tr>
<tr>
<td>Medium</td>
<td>Medium</td>
<td>Very low</td>
<td>1.4</td>
</tr>
<tr>
<td>Medium</td>
<td>Medium</td>
<td>High</td>
<td>0.6</td>
</tr>
<tr>
<td>High</td>
<td>Low</td>
<td>High</td>
<td>0.8</td>
</tr>
<tr>
<td>High</td>
<td>Zero</td>
<td>Very low</td>
<td>1.4</td>
</tr>
</tbody>
</table>
</table-wrap>
<p>The rules are designed based on the charge-sustaining strategy to ensure that battery SOC is maintained at a sufficiently high level. From each rule, an inference result <inline-formula id="inline-formula9-0954407011417764">
<mml:math display="inline" id="math9-0954407011417764">
<mml:mrow>
<mml:mi>μ</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>i</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math></inline-formula> can be determined.</p>
<p>The final output of the FLC is a weighted average of all rule outputs, which represents the power split gain <italic>k</italic> contributed from the engine</p>
<p>
<disp-formula id="disp-formula1-0954407011417764">
<label>(1)</label>
<mml:math display="block" id="math10-0954407011417764">
<mml:mrow>
<mml:mi>k</mml:mi>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:munderover>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>N</mml:mi>
</mml:mrow>
</mml:munderover>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mi>μ</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>i</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>×</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>i</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
<mml:mrow>
<mml:munderover>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>N</mml:mi>
</mml:mrow>
</mml:munderover>
<mml:mi>μ</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>i</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula1-0954407011417764" xlink:href="10.1177_0954407011417764-eq1.tif"/>
</disp-formula>
</p>
<p>where <inline-formula id="inline-formula10-0954407011417764">
<mml:math display="inline" id="math11-0954407011417764">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>i</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula> is the membership function of the FLC outputs, which is 0, 0.2, 0.4, 0.6, 0.8, 1, 1.2, or 1.4, <inline-formula id="inline-formula11-0954407011417764">
<mml:math display="inline" id="math12-0954407011417764">
<mml:mrow>
<mml:mi>μ</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>i</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math></inline-formula> is the inference output of each FLC rule, and <italic>N</italic> is the number of rules.</p>
<p>The fuzzy logic control rules presented above are selected with hand-tuning. However, fuzzy logic controller hand-tuning is a laborious task and is only applicable to the simulation of a hybrid vehicle over a particular driving cycle. There is quite a lot of research work carried out on fuzzy logic controller tuning, adaption, and learning. A detailed investigation on an adaptive fuzzy hybrid vehicle powertrain controller was presented by Farrall [<xref ref-type="bibr" rid="bibr39-0954407011417764">39</xref>]. Since this paper concentrates on the modelling strategy for various HEV architectures and fuzzy logic control is designed to exercise the HEV architectures, the fuzzy logic controller optimization is not discussed in this paper.</p>
</sec>
</sec>
<sec id="section20-0954407011417764" sec-type="results">
<title>4 Simulation Results</title>
<p>The proposed generalized fuzzy-logic-based supervisory controller has been implemented and simulated in WARPSTAR2. The rule-based supervisory controller is also simulated and the results are compared against each other.</p>
<p>The simulation was run with a PI driver model to control the accelerator and brake pedals, clutch pedals, and gear selection (if required) to ensure that the vehicle speed follows the speed profile versus time in the driving cycle. The speed profile is specified in the Environment block shown in <xref ref-type="fig" rid="fig3-0954407011417764">Fig. 3</xref>.</p>
<p>Three main subtypes of HEV architectures, Mild Parallel, Series, and Power Split, were developed and simulation was carried out in WARPSTAR2. The simulation results of vehicle speed, battery SOC, engine power, and battery power are given in <xref ref-type="fig" rid="fig10-0954407011417764">Figs 10</xref> to <xref ref-type="fig" rid="fig12-0954407011417764">12</xref> for the three HEV architectures. It can be seen that the results of engine, and battery power usages using rule-based, and generalized fuzzy-logic-based supervisory controllers are close for the three HEVs.</p>
<fig id="fig10-0954407011417764" position="float">
<label>Fig. 10</label>
<caption>
<p>Power management of Honda Insight (Mild Parallel)</p>
</caption>
<graphic xlink:href="10.1177_0954407011417764-fig10.tif"/>
</fig>
<fig id="fig11-0954407011417764" position="float">
<label>Fig. 11</label>
<caption>
<p>Power management of Orion 6 bus (Series)</p>
</caption>
<graphic xlink:href="10.1177_0954407011417764-fig11.tif"/>
</fig>
<fig id="fig12-0954407011417764" position="float">
<label>Fig. 12</label>
<caption>
<p>Power management of Toyota Prius (Power Split)</p>
</caption>
<graphic xlink:href="10.1177_0954407011417764-fig12.tif"/>
</fig>
<p>A selection of the fuel consumption results in the New European Driving Cycle (NEDC) or Central Business District (CBD) driving cycle for the illustrative examples of Mild Parallel, Series, and Power Split, is shown in <xref ref-type="fig" rid="fig13-0954407011417764">Fig. 13</xref>, with the difference between published certified figures and those from simulation using rule-based and fuzzy-logic-based supervisory controllers.</p>
<fig id="fig13-0954407011417764" position="float">
<label>Fig. 13</label>
<caption>
<p>Fuel consumption figures</p>
</caption>
<graphic xlink:href="10.1177_0954407011417764-fig13.tif"/>
</fig>
<p>The simulation results showed that the accuracy achieved using the modelling architectures with Dymola and MATLAB/Simulink for a forward dynamic analysis of three different hybrid electric vehicles using both the rule-based and the generalized fuzzy-logic-based supervisory controllers is within 5 per cent of published certified figures.</p>
<p>In the simulation with fuzzy-logic-based control, the power is regulated using fuzzy logic control when the engine is on. There are fewer state transitions compared to the vehicle using rule-based control. With an appropriate design of FLC rules, a smoother power regulation between the engine and the battery/motor can be achieved.</p>
<p>As shown in <xref ref-type="fig" rid="fig13-0954407011417764">Fig. 13</xref>, the differences in fuel consumption figures between rule-based and fuzzy-logic-based controllers are within 5 per cent. This is because the two controllers are calibrated so that they behave similarly in the NEDC or CBD driving cycles, which are fairly smooth. It is likely that the fuzzy-logic-based supervisory controller would be of more use to real-world driving with higher dynamics.</p>
<p>In related work, the real-world driving behaviour of accelerator/brake pedal movements, gear selection, and clutch movements are studied in various driving scenarios. This information is being used to develop a more representative real-world driver model than a PI driver model used in this paper. The real-world driver model will be incorporated into the simulation tool WARPSTAR2 and the performance of fuel consumption and emissions with these two supervisory controllers will be compared with real-world driving scenarios.</p>
<p>In this paper, a comprehensive and flexible forward dynamic powertrain simulation tool is presented. It includes physical modelling of vehicle components in Dymola and the development of a component controller and a hybrid supervisory controller in MATLAB/Simulink. Compared to bespoke hybrid programs, such as ADVISOR [<xref ref-type="bibr" rid="bibr2-0954407011417764">2</xref>], VSIM [<xref ref-type="bibr" rid="bibr3-0954407011417764">3</xref>], PSAT [<xref ref-type="bibr" rid="bibr7-0954407011417764">7</xref>] and WARPSTAR [<xref ref-type="bibr" rid="bibr6-0954407011417764">6</xref>], the simulation tool in this paper is more flexible with casual solutions of vehicle modelling in Dymola and with a generalized fuzzy logic control formation of hybrid supervisory control. This gives the potential for the simulation tool to provide vehicle models with higher fidelities and flexibility for modelling various HEV architectures. Compared to MATLAB/Simulink toolboxes of SimDriveline and SimPowerSystems, the pre-built open and commercial libraries of mechanical, electrical, thermal, hydraulic, magnetic, and vehicle dynamics in Dymola will ensure the fidelities of models and greatly facilitate the modelling process.</p>
<p>Compared to multiphysics programs only, the simulation tool in this paper develops the controller algorithms in MATLAB/Simulink and provides a more compatible platform.</p>
<p>In all, the simulation tool utilizes the merits of both Dymola and MATLAB/Simulink. It provides a comprehensive and flexible forward dynamic powertrain simulation modelling and simulation tool for various hybrid electric vehicle architectures.</p>
<p>In addition, this powertrain simulation tool is forward dynamic and includes a driver model. It can be used as a platform to study the influence of driver behaviour on various vehicles in terms of fuel consumption and emissions. A real-world parameterized driver model is under development [<xref ref-type="bibr" rid="bibr40-0954407011417764">40</xref>] that is capable of modelling the real-world driving behaviour. The real-world driver model and the powertrain simulation tool are combined together and produce a similar vehicle speed profile to that recorded in vehicle testing.</p>
</sec>
<sec id="section21-0954407011417764" sec-type="conclusions">
<title>5 Conclusions</title>
<p>A comprehensive forward dynamic powertrain simulation tool for various hybrid electric vehicle architectures is introduced in this paper. A structure is proposed with physical powertrain modelling in Dymola and control strategy design in MATLAB/Simulink. Thus the power of the two software tools can be combined.</p>
<p>A generalized fuzzy-logic-based supervisory controller is designed and the formation can be easily adapted for various hybrid vehicle architectures with different parameter settings. Simulation of three kinds of hybrid vehicle architectures using the generalized fuzzy-logic-based controller was carried out in the simulation tool and the results were compared to those using a rule-based controller. The results of those two controllers are in good agreement and both of the simulated fuel consumptions are close to the certified values.</p>
<p>The simulation tool is compared to other current similar ones and its merits are explained to show that it is a comprehensive and flexible forward dynamic powertrain simulation tool with the capability of high fidelity and multidomain physical modelling and compatibility within the MATLAB/Simulink environment.</p>
</sec>
</body>
<back>
<ack>
<p>The work presented in this paper is part of the project Sustainable Action on Vehicle Energy (SAVE) in the Warwick Innovative Manufacturing Research Centre (WIMRC). The authors acknowledge the support from the Engineering and Physical Sciences Research Council (EPSRC) through the WIMRC. The authors also gratefully acknowledge the continuing support of the project’s industrial partners: Froude Hofmann and Jaguar Land Rover.</p>
</ack>
<fn-group>
<fn fn-type="financial-disclosure">
<p>Funding was received from the Engineering and Physical Sciences Research Council through the Warwick Innovative Manufacturing Research Centre.</p>
</fn>
</fn-group>
<ref-list>
<title>References</title>
<ref id="bibr1-0954407011417764">
<label>1</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Chan</surname><given-names>C. C.</given-names></name>
</person-group> <article-title>The state of the art of electric, hybrid, and fuel cell vehicles</article-title>. <source>Proc. IEEE</source>, <year>2007</year>, <volume>95</volume>(<issue>4</issue>), <fpage>704</fpage>–<lpage>718</lpage>.</citation>
</ref>
<ref id="bibr2-0954407011417764">
<label>2</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Markel</surname><given-names>T.</given-names></name>
<name><surname>Brooker</surname><given-names>A.</given-names></name>
<name><surname>Hendricks</surname><given-names>T.</given-names></name>
<name><surname>Johnson</surname><given-names>V.</given-names></name>
<name><surname>Kelly</surname><given-names>K.</given-names></name>
<name><surname>Kramer</surname><given-names>B.</given-names></name>
<name><surname>O’Keefe</surname><given-names>M.</given-names></name>
<name><surname>Sprik</surname><given-names>S.</given-names></name>
<name><surname>Wipke</surname><given-names>K.</given-names></name>
</person-group> <article-title>ADVISOR: a system analysis tool for advanced vehicle modelling</article-title>. <source>J. Power Sources</source>, <year>2002</year>, <volume>110</volume>(<issue>2</issue>), <fpage>255</fpage>–<lpage>266</lpage>.</citation>
</ref>
<ref id="bibr3-0954407011417764">
<label>3</label>
<citation citation-type="web">
<article-title>Ricardo, Design and simulation, overview of Ricardo’s V-SIM tool</article-title>, <year>2010</year>, <comment>available from <ext-link ext-link-type="uri" xlink:href="http://www.ricardo.com/What-we-do/Technical-Consulting/Hybrid-Electric-Systems/Design-and-Simulation/">http://www.ricardo.com/What-we-do/Technical-Consulting/Hybrid-Electric-Systems/Design-and-Simulation/</ext-link></comment>.</citation>
</ref>
<ref id="bibr4-0954407011417764">
<label>4</label>
<citation citation-type="web">
<article-title>LMS, 1D multi-domain system simulation</article-title>, <year>2010</year>, <comment>available from <ext-link ext-link-type="uri" xlink:href="http://www.lmsintl.com/imagine-amesim-1-d-multi-domain-system-simulation">http://www.lmsintl.com/imagine-amesim-1-d-multi-domain-system-simulation</ext-link></comment>.</citation>
</ref>
<ref id="bibr5-0954407011417764">
<label>5</label>
<citation citation-type="web">
<article-title>Dassault Systemes, Dymola, multi-engineering modeling and simulation</article-title>, <year>2010</year>, <comment>available from <ext-link ext-link-type="uri" xlink:href="http://www.3ds.com/products/catia/portfolio/dymola">http://www.3ds.com/products/catia/portfolio/dymola</ext-link></comment>.</citation>
</ref>
<ref id="bibr6-0954407011417764">
<label>6</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Walker</surname><given-names>A.</given-names></name>
<name><surname>McGordon</surname><given-names>A.</given-names></name>
<name><surname>Hannis</surname><given-names>G.</given-names></name>
<name><surname>Picarelli</surname><given-names>A.</given-names></name>
<name><surname>Breddy</surname><given-names>J.</given-names></name>
<name><surname>Carter</surname><given-names>S.</given-names></name>
<name><surname>Vinsome</surname><given-names>A.</given-names></name>
<name><surname>Jennings</surname><given-names>P.</given-names></name>
<name><surname>Dempsey</surname><given-names>M.</given-names></name>
<name><surname>Willows</surname><given-names>M.</given-names></name>
</person-group> <article-title>A novel structure for comprehensive HEV powertrain modelling</article-title>. In <conf-name>Proceedings of the IEEE Vehicle Power and Propulsion Conference</conf-name>, <conf-loc>Windsor, UK</conf-loc>, <conf-date>6–8 September 2006</conf-date>, pp. <fpage>1</fpage>–<lpage>5</lpage>.</citation>
</ref>
<ref id="bibr7-0954407011417764">
<label>7</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Slezak</surname><given-names>L.</given-names></name>
<name><surname>Rousseau</surname><given-names>A. P.</given-names></name>
<name><surname>Sharer</surname><given-names>P. B.</given-names></name>
<name><surname>Besnier</surname><given-names>F.</given-names></name>
</person-group> <article-title>Feasibility of reusable vehicle modeling: application to hybrid vehicles</article-title>. In <conf-name>Proceedings of the SAE 2004 World Congress and Exhibition</conf-name>, <conf-loc>Detroit, Michigan</conf-loc>, <conf-date>8–11 March 2004</conf-date>, <comment>SAE paper 2004-01-1618</comment>.</citation>
</ref>
<ref id="bibr8-0954407011417764">
<label>8</label>
<citation citation-type="web">
<article-title>The MathWorks, SimDriveline – model and simulate mechanical driveline systems</article-title>, <year>2010</year>, <comment>available from <ext-link ext-link-type="uri" xlink:href="http://www.mathworks.com/products/simdrive/">http://www.mathworks.com/products/simdrive/</ext-link></comment>.</citation>
</ref>
<ref id="bibr9-0954407011417764">
<label>9</label>
<citation citation-type="web">
<article-title>The MathWorks, SimPowerSystems – model and simulate electrical power systems</article-title>, <year>2010</year>, <comment>available from <ext-link ext-link-type="uri" xlink:href="http://www.mathworks.com/products/simpower/">http://www.mathworks.com/products/simpower/</ext-link></comment>.</citation>
</ref>
<ref id="bibr10-0954407011417764">
<label>10</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>van de Venne</surname><given-names>J. W. C. M.</given-names></name>
<name><surname>Hendriksen</surname><given-names>P.</given-names></name>
<name><surname>Smokers</surname><given-names>R. T. M.</given-names></name>
<name><surname>Verkiel</surname><given-names>M.</given-names></name>
</person-group> <article-title>TNO-ADVANCE: a modular power-train simulation and design tool</article-title>. In <conf-name>Proceedings of the International Conference on Combustion engines and hybrid vehicles</conf-name>, <conf-loc>London, UK</conf-loc>, <conf-date>28–30 April 1998</conf-date>, pp. <fpage>220</fpage>–<lpage>221</lpage>.</citation>
</ref>
<ref id="bibr11-0954407011417764">
<label>11</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Guzzella</surname><given-names>L.</given-names></name>
<name><surname>Amstutz</surname><given-names>A.</given-names></name>
</person-group> <article-title>CAE tools for quasi-static modelling and optimization of hybrid powertrains</article-title>. <source>IEEE Trans. on Vehicular Technol.</source>, <year>1999</year>, <volume>48</volume>(<issue>6</issue>), <fpage>1762</fpage>–<lpage>1769</lpage>.</citation>
</ref>
<ref id="bibr12-0954407011417764">
<label>12</label>
<citation citation-type="web">
<article-title>MSC Software Corp, Easy5 for controls and systems simulation</article-title>, <year>2010</year>, <comment>available from <ext-link ext-link-type="uri" xlink:href="http://www.mscsoftware.com/Products/CAE-Tools/Easy5.aspx">http://www.mscsoftware.com/Products/CAE-Tools/Easy5.aspx</ext-link></comment>.</citation>
</ref>
<ref id="bibr13-0954407011417764">
<label>13</label>
<citation citation-type="web">
<article-title>Ansoft Corp, Simplorer, system simulation software for multi-domain design</article-title>, <year>2010</year>, <comment>available from <ext-link ext-link-type="uri" xlink:href="http://www.ansoft.com/products/em/simplorer/">http://www.ansoft.com/products/em/simplorer/</ext-link></comment>.</citation>
</ref>
<ref id="bibr14-0954407011417764">
<label>14</label>
<citation citation-type="web">
<article-title>Maplesoft, MapleSim – high performance physical modeling and simulation</article-title>, <year>2010</year>, <comment>available from <ext-link ext-link-type="uri" xlink:href="http://www.maplesoft.com/products/maplesim/">http://www.maplesoft.com/products/maplesim/</ext-link></comment>.</citation>
</ref>
<ref id="bibr15-0954407011417764">
<label>15</label>
<citation citation-type="web">
<article-title>Synopsys Inc., Saber – optimizing system performance and reliability</article-title>, <year>2010</year>, <comment>available from <ext-link ext-link-type="uri" xlink:href="http://www.synopsys.com/Tools/SLD/Mechatronics/Saber/Pages/default.aspx">http://www.synopsys.com/Tools/SLD/Mechatronics/Saber/Pages/default.aspx</ext-link></comment>.</citation>
</ref>
<ref id="bibr16-0954407011417764">
<label>16</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Keribar</surname><given-names>R.</given-names></name>
<name><surname>Ciesla</surname><given-names>C. R.</given-names></name>
<name><surname>Morel</surname><given-names>T.</given-names></name>
</person-group> <article-title>Engine/powertrain/vehicle modeling tool applicable to all stages of the design process</article-title>. In <conf-name>Proceedings of the SAE World Congress</conf-name>, <conf-loc>Detroit, Michigan</conf-loc>, <conf-date>6–9 March 2000</conf-date>, SAE paper 2000-01-0934.</citation>
</ref>
<ref id="bibr17-0954407011417764">
<label>17</label>
<citation citation-type="web">
<article-title>AVL List GmbH, AVL CRUISE – vehicle and driveline system analysis for conventional and future vehicle concepts</article-title>, <year>2010</year>, <comment>available from <ext-link ext-link-type="uri" xlink:href="http://www.avl.com/cruise1">http://www.avl.com/cruise1</ext-link></comment>.</citation>
</ref>
<ref id="bibr18-0954407011417764">
<label>18</label>
<citation citation-type="web">
<article-title>Ricardo, WAVE – Ricardo</article-title>, <year>2010</year>, <comment>available from <ext-link ext-link-type="uri" xlink:href="http://www.ricardo.com/en-gb/What-we-do/Software/Products/WAVE/">http://www.ricardo.com/en-gb/What-we-do/Software/Products/WAVE/</ext-link></comment>.</citation>
</ref>
<ref id="bibr19-0954407011417764">
<label>19</label>
<citation citation-type="thesis">
<person-group person-group-type="author">
<name><surname>King</surname><given-names>G.</given-names></name>
</person-group> <source>Systems modelling and simulation in the product development process for automotive powertrains</source>. <comment>EngD Thesis</comment>, <publisher-name>University of Warwick</publisher-name>, <publisher-loc>Coventry, UK</publisher-loc>, <year>2002</year>.</citation>
</ref>
<ref id="bibr20-0954407011417764">
<label>20</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Elmqvist</surname><given-names>H.</given-names></name>
<name><surname>Mattsson</surname><given-names>S. E.</given-names></name>
</person-group> <article-title>An introduction to the physical modeling language Modelica</article-title>. In <conf-name>Proceedings of the 9th European Simulation Symposium</conf-name>, <conf-loc>Passau, Germany</conf-loc>, <conf-date>19–22 October 1997</conf-date>, pp. <fpage>110</fpage>–<lpage>114</lpage>.</citation>
</ref>
<ref id="bibr21-0954407011417764">
<label>21</label>
<citation citation-type="book">
<person-group person-group-type="author">
<name><surname>Tiller</surname><given-names>M.</given-names></name>
</person-group> <source>Introduction to physical modeling with Modelica</source>, <year>2001</year> (<publisher-name>Kluwer Academic Publishers</publisher-name>, <publisher-loc>Massachusetts</publisher-loc>).</citation>
</ref>
<ref id="bibr22-0954407011417764">
<label>22</label>
<citation citation-type="web">
<article-title>Modelica Association, Modelica and the Modelica Association</article-title>, <year>2010</year>, <comment>available from <ext-link ext-link-type="uri" xlink:href="http://www.modelica.org">http://www.modelica.org</ext-link></comment>.</citation>
</ref>
<ref id="bibr23-0954407011417764">
<label>23</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Aoki</surname><given-names>K.</given-names></name>
<name><surname>Kuroda</surname><given-names>S.</given-names></name>
<name><surname>Kajiwara</surname><given-names>S.</given-names></name>
<name><surname>Sato</surname><given-names>H.</given-names></name>
<name><surname>Yamamoto</surname><given-names>Y.</given-names></name>
</person-group> <article-title>Development of intergrated motor assist hybrid system: development of the ‘Insight’, a personal hybrid coupe</article-title>. In <conf-name>Proceedings of the SAE Government/Industry Meeting</conf-name>, <conf-loc>Washington, DC</conf-loc>, <conf-date>19–21 June 2000</conf-date>, <comment>SAE paper 2000-01-2216</comment>.</citation>
</ref>
<ref id="bibr24-0954407011417764">
<label>24</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Dempsey</surname><given-names>M.</given-names></name>
<name><surname>Elmqvis</surname><given-names>H.</given-names></name>
<name><surname>Gaefvert</surname><given-names>M.</given-names></name>
<name><surname>Harman</surname><given-names>P.</given-names></name>
<name><surname>Kral</surname><given-names>C.</given-names></name>
<name><surname>Otter</surname><given-names>M.</given-names></name>
<name><surname>Treffinger</surname><given-names>P.</given-names></name>
</person-group> <article-title>Coordinated automotive library for vehicle system modelling</article-title>. In <conf-name>Proceedings of the 5th International Modelica Conference</conf-name>, <conf-loc>Vienna, Austria</conf-loc>, <conf-date>4–5 September 2006</conf-date>.</citation>
</ref>
<ref id="bibr25-0954407011417764">
<label>25</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Hofman</surname><given-names>T.</given-names></name>
<name><surname>Steinbuch</surname><given-names>M.</given-names></name>
</person-group> <article-title>Rule-based energy management strategies for hybrid vehicles</article-title>. <source>Int. J. Electric Hybrid Vehicles</source>, <year>2007</year>, <volume>1</volume>(<issue>1</issue>), <fpage>71</fpage>–<lpage>94</lpage>.</citation>
</ref>
<ref id="bibr26-0954407011417764">
<label>26</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Jalil</surname><given-names>N.</given-names></name>
<name><surname>Kheir</surname><given-names>N. A.</given-names></name>
<name><surname>Salman</surname><given-names>M.</given-names></name>
</person-group> <article-title>A rule-based energy management strategy for a series hybrid vehicle</article-title>. In <conf-name>Proceedings of the American Control Conference, Albuquerque</conf-name>, <conf-loc>New Mexico</conf-loc>, <conf-date>4–6 June 1997</conf-date>, pp. <fpage>689</fpage>–<lpage>693</lpage>.</citation>
</ref>
<ref id="bibr27-0954407011417764">
<label>27</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Farrall</surname><given-names>S. D.</given-names></name>
<name><surname>Jones</surname><given-names>R. P.</given-names></name>
</person-group> <article-title>Energy management in an automotive electric/heat engine hybrid powertrain using fuzzy decision making</article-title>. In <conf-name>Proceedings of the International Symposium on Intelligent control</conf-name>, <conf-loc>Chicago, Illinois</conf-loc>, <conf-date>25–27 August 1993</conf-date>, pp. <fpage>463</fpage>–<lpage>468</lpage>.</citation>
</ref>
<ref id="bibr28-0954407011417764">
<label>28</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Schouten</surname><given-names>N. J.</given-names></name>
<name><surname>Salman</surname><given-names>M. A.</given-names></name>
<name><surname>Kheir</surname><given-names>N. A.</given-names></name>
</person-group> <article-title>Fuzzy logic control for parallel hybrid vehicles</article-title>. <source>IEEE Trans. Control Systems Technol.</source>, <year>2002</year>, <volume>10</volume>(<issue>3</issue>), <fpage>460</fpage>–<lpage>468</lpage>.</citation>
</ref>
<ref id="bibr29-0954407011417764">
<label>29</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Bathaee</surname><given-names>S. M. T.</given-names></name>
<name><surname>Gastaj</surname><given-names>A. H.</given-names></name>
<name><surname>Emami</surname><given-names>S. R.</given-names></name>
<name><surname>Mohammadian</surname><given-names>M.</given-names></name>
</person-group> <article-title>A fuzzy-based supervisory robust control for parallel hybrid electric vehicles</article-title>. In <conf-name>Proceedings of the IEEE Vehicle Power and Propulsion Conference</conf-name>, <conf-loc>Chicago, Illinois</conf-loc>, <conf-date>7–9 September 2005</conf-date>, pp. <fpage>694</fpage>–<lpage>700</lpage>.</citation>
</ref>
<ref id="bibr30-0954407011417764">
<label>30</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Chen</surname><given-names>Z.</given-names></name>
<name><surname>Mi</surname><given-names>C. C.</given-names></name>
</person-group> <article-title>An adaptive online energy management controller for power-split HEV based on dynamic programming and fuzzy logic</article-title>. In <conf-name>Proceedings of the 5th IEEE International Vehicle Power and Propulsion Conference</conf-name>, <conf-loc>Dearborn, Michigan</conf-loc>, <conf-date>7–11 September 2009</conf-date>.</citation>
</ref>
<ref id="bibr31-0954407011417764">
<label>31</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Paganelli</surname><given-names>G.</given-names></name>
<name><surname>Delprat</surname><given-names>S.</given-names></name>
<name><surname>Guerra</surname><given-names>T. M.</given-names></name>
<name><surname>Rimaux</surname><given-names>J.</given-names></name>
<name><surname>Santin</surname><given-names>J. J.</given-names></name>
</person-group> <article-title>Equivalent consumption minimization strategy for parallel hybrid powertrains</article-title>. In <conf-name>Proceedings of the IEEE 55th Vehicular Technology Conference</conf-name>, <conf-loc>Columbus, Ohio</conf-loc>, <conf-date>6–9 May 2002</conf-date>, pp. <fpage>2076</fpage>–<lpage>2081</lpage>.</citation>
</ref>
<ref id="bibr32-0954407011417764">
<label>32</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Pisu</surname><given-names>P.</given-names></name>
<name><surname>Rizzoni</surname><given-names>G.</given-names></name>
</person-group> <article-title>A supervisory control strategy for series hybrid electric vehicles with two energy storage systems</article-title>. In <conf-name>Proceedings of the IEEE Vehicle Power and Propulsion Conference</conf-name>, <conf-loc>Chicago, Illinois</conf-loc>, <conf-date>7–9 September 2005</conf-date>.</citation>
</ref>
<ref id="bibr33-0954407011417764">
<label>33</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Lin</surname><given-names>C.-C.</given-names></name>
<name><surname>Peng</surname><given-names>H.</given-names></name>
<name><surname>Grizzle</surname><given-names>J. W.</given-names></name>
<name><surname>Kang</surname><given-names>J.-M.</given-names></name>
</person-group> <article-title>Power management strategy for a parallel hybrid electric truck</article-title>. <source>IEEE Trans. on Control Systems Technol.</source>, <year>2003</year>, <volume>11</volume>(<issue>6</issue>), <fpage>839</fpage>–<lpage>849</lpage>.</citation>
</ref>
<ref id="bibr34-0954407011417764">
<label>34</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Delprat</surname><given-names>S.</given-names></name>
<name><surname>Lauber</surname><given-names>J.</given-names></name>
<name><surname>Guerra</surname><given-names>T. M.</given-names></name>
<name><surname>Rimaux</surname><given-names>J.</given-names></name>
</person-group> <article-title>Control of a parallel hybrid powertrain: optimal control</article-title>. <source>IEEE Trans. on Vehicular Technol.</source>, <year>2004</year>, <volume>53</volume>(<issue>3</issue>), <fpage>872</fpage>–<lpage>881</lpage>.</citation>
</ref>
<ref id="bibr35-0954407011417764">
<label>35</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Raja Ahsan Shah</surname><given-names>R. M.</given-names></name>
<name><surname>Jones</surname><given-names>R. P.</given-names></name>
<name><surname>Cheng</surname><given-names>C.</given-names></name>
<name><surname>Dhadyalla</surname><given-names>G.</given-names></name>
<name><surname>Pawar</surname><given-names>J.</given-names></name>
<name><surname>Biggs</surname><given-names>S.</given-names></name>
</person-group> <article-title>A low fidelity nonlinear model of 4WD torsional stiffness at tip-in/tip-out</article-title>. In Proceedings of the <conf-name>FISITA World Automotive Congress</conf-name>, <conf-loc>Budapest, Hungary</conf-loc>, <conf-date>30 May–4 June 2010</conf-date>.</citation>
</ref>
<ref id="bibr36-0954407011417764">
<label>36</label>
<citation citation-type="book">
<person-group person-group-type="author">
<name><surname>Ross</surname><given-names>T. J.</given-names></name>
</person-group> <source>Fuzzy logic with engineering applications</source>, <year>1995</year> (<publisher-name>McGraw Hill, Inc.</publisher-name>, <publisher-loc>New York</publisher-loc>).</citation>
</ref>
<ref id="bibr37-0954407011417764">
<label>37</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Mamdani</surname><given-names>E. H.</given-names></name>
<name><surname>Assilian</surname><given-names>S.</given-names></name>
</person-group> <article-title>An experiment in linguistic synthesis with a fuzzy logic controller</article-title>. <source>Int. J. Man–Machine Studies</source>, <year>1975</year>, <volume>7</volume>(<issue>1</issue>), <fpage>1</fpage>–<lpage>13</lpage>.</citation>
</ref>
<ref id="bibr38-0954407011417764">
<label>38</label>
<citation citation-type="book">
<person-group person-group-type="author">
<name><surname>Sugeno</surname><given-names>M.</given-names></name>
</person-group> <source>Industrial applications of fuzzy control</source>, <year>1985</year> (<publisher-name>Elsevier Science Publishing Co.</publisher-name>, <publisher-loc>New York</publisher-loc>).</citation>
</ref>
<ref id="bibr39-0954407011417764">
<label>39</label>
<citation citation-type="thesis">
<person-group person-group-type="author">
<name><surname>Farrall</surname><given-names>S. D.</given-names></name>
</person-group> <source>A study in the use of fuzzy logic in the management of an automotive heat engine/electric hybrid vehicle powertrain</source>. <comment>PhD Thesis</comment>, <publisher-name>University of Warwick</publisher-name>, <publisher-loc>Coventry, UK</publisher-loc>, <year>1993</year>.</citation>
</ref>
<ref id="bibr40-0954407011417764">
<label>40</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>McGordon</surname><given-names>A.</given-names></name>
<name><surname>Poxon</surname><given-names>J. E. W.</given-names></name>
<name><surname>Cheng</surname><given-names>C.</given-names></name>
<name><surname>Jones</surname><given-names>R. P.</given-names></name>
<name><surname>Jennings</surname><given-names>P. A.</given-names></name>
</person-group> <article-title>Development of a driver model to study the effects of real-world driver behaviour on the fuel consumption</article-title>. <source>Proc. IMechE, Part D: J. Automobile Engineering</source>, <year>2011</year> (<comment>in press</comment>). DOI: 10.1177/0954407011409116<pub-id pub-id-type="doi">10.1177/0954407011409116</pub-id>.</citation>
</ref>
</ref-list>
</back>
</article>