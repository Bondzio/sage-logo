<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v2.3 20070202//EN" "journalpublishing.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">LRT</journal-id>
<journal-id journal-id-type="hwp">splrt</journal-id>
<journal-title>Lighting Research &amp; Technology</journal-title>
<issn pub-type="ppub">1477-1535</issn>
<issn pub-type="epub">1477-0938</issn>
<publisher>
<publisher-name>SAGE Publications</publisher-name>
<publisher-loc>Sage UK: London, England</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1177/1477153511428026</article-id>
<article-id pub-id-type="publisher-id">10.1177_1477153511428026</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Articles</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Optimal pruning for selecting LEDs to synthesize tunable illumination spectra</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<name><surname>Wu</surname><given-names>C-C</given-names></name><degrees>PhD</degrees>
<xref ref-type="corresp" rid="corresp1-1477153511428026"/>
</contrib>
<contrib contrib-type="author">
<name><surname>Hu</surname><given-names>N-C</given-names></name><degrees>PhD</degrees>
</contrib>
<contrib contrib-type="author">
<name><surname>Fong</surname><given-names>Y-C</given-names></name><degrees>MEng</degrees>
</contrib>
<contrib contrib-type="author">
<name><surname>Hsiao</surname><given-names>H-C</given-names></name><degrees>PhD</degrees>
</contrib>
<contrib contrib-type="author">
<name><surname>Hsiao</surname><given-names>S-L</given-names></name><degrees>Meng</degrees>
</contrib>
</contrib-group>
<aff id="aff1-1477153511428026">Department of Electronic Engineering and Intelligent Building Research Center, National Taiwan University of Science and Technology, Taipei, Taiwan, ROC</aff>
<author-notes>
<corresp id="corresp1-1477153511428026">C-C Wu, Department of Electronic Engineering and Intelligent Building Research Center, National Taiwan University of Science and Technology, 43 Keelung Road, Sec 4, Taipei, Taiwan. ROC. E-mail: <email>D9302209@mail.ntust.edu.tw</email></corresp>
</author-notes>
<pub-date pub-type="epub-ppub">
<month>12</month>
<year>2012</year>
</pub-date>
<volume>44</volume>
<issue>4</issue>
<fpage>484</fpage>
<lpage>497</lpage>
<history>
<date date-type="received"><day>14</day><month>7</month><year>2011</year></date>
<date date-type="rev-recd"><day>29</day><month>8</month><year>2011</year></date>
<date date-type="accepted"><day>6</day><month>10</month><year>2011</year></date>
</history>
<permissions>
<copyright-statement>© The Chartered Institution of Building Services Engineers 2011</copyright-statement>
<copyright-year>2011</copyright-year>
<copyright-holder content-type="sage">SAGE Publications</copyright-holder>
</permissions>
<abstract>
<p>Multi-channel light-emitting diode (LED) light sources have been developed for various applications in lighting, but especially for spectrum-tunable lighting. However, how to select the optimal combination of LEDs for these light sources is rarely discussed. Unlike the negative-pruning process which operates by removing LEDs from a set of available LEDs based on an unrealizable negative-coefficient criterion alone, the proposed pruning process removes LEDs so as to minimize the synthesis error. This method not only produces the same optimal set of LEDs as those identified by the full-search method but also suggests when using phosphor-converted LEDs is beneficial. It does this by investigating the trade-off between the full width half maximum of the LEDs and the number of LEDs.</p>
</abstract>
</article-meta>
</front>
<body>
<sec id="sec1-1477153511428026" sec-type="intro"><title>1. Introduction</title>
<p>Many photometric facilities are equipped with different types of standard light source, such as the CIE illuminants A, <inline-formula id="ilm1-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math1-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mtext>D</mml:mtext></mml:mrow><mml:mrow><mml:mn>65</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula id="ilm2-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math2-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mtext>D</mml:mtext></mml:mrow><mml:mrow><mml:mn>55</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula id="ilm3-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math3-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mtext>D</mml:mtext></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> or perhaps E (equal energy) for calibration, comparison or calculation of the colour rendering index (CRI) of other light sources. In a light booth, control and maintenance of these sources is very inconvenient and expensive. Further, since all the different illuminants are installed, these installations use up a lot of space. Implementing the spectral power distributions (SPDs) of the above standard illuminants using only one light source has both ease of use and economic advantages. Besides, due to the dramatic increases in the efficiency of LEDs in the past 10 years, it is believed that solid-state lighting will usher in a new revolution in lighting. The most ambitious application for LEDs is to implement spectrum-tunable illuminants, instead of fixed spectrum lighting such as the incandescent, fluorescent or metal halide lamps currently used for general lighting. Apart from general lighting, we may ultimately need lighting where the colour can be changed according to the user’s moods so as to encourage concentration or relaxation in a living space. Smart and ergonomic lighting which provides different colours of illumination may be mainstream illumination in the near future.</p>
<p>LEDs are light sources which can produce as many colours of illumination as you want, theoretically. However, there are many different issues in multi-channel light-emitting diode (LED) colour mixing. Some studies<sup><xref ref-type="bibr" rid="bibr1-1477153511428026">1</xref>–<xref ref-type="bibr" rid="bibr5-1477153511428026">5</xref></sup> have tried to mimic a white light, considering the trade-off between the CRI and the radiation luminous efficacy of polychromatic LEDs so as to yield light of a given colour or to optimize the CRI or the radiation luminous efficacy. For producing better colour matches for complex illumination spectra, Wenger <italic>et al.</italic><sup><xref ref-type="bibr" rid="bibr6-1477153511428026">6</xref></sup> used nine-channel multi-spectral LED light sources. For imitating the CIE standard illuminants and other illuminants, Fryc <italic>et al.</italic><sup><xref ref-type="bibr" rid="bibr7-1477153511428026">7</xref></sup> proposed a tunable light source using LEDs based on Gaussian function with a full width half maximum (FWHM) of 20 nm with 5 nm, 10 nm, and 20 nm equal intervals in the 380–780 nm region resulting in 80, 40 or 20 LEDs. Recently, Miller <italic>et al.</italic> developed a spectrally tunable light source to allow state-of-the-art vision experiments on colour rendering and lighting using 17 colour channels of narrow-band LEDs and five phosphor-converted (p-c) LEDs.<sup><xref ref-type="bibr" rid="bibr8-1477153511428026">8</xref></sup> In these light sources, the numbers and the types of LEDs were given without mention of any LED selection scheme. Therefore, the given LED set, collected from different LED companies, might not be optimal to synthesize the spectra in the sense of the least squared error (SE) or other metrics. For economic reasons, it is better to use as few LEDs as possible and with the least SE as well. This is an optimization issue. The straightforward method to get an optimal LED set is by the full-search method. This selects <italic>M</italic> LEDs randomly from the available <italic>N</italic> LEDs forming <inline-formula id="ilm4-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math4-1477153511428026"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mfrac linethickness="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> combinations of LED sets, and then the optimal set is the one with the smallest SE. This is a burdensome job requiring many computations. Besides, it is valid only for small <italic>N</italic> and becomes impractical if <italic>N</italic> is large. The other drawback of this method is how to determine <italic>M</italic>. The usual way to do this is by the negative synthesis coefficient pruning process.<sup><xref ref-type="bibr" rid="bibr9-1477153511428026">9</xref></sup> The synthesis coefficient of a LED is equivalent to the intensity ratio of the LED’s contribution to the synthesized spectrum. This means the synthesis coefficients cannot be negative. The negative-coefficient pruning process is based on the criterion of allowing only positive synthesis coefficients. This method guarantees positive coefficients but not to have an optimal LED set. The optimal LED set is defined by having the smallest SE and all positive synthesis coefficients.</p>
<p>This paper is organized as follows. The pruning process to achieve the smallest SE and positive synthesis coefficients is presented in Section 2. In Section 3, available p-c LEDs and LEDs with different FWHMs are used for simulations. The trade-off between the LEDs with broader FWHM and the number of LEDs is analysed by the developed formula. The possibility of using p-c LEDs is also suggested. Conclusions are given in Section 4.</p>
</sec>
<sec id="sec2-1477153511428026"><title>2. Spectral synthesis error and optimization algorithm</title>
<sec id="sec3-1477153511428026"><title>2.1. Synthesis error and optimal synthesis coefficients</title>
<p>The synthesized SPD of <inline-formula id="ilm5-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math5-1477153511428026"><mml:mrow><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, <inline-formula id="ilm6-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math6-1477153511428026"><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> by <italic>M</italic> LEDs is given as
<disp-formula id="disp-formula1-1477153511428026"><label>(1)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math1-1477153511428026"><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo/><mml:mo>(</mml:mo></mml:mrow><mml:mi>λ</mml:mi><mml:mrow><mml:mo/><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math><graphic alternate-form-of="disp-formula1-1477153511428026" xlink:href="10.1177_1477153511428026-eq1.tif"/></disp-formula>
where <inline-formula id="ilm7-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math7-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <italic>c<sub>i</sub></italic> denote the SPD of the <italic>i</italic>th LED in the LED set and its synthesis coefficient, respectively. <italic>λ</italic> is the wavelength sampled node for every 5 nm from 400 nm to 700 nm of SPD. <inline-formula id="ilm8-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math8-1477153511428026"><mml:mrow><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the CIE illuminant’s SPD. The optimal coefficients of the illuminant in the sense of minimizing SE can be obtained as
<disp-formula id="disp-formula5-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math5-1477153511428026"><mml:mrow><mml:mtext>SE</mml:mtext><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:mrow><mml:mo/><mml:mo>{</mml:mo></mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo/><mml:mo>(</mml:mo></mml:mrow><mml:mi>λ</mml:mi><mml:mrow><mml:mo/><mml:mo>)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover><mml:mrow><mml:mo/><mml:mo>(</mml:mo></mml:mrow><mml:mi>λ</mml:mi><mml:mrow><mml:mo/><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mo/><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mtext>d</mml:mtext><mml:mi>λ</mml:mi></mml:mrow></mml:math><graphic alternate-form-of="disp-formula5-1477153511428026" xlink:href="10.1177_1477153511428026-eq5.tif"/></disp-formula>
</p>
<p>To have the smallest SE, we take <inline-formula id="ilm9-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math9-1477153511428026"><mml:mrow><mml:mo>∂</mml:mo><mml:mi>SE</mml:mi><mml:mo>/</mml:mo><mml:mo>∂</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mo>∫</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo/><mml:mo>(</mml:mo></mml:mrow><mml:mi>λ</mml:mi><mml:mrow><mml:mo/><mml:mo>)</mml:mo></mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">}</mml:mo><mml:mtext>d</mml:mtext><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, for <italic>i</italic> = 1,…, <italic>M</italic>. In vector and matrix notation, the above equations form <italic>M</italic> equations with coefficients <italic>c<sub>i</sub></italic>. We obtain the synthesis coefficients in vector form as<sup><xref ref-type="bibr" rid="bibr9-1477153511428026">9</xref></sup>
<disp-formula id="disp-formula2-1477153511428026"><label>(2)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math2-1477153511428026"><mml:mrow><mml:mover><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mo>⇀</mml:mo></mml:mrow></mml:mover><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi>AA</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi/><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>A</mml:mi><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mo>⇀</mml:mo></mml:mrow></mml:mover><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mo>⇀</mml:mo></mml:mrow></mml:mover></mml:mrow></mml:math><graphic alternate-form-of="disp-formula2-1477153511428026" xlink:href="10.1177_1477153511428026-eq2.tif"/></disp-formula>
where
<disp-formula id="disp-formula6-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math6-1477153511428026"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo/><mml:mo>[</mml:mo></mml:mrow><mml:mtable align="left"><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>…</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>61</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center" columnspan="1"><mml:mrow><mml:mo>:</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center" columnspan="1"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>…</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>61</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mrow><mml:mo/><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math><graphic alternate-form-of="disp-formula6-1477153511428026" xlink:href="10.1177_1477153511428026-eq6.tif"/></disp-formula>
is the matrix of size <inline-formula id="ilm10-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math10-1477153511428026"><mml:mrow><mml:mi>M</mml:mi><mml:mo>×</mml:mo><mml:mn>61</mml:mn></mml:mrow></mml:math></inline-formula>, whose entries are the components of the sampled SPDs of the LEDs. <inline-formula id="ilm11-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math11-1477153511428026"><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mo>⇀</mml:mo></mml:mrow></mml:mover></mml:mrow></mml:math></inline-formula> denotes the sampled SPD vector of size 61 if the spectrum is sampled every 5 nm<?tlb?> from 400 nm to 700 nm. <inline-formula id="ilm12-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math12-1477153511428026"><mml:mrow><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is the pseudo-inverse matrix of <italic>A</italic> with size <inline-formula id="ilm13-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math13-1477153511428026"><mml:mrow><mml:mi>M</mml:mi><mml:mo>×</mml:mo><mml:mn>61</mml:mn></mml:mrow></mml:math></inline-formula>.</p>
<p>The norm is a function that assigns a strictly positive length or size to all vectors in a vector space of SPD, for example, <inline-formula id="ilm14-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math14-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, <italic>i</italic> = 1,…, <italic>M</italic> and <inline-formula id="ilm15-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math15-1477153511428026"><mml:mrow><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, defined by <inline-formula id="ilm16-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math16-1477153511428026"><mml:mrow><mml:mo>∫</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo/><mml:mo>(</mml:mo></mml:mrow><mml:mi>λ</mml:mi><mml:mrow><mml:mo/><mml:mo>)</mml:mo></mml:mrow><mml:mtext>d</mml:mtext><mml:mi>λ</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula id="ilm17-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math17-1477153511428026"><mml:mrow><mml:mo>∫</mml:mo><mml:msup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo/><mml:mo>(</mml:mo></mml:mrow><mml:mi>λ</mml:mi><mml:mrow><mml:mo/><mml:mo>)</mml:mo></mml:mrow><mml:mtext>d</mml:mtext><mml:mi>λ</mml:mi></mml:mrow></mml:math></inline-formula> or <inline-formula id="ilm18-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math18-1477153511428026"><mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>→</mml:mi></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>→</mml:mi></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mover><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>→</mml:mi></mml:mover></mml:mrow></mml:math></inline-formula> and <inline-formula id="ilm19-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math19-1477153511428026"><mml:mrow><mml:mrow><mml:mo/></mml:mrow><mml:mi> </mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>→</mml:mi></mml:mover><mml:mrow><mml:mo/></mml:mrow><mml:mi> </mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>→</mml:mi></mml:mover></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>→</mml:mi></mml:mover></mml:mrow></mml:math></inline-formula> in vector form which is the Euclidean norm to the power of 2. The<?tlb?> norms of <inline-formula id="ilm20-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math20-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> are normalized to 1 to simplify the explanation in the pruning process in Section 2.2. For this reason, the synthesis coefficients <italic>c<sub>i</sub></italic>’s will be less than 1. <italic>c<sub>i</sub></italic>’s are closely related to the ratio of the radiant flux a LED contributes to the synthesized spectra to the rated radiant flux of this LED and plays an important role in spectrum-tunable lighting realized by the multi-channel LEDs.</p>
<p>The synthesized spectrum of <inline-formula id="ilm21-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math21-1477153511428026"><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>→</mml:mi></mml:mover></mml:mrow></mml:math></inline-formula> is obtained by <inline-formula id="ilm22-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math22-1477153511428026"><mml:mrow><mml:mover><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow><mml:mrow><mml:mo>⇀</mml:mo></mml:mrow></mml:mover><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mo>⇀</mml:mo></mml:mrow></mml:mover></mml:mrow></mml:math></inline-formula>. The synthesis error which is the norm of <inline-formula id="ilm23-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math23-1477153511428026"><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mo>⇀</mml:mo></mml:mrow></mml:mover><mml:mo>-</mml:mo><mml:mover><mml:mrow><mml:mover><mml:mrow/><mml:mi>∧</mml:mi></mml:mover></mml:mrow><mml:mrow><mml:mo>⇀</mml:mo></mml:mrow></mml:mover><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mo>⇀</mml:mo></mml:mrow></mml:mover></mml:mrow></mml:math></inline-formula> is minimal.<sup><xref ref-type="bibr" rid="bibr10-1477153511428026">10</xref></sup> This is the first stage to determine<?tlb?> the optimal synthesis coefficients to synthesize <inline-formula id="ilm24-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math24-1477153511428026"><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>→</mml:mi></mml:mover></mml:mrow></mml:math></inline-formula> by any arbitrary LED set, or the candidate LED set containing a large number of available LEDs. This LED set is not an optimal set yet, since it may contain negative synthesis coefficients and cannot be realized practically. By repeatedly applying the pruning process described below to remove LEDs so that the final LED set contains all positive coefficients and the smallest SE, the optimal LED set is identified.</p>
</sec>
<sec id="sec4-1477153511428026"><title>2.2. Optimal algorithm for selecting LEDs</title>
<p>In order to have both the smallest SE and positive synthesis coefficients, we first need to have a large LED set. Then, the pruning process is applied to this LED set to remove improper LEDs which will be defined later. Ideally, the norm of <inline-formula id="ilm25-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math25-1477153511428026"><mml:mrow><mml:mover><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow><mml:mrow><mml:mo>⇀</mml:mo></mml:mrow></mml:mover></mml:mrow></mml:math></inline-formula> will be equal to 1 since the norm of <inline-formula id="ilm26-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math26-1477153511428026"><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>→</mml:mi></mml:mover></mml:mrow></mml:math></inline-formula> is 1. If this happens, this also means the SE is zero, based on the projection theorem of the least squared solution.<sup><xref ref-type="bibr" rid="bibr10-1477153511428026">10</xref></sup> If the norm of <inline-formula id="ilm27-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math27-1477153511428026"><mml:mrow><mml:mover><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow><mml:mrow><mml:mo>⇀</mml:mo></mml:mrow></mml:mover></mml:mrow></mml:math></inline-formula> is far away from 1 that means a large SE will be generated. Thus, we use the<?tlb?> norm of the synthesized spectrum to interpret the SE.</p>
<p>We begin with the total synthesis norm of the synthesized spectrum <inline-formula id="ilm28-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math28-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> by substituting <xref ref-type="disp-formula" rid="disp-formula1-1477153511428026">Equation (1)</xref> in the norm defined as
<disp-formula id="disp-formula3-1477153511428026"><label>(3)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math3-1477153511428026"><mml:mrow><mml:mtable align="right"><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:msup><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext>d</mml:mtext><mml:mi>λ</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:mrow><mml:mo/><mml:mo>(</mml:mo></mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo/><mml:mo>(</mml:mo></mml:mrow><mml:mi>λ</mml:mi><mml:mrow><mml:mo/><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo/><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo/><mml:mo>(</mml:mo></mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo/><mml:mo>(</mml:mo></mml:mrow><mml:mi>λ</mml:mi><mml:mrow><mml:mo/><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo/><mml:mo>)</mml:mo></mml:mrow><mml:mtext>d</mml:mtext><mml:mi>λ</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:mrow><mml:mo/><mml:mo>[</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo/><mml:mo>(</mml:mo></mml:mrow><mml:mi>λ</mml:mi><mml:mrow><mml:mo/><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mo>…</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo/><mml:mo>(</mml:mo></mml:mrow><mml:mi>λ</mml:mi><mml:mrow><mml:mo/><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo/><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:mo>·</mml:mo><mml:mrow><mml:mo/><mml:mo>[</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo/><mml:mo>(</mml:mo></mml:mrow><mml:mi>λ</mml:mi><mml:mrow><mml:mo/><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mo>…</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo/><mml:mo>(</mml:mo></mml:mrow><mml:mi>λ</mml:mi><mml:mrow><mml:mo/><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo/><mml:mo>]</mml:mo></mml:mrow><mml:mtext>d</mml:mtext><mml:mi>λ</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:mrow><mml:mo/><mml:mo>[</mml:mo></mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo/><mml:mo>(</mml:mo></mml:mrow><mml:mi>λ</mml:mi><mml:mrow><mml:mo/><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mfrac linethickness="0"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo/><mml:mo>(</mml:mo></mml:mrow><mml:mi>λ</mml:mi><mml:mrow><mml:mo/><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo/><mml:mo>(</mml:mo></mml:mrow><mml:mi>λ</mml:mi><mml:mrow><mml:mo/><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo/><mml:mo>]</mml:mo></mml:mrow><mml:mtext>d</mml:mtext><mml:mi>λ</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mfrac linethickness="0"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mfrac linethickness="0"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic alternate-form-of="disp-formula3-1477153511428026" xlink:href="10.1177_1477153511428026-eq3.tif"/></disp-formula>
where <italic>p<sub>i</sub></italic> denotes <inline-formula id="ilm29-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math29-1477153511428026"><mml:mrow><mml:mo>∫</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext>d</mml:mtext><mml:mi>λ</mml:mi></mml:mrow></mml:math></inline-formula> which is the norm of the SPD of the <italic>i</italic>th LED and <inline-formula id="ilm30-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math30-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. <inline-formula id="ilm31-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math31-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> denotes <inline-formula id="ilm32-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math32-1477153511428026"><mml:mrow><mml:mo>∫</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext>d</mml:mtext><mml:mi>λ</mml:mi></mml:mrow></mml:math></inline-formula> which is always positive. <inline-formula id="ilm33-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math33-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> depends on the overlapped area of the SPDs of the neighbouring LEDs of the <italic>i</italic>th LED. If the peak wavelengths of the <italic>i</italic>th LED and the <italic>j</italic>th LED are far apart from each other, <inline-formula id="ilm34-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math34-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> will be small and can be neglected.</p>
<p>In the pruning process, if the <italic>i</italic>th LED is removed from the LED set, the sub-norm of the <italic>i</italic>th LED <inline-formula id="ilm35-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math35-1477153511428026"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> taken away from <inline-formula id="ilm36-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math36-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is given as
<disp-formula id="disp-formula4-1477153511428026"><label>(4)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math4-1477153511428026"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mfrac linethickness="0"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><graphic alternate-form-of="disp-formula4-1477153511428026" xlink:href="10.1177_1477153511428026-eq4.tif"/></disp-formula>
</p>
<p>When the <italic>i</italic>th LED is removed, all the terms indexed by <italic>i</italic> are removed from <xref ref-type="disp-formula" rid="disp-formula3-1477153511428026">Equation (3)</xref>. The sum of these removed terms is the sub-norm of the <italic>i</italic>th LED. Since <inline-formula id="ilm37-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math37-1477153511428026"><mml:mrow><mml:mrow><mml:mo/></mml:mrow><mml:mi> </mml:mi><mml:mo>|</mml:mo><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>→</mml:mi></mml:mover><mml:mrow><mml:mo/></mml:mrow><mml:mi> </mml:mi><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula id="ilm38-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math38-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="disp-formula3-1477153511428026">Equation (3)</xref> will also be 1 if the synthesized spectrum <inline-formula id="ilm39-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math39-1477153511428026"><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is perfectly reconstructed. But if <inline-formula id="ilm40-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math40-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is far away from 1, then SE is large.<?tlb?> Therefore, if we want <inline-formula id="ilm41-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math41-1477153511428026"><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> to be reconstructed with a small SE, <inline-formula id="ilm42-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math42-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> should be as close to 1 as possible. Thus, the basic idea of the pruning process is to keep <inline-formula id="ilm43-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math43-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> as close to 1 as possible. The pruning process is developed as follows.</p>
<sec id="sec5-1477153511428026"><title>2.2.1. Removing improper LEDs with maximum <inline-formula id="ilm44-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math44-1477153511428026"><mml:mrow><mml:mo>∇</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula> when <inline-formula id="ilm45-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math45-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow></mml:msub><mml:mo>&gt;&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula></title>
<p>At the beginning of the pruning process, if the LED candidate set has <inline-formula id="ilm46-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math46-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow></mml:msub><mml:mo>&gt;&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, the role of the pruning algorithm is to remove the LED which has the greatest <inline-formula id="ilm47-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math47-1477153511428026"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula> among <inline-formula id="ilm48-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math48-1477153511428026"><mml:mrow><mml:mo>∇</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>,…, <inline-formula id="ilm49-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math49-1477153511428026"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> so as to cut down the large <inline-formula id="ilm50-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math50-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, since the sub-norm of this LED contributes the greatest amount to the SE and pushes <inline-formula id="ilm51-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math51-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> far away from 1. <inline-formula id="ilm52-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math52-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow></mml:msub><mml:mo>&gt;&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> is defined as <inline-formula id="ilm53-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math53-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> greater than 1.1 and <inline-formula id="ilm54-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math54-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> is if <inline-formula id="ilm55-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math55-1477153511428026"><mml:mrow><mml:mn>1</mml:mn><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, since <inline-formula id="ilm56-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math56-1477153511428026"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula> is in the order of 10<sup>−1</sup> if the size of the LED set is shrunk after applying the pruning process repeatedly. Usually, if the candidate LED set contains a large number of LEDs <inline-formula id="ilm57-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math57-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow></mml:msub><mml:mo>&gt;&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula><italic>.</italic> The <inline-formula id="ilm58-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math58-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> of the LED set after removing the LED with the maximum <inline-formula id="ilm59-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math59-1477153511428026"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula> will be smaller than that created by removing a non-maximum <inline-formula id="ilm60-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math60-1477153511428026"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula>. Thus, the least SE property is preserved. The above pruning algorithm is applied repeatedly to remove LEDs, until the final LED set makes <inline-formula id="ilm61-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math61-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> close but a little larger than 1. This LED set is quite close to the optimal set but you cannot remove the maximum <inline-formula id="ilm62-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math62-1477153511428026"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula> anymore; otherwise <inline-formula id="ilm63-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math63-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> will be much less than 1. In this situation, the candidate LED set is too small.</p>
</sec>
<sec id="sec6-1477153511428026"><title>2.2.2. Removing improper LEDs with minimum <inline-formula id="ilm64-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math64-1477153511428026"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula> when <inline-formula id="ilm65-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math65-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> close to but larger than 1</title>
<p>In this situation, the pruning process needs to continue because some synthesis coefficients may be negative or a smaller number of LEDs is required. The role of the pruning process now is to remove the LED which has the smallest <inline-formula id="ilm66-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math66-1477153511428026"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula> in this set of LEDs in order to keep <inline-formula id="ilm67-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math67-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> not too far away from 1. This preserves the smallest SE and makes other LEDs with negative coefficients positive. This is because that the SPDs of the LEDs are overlapped depending on their FWHMs. So, removing an LED will change the coefficients of its adjacent LEDs at the same time. This process makes the negative coefficients of the adjacent LEDs positive.</p>
<p>If the candidate LED set contains a large number of LEDs, the pruning process starts with Step 1 with <inline-formula id="ilm68-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math68-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow></mml:msub><mml:mo>&gt;&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and ends up with Step 2. But if the LED size is too small with <inline-formula id="ilm69-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math69-1477153511428026"><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>1</mml:mn><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, the pruning process starts with Step 2. If an LED set has <inline-formula id="ilm70-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math70-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> before the pruning process is applied, this set does not contain enough LEDs and no pruning process is required. Rather, what is needed is to add more LEDs to this set so that <inline-formula id="ilm71-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math71-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow></mml:msub><mml:mo>&gt;&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>.</p>
<p>An illustrative example is given below. The synthesis coefficients for synthesizing the SPD of <inline-formula id="ilm72-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math72-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mtext>D</mml:mtext></mml:mrow><mml:mrow><mml:mn>65</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> from a set of 31 LEDs pruned to 30 LEDs are given in <xref ref-type="table" rid="table1-1477153511428026">Table 1</xref>. In this table, we list one negative coefficient and the coefficients of its five neighbours only. We cannot remove the LED with a peak emission at 591 nm having a negative coefficient. Instead, the LED with a peak emission at 589 nm and having a positive coefficient is removed because the <inline-formula id="ilm73-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math73-1477153511428026"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula> of the LED with a peak at 589 nm is the smallest among the LEDs. After removal, the coefficient of the LED with a peak emission at 591 nm becomes positive, as shown in <xref ref-type="table" rid="table2-1477153511428026">Table 2</xref>. This is a correct decision and is verified by the full-search method, where the LED with a peak emission at 591 nm is kept. The LED with a peak emission at 591 nm is one of the LEDs in the final selected optimal LED set shown in the upper part of <xref ref-type="table" rid="table5-1477153511428026">Table 5</xref>. However, the LED with a peak at 591 nm is removed by the negative-pruning process,<sup><xref ref-type="bibr" rid="bibr9-1477153511428026">9</xref></sup> resulting in a non-optimal LED set being obtained. This is the major difference between our approach and the negative-pruning process. The proposed pruning process does not require the steps of synthesizing the spectrum and calculating the synthesis error while these steps are necessary for the negative-coefficient pruning process<sup><xref ref-type="bibr" rid="bibr9-1477153511428026">9</xref></sup> and the full-search method in order to search for the greatest or smallest synthesis error.
<table-wrap id="table1-1477153511428026" position="float"><label>Table 1.</label><caption><p>Synthesis coefficients for simulating <inline-formula id="ilm74-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math74-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mtext>D</mml:mtext></mml:mrow><mml:mrow><mml:mn>65</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> by the set of 31 LEDs pruned to 30 LEDs which is the middle of the pruning process from a 61-LED set to the optimal set. The LED with a peak emission at 589 nm and with the smallest <inline-formula id="ilm75-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math75-1477153511428026"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula> is removed instead of the LED with a peak emission at 591 nm and a negative coefficient</p></caption>
<graphic alternate-form-of="table1-1477153511428026" xlink:href="10.1177_1477153511428026-table1.tif"/>
<table frame="hsides"><thead align="left">
<tr><th>Peak wavelength (nm)</th>
<th>588</th>
<th>589</th>
<th><italic>591</italic></th>
<th><italic>594</italic></th>
<th><italic>604</italic></th>
<th>610</th></tr></thead>
<tbody align="left">
<tr>
<td><italic>c<sub>i</sub></italic></td>
<td>0.1230</td>
<td>0.0921</td>
<td>−0.1335</td>
<td>0.1216</td>
<td>0.1483</td>
<td>0.1571</td></tr>
<tr>
<td><inline-formula id="ilm76-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math76-1477153511428026"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula></td>
<td>0.0165</td>
<td>0.0101</td>
<td>0.0130</td>
<td>0.0183</td>
<td>0.0244</td>
<td>0.0247</td></tr>
</tbody>
</table>
</table-wrap>
<table-wrap id="table2-1477153511428026" position="float"><label>Table 2.</label><caption><p>After removing the 589 nm LED thereby reducing the 31-LED set to a 30-LED set, the synthesis coefficient of the LED with a peak emission at 591 nm becomes positive. This is one of LEDs in the final optimal LED set shown in the upper part of <xref ref-type="table" rid="table5-1477153511428026">Table 5</xref></p></caption>
<graphic alternate-form-of="table2-1477153511428026" xlink:href="10.1177_1477153511428026-table2.tif"/>
<table frame="hsides"><thead align="left">
<tr><th>Peak wavelength (nm)</th>
<th>588</th>
<th>591</th>
<th><italic>594</italic></th>
<th>604</th>
<th>610</th>
<th>613</th></tr></thead>
<tbody align="left">
<tr>
<td><italic>c<sub>i</sub></italic></td>
<td>0.1387</td>
<td>0.1286</td>
<td>0.1048</td>
<td>0.1401</td>
<td>0.1353</td>
<td>0.1311</td></tr>
<tr>
<td><inline-formula id="ilm77-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math77-1477153511428026"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula></td>
<td>0.0244</td>
<td>0.0251</td>
<td>0.0152</td>
<td>0.0234</td>
<td>0.0201</td>
<td>0.0172</td></tr>
</tbody>
</table>
</table-wrap>
</p>
<p>The above algorithm aims to imitate only one illuminant. To imitate a group of illuminants from only one LED set, we treat the averaged SPD of the illuminants in this group as the target SPD, because the averaged SPD is the least SE representation of the spectra in this group. This borrows from probability theory.<sup><xref ref-type="bibr" rid="bibr11-1477153511428026">11</xref></sup> Thus, an LED set that synthesizes the averaged SPD optimally can also synthesize each illuminant in this group optimally, too.</p>
</sec>
</sec>
</sec>
<sec id="sec7-1477153511428026"><title>3. Simulations of the proposed optimal method</title>
<p>Since the width of the LED FWHM and the number of LEDs used are closely related when synthesizing spectra, we want to discuss the relationship first as follows. This will give an indication of the value of using p-c LEDs which have much broader FWHMs.</p>
<sec id="sec8-1477153511428026"><title>3.1. The trade-off between broader FWHMs and LED numbers</title>
<p>Two 61-LED sets are used as an illustrative example. One 61-LED set containing 4 p-c LEDs is given in <xref ref-type="table" rid="table3-1477153511428026">Table 3</xref> which is obtained from the LEDs in reference<xref ref-type="bibr" rid="bibr8-1477153511428026"> 8</xref> combined with the LEDs in reference<xref ref-type="bibr" rid="bibr9-1477153511428026"> 9</xref>. The other 61-LED set is the same as the former but with the 4 p-c LEDs replaced by four LEDs with the same peak wavelengths and FWHMs of 30 nm. The two LED sets are applied to the reference spectrum, <inline-formula id="ilm81-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math81-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>avg</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo/><mml:mo>(</mml:mo></mml:mrow><mml:mi>λ</mml:mi><mml:mrow><mml:mo/><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> which is the averaged spectrum of the illuminants A, D<sub>65</sub>, D<sub>55</sub>, D<sub>50</sub> and E mentioned in the last paragraph of Section 2. Both <inline-formula id="ilm82-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math82-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> = 2.54799 and <inline-formula id="ilm83-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math83-1477153511428026"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> = 1.31258 of the 61-LED set with the p-c LEDs are smaller than <inline-formula id="ilm84-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math84-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> = 3.98216 and <inline-formula id="ilm85-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math85-1477153511428026"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> = 1.81479 of the 61-LED set without p-c LEDs. Since both <inline-formula id="ilm86-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math86-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>’s are greater than 1.1, the pruning process starts by removing the LEDs with the maximum sub-norm repeatedly until <inline-formula id="ilm87-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math87-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is a little bit larger than 1. This happens when <inline-formula id="ilm88-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math88-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> = 1.00587 with 46 LEDs left for the LED set with p-c LEDs while <inline-formula id="ilm89-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math89-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> = 1.00473 with 52 LEDs left for the LED set without p-c LEDs.
<table-wrap id="table3-1477153511428026" position="float"><label>Table 3.</label><caption><p>The emission peak wavelength and full width half maximum (FWHM) of the 61 available LEDs collected from the LEDs in Ref.<sup><xref ref-type="bibr" rid="bibr9-1477153511428026">9</xref></sup> combined with the LEDs used in Ref<sup><xref ref-type="bibr" rid="bibr8-1477153511428026">8</xref></sup></p></caption>
<graphic alternate-form-of="table3-1477153511428026" xlink:href="10.1177_1477153511428026-table3.tif"/>
<table frame="hsides">
<tbody align="left">
<tr>
<td align="justify">Peak wave length</td>
<td>401.8</td>
<td>402</td>
<td>405</td>
<td>416. 3</td>
<td>430</td>
<td>440</td>
<td>451.7</td>
<td>458.7</td>
<td>461</td></tr>
<tr>
<td align="justify">FWHM</td>
<td>30</td>
<td>30</td>
<td>13</td>
<td>30</td>
<td>30</td>
<td>21</td>
<td>30</td>
<td>30</td>
<td>30</td></tr>
<tr>
<td align="justify">Peak wavelength</td>
<td>465</td>
<td>468</td>
<td>468.5</td>
<td>470</td>
<td>480</td>
<td>481</td>
<td>500</td>
<td>502</td>
<td>504.4</td></tr>
<tr>
<td align="justify">FWHM</td>
<td>25</td>
<td>20</td>
<td>30</td>
<td>30</td>
<td>30</td>
<td>30</td>
<td>30</td>
<td>20</td>
<td>30</td></tr>
<tr>
<td align="justify">Peak wavelength</td>
<td>505</td>
<td>514</td>
<td>520</td>
<td>522</td>
<td>523</td>
<td>525</td>
<td>530</td>
<td>563</td>
<td>570</td></tr>
<tr>
<td align="justify">FWHM</td>
<td>30</td>
<td>30</td>
<td>35</td>
<td>30</td>
<td>20</td>
<td>37</td>
<td>30</td>
<td>30</td>
<td>30</td></tr>
<tr>
<td align="justify">Peak wavelength</td>
<td>571</td>
<td>573</td>
<td>575</td>
<td>581</td>
<td>585</td>
<td>588</td>
<td>589</td>
<td>590</td>
<td>591</td></tr>
<tr>
<td align="justify">FWHM</td>
<td>30</td>
<td>30</td>
<td>10</td>
<td>30</td>
<td>30</td>
<td>25</td>
<td>30</td>
<td>18</td>
<td>30</td></tr>
<tr>
<td align="justify">Peak wavelength</td>
<td>592</td>
<td>593.4</td>
<td>594</td>
<td>604</td>
<td>605</td>
<td>610</td>
<td>613</td>
<td>616</td>
<td>620</td></tr>
<tr>
<td align="justify">FWHM</td>
<td>20</td>
<td>30</td>
<td>20</td>
<td>30</td>
<td>30</td>
<td>40</td>
<td>25</td>
<td>30</td>
<td>20</td></tr>
<tr>
<td align="justify">Peak wavelength</td>
<td>624</td>
<td>625</td>
<td>630</td>
<td>635</td>
<td>639</td>
<td>640</td>
<td>641</td>
<td>643</td>
<td>645</td></tr>
<tr>
<td align="justify">FWHM</td>
<td>30</td>
<td>30</td>
<td>20</td>
<td>50</td>
<td>30</td>
<td>20</td>
<td>30</td>
<td>30</td>
<td>30</td></tr>
<tr>
<td align="justify">Peak</td>
<td> 655</td>
<td>   660</td>
<td>   700</td>
<td colspan="6">   615 nm   535 nm    450 nm   560 nm</td></tr>
<tr>
<td> wavelength</td>
<td/>
<td/>
<td/>
<td colspan="6">   red p-c   green p-c   blue p-c   yellow p-c</td></tr>
<tr>
<td/>
<td/>
<td/>
<td/>
<td colspan="6">   LEC    LED      LED     LED</td></tr>
<tr>
<td align="justify">FWHM</td>
<td>  50</td>
<td>    21</td>
<td>    45</td>
<td colspan="6">    10     50       60      140</td></tr>
</tbody>
</table>
</table-wrap></p>
<p>Next, the pruning process removes the LEDs with the least sub-norms from the 46 LED set or the 52 LED set. The sub-norm in <xref ref-type="disp-formula" rid="disp-formula4-1477153511428026">Equation (4)</xref> will be smaller if the second term on the right-hand side of the equation becomes negative. This happens when either <italic>c<sub>i</sub></italic> or <italic>c<sub>j</sub></italic> is negative. If an LED set contains LEDs with broader FWHMs, such as the p-c LEDs, the SPD of the p-c LED has many regions overlapped with its neighbouring LEDs. This makes the synthesis coefficients <italic>c<sub>i</sub></italic> smaller or even negative compared with the LED set without p-c LEDs. The smaller or negative <italic>c<sub>i</sub></italic> in the LED set with p-c LEDs makes some <inline-formula id="ilm90-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math90-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> terms in <xref ref-type="disp-formula" rid="disp-formula4-1477153511428026">Equation (4)</xref> negative. Thus, its <inline-formula id="ilm91-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math91-1477153511428026"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula> is smaller than the <inline-formula id="ilm92-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math92-1477153511428026"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula> for the LED set without p-c LEDs.</p>
<p>The smaller <inline-formula id="ilm93-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math93-1477153511428026"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula> has two effects. The first is that the maximum number of LEDs in the LED set with p-c LEDs included is smaller than that of the LED set without p-c LEDs. The maximum number of LEDs means that adding one more LED to this set will introduce negative coefficients. The second is that the synthesis performance of the LED set with p-c LEDs is better than that of the LED set without p-c LEDs at the same but small number of LEDs.</p>
<p>The reason for the first effect is that the LED set with p-c LEDs has more negative or smaller synthesis coefficients than the LED set without p-c LEDs as mentioned above. Thus, more pruning processes are required to reach a smaller number of LEDs with this LED set. For example, comparing the 13-LED set with two p-c LEDs shown in the upper part of <xref ref-type="table" rid="table4-1477153511428026">Table 4</xref> with the 13-LED set without p-c LEDs in the lower part of <xref ref-type="table" rid="table4-1477153511428026">Table 4</xref>, the smallest <inline-formula id="ilm94-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math94-1477153511428026"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula>’s, such as 0.0013, 0.0094 and 0.0119, are in the 13-LED set with two p-c LEDs. Thus, one more pruning process is required to get rid of the LED with the negative coefficient in the 13-LED set with two p-c LEDs while all the 13 LEDs without p-c LEDs have positive coefficients. This confirms that the maximum number of LEDs obtained from the LED set with p-c LEDs is smaller than that obtained from the LED set without p-c LEDs. The final 12-LEDs with two p-c LEDs are shown in the upper part of <xref ref-type="table" rid="table5-1477153511428026">Table 5</xref> and will be used for simulation later in Section 3.2.
<table-wrap id="table4-1477153511428026" position="float"><label>Table 4.</label><caption><p>The synthesis coefficients and Δ<italic>p</italic>’s of the 13 LEDs with <inline-formula id="ilm95-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math95-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> = 0.989017 pruned from 61 LEDs with 4 p-c LEDs and those with <inline-formula id="ilm96-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math96-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> = 0.971068 pruned from 61 LEDs without p-c LEDs. Most of the <italic>c<sub>i</sub></italic>’s and <inline-formula id="ilm97-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math97-1477153511428026"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula>’s of the LED set with p-c LEDs are smaller than those of the LED set without p-c LEDs. The coefficient of one LED in the LED set with p-c LEDs is negative while all the coefficients are positive in the LED set without p-c LEDs</p></caption>
<graphic alternate-form-of="table4-1477153511428026" xlink:href="10.1177_1477153511428026-table4.tif"/>
<table frame="hsides"><thead align="left">
<tr><th colspan="14">13 LEDs<hr/></th></tr></thead>
<tbody align="left">
<tr>
<td colspan="14"><italic>Panel A: Two p-c LEDs</italic><hr/></td></tr>
<tr>
<td>nm<hr/></td>
<td>401.8</td>
<td>416. 3</td>
<td>Blue pc LED 450 nm</td>
<td>458.7</td>
<td>468</td>
<td>480</td>
<td>500</td>
<td>505</td>
<td>Yellow p-c LED 560 nm</td>
<td>591</td>
<td>616</td>
<td>655</td>
<td>700</td></tr>
<tr>
<td><italic>c<sub>i</sub></italic></td>
<td>0.0926</td>
<td>0.0821</td>
<td>0.1715</td>
<td>−0.148</td>
<td>0.0974</td>
<td>0.1019</td>
<td>0.0867</td>
<td>0.0263</td>
<td>0.6609</td>
<td>0.0160</td>
<td>0.0553</td>
<td>0.2343</td>
<td>0.2200</td></tr>
<tr>
<td>Δ<italic>p</italic><hr/></td>
<td>0.0214</td>
<td>0.0233</td>
<td>0.0563</td>
<td>0.0013</td>
<td>0.0433</td>
<td>0.0478</td>
<td>0.0409</td>
<td>0.0119</td>
<td>0.5206</td>
<td>0.0094</td>
<td>0.0153</td>
<td>0.1225</td>
<td>0.0751</td></tr>
<tr>
<td colspan="14"><italic>Panel B: Without p-c LEDs</italic><hr/></td></tr>
<tr>
<td>nm<hr/></td>
<td>401.8</td>
<td>416. 3</td>
<td>450</td>
<td>470</td>
<td>481</td>
<td>505</td>
<td>530</td>
<td>560</td>
<td>588</td>
<td>610</td>
<td>635</td>
<td>655</td>
<td>700</td></tr>
<tr>
<td><italic>c<sub>i</sub></italic></td>
<td>0.0526</td>
<td>0.1828</td>
<td>0.2446</td>
<td>0.0567</td>
<td>0.1327</td>
<td>0.2135</td>
<td>0.2795</td>
<td>0.2792</td>
<td>0.1329</td>
<td>0.2671</td>
<td>0.0474</td>
<td>0.3428</td>
<td>0.2506</td></tr>
<tr>
<td>Δ<italic>p</italic></td>
<td>0.0148</td>
<td>0.0557</td>
<td>0.0843</td>
<td>0.0123</td>
<td>0.0353</td>
<td>0.0854</td>
<td>0.1340</td>
<td>0.1275</td>
<td>0.0455</td>
<td>0.0980</td>
<td>0.0144</td>
<td>0.1396</td>
<td>0.1245</td></tr>
</tbody>
</table>
</table-wrap>
<table-wrap id="table5-1477153511428026" position="float"><label>Table 5.</label><caption><p>61 LEDs with 4 p-c LEDs and without p-c LEDs pruned to 12 LEDs with <inline-formula id="ilm78-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math78-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> = 0.984354 (with p-c LED) and <inline-formula id="ilm79-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math79-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> = 0.968468 (without p-c LED). Again, most of the <italic>c<sub>i</sub></italic>’s and <inline-formula id="ilm80-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math80-1477153511428026"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula>’s of the LED set with p-c LEDs are smaller than those of the LED set without p-c LEDs. This shows the advantage of using p-c LEDs when a small size LED set is required. The 12-LED set with 2 p-c LEDs is used for the simulations in Section 3.2</p></caption>
<graphic alternate-form-of="table5-1477153511428026" xlink:href="10.1177_1477153511428026-table5.tif"/>
<table frame="hsides"><thead align="left">
<tr><th colspan="13">12 LEDs<hr/></th></tr></thead>
<tbody align="left">
<tr>
<td colspan="13"><italic>Panel A: Two p-c LEDs</italic><hr/></td></tr>
<tr>
<td>nm<hr/></td>
<td>401.8</td>
<td>416. 3</td>
<td>Blue p-c LED 450 nm</td>
<td>468</td>
<td>480</td>
<td>500</td>
<td>505</td>
<td>Yellow p-c LED 560 nm</td>
<td>591</td>
<td>616</td>
<td>655</td>
<td>700</td></tr>
<tr>
<td><italic>c<sub>i</sub></italic></td>
<td>0.0654</td>
<td>0.1527</td>
<td>0.0401</td>
<td>0.0266</td>
<td>0.1524</td>
<td>0.0544</td>
<td>0.0546</td>
<td>0.6607</td>
<td>0.0264</td>
<td>0.0390</td>
<td>0.2363</td>
<td>0.2193</td></tr>
<tr>
<td>Δ<italic>p</italic><hr/></td>
<td>0.0109</td>
<td>0.0400</td>
<td>0.0101</td>
<td>0.0107</td>
<td>0.0779</td>
<td>0.0249</td>
<td>0.0291</td>
<td>0.5410</td>
<td>0.0173</td>
<td>0.0113</td>
<td>0.1345</td>
<td>0.0767</td></tr>
<tr>
<td colspan="13"><italic>Panel B: Without p-c LEDs</italic><hr/></td></tr>
<tr>
<td>nm</td>
<td>401.8</td>
<td>416.3</td>
<td>450</td>
<td>481</td>
<td>505</td>
<td>530</td>
<td>560</td>
<td>588</td>
<td>610</td>
<td>635</td>
<td>655</td>
<td>700</td></tr>
<tr>
<td>c<sub>i</sub></td>
<td>0.0566</td>
<td>0.1781</td>
<td>0.2612</td>
<td>0.1851</td>
<td>0.1930</td>
<td>0.2875</td>
<td>0.2840</td>
<td>0.1292</td>
<td>0.2649</td>
<td>0.0485</td>
<td>0.3417</td>
<td>0.2522</td></tr>
<tr>
<td>Δ<italic>p</italic></td>
<td>0.0174</td>
<td>0.0521</td>
<td>0.1022</td>
<td>0.0653</td>
<td>0.0704</td>
<td>0.1281</td>
<td>0.1245</td>
<td>0.0390</td>
<td>0.0937</td>
<td>0.0125</td>
<td>0.1390</td>
<td>0.1255</td></tr>
</tbody>
</table>
</table-wrap>
</p>
<p>The reason for the second effect is that the removed sub-norm <inline-formula id="ilm98-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math98-1477153511428026"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula> in the LED set with p-c LEDs is smaller than that of the LED set without p-c LEDs. This can also be verified by comparing the 12-LED sets in <xref ref-type="table" rid="table5-1477153511428026">Table 5</xref>. Most of <inline-formula id="ilm99-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math99-1477153511428026"><mml:mrow><mml:mi>Δ</mml:mi><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:msup><mml:mtext>s</mml:mtext></mml:mrow></mml:math></inline-formula> of the 12-LEDs with p-c LEDs are smaller than the 12-LED set without p-c LEDs. Thus, the resultant <inline-formula id="ilm100-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math100-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is greater than that of the LED set without p-c LEDs. This implies that the synthesis performance of the LED set with p-c LEDs is better than the LED set without p-c LEDs at the same but small number of LEDs.</p>
<p>LEDs with broader FWHMs such as p-c LEDs are not suggested for synthesizing standard illumination systems with very small colour differences in <italic>L</italic><sup>*</sup><italic>a</italic><sup>*</sup><italic>b</italic><sup>*</sup> space (<inline-formula id="ilm101-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math101-1477153511428026"><mml:mrow><mml:mi>Δ</mml:mi><mml:msubsup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>ab</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>) or high CRI such as greater than 99.9 for calibration or photometric measurement purposes. To obtain these levels of performance requires many LEDs with small FWHMs. In order to have many LEDs, the p-c LEDs cannot be included according to the first effect. Conversely, to synthesize illumination systems with a medium level of <inline-formula id="ilm102-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math102-1477153511428026"><mml:mrow><mml:mi>Δ</mml:mi><mml:msubsup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>ab</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, or a CRI under 95 but greater than 85 for general lighting uses such as tunable smart lighting, fewer LEDs are required. To have fewer LEDs, p-c LEDs are included to enhance the synthesis performance according to the second effect.</p>
</sec>
<sec id="sec9-1477153511428026"><title>3.2. Simulations with p-c LEDs included</title>
<p>Next, the results of the proposed optimal pruning process and the negative-pruning process obtained from an LED set containing p-c LEDs being used to imitate the SPDs of the CIE illuminants A, D-series and E are compared. The merit indices are the goodness-of-fit coefficient (GFC),<sup><xref ref-type="bibr" rid="bibr12-1477153511428026">12</xref></sup> the colour difference in <inline-formula id="ilm103-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math103-1477153511428026"><mml:mrow><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> space,<inline-formula id="ilm104-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math104-1477153511428026"><mml:mrow><mml:mi>Δ</mml:mi><mml:msubsup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>ab</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and the CRI.</p>
<p>We use the above 61 LED set with four p-c LEDs shown in <xref ref-type="table" rid="table3-1477153511428026">Table 3</xref>. This LED set has <inline-formula id="ilm105-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math105-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> = 2.54799 &gt;&gt; 1 for synthesizing <inline-formula id="ilm106-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math106-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>avg</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo/><mml:mo>(</mml:mo></mml:mrow><mml:mi>λ</mml:mi><mml:mrow><mml:mo/><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The pruning process starts by removing the LED with the maximum sub-norm repeatedly until <inline-formula id="ilm107-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math107-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> = 1.00587. Then, the pruning process removes the LED with the least sub-norm. Finally, a 12-LED set is obtained with all the positive coefficients shown in the upper part of <xref ref-type="table" rid="table5-1477153511428026">Table 5</xref>. The SPDs of these LEDs are shown in <xref ref-type="fig" rid="fig1-1477153511428026">Figure 1</xref>.
<fig id="fig1-1477153511428026" position="float"><label>Figure 1.</label><caption><p>The SPDs of the proposed optimal 12-LED set with two p-c LEDs shown in the upper part of <xref ref-type="table" rid="table5-1477153511428026">Table 5</xref></p></caption><graphic xlink:href="10.1177_1477153511428026-fig1.tif"/>
</fig></p>
<p>This 12-LED set is the same as the one obtained by the full-search method by picking the LED set with the least SE from <inline-formula id="ilm108-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math108-1477153511428026"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mfrac linethickness="0"><mml:mrow><mml:mn>18</mml:mn></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>=18 564 LED combinations. Here, we do not actually use <inline-formula id="ilm109-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math109-1477153511428026"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mfrac linethickness="0"><mml:mrow><mml:mn>61</mml:mn></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> combinations for the full-search method owing to the huge number of LED combinations. Instead, we select the 12 LEDs from the 18 LEDs used in the full-search method. The 18 LEDs come from the 61 LEDs by removing one LED and calculating the associated SE in turn. At the beginning, there are 61 SEs and the LED with the greatest SE is removed from the 61 LEDs to form 60 LEDs. By repeatedly doing this until 18 LEDs is reached, the 18 LEDs synthesize the spectrum with least SE. Therefore, the set selected from <inline-formula id="ilm110-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math110-1477153511428026"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mfrac linethickness="0"><mml:mrow><mml:mn>18</mml:mn></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> will be the same as that selected from <inline-formula id="ilm111-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math111-1477153511428026"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mfrac linethickness="0"><mml:mrow><mml:mn>61</mml:mn></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
<p>The other 12-LED set, obtained by the negative-coefficient pruning process is given in <xref ref-type="table" rid="table6-1477153511428026">Table 6</xref>. In the negative-coefficient pruning process,<sup><xref ref-type="bibr" rid="bibr9-1477153511428026">9</xref></sup> the LED whose synthesis coefficient is negative and with the least absolute value in the spectrum synthesized by the 61-LED set is removed to form a new 60-LED set. This process is repeated until a 12-LED set is reached.
<table-wrap id="table6-1477153511428026" position="float"><label>Table 6.</label><caption><p>The 12-LED set obtained by the negative-coefficient pruning process from the 61-LED set with p-c LEDs given in <xref ref-type="table" rid="table3-1477153511428026">Table 3</xref></p></caption>
<graphic alternate-form-of="table6-1477153511428026" xlink:href="10.1177_1477153511428026-table6.tif"/>
<table frame="hsides"><thead align="left">
<tr><th colspan="7">12 LEDs by negative-coefficient pruning process</th></tr></thead>
<tbody align="left">
<tr>
<td>Peak wavelength</td>
<td>401.8</td>
<td>430</td>
<td>Blue-pc LED</td>
<td>465</td>
<td>481</td>
<td>514</td></tr>
<tr>
<td>FWHM</td>
<td>30 nm</td>
<td>30 nm</td>
<td>60 nm</td>
<td>30 nm</td>
<td>30 nm</td>
<td>30 nm</td></tr>
<tr>
<td>Peak wavelength</td>
<td>Yellow-pc LED</td>
<td>575</td>
<td>594 nm</td>
<td>635 nm</td>
<td>655 nm</td>
<td>700 nm</td></tr>
<tr>
<td>FWHM</td>
<td>140 nm</td>
<td>30 nm</td>
<td>40 nm</td>
<td>50 nm</td>
<td>50 nm</td>
<td>45 nm</td></tr>
</tbody>
</table>
</table-wrap></p>
<p>The synthesis performance merit indices for the five illuminants achieved by the proposed pruning process and the negative-coefficient pruning process are given in <xref ref-type="table" rid="table7-1477153511428026">Table 7</xref>. From this table, the proposed pruning process has much better performance than the negative-pruning process which shows that the averaged <inline-formula id="ilm112-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math112-1477153511428026"><mml:mrow><mml:mi>Δ</mml:mi><mml:msubsup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>ab</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and SE of the former are only half of the latter. The synthesized spectra of the illuminants A, <inline-formula id="ilm113-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math113-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mtext>D</mml:mtext></mml:mrow><mml:mrow><mml:mn>65</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and E by the proposed method are shown in <xref ref-type="fig" rid="fig2-1477153511428026">Figure 2</xref>. 12 LEDs are the maximum number that this 61-LED set with p-c LEDs can generate and the corresponding merit indices are the best that this 61-LED pool can achieve if p-c LEDs are included.
<fig id="fig2-1477153511428026" position="float"><label>Figure 2.</label><caption><p>Spectra of the illuminants A, <inline-formula id="ilm114-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math114-1477153511428026"><mml:mrow><mml:msub><mml:mrow><mml:mtext>D</mml:mtext></mml:mrow><mml:mrow><mml:mn>65</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and E synthesized by the proposed 12-LED set with two p-c LEDs included. The <inline-formula id="ilm115-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math115-1477153511428026"><mml:mrow><mml:mi>Δ</mml:mi><mml:msubsup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>ab</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and SE values of these three illuminants are 0.12497, 0.00051; 0.13235, 0.00091; and 0.11432, 0.00079, respectively</p></caption><graphic xlink:href="10.1177_1477153511428026-fig2.tif"/>
</fig>
<table-wrap id="table7-1477153511428026" position="float"><label>Table 7.</label><caption><p>Synthesis performance metrics for the five SPDs simulated by the 12-LED sets with 2 p-c LEDs obtained by the proposed method and the negative-pruning method (GFC = goodness of fit coefficient)</p></caption>
<graphic alternate-form-of="table7-1477153511428026" xlink:href="10.1177_1477153511428026-table7.tif"/>
<table frame="hsides"><thead align="left">
<tr><th rowspan="2">Illuminants</th>
<th colspan="4">Metrics<hr/></th></tr>
<tr><th/>
<th>GFC</th>
<th><inline-formula id="ilm116-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math116-1477153511428026"><mml:mrow><mml:mi>Δ</mml:mi><mml:msubsup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>ab</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula></th>
<th>SE</th>
<th>CRI</th></tr></thead>
<tbody align="left">
<tr>
<td colspan="5"><italic>Panel A: 12 LEDs by proposed algorithm</italic></td></tr>
<tr>
<td>A</td>
<td>0.999709</td>
<td>0.124975</td>
<td>0.000508</td>
<td>99.9</td></tr>
<tr>
<td>D65</td>
<td>0.999657</td>
<td>0.132351</td>
<td>0.000906</td>
<td>99.9</td></tr>
<tr>
<td>D55</td>
<td>0.999582</td>
<td>0.152907</td>
<td>0.000989</td>
<td>99.9</td></tr>
<tr>
<td>D50</td>
<td>0.999487</td>
<td>0.172084</td>
<td>0.000993</td>
<td>99.9</td></tr>
<tr>
<td>E</td>
<td>0.999707</td>
<td>0.114321</td>
<td>0.000542</td>
<td>99.5</td></tr>
<tr>
<td>Average</td>
<td>0.999628</td>
<td>0.139328</td>
<td>0.000788</td>
<td>99.8</td></tr>
<tr>
<td colspan="5"><italic>Panel B: 12 LEDs by negative-coefficient pruning process</italic></td></tr>
<tr>
<td>A</td>
<td>0.999398</td>
<td>0.230276</td>
<td>0.001204</td>
<td>99.8</td></tr>
<tr>
<td>D65</td>
<td>0.999156</td>
<td>0.294537</td>
<td>0.001687</td>
<td>99.7</td></tr>
<tr>
<td>D55</td>
<td>0.999145</td>
<td>0.295222</td>
<td>0.001711</td>
<td>99.7</td></tr>
<tr>
<td>D50</td>
<td>0.999141</td>
<td>0.294831</td>
<td>0.001718</td>
<td>99.7</td></tr>
<tr>
<td>E</td>
<td>0.999383</td>
<td>0.233975</td>
<td>0.001235</td>
<td>99.5</td></tr>
<tr>
<td>Average</td>
<td>0.999244</td>
<td>0.269768</td>
<td>0.001511</td>
<td>99.7</td></tr>
</tbody>
</table>
</table-wrap></p>
</sec>
<sec id="sec10-1477153511428026"><title>3.3. Simulations of a LED set without p-c LEDs</title>
<p>In this section, a set of 61 LEDs without p-c LEDs are used to extract the optimal sets for comparing the results with the set obtained in Section 3.2 and for verifying the effects of p-c LEDs discussed in Section 3.1.</p>
<p>The 61-LED set, which is the same as the LEDs in <xref ref-type="table" rid="table3-1477153511428026">Table 3</xref> but replacing the four p-c LEDs by four LEDs with the same peak wavelengths and FWHMs of 30 nm, is used for the simulation. The resulting LED sets can be 20-, 16-, 15- or 12-LEDs, all with positive synthesis coefficients. The maximum number of LEDs while preserving positive coefficients is 20. The simulation results of these LED sets are shown in <xref ref-type="table" rid="table8-1477153511428026">Table 8</xref>. From the table, the synthesis performance, in the sense of greater GFC and CRI, smaller <inline-formula id="ilm117-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math117-1477153511428026"><mml:mrow><mml:mi>Δ</mml:mi><mml:msubsup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>ab</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and SE, of the 20-LED set is the best compared with any other set obtained from these 61 LEDs.
<table-wrap id="table8-1477153511428026" position="float"><label>Table 8.</label><caption><p>Synthesis performance metrics for LED sets of different size obtained by the proposed pruning process applied to the 61-LED set obtained by replacing the 4 p-c LEDs in <xref ref-type="table" rid="table3-1477153511428026">Table 3</xref> by 4 LEDs with the same emission peak wavelength and a FWHM of 30 nm. In terms of greater goodness of fit coefficient (GFC) and CRI and smaller <inline-formula id="ilm118-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math118-1477153511428026"><mml:mrow><mml:mi>Δ</mml:mi><mml:msubsup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>ab</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and SE, the 20 LED set is the best. It is also much better than the 12 LED set with 2 p-c LEDs shown in the upper part of <xref ref-type="table" rid="table7-1477153511428026">Table 7</xref>. However, the performance metrics of the 12 LED set with two p-c LEDs is close to the performance to the 16 LED set but is much better than the 15 and 12 LED sets shown. This result demonstrates that the use of p-c LEDs can enhance synthesis performance for small size LED sets, but not for a large size LED set</p></caption>
<graphic alternate-form-of="table8-1477153511428026" xlink:href="10.1177_1477153511428026-table8.tif"/>
<table frame="hsides"><thead align="left">
<tr><th rowspan="2">Illuminants</th>
<th colspan="4">Metrics<hr/></th></tr>
<tr><th/>
<th>GFC</th>
<th><inline-formula id="ilm119-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math119-1477153511428026"><mml:mrow><mml:mi>Δ</mml:mi><mml:msubsup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>ab</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula></th>
<th>SE</th>
<th>CRI</th></tr></thead>
<tbody align="left">
<tr>
<td colspan="5"><italic>Panel A: 20 LEDs</italic></td></tr>
<tr>
<td>A</td>
<td>0.99994</td>
<td>0.0009951</td>
<td>0.000087</td>
<td>99.9</td></tr>
<tr>
<td>D65</td>
<td>0.99993</td>
<td>0.001001</td>
<td>0.000113</td>
<td>99.9</td></tr>
<tr>
<td>D55</td>
<td>0.99993</td>
<td>0.001007</td>
<td>0.000115</td>
<td>99.9</td></tr>
<tr>
<td>D50</td>
<td>0.99992</td>
<td>0.001004</td>
<td>0.000122</td>
<td>99.9</td></tr>
<tr>
<td>E</td>
<td>0.99993</td>
<td>0.001005</td>
<td>0.000094</td>
<td>99.9</td></tr>
<tr>
<td>Average</td>
<td>0.99993</td>
<td>0.001002</td>
<td>0.000106</td>
<td>99.9</td></tr>
<tr>
<td colspan="5"><italic>Panel B: 16 LEDs</italic></td></tr>
<tr>
<td>A</td>
<td>0.999744</td>
<td>0.102201</td>
<td>0.000549</td>
<td>99.9</td></tr>
<tr>
<td>D65</td>
<td>0.999661</td>
<td>0.113226</td>
<td>0.000629</td>
<td>99.9</td></tr>
<tr>
<td>D55</td>
<td>0.999668</td>
<td>0.112798</td>
<td>0.000637</td>
<td>99.9</td></tr>
<tr>
<td>D50</td>
<td>0.999652</td>
<td>0.113417</td>
<td>0.000709</td>
<td>99.9</td></tr>
<tr>
<td>E</td>
<td>0.999860</td>
<td>0.099166</td>
<td>0.000339</td>
<td>99.9</td></tr>
<tr>
<td>Average</td>
<td>0.999717</td>
<td>0.108162</td>
<td>0.000573</td>
<td>99.9</td></tr>
<tr>
<td colspan="5"><italic>Panel C: 15 LEDs</italic></td></tr>
<tr>
<td>A</td>
<td>0.999325</td>
<td>0.292950</td>
<td>0.035784</td>
<td>99.8</td></tr>
<tr>
<td>D65</td>
<td>0.999101</td>
<td>0.311525</td>
<td>0.040614</td>
<td>99.8</td></tr>
<tr>
<td>D55</td>
<td>0.999160</td>
<td>0.310797</td>
<td>0.039411</td>
<td>99.8</td></tr>
<tr>
<td>D50</td>
<td>0.999195</td>
<td>0.318705</td>
<td>0.038673</td>
<td>99.8</td></tr>
<tr>
<td>E</td>
<td>0.999316</td>
<td>0.300476</td>
<td>0.035994</td>
<td>99.8</td></tr>
<tr>
<td>Average</td>
<td>0.999219</td>
<td>0.306891</td>
<td>0.038095</td>
<td>99.8</td></tr>
<tr>
<td colspan="5"><italic>Panel D: 12 LEDs</italic></td></tr>
<tr>
<td>A</td>
<td>0.993271</td>
<td>2.124625</td>
<td>0.106059</td>
<td>99.5</td></tr>
<tr>
<td>D65</td>
<td>0.992964</td>
<td>2.110152</td>
<td>0.108409</td>
<td>99.5</td></tr>
<tr>
<td>D55</td>
<td>0.993148</td>
<td>2.129969</td>
<td>0.107005</td>
<td>99.5</td></tr>
<tr>
<td>D50</td>
<td>0.993269</td>
<td>2.138169</td>
<td>0.106071</td>
<td>99.5</td></tr>
<tr>
<td>E</td>
<td>0.993313</td>
<td>2.101455</td>
<td>0.105735</td>
<td>99.5</td></tr>
<tr>
<td>Average</td>
<td>0.993193</td>
<td>2.120874</td>
<td>0.106656</td>
<td>99.5</td></tr>
</tbody>
</table>
</table-wrap></p>
<p>Comparing synthesis performance, the 20-LED set without p-c LEDs in <xref ref-type="table" rid="table8-1477153511428026">Table 8</xref> is much better than that of the 12-LED set with p-c LEDs in the upper part of <xref ref-type="table" rid="table7-1477153511428026">Table 7</xref>. This implies that to obtain better synthesis performance, more LEDs are required and p-c LEDs not allowed. This verifies the first effect discussed in Section 3.1. However, comparing synthesis performance, the proposed 12-LED set with two p-c LEDs in the upper part of <xref ref-type="table" rid="table7-1477153511428026">Table 7</xref> is only a little bit worse than the 16-LED set in <xref ref-type="table" rid="table8-1477153511428026">Table 8</xref>, but is much better than the 15- and 12-LED sets in <xref ref-type="table" rid="table8-1477153511428026">Table 8</xref>. This is the second effect discussed in Section 3.1, that p-c LEDs can be included to enhance the performance for an LED set with fewer LEDs. This shows the advantage of using p-c LEDs. This is the trade-off between FWHM and the number of LEDs discussed in Section 3.1. This implies that we must use different starting sets depending what type of spectrum we want to synthesize. LEDs with broader SPDs are better for some spectra while narrower SPDs are better for others.</p>
<p>The LED set in the upper part of <xref ref-type="table" rid="table5-1477153511428026">Table 5</xref> is tailored by our algorithm to synthesize the five illuminants with correlated colour temperatures ranging from 2800 K to 6500 K. An out-of-class test is performed. The out-of-class illuminants, such as blackbody radiation at 2000 K to 10 000 K, are synthesized by the LED set. The performance metrics achieved by the LED set are shown in <xref ref-type="table" rid="table9-1477153511428026">Table 9</xref>. By comparing <xref ref-type="table" rid="table9-1477153511428026">Table 9</xref> and the upper part of <xref ref-type="table" rid="table7-1477153511428026">Table 7</xref>, the average synthesis of blackbody radiation over the range 2000–10 000 K has better performance than that synthesizing the five illuminants. This is because the SPDs of the illuminant D-series are not smooth, so they are not suitable for synthesizing using LEDs with broader FWHMs and with fewer LEDs. Also, this selected LED set is not suitable for imitating spectra which vary greatly in their SPDs, such as fluorescent light sources owing to the FWHMs of the LEDs being larger than 30 nm. To have very good synthesis performance or to imitate fluorescent light sources, the LEDs should have narrower FWHMs.
<table-wrap id="table9-1477153511428026" position="float"><label>Table 9.</label><caption><p>Synthesis performance metrics for the SPDs of blackbody radiation in the range 200 0K to 10 000K by the proposed 12-LED set with 2 p-c LEDs given in the upper part of <xref ref-type="table" rid="table5-1477153511428026">Table 5</xref></p></caption>
<graphic alternate-form-of="table9-1477153511428026" xlink:href="10.1177_1477153511428026-table9.tif"/>
<table frame="hsides"><thead align="left">
<tr><th rowspan="2">Illuminants</th>
<th colspan="4">Metrics<hr/></th></tr>
<tr><th/>
<th>GFC</th>
<th><inline-formula id="ilm120-1477153511428026"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math120-1477153511428026"><mml:mrow><mml:mi>Δ</mml:mi><mml:msubsup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>ab</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula></th>
<th>SE</th>
<th>CRI</th></tr></thead>
<tbody align="left">
<tr>
<td>2000 K</td>
<td>0.999840</td>
<td>0.097985</td>
<td>0.000472</td>
<td>99.9</td></tr>
<tr>
<td>3000 K</td>
<td>0.999858</td>
<td>0.094667</td>
<td>0.000440</td>
<td>99.9</td></tr>
<tr>
<td>4000 K</td>
<td>0.999871</td>
<td>0.091660</td>
<td>0.000416</td>
<td>99.9</td></tr>
<tr>
<td>5000 K</td>
<td>0.999878</td>
<td>0.098137</td>
<td>0.000403</td>
<td>99.9</td></tr>
<tr>
<td>6000 K</td>
<td>0.999880</td>
<td>0.095902</td>
<td>0.000400</td>
<td>99.9</td></tr>
<tr>
<td>7000 K</td>
<td>0.999849</td>
<td>0.098954</td>
<td>0.000456</td>
<td>99.9</td></tr>
<tr>
<td>8000 K</td>
<td>0.999940</td>
<td>0.089078</td>
<td>0.000429</td>
<td>99.9</td></tr>
<tr>
<td>9000 K</td>
<td>0.999958</td>
<td>0.086061</td>
<td>0.000400</td>
<td>99.9</td></tr>
<tr>
<td>10 000 K</td>
<td>0.999971</td>
<td>0.083327</td>
<td>0.000378</td>
<td>99.9</td></tr>
<tr>
<td>Average</td>
<td>0.999894</td>
<td>0.092864</td>
<td>0.000422</td>
<td>99.9</td></tr>
</tbody>
</table>
</table-wrap></p>
</sec>
</sec>
<sec id="sec11-1477153511428026" sec-type="conclusions"><title>4. Conclusions</title>
<p>Theoretically, the peak emission wavelengths and the FWHMs of LEDs can be arbitrarily different, and practically those of commercial LEDs are very diverse. Thus, how to select optimal LEDs for a multi-channel LED light source designed to realize spectrum-tunable lighting is a key problem which has not been discussed previously. In this paper, the optimal selection of LEDs for synthesizing the SPDs of a group of illuminants is presented. This is based on using a smallest SE process to prune LEDs from a set of available LEDs. As a result, the optimal LED set obtained by the proposed method is the same as that obtained by the full-search method which is not practical if the number of the available LEDs is large. The proposed method concentrates on using available LEDs to synthesize the CIE standard illuminants and the blackbody radiator, instead of using the hypothetical LEDs which may be obtained by the principal component analysis method.<sup><xref ref-type="bibr" rid="bibr7-1477153511428026">7</xref>,<xref ref-type="bibr" rid="bibr13-1477153511428026">13</xref></sup></p>
<p>Owing to the trade-off between the FWHM and the number of LEDs, for a lighting system requiring a high level of synthesis performance such as for imitating the CIE standard illuminants used in many photometric facilities for calibration or colour matching, the LED set should have more narrow-band LEDs and no p-c LEDs. A lighting system with a medium level of synthesis performance used for implementing tunable illumination spectra for general lighting with high CRI, such as smart indoor lighting, requires a LED set with fewer LEDs including some p-c LEDs.</p>
<p>Once the LED set is determined, the next two key problems for multi-channel LED lighting are optimal selection of the radiant flux for each LED and the compensation of the peak wavelength shift due to temperature increase. These two issues are related to synthesis coefficients and worthy of further investigation.</p>
</sec>
</body>
<back>
<sec id="sec12-1477153511428026"><title>Funding</title>
<p>This work has been supported by the Intelligent Building Research Center of National Taiwan University of Science and Technology and partially by NSC 97-2221-E-011-016.</p>
</sec>
<ref-list>
<title>References</title>
<ref id="bibr1-1477153511428026"><label>1</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Žukauskas</surname><given-names>A</given-names></name><name><surname>Vaicekauskas</surname><given-names>R</given-names></name><name><surname>Ivanauskas</surname><given-names>F</given-names></name><name><surname>Gaska</surname><given-names>R</given-names></name><name><surname>Shur</surname><given-names>MS</given-names></name></person-group>. <article-title>Optimization of white polychromatic semiconductor lamps</article-title>. <source>Applied Physics Letters</source> <year>2002</year>; <volume>80</volume>: <fpage>234</fpage>–<lpage>236</lpage>.</citation></ref>
<ref id="bibr2-1477153511428026"><label>2</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ohno</surname><given-names>Y</given-names></name></person-group>. <article-title>Spectral design considerations for white LED color rendering</article-title>. <source>Optical Engineering</source> <year>2005</year>; <volume>44</volume>: <fpage>111302</fpage>–<lpage>111302</lpage>.</citation></ref>
<ref id="bibr3-1477153511428026"><label>3</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Mirhosseini</surname><given-names>R</given-names></name><name><surname>Schubert</surname><given-names>MF</given-names></name><name><surname>Chhajed</surname><given-names>S</given-names></name><name><surname>Cho</surname><given-names>J</given-names></name><name><surname>Kim</surname><given-names>JK</given-names></name><name><surname>Schubert</surname><given-names>EF</given-names></name></person-group>. <article-title>Improved color rendering and luminous efficacy in phosphor-converted white light-emitting diodes by use of dual-blue emitting active regions</article-title>. <source>Optical Express</source> <year>2009</year>; <volume>17</volume>: <fpage>10806</fpage>–<lpage>10813</lpage>.</citation></ref>
<ref id="bibr4-1477153511428026"><label>4</label><citation citation-type="other"><comment>Chalmers A, Soltic S. Towards the optimum light source spectrum. <italic>Advances in OptoElectronics.</italic> 2010; 2010: 9</comment>.</citation></ref>
<ref id="bibr5-1477153511428026"><label>5</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ries</surname><given-names>H</given-names></name><name><surname>Leike</surname><given-names>I</given-names></name></person-group>. <article-title>Optimal additive mixing of colored light-emitting diodes sources</article-title>. <source>Optical Engineering</source> <year>2004</year>; <volume>43</volume>: <fpage>1531</fpage>–<lpage>1536</lpage>.</citation></ref>
<ref id="bibr6-1477153511428026"><label>6</label><citation citation-type="other"><comment>Wenger A, Hawkins T, Debevec P. <italic>Optimizing color matching in a lighting reproduction system for complex subject and illuminant spectra</italic>: Proceedings of the 14th Eurographics Symposium on Rendering, Leuven, Belgium, June 25–27: 2003. Geneva, Switzerland: The Eurographics Association, pp. 249–259</comment>.</citation></ref>
<ref id="bibr7-1477153511428026"><label>7</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Fryc</surname><given-names>I</given-names></name><name><surname>Brown</surname><given-names>SW</given-names></name><name><surname>Eppeldauer</surname><given-names>GP</given-names></name><name><surname>Ohno</surname><given-names>Y</given-names></name></person-group>. <article-title>LED-based spectrally tunable source for radiometric, photometric, and colorimetric applications</article-title>. <source>Optical Engineering</source> <year>2005</year>; <volume>44</volume>: <fpage>111309</fpage>–<lpage>111309</lpage>.</citation></ref>
<ref id="bibr8-1477153511428026"><label>8</label><citation citation-type="other"><comment>Miller C, Ohno Y, Davis W, Zong Y, Dowling K. <italic>NIST spectrally tunable lighting facility for color rendering and lighting experiments</italic>: Proceedings of CIE 2009 Light and Lighting Conference with Special Reference to LEDs and Solid State Lighting, Budapest, Hungary, May 27–29: 2009: Vienna: CIE, pp. 5</comment>.</citation></ref>
<ref id="bibr9-1477153511428026"><label>9</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hu</surname><given-names>NC</given-names></name><name><surname>Wu</surname><given-names>CC</given-names></name><name><surname>Chen</surname><given-names>SF</given-names></name><name><surname>Hsiao</surname><given-names>HC</given-names></name></person-group>. <article-title>Implementing dynamic daylight spectra with light-emitting diodes</article-title>. <source>Applied Optics</source> <year>2008</year>; <volume>47</volume>: <fpage>3423</fpage>–<lpage>3432</lpage>.</citation></ref>
<ref id="bibr10-1477153511428026"><label>10</label><citation citation-type="book"><person-group person-group-type="author"><name><surname>Watkins</surname><given-names>DS</given-names></name></person-group>. <source>Fundamentals of Matrix Computations</source> , <publisher-loc>New York</publisher-loc>: <publisher-name>John Wiley and Sons</publisher-name>, <year>1991</year>.</citation></ref>
<ref id="bibr11-1477153511428026"><label>11</label><citation citation-type="book"><person-group person-group-type="author"><name><surname>Papoulis</surname><given-names>A</given-names></name></person-group>. <source>Probability, Random Variables, and Stochastic Process</source> <year>1984</year>. <comment>2nd Edition</comment>, <publisher-loc>New York</publisher-loc>: <publisher-name>McGraw-Hill</publisher-name>.</citation></ref>
<ref id="bibr12-1477153511428026"><label>12</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Romero</surname><given-names>J</given-names></name><name><surname>García-Beltrán</surname><given-names>A</given-names></name><name><surname>Hernández-Andrés</surname><given-names>J</given-names></name></person-group>. <article-title>Linear bases for representation of natural and artificial illuminants</article-title>. <source>Journal of the Optical Society of America</source> <year>1997</year>; <volume>A 14</volume>: <fpage>1007</fpage>–<lpage>1014</lpage>.</citation></ref>
<ref id="bibr13-1477153511428026"><label>13</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hu</surname><given-names>NC</given-names></name><name><surname>Wu</surname><given-names>CC</given-names></name></person-group>. <article-title>Optimal selection of commercial sensors for linear model representation of daylight spectra</article-title>. <source>Applied Optics</source> <year>2008</year>; <volume>47</volume>: <fpage>3114</fpage>–<lpage>3123</lpage>.</citation></ref>
</ref-list>
</back>
</article>