<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v2.3 20070202//EN" "journalpublishing.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">SMM</journal-id>
<journal-id journal-id-type="hwp">spsmm</journal-id>
<journal-id journal-id-type="nlm-ta">Stat Methods Med Res</journal-id>
<journal-title>Statistical Methods in Medical Research</journal-title>
<issn pub-type="ppub">0962-2802</issn>
<issn pub-type="epub">1477-0334</issn>
<publisher>
<publisher-name>SAGE Publications</publisher-name>
<publisher-loc>Sage UK: London, England</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1177/0962280212446328</article-id>
<article-id pub-id-type="publisher-id">10.1177_0962280212446328</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Articles</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Bayesian point event modeling in spatial and environmental epidemiology</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<name><surname>Lawson</surname><given-names>Andrew B</given-names></name>
<xref ref-type="corresp" rid="corresp1-0962280212446328"/>
</contrib>
<aff id="aff1-0962280212446328">Division of Biostatistics &amp; Epidemiology, College of Medicine, Medical University of South Carolina, Charleston, SC, USA</aff>
</contrib-group>
<contrib-group content-type="issue">
<contrib contrib-type="guest-editor">
<name><surname>Lawson</surname><given-names>Andrew B</given-names></name>
</contrib>
<contrib contrib-type="guest-editor">
<name><surname>Cocchi</surname><given-names>Daniela</given-names></name>
</contrib>
<contrib contrib-type="guest-editor">
<name><surname>Banerjee</surname><given-names>Sudipto</given-names></name>
</contrib>
<contrib contrib-type="guest-editor">
<name><surname>Brown</surname><given-names>Patrick</given-names></name>
</contrib>
</contrib-group>
<author-notes>
<corresp id="corresp1-0962280212446328">Andrew B Lawson, Division of Biostatistics &amp; Epidemiology, College of Medicine, Medical University of South Carolina, Charleston, SC, USA. Email: <email>lawsonab@musc.edu</email></corresp>
</author-notes>
<pub-date pub-type="epub-ppub">
<month>10</month>
<year>2012</year>
</pub-date>
<volume>21</volume>
<issue>5</issue>
<issue-title>Special Issue: GEOMED 2011</issue-title>
<fpage>509</fpage>
<lpage>529</lpage>
<permissions>
<copyright-statement>© The Author(s) 2012 Reprints and permissions: sagepub.co.uk/journalsPermissions.nav</copyright-statement>
<copyright-year>2012</copyright-year>
<copyright-holder content-type="sage">SAGE Publications</copyright-holder>
</permissions>
<abstract>
<p>This paper reviews the current state of point event modeling in spatial epidemiology from a Bayesian perspective. Point event (or case event) data arise when geo-coded addresses of disease events are available. Often, this level of spatial resolution would not be accessible due to medical confidentiality constraints. However, for the examination of small spatial scales, it is important to be capable of examining point process data directly. Models for such data are usually formulated based on point process theory. In addition, special conditioning arguments can lead to simpler Bernoulli likelihoods and logistic spatial models. Goodness-of-fit diagnostics and Bayesian residuals are also considered. Applications within putative health hazard risk assessment, cluster detection, and linkage to environmental risk fields (misalignment) are considered.</p>
</abstract>
<kwd-group>
<kwd>Case event</kwd>
<kwd>point event</kwd>
<kwd>point process</kwd>
<kwd>logistic</kwd>
<kwd>Bayesian</kwd>
<kwd>Poisson process</kwd>
<kwd>Cox process</kwd>
<kwd>log Gaussian process</kwd>
<kwd>semi-parametric</kwd>
<kwd>putative hazard</kwd>
<kwd>predictor fields</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="sec1-0962280212446328" sec-type="intro"><title>1 Introduction</title>
<p>Bayesian modeling of small area count data has seen considerable advances in recent times.<sup><xref ref-type="bibr" rid="bibr1-0962280212446328">1</xref></sup><sup>–</sup><sup><xref ref-type="bibr" rid="bibr3-0962280212446328">3</xref></sup> This is partly due to the availability of such data and its ready application. However, there has been little development of equivalent modeling of geo-referenced address data. Address data naturally form point processes in space and the modeling of such data is often either prohibited due to confidentiality restrictions on health records or because the models are less familiar to the practitioners. A recent technical review of these point process models and approaches is found in Møller and Waagpeteresen.<sup><xref ref-type="bibr" rid="bibr4-0962280212446328">4</xref></sup> It is the purpose of this review to examine the application of Bayesian methods where geo-referenced health outcome data is the natural format. Most of this paper will focus on spatial models and spatial data, but in a later section (Section 7). I will briefly examine the issues related to spatio-temporal case event data and modeling.</p>
<p>The rest of the paper is laid out as follows. In the next sections, I discuss the sources of data, the nature of geo-referenced health data, and the use of control diseases to represent population effects. In the subsequent section, I examine basic models for this data and define the Bayesian context for such models. In particular, I examine the heterogeneous Poisson Process (HPP) model and its extension to a log Gaussian Cox Process (LGCP) and spatial cluster processes. Following that I review specific application areas where Bayesian model have or can be applied. Finally I summarize the current state of development and suggest areas for future work. An appendix with program code is also provided for a selection of the examples.</p>
</sec>
<sec id="sec2-0962280212446328"><title>2 Data sources</title>
<p>Geo-coded address data, also known as <italic>case event</italic> data, is found where a point location is used to represent the residential address of a case of disease. Hence, a sample of street addresses of disease cases yields case event data. Whereas if only a postal code or zip code or other arbitrary area is known for the cases, then (usually) only a count of disease can be analyzed within that area. The distinction between case event and count data is blurred by the fact that counts are just a spatially-aggregated form of case event data. However, when point locations are available, a substantially different form of analysis must be performed.</p>
<p>Usually, geo-coded address data are found where studies focus on relatively small spatial windows. When considering, for example, the effects of an environmental pollution source on surrounding communities, it may be important to consider a scale of analysis that is defined within a study window of only a few kilometers or miles. Because the scale of postal or census regions is often large by comparison, it would not be feasible in these cases to examine the aggregated counts of disease due to the inherent smoothing of the risk variation. In short, the risk variation would be smoothed out by aggregation.</p>
<p>The use of such case event data has many advantages and some disadvantages. First of all the data is held at the individual case level and so could be augmented by individual covariates or predictors thought to be relevant in the analysis. On the other hand, the use of a residential address may be questioned in that it is used to represent the assumed point at which exposure has taken place. How appropriate this location is will depend on prior understanding of the exposure process and disease etiology.</p>
<p>Case event data can be obtained from local departments of health but are usually subject to stringent confidentiality restrictions. Usually, individual level data requests from health departments are subject to concerns about identification of patients. Hence address data must be handled with care. A map at a fine level of resolution could lead to identification of individual patients (even when individual identifiers are not held in the data set). Hence, the mapping of such data and its public presentation may also be subject to restrictions in addition to de-identification of patients before analysis.</p>
</sec>
<sec id="sec3-0962280212446328"><title>3 Control diseases</title>
<p>As in the analysis of count data in aggregate spatial units, it is important to account for the population underlying the case event data. All disease events occur within a population which has a spatially varying density and also varies from place to place in its demographic composition. Because some population groups have greater or lesser susceptibility to disease than others, it could be important to account for this variation so that apparent concentration of disease is not mistaken for population peaks. In essence, larger/denser populations give rise to greater disease incidence and this effect is a fundamental feature of a <italic>linear</italic> model of disease risk. <xref ref-type="fig" rid="fig1-0962280212446328">Figure 1</xref> displays the spatial distribution of case events (larynx cancer) and controls (respiratory cancer) for a well-known example: larynx cancer incidence in Lancashire NW England 1973–1984.<sup><xref ref-type="bibr" rid="bibr5-0962280212446328">5</xref></sup>
<fig id="fig1-0962280212446328" position="float"><label>Figure 1.</label><caption><p>Larynx cancer (left panel) and respiratory cancer (right panel) incidence in a study region in Lancashire NW England.</p></caption><graphic xlink:href="10.1177_0962280212446328-fig1.tif"/></fig></p>
</sec>
<sec id="sec4-0962280212446328"><title>4 Models</title>
<p>Some basic notation that will be useful in the rest of this paper follows. Define a study window as a bounded area within which we observe events. The window is denoted by <italic>T</italic> and its area by <italic>A</italic>. A realization of cases of disease is found within the window <italic>T.</italic> Unlike a random sample, a realization is a complete enumeration of all events (cases) within an area (in this case <italic>T</italic>). Assume that there are <italic>m</italic> observed cases. This set of events has locations defined by <inline-formula id="ilm2-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math2-0962280212446328"><mml:mrow><mml:mi>S</mml:mi><mml:mo>:</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>. Here, <italic>s</italic> represents the two-dimensional (2D) geographic coordinate of the case. This is usually a residential address as we usually associate exposure with residence, unless an occupational etiology were to be the focus. In veterinary studies, the set <italic>S</italic> might be siting locations for diseased animals, for example.</p>
<p>We also assume that we observe within <italic>T</italic> a set of <italic>n</italic> control locations: <inline-formula id="ilm3-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math3-0962280212446328"><mml:mrow><mml:mi>C</mml:mi><mml:mo>:</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>. This set consists of a geographical control for the case outcomes. This could be another disease or the nondiseased portion of the population at risk. For example, we could observe maternal residences of babies born with abnormalities and as control we could examine all normal birth locations for the same time period and area.</p>
<p>It is often useful to derive a composite binary variable from the concatenation of case and control realizations. Define the <inline-formula id="ilm4-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math4-0962280212446328"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> set of locations where the first <italic>m</italic> are cases and the next <italic>n</italic> are controls as: <inline-formula id="ilm5-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math5-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>S</mml:mi><mml:mo>∪</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">}</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi/><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>cN</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>. Define a binary vector <inline-formula id="ilm6-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math6-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> where the first <italic>m</italic> are cases and the last <italic>n</italic> are controls thus
<disp-formula id="disp-formula7-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math7-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable align="left"><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mtext>if</mml:mtext><mml:mi>   </mml:mi><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center" columnspan="1"><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mtext>otherwise</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo/></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic alternate-form-of="disp-formula7-0962280212446328" xlink:href="10.1177_0962280212446328-eq7.tif"/></disp-formula>
</p>
<p>This vector is now a binary outcome variable, associated with the
<italic>S<sub>c</sub></italic>
 locations, and can be considered as the outcome of choice and modeled within a logistic formulation (as will be discussed in detail in the next section).</p>
</sec>
<sec id="sec5-0962280212446328"><title>5 Bayesian approach</title>
<p>Bayesian modeling has as a fundamental ingredient, the specification of a likelihood for the observed data. In addition it requires that parameters in models are regarded as stochastic and are assigned prior distributions. The product of the likelihood and prior distributions for parameters yields a posterior distribution for the parameters after suitable normalization. Inference about models is largely based on this posterior distribution. By modeling both the observed data and any unknown parameter or other unobserved effects as random variables, the hierarchical Bayesian approach to statistical analysis provides a cohesive framework for combining complex data models and external knowledge or expert opinion.<sup><xref ref-type="bibr" rid="bibr6-0962280212446328">6</xref></sup> In general, the data model, which is used in the likelihood, can be denoted <inline-formula id="ilm7-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math7-0962280212446328"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo/></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for observation <italic>y and a set of parameters</italic> θ, and then the likelihood for <italic>N</italic> observations is given by <inline-formula id="ilm9-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math9-0962280212446328"><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">y</mml:mtext><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>Π</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo/></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, for a sample of <inline-formula id="ilm10-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math10-0962280212446328"><mml:mrow><mml:msup><mml:mrow><mml:mtext mathvariant="bold">y</mml:mtext></mml:mrow><mml:mrow><mml:mo mathvariant="bold">'</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> of size <italic>N</italic>. The assumption is made that given the parameters then the data are conditionally independent.</p>
<sec id="sec6-0962280212446328"><title>5.1 Modeling event locations: the heterogeneous Poisson process likelihood</title>
<p>In our application, the random quantity is the address locations of cases. Hence, we need to define our likelihood as <inline-formula id="ilm11-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math11-0962280212446328"><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">s</mml:mtext><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>Π</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> for a suitably defined <inline-formula id="ilm12-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math12-0962280212446328"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Once a choice is made for <inline-formula id="ilm13-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math13-0962280212446328"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, then suitable prior distributions must be chosen for the parameters θ. It is conventional in the analysis of case events to assume that the events form a realization from a heterogeneous Poisson process (HePP). This process describes the distribution of points within a spatial region and the process is governed by a first-order intensity function, which is defined for any location <italic>s</italic> as <inline-formula id="ilm15-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math15-0962280212446328"><mml:mrow><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. This function is strictly positive and yields a local ‘rate’ of events anywhere within the study area. It is this function that can be modeled via a likelihood. Formal properties of these processes are described by Diggle.<sup><xref ref-type="bibr" rid="bibr7-0962280212446328">7</xref></sup> Two forms of likelihood are associated with this process: conditional and unconditional. Here, I only consider the likelihood conditional on <italic>m</italic> events being found in a study area. In this case, the probability of an event at a specific location <italic>s</italic> is just <inline-formula id="ilm16-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math16-0962280212446328"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>Λ</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mi> </mml:mi><mml:mtext>where</mml:mtext><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi>Λ</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>∫</mml:mo></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mi>du</mml:mi></mml:mrow></mml:math></inline-formula>. Note that <inline-formula id="ilm17-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math17-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>Λ</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is just a normalizing constant and it is the integral over the study area of the intensity function <inline-formula id="ilm18-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math18-0962280212446328"><mml:mrow><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Hence, in this situation we have the log likelihood:
<disp-formula id="disp-formula1-0962280212446328"><label>(m1)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math1-0962280212446328"><mml:mrow><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">s</mml:mtext><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mi>m</mml:mi><mml:mi> </mml:mi><mml:mtext>log</mml:mtext><mml:msub><mml:mrow><mml:mi>Λ</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><graphic alternate-form-of="disp-formula1-0962280212446328" xlink:href="10.1177_0962280212446328-eq1.tif"/></disp-formula>
</p>
<p>This likelihood can be used for inference within a Bayesian modeling framework, assuming that <inline-formula id="ilm19-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math19-0962280212446328"><mml:mrow><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is suitably specified. Usually, when we consider spatial epidemiological examples, we need to consider the population at risk in relation to the case density and it is common for the intensity function to have two parts: a model part and a background part.</p>
<p>For example, we can define <inline-formula id="ilm20-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math20-0962280212446328"><mml:mrow><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> where <inline-formula id="ilm21-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math21-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> represents background population variation and <inline-formula id="ilm22-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math22-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the model component. If we assume that there are no parameters to estimate within <inline-formula id="ilm23-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math23-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> (i.e. that it is fixed or given), then in that case we have
<disp-formula id="disp-formula2-0962280212446328"><label>(m2)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math2-0962280212446328"><mml:mrow><mml:mtable align="right"><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">s</mml:mtext><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mi>m</mml:mi><mml:mi> </mml:mi><mml:mtext>log</mml:mtext><mml:msub><mml:mrow><mml:mi>Λ</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mi>m</mml:mi><mml:mi> </mml:mi><mml:mtext>log</mml:mtext><mml:msub><mml:mrow><mml:mi>Λ</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic alternate-form-of="disp-formula2-0962280212446328" xlink:href="10.1177_0962280212446328-eq2.tif"/></disp-formula>
</p>
<p>These likelihoods (m1 or m2) are not based on standard distributions and to use them for inference one would have to evaluate the spatial integral <inline-formula id="ilm24-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math24-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>Λ</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. This of course is not difficult as it is 2D, and it can be evaluated by using Monte Carlo integration, or even numerical integration schemes if the area were regular such as rectangular, for example. Note that attempts have been made to allow the fitting of these likelihoods in standard software packages, via the use of a Poisson distribution, which has a likelihood similar to that of the HePP form.<sup><xref ref-type="bibr" rid="bibr8-0962280212446328">8</xref>,<xref ref-type="bibr" rid="bibr9-0962280212446328">9</xref></sup> By choosing a numerical integration scheme the likelihood m1 can be written
<disp-formula id="disp-formula3-0962280212446328"><label>(m3)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math3-0962280212446328"><mml:mrow><mml:mtable align="right"><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>log</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mi> </mml:mi><mml:mtext>as</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:mi>   </mml:mi><mml:msub><mml:mrow><mml:mi>Λ</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∫</mml:mo><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munder><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mi>du</mml:mi><mml:mo>≈</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic alternate-form-of="disp-formula3-0962280212446328" xlink:href="10.1177_0962280212446328-eq3.tif"/></disp-formula>
and the likelihood m3 is a weighted Poisson likelihood for indicator variable
<italic>I<sub>i</sub></italic>
 with mean <inline-formula id="ilm25-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math25-0962280212446328"><mml:mrow><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and with integration weights <inline-formula id="ilm26-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math26-0962280212446328"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> and an indicator vector where <inline-formula id="ilm27-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math27-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. The weights could be Dirichlet tile areas<sup><xref ref-type="bibr" rid="bibr7-0962280212446328">7</xref></sup> around the case event locations, for example. The choice of weights is really crucial for the accuracy of the integral approximation. Usually, the accuracy of this approximation is not good unless extra dummy weights are added to the sum. Note that m3 can be programmed using the zeroes or ones trick in WInBUGS as an arbitrary likelihood and so a Bayesian hierarchical model can be based on m3 (see Appendix 1). Of course outside of WinBUGS it is possible to simply evaluate m2 with a suitable integration scheme where <inline-formula id="ilm28-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math28-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>Λ</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>≈</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Once a likelihood is specified within WInBUGS, it is then possible to extend our model to include covariates (via linear or spline functions), and random effects, both spatially correlated and uncorrelated simply by suitable specification of <inline-formula id="ilm29-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math29-0962280212446328"><mml:mrow><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> or <inline-formula id="ilm30-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math30-0962280212446328"><mml:mrow><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
<p>The above discussion assumes that <inline-formula id="ilm31-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math31-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is known or given of course. An early solution to the problem when <inline-formula id="ilm32-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math32-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is unknown was to use a nonparametric intensity estimator of the control data to yield <inline-formula id="ilm33-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math33-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and to use that as a <italic>plug in</italic> within m2, with <inline-formula id="ilm34-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math34-0962280212446328"><mml:mrow><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and therefore a profile likelihood would result. The resulting inference was found to be sensitive to the smoothing employed to estimate <inline-formula id="ilm35-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math35-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mi>∧</mml:mi></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.<sup><xref ref-type="bibr" rid="bibr10-0962280212446328">10</xref></sup> Another approach to this problem is to change the outcome data that is used and to convert the problem into a simpler binary regression. This is discussed in a later section.</p>
</sec>
<sec id="sec7-0962280212446328"><title>5.2 Intensity specification</title>
<p>A fundamental part of the modeling process is the specification of the intensity to be modeled. In spatial or environmental epidemiology, the interest is mainly on the specification of <inline-formula id="ilm36-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math36-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mi> </mml:mi><mml:mtext>or</mml:mtext><mml:mi> </mml:mi><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. How this is achieved will in part depend on the application. However, one can in general consider the generalized mixed model formulation where
<disp-formula id="disp-formula4-0962280212446328"><label>(I1)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math4-0962280212446328"><mml:mrow><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mo mathvariant="bold">β</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:msubsup><mml:mo mathvariant="bold">γ</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic alternate-form-of="disp-formula4-0962280212446328" xlink:href="10.1177_0962280212446328-eq4.tif"/></disp-formula>
</p>
<p>Here, the first term is a linear predictor for covariates (<inline-formula id="ilm37-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math37-0962280212446328"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>), the second term consists of potentially nonlinear functions (splines) of covariates (<inline-formula id="ilm38-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math38-0962280212446328"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>) and finally, the third term is a collection of random effects (<inline-formula id="ilm39-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math39-0962280212446328"><mml:mrow><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>) with inclusion vector γ. The covariates in the first term could include the spatial coordinates of the <italic>i</italic>th location or functions such as distance or direction from a known location (as is used in putative health hazard detection). In addition, personal covariates could be included such as age or gender of the case. The choice of which covariates to include in the nonlinear term depends on application. It may be that a 2D field of measurements are to be related to the events and this must be smoothed over space. In that case, a 2D spline might be considered. An example would be pollution measurements at spatial sites that must be interpolated to the point locations of events. Finally, we may consider that additional random variation in the case outcomes occurs. This may possibly be due to unobserved confounding. The confounders could be unknown or unmeasured. First an individual level frailty term could be considered whereby individual differences in disease response is allowed. Second, we could consider spatial random heterogeneity which could modulate the intensity. This could be uncorrelated or correlated (spatially structured). We use the acronyms UH and CH to distinguish these effects. Hence, within a hierarchical modeling framework, we would have a hierarchy of effects specified via prior distributions just as in conventional Bayesian models.</p>
<p>A more concrete example would be useful. In a study of sources of air pollution risk on respiratory asthma cases, we are concerned with the distance effect from a putative pollution source (incinerator), we are also concerned to make allowance for the age of the cases, as well as for the spatial distribution of a competing risk (PM2.5 measured at a network of sites). We want to allow for confounding also. We assume that confounding could be spatially correlated.</p>
<p>A possible formulation would be
<disp-formula id="disp-formula5-0962280212446328"><label>(I2)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math5-0962280212446328"><mml:mrow><mml:mtable align="right"><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>age</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>pm</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:mtext>where</mml:mtext><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mtext>log</mml:mtext><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mtext>exp</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic alternate-form-of="disp-formula5-0962280212446328" xlink:href="10.1177_0962280212446328-eq5.tif"/></disp-formula>
</p>
<p>Here, the link to the source is via distance (
<italic>d<sub>i</sub></italic>
) in an additive-multiplicative form, with covariate
<italic>age<sub>i</sub></italic>
 and 2d spline on
<italic>pm<sub>i</sub></italic>
 (interpolated to the case sites) and finally
<italic>u<sub>i</sub></italic>
, which is a spatially correlated random effect. This example of course would require the addition of prior distributions for all parameters and effects (<inline-formula id="ilm41-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math41-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> parameters in <inline-formula id="ilm42-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math42-0962280212446328"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mo>·</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) to complete the Bayesian specification. We consider the full Bayesian specification in a later section.</p>
</sec>
<sec id="sec8-0962280212446328"><title>5.3 Modeling the binary outcome vector</title>
<p>In the above, we assumed that <inline-formula id="ilm43-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math43-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is known or can be estimated to provide a profile likelihood. However, this is often not available or could lead to smoothing problems.</p>
<p>An alternative formation of the point process model is to consider instead the joint realization of cases and controls and to model the binary label on the joint vector. Hence, instead of directly modeling the locations, we model the binary labels (<inline-formula id="ilm44-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math44-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>) on the locations. It is known from Point process theory that the joint distribution of cases and controls is a HePP also with intensity <inline-formula id="ilm45-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math45-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, assuming that the controls are HePP with intensity <inline-formula id="ilm46-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math46-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. From this definition, we can define the conditional probability of a case (<inline-formula id="ilm47-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math47-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) at a given location as
<disp-formula id="disp-formula6-0962280212446328"><label>(Pr1)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math6-0962280212446328"><mml:mrow><mml:mo>⪻</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic alternate-form-of="disp-formula6-0962280212446328" xlink:href="10.1177_0962280212446328-eq6.tif"/></disp-formula>
</p>
<p>This is just a logistic probability for a binary outcome variable. In the process of derivation, we have removed the nuisance term (<inline-formula id="ilm48-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math48-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>) and so do not have to estimate it now, and we have derived a conventional probability model (Bernoulli). Note that spatial dependence can appear in the model, but it is addressing the labeling rather than the locations themselves. Diggle and Rowlingson<sup><xref ref-type="bibr" rid="bibr11-0962280212446328">11</xref></sup> first proposed this approach and its extensions into semi-parametric modeling.<sup><xref ref-type="bibr" rid="bibr12-0962280212446328">12</xref></sup> Under a Bernoulli data model, the binary outcome variable can be treated as any other binary variable and so a hierarchical model can be constructed which in this case can be termed a Bayesian spatial logistic model. Hence we have
<disp-formula id="disp-formula8-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math8-0962280212446328"><mml:mrow><mml:mtable align="right"><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mi>Bern</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:mtext>logit</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic alternate-form-of="disp-formula8-0962280212446328" xlink:href="10.1177_0962280212446328-eq8.tif"/></disp-formula>
</p>
<p>Hence, a logistic linear spatial model would arise if <inline-formula id="ilm49-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math49-0962280212446328"><mml:mrow><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is defined by a linear predictor in covariates and random effects. Instead a logistic spline spatial model arises when <inline-formula id="ilm50-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math50-0962280212446328"><mml:mrow><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Appendix 2 provides an example of WinBUGS code for a logistic linear spatial model with
<disp-formula id="disp-formula9-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math9-0962280212446328"><mml:mrow><mml:mtable align="right"><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>exp</mml:mi><mml:mo stretchy="false">{</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>·</mml:mo><mml:mi>exp</mml:mi><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:mtext>where</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>  </mml:mi><mml:mtext>is</mml:mtext><mml:mi>  </mml:mi><mml:mtext>distance</mml:mtext><mml:mi>  </mml:mi><mml:mtext>to</mml:mtext><mml:mi>  </mml:mi><mml:mtext>a</mml:mtext><mml:mi>  </mml:mi><mml:mtext>putative</mml:mtext><mml:mi>  </mml:mi><mml:mtext>point</mml:mtext><mml:mi>  </mml:mi><mml:mtext>source</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>  </mml:mi><mml:mtext>is</mml:mtext><mml:mi>  </mml:mi><mml:mtext>age</mml:mtext><mml:mi>  </mml:mi><mml:mtext>of</mml:mtext><mml:mi>  </mml:mi><mml:mtext>the</mml:mtext><mml:mi>  </mml:mi><mml:mtext>individual</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>  </mml:mi><mml:mtext>is</mml:mtext><mml:mi>  </mml:mi><mml:mtext>an</mml:mtext><mml:mi>  </mml:mi><mml:mtext>uncorrelated</mml:mtext><mml:mi>  </mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext>UH</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mi>  </mml:mi><mml:mtext>random</mml:mtext><mml:mi>  </mml:mi><mml:mtext>effect</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>  </mml:mi><mml:mtext>is</mml:mtext><mml:mi>  </mml:mi><mml:mtext>a</mml:mtext><mml:mi>  </mml:mi><mml:mtext>spatially</mml:mtext><mml:mi>  </mml:mi><mml:mtext>correlated</mml:mtext><mml:mi>  </mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext>CH</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mi>  </mml:mi><mml:mtext>random</mml:mtext><mml:mi>  </mml:mi><mml:mtext>effect</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic alternate-form-of="disp-formula9-0962280212446328" xlink:href="10.1177_0962280212446328-eq9.tif"/></disp-formula>
</p>
<p>The focus in the analysis is to make inference about the distance effect (<inline-formula id="ilm51-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math51-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) making allowance for individual age (<inline-formula id="ilm52-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math52-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) and unobserved confounders (<inline-formula id="ilm53-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math53-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>). The choice of random effect and their prior distributions here could be important as we have individual locations where the labels are observed. An uncorrelated effect at the individual level maybe straightforward to model but correlated (CH) effects may not be. Correlation between fixed locations in this case must be considered. There are two basic approaches that could be adopted for this CH specification: (1) a full multivariate normal distribution (MVN) covariance model where the spatial covariance between locations is a function of their distance separation and (2) conditional autoregressive (CAR) model whereby neighborhood relations are assumed between locations. In the first case, the proper prior distribution is defined as
<disp-formula id="disp-formula10-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math10-0962280212446328"><mml:mrow><mml:mtable align="right"><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:mi>w</mml:mi><mml:mo>~</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo mathvariant="bold">μ</mml:mo><mml:mo>,</mml:mo><mml:mi>Σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:mtext>where</mml:mtext><mml:mi>  </mml:mi><mml:mtext>the</mml:mtext><mml:mi>  </mml:mi><mml:mtext>covariance</mml:mtext><mml:mi>  </mml:mi><mml:mtext>matrix</mml:mtext><mml:mi>  </mml:mi><mml:mtext>has</mml:mtext><mml:mi>  </mml:mi><mml:mtext>elements</mml:mtext><mml:mi>  </mml:mi><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:mtext>and</mml:mtext><mml:mi>  </mml:mi><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub><mml:mi>  </mml:mi><mml:mtext>is</mml:mtext><mml:mi>  </mml:mi><mml:mtext>the</mml:mtext><mml:mi>  </mml:mi><mml:mtext>distance</mml:mtext><mml:mi>  </mml:mi><mml:mtext>between</mml:mtext><mml:mi>  </mml:mi><mml:mtext>the</mml:mtext><mml:mi>  </mml:mi><mml:mi>i</mml:mi><mml:mtext>th</mml:mtext><mml:mi>  </mml:mi><mml:mtext>and</mml:mtext><mml:mi>  </mml:mi><mml:mi>j</mml:mi><mml:mtext>th</mml:mtext><mml:mi>  </mml:mi><mml:mtext>locations</mml:mtext><mml:mi>  </mml:mi><mml:mtext>and</mml:mtext><mml:mi>  </mml:mi><mml:mo mathvariant="bold">μ</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:munder><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic alternate-form-of="disp-formula10-0962280212446328" xlink:href="10.1177_0962280212446328-eq10.tif"/></disp-formula>
</p>
<p>Usually, Σ has parameters that must be estimated in the model. For example, a common simple model is the exponential covariance where <inline-formula id="ilm55-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math55-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi>exp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> so that the variability is modeled by <inline-formula id="ilm56-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math56-0962280212446328"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>and the distance dependence is modeled by α.</p>
<p>The second approach attempts to avoid the computational burden of estimation of covariance parameters and instead considers a CAR alternative. CAR models<sup><xref ref-type="bibr" rid="bibr1-0962280212446328">1</xref></sup> require a simple neighborhood specification for their spatial structure and if such can be found for a set of locations then this could be a candidate model. There are a number of ways one could define neighboring points to a given point: an arbitrary distance threshold could be used for example. An alternative known as ‘natural neighborhoods’<sup><xref ref-type="bibr" rid="bibr13-0962280212446328">13</xref>,<xref ref-type="bibr" rid="bibr14-0962280212446328">14</xref></sup> uses a tiling of the points and assumes that any adjacencies contain neighboring points. Often, a <italic>Dirichlet/Voronoi tessellation</italic> is specified as this has the property that all locations within a tile are closer to the tile point than to any other point. Hence, the tessellation defines ‘territories’ for the point set. <xref ref-type="fig" rid="fig2-0962280212446328">Figure 2</xref> displays the tessellation of a set of arbitrary points. This was created by the R function DELDIR which is designed to compute such tessellations and triangulations. One disadvantage of the Dirichlet tessellation is that it does not have support at the edges of the study region. Instead, it is always possible to compute the dual of the tessellation, the Delauney triangulation. This is also shown on <xref ref-type="fig" rid="fig2-0962280212446328">Figure 2</xref> and is formed by joining the tile centers with a common boundary. In this example, the Delauney neighbors (points joined by a triangle) are given by the coordinates X: 0.1 0.2 0.4 0.45 0.6 0.3; and Y: 0.1 0.3 0.7 0.2 0.7 0.4, with the number of neighbors defined as 2, 4, 3, 4, 3, 4. In this way, it is possible to define an adjancy matrix and hence a CAR random effect could be assumed. Note that no knowledge of the exact location of the points is required, only the labels of the adjacent points. Appendix 2 displays the WinBUGS code for this model for the larynx cancer dataset (1036 case–control locations) and the dataset is available as detailed in the Appendix.
<fig id="fig2-0962280212446328" position="float"><label>Figure 2.</label><caption><p>Tesellation/triangulation of an arbitrary set of six points: Dirichlet tessellation dashed line; Delauney triangulation solid lines.</p></caption><graphic xlink:href="10.1177_0962280212446328-fig2.tif"/></fig></p>
</sec>
<sec id="sec9-0962280212446328"><title>5.4 Prior distributional choices</title>
<p>So far I have only considered a small range of data types and approaches to likelihood definition. Once a likelihood is assumed, whether it is (m1) – (m3) or based on (Pr1), with the intensity specified, it is important to specify prior distributions for all parameters and random effects. It is one of the great advantages of a Bayesian modeling approach that it is possible to place model structure at different levels of model hierarchy and in this way can avoid complicated likelihood specification. In fact, in spatial statistics, a major concern is the introduction of spatial correlation into a model. By allowing correlation to be placed in prior distributions, a Bayesian model can exploit conditional independence down the hierarchy to allow independent likelihood contributions.</p>
<p>Assuming we have the general form <inline-formula id="ilm58-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math58-0962280212446328"><mml:mrow><mml:mi>log</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mo mathvariant="bold">β</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:msubsup><mml:mo mathvariant="bold">γ</mml:mo></mml:mrow></mml:math></inline-formula>, then the different parameters and effects can be treated as follows. First, we usually try to choose noninformative prior distributions if possible. For regression parameters (<inline-formula id="ilm59-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math59-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mo mathvariant="bold">β</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) within linear predictors it is commonly assumed that they can each be independently assigned a zero mean Gaussian distribution with precision <inline-formula id="ilm60-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math60-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> i.e. <inline-formula id="ilm61-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math61-0962280212446328"><mml:mrow><mml:mi>β</mml:mi><mml:mo>~</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula> The precision is just the inverse of the variance and it measures how concentrated the distribution is. For uncorrelated random effects, a similar specification is made with zero mean and specified precision: <inline-formula id="ilm62-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math62-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. It is conventional to consider the combined specification of parameter prior distribution and precision hyper-prior distribution. It is important to specify a prior distribution for a precision parameter (especially for random effects) as
<disp-formula id="disp-formula11-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math11-0962280212446328"><mml:mrow><mml:mtable align="right"><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mi>Ga</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>   </mml:mi><mml:mtext>with</mml:mtext><mml:mi>   </mml:mi><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo>/</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:mtext>so</mml:mtext><mml:mi>  </mml:mi><mml:mtext>that</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>~</mml:mo><mml:mi>IG</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic alternate-form-of="disp-formula11-0962280212446328" xlink:href="10.1177_0962280212446328-eq11.tif"/></disp-formula>
where <italic>IG</italic>(˙) stands for inverse gamma distribution. Often, a reasonably noninformative Gamma with large variance is chosen for the precision with <italic>a</italic> = 0.001, <italic>b</italic> = 0.001, or even an exponential specification such as <italic>Ga</italic> (1, 0.026).<sup><xref ref-type="bibr" rid="bibr15-0962280212446328">15</xref></sup> Other specifications can be considered as well, such as ‘close-to’ exponential: <italic>a</italic> = 2.0, <italic>b</italic> = 0.5. Unfortunately, while gamma prior distributions are a natural choice for precisions, they can sometimes lead to singularities at zero and also can be difficult to sample within Markov chain Monte Carlo (McMC) samplers. As an alternative, Gelman<sup><xref ref-type="bibr" rid="bibr16-0962280212446328">16</xref></sup> suggested using half Cauchy prior distributions and sd-uniform variants. For example, the specification <inline-formula id="ilm63-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math63-0962280212446328"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>~</mml:mo><mml:mi>U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> has been recommended and used extensively in WinBUGS help examples. The choice of <italic>c</italic> is usually in the range <italic>c</italic> = 5 to <italic>c</italic> = 10. However, even a value of 5 leads to a very liberal range for the variance parameter and so small values of <italic>c</italic> are sometimes utilized to ensure convergence, especially in models with random effects.</p>
</sec>
<sec id="sec10-0962280212446328"><title>5.5 Cox process formulation</title>
<p>A Cox process results when the intensity specified is regarded as stochastic. This lends itself to a hierarchical formulation as within a Bayesian formalism the conditioning occurs within a hierarchy and at lower levels of the hierarchy conditional independence results. Hence, in the Cox process, we have an intensity that has spatial stochastic variation but conditional on the intensity the cases are distributed independently as a HePP. Conditional on the realization of the intensity function then data under this process can be modeled via the HePP likelihood. A variety of models result from this formulation.</p>
<p>First, a special case is where a spatial Gaussian process <inline-formula id="ilm64-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math64-0962280212446328"><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is assumed and <inline-formula id="ilm65-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math65-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>exp</mml:mi><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> where <inline-formula id="ilm66-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math66-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is an intercept. A spatial Gaussian process defines a random field that has both long-range variation (trend) and short-range covariation (spatial covariation or correlation). In this way, both correlation and trend can be built into the intensity process. Note that the process with <inline-formula id="ilm67-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math67-0962280212446328"><mml:mrow><mml:mi>log</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is often termed a LGCP. A Gaussian process has marginal distributions that are multivariate normal with mean μ and covariance Σ. Often the covariance is specified by a specific function which measures the covariation at given distances between locations. An example of a commonly used covariance function is the exponential where <inline-formula id="ilm70-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math70-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>τ</mml:mi><mml:mi>exp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mi>φ</mml:mi><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="ilm71-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math71-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is th <italic>ij-</italic>th element of Σ. Note that this specification is close to that discussed in Section 5.3 with respect to the linear logistic spatial model except that here we do not assume a transformation from point process to conditional specification of the case–control logistic model for the point labels. To directly utilize an LGCP model with a Hierarchical context would require the normalization of the overall intensity via <inline-formula id="ilm73-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math73-0962280212446328"><mml:mrow><mml:mi>Λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>exp</mml:mi><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo><mml:mo>·</mml:mo><mml:mo>∫</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>exp</mml:mi><mml:mo stretchy="false">{</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">}</mml:mo><mml:mi>ds</mml:mi></mml:mrow></mml:math></inline-formula> over the study region. This integral could be evaluated via Monte Carlo integration within a sampler if required, if the background intensity were known. It could also be approximated via the Berman-Turner method if need be with the assumption that <inline-formula id="ilm74-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math74-0962280212446328"><mml:mrow><mml:mo>∫</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>exp</mml:mi><mml:mo stretchy="false">{</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">}</mml:mo><mml:mi>ds</mml:mi><mml:mo>≈</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi>exp</mml:mi><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> Fitting of LGCPs has also been advocated for aggregated counts with augmentation of unobserved case events.<sup><xref ref-type="bibr" rid="bibr17-0962280212446328">17</xref></sup> It has also been advocated for the analysis of boundary effects (Wombling) in health data.<sup><xref ref-type="bibr" rid="bibr18-0962280212446328">18</xref></sup></p>
<p>Approximation of the <inline-formula id="ilm75-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math75-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> with piecewise constant <inline-formula id="ilm76-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math76-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> could be achieved in a number of ways. Of course the linear logistic formulation in Section 5.3 avoids the complication of evaluating such integrals, or estimating <inline-formula id="ilm77-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math77-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, but makes inference conditional in the locations observed. This still allows the use of spatial information in the modeling but it does not directly model the locations of events per se.</p>
</sec>
<sec id="sec11-0962280212446328"><title>5.6 Cluster formulation</title>
<p>Cox processes can also be specified with different types of stochastic driving processes. For example, a clustered process could be conceived where <inline-formula id="ilm78-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math78-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>μ</mml:mi><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ik</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> where we assume that there are <italic>k</italic>=1, … , <italic>k</italic> clusters and <italic>d<sub>ik</sub></italic> is the distance from the point <italic>s<sub>i</sub></italic> the <italic>k</italic>th center, and <italic>h</italic>(˙) is a cluster distribution function.</p>
<p>The cluster distribution function can be a 2D density such as a bivariate normal if required, but the assumption of a density is not necessary as in the full PP model the intensity is integrated for normalization. The cluster distribution function depends on a variance or precision parameter which controls the spread of the clusters. Note that the clusters are unobserved and usually the number <italic>K</italic> is unknown as well. This kind of model may be favored when an LGCP is regarded as too regular a process for the spatial distribution of cases of disease. If irregular clustering is more common then a process where cluster centers must be estimated could be more appropriate. Special cases of this process arise with specific assumptions such as Poisson cluster processes and the Neyman-Scott process.<sup><xref ref-type="bibr" rid="bibr4-0962280212446328">4</xref></sup></p>
<sec id="sec12-0962280212446328"><title>5.6.1 Shot noise process</title>
<p>Cluster processes which admit a random effect for each cluster center are often called shot-noise processes so that <inline-formula id="ilm79-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math79-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>μ</mml:mi><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:mi>exp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>·</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ik</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> where <inline-formula id="ilm80-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math80-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is assumed to be zero mean Gaussian distributed. Of course, extension to covariate models is straightforward when a multiplicative link is assumed so that <inline-formula id="ilm81-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math81-0962280212446328"><mml:mrow><mml:mi>log</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi/><mml:mrow><mml:mo>'</mml:mo></mml:mrow></mml:msup><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mi>log</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:mi>exp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>·</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ik</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. This yields a hierarchical model for parameters <inline-formula id="ilm82-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math82-0962280212446328"><mml:mrow><mml:mi>β</mml:mi><mml:mo>,</mml:mo><mml:mo mathvariant="bold">γ</mml:mo><mml:mo>,</mml:mo><mml:mtext>and</mml:mtext><mml:mo> </mml:mo><mml:mtext>centers</mml:mtext></mml:mrow></mml:math></inline-formula>. Of course, a logistic spatial model could be assumed in this case, but the appearance of centers of unknown number complicates the problem. As centers must be sampled within McMC iterations, there is a need to recompute distances from data to new sampled centers as well as sampling different values of <italic>K</italic>. Reversible jump McMC is often proposed for these situations. Lawson<sup><xref ref-type="bibr" rid="bibr19-0962280212446328">19</xref></sup> (section 6.5.2 and 6.5.3) gives examples of the posterior estimates of risk under these types of models. This type of problem is difficult to implement in conventional software such as WinBUGS/JAGS and resort must be made to R functions such as MCMC pack or bespoke programming.</p>
</sec>
<sec id="sec13-0962280212446328"><title>5.6.2 Cluster approximation: exceedance estimation</title>
<p>One common approach to clustering is to model relative disease risk and examine posterior information that provides evidence for clustering in the risk rather than specify a parametric cluster model. One such approach is to consider a posterior sample of <inline-formula id="ilm83-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math83-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> values and to examine how many in the sample display elevated values. Assuming that elevated risk values may suggest clustering of risk, we could formalize this approach by assuming the set of <italic>G</italic> posterior sample values <inline-formula id="ilm84-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math84-0962280212446328"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">}</mml:mo><mml:msub><mml:mi/><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and declaring a threshold for the ‘elevated’ risk, say <italic>c</italic>, and compute a posterior functional such as
<disp-formula id="disp-formula12-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math12-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>⪻</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:munderover><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><graphic alternate-form-of="disp-formula12-0962280212446328" xlink:href="10.1177_0962280212446328-eq12.tif"/></disp-formula>
</p>
<p>This computation yields an estimate of the exceedance probability (<italic>Q<sub>i</sub></italic>) at a location and large values of this quantity suggest ‘unusually’ elevated risk. The choice of two different thresholds have to be made here. First <italic>c</italic> must be specified. Second, the level of probability deemed ‘unusual’ must be decided. The choice of <italic>c</italic> essentially amounts to consideration of ‘null’ or ‘no effect’ value of the intensity. One choice might be <italic>c = </italic>1 in that this absorbs the intensity into the background. Another possibility is to assume <inline-formula id="ilm85-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math85-0962280212446328"><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mover><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, an average level of risk, and this would be appropriate if the intensity of the case disease was overall higher than the control (i.e. a mis-specified control disease).</p>
<p>The choice of threshold for <italic>Q<sub>i</sub></italic> may be as a conventional <italic>p</italic> value e.g. <inline-formula id="ilm86-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math86-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>90</mml:mn><mml:mi> </mml:mi><mml:mtext>or</mml:mtext><mml:mi> </mml:mi><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>95</mml:mn></mml:mrow></mml:math></inline-formula>.</p>
<p>There is some trade-off between choice of <italic>c</italic> and probability level of <italic>Q<sub>i</sub></italic>. In fact, different spatial effects might appear when different combinations of these are assumed. Richardson et al.<sup><xref ref-type="bibr" rid="bibr20-0962280212446328">20</xref></sup> have suggested using a Bayesian decision rule based on a relative risk threshold of <italic>c</italic> = 1 for aggregated count data. Using this exceedance approach has the advantage of allowing clustering to appear without making strong clustering assumptions. On the other hand, the exceedances can be highly dependent on the model that is assumed for <inline-formula id="ilm87-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math87-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. In fact, patterns of exceedance tend to mimic the overall model form i.e. when a spatial trend is assumed, then the exceedances will be trended, while if a more heterogeneous spatial distribution is assumed, then the exceedances will be heterogeneous (even for the same dataset!). This model dependence means that there must be a sensitivity analysis carried out among candidate models and prior distributions to make sure that the final inference is robust.</p>
</sec>
<sec id="sec14-0962280212446328"><title>5.6.3 Alternative intensity models</title>
<p>A number of alternatives to conventional specifications of intensities can be considered. First, it is possible to approximate a Gaussian process with a Gaussian process convolution<sup><xref ref-type="bibr" rid="bibr21-0962280212446328">21</xref>,<xref ref-type="bibr" rid="bibr22-0962280212446328">22</xref></sup> and so this could be used within an intensity. In that case, the intensity could be specified as
<disp-formula id="disp-formula13-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math13-0962280212446328"><mml:mrow><mml:mi>log</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>|</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>υ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mi>k</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><graphic alternate-form-of="disp-formula13-0962280212446328" xlink:href="10.1177_0962280212446328-eq13.tif"/></disp-formula>
where α is an intercept, <inline-formula id="ilm89-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math89-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>υ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is a random effect, and <inline-formula id="ilm90-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math90-0962280212446328"><mml:mrow><mml:mi>k</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is a kernel function centered on
<italic>w<sub>k</sub></italic>
. The set of points <inline-formula id="ilm91-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math91-0962280212446328"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> act as a set of fixed nodes (or knots) usually with <inline-formula id="ilm92-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math92-0962280212446328"><mml:mrow><mml:mi>K</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula>. Usually, the kernel function is assumed to be a symmetric density and a common choice is a 2D Gaussian form, such as
<disp-formula id="disp-formula14-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math14-0962280212446328"><mml:mrow><mml:mi>k</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mfrac><mml:mi>exp</mml:mi><mml:mo stretchy="false">{</mml:mo><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi/><mml:mrow><mml:msub><mml:mrow><mml:mi>sw</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">}</mml:mo><mml:mo>;</mml:mo><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>sw</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi> </mml:mi><mml:mo>|</mml:mo><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:math><graphic alternate-form-of="disp-formula14-0962280212446328" xlink:href="10.1177_0962280212446328-eq14.tif"/></disp-formula>
</p>
<p>Also, the prior distribution for the random term is usually assumed to be <inline-formula id="ilm93-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math93-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. As there is no parameter in the kernel function, the form will be controlled by the precision of the random effect. Note that the degree of smoothing will depend on the placement and number of nodes and the random mixing term. Essentially, this is close in form to a spline basis, but where fixed knots are the data points, and also a Cox cluster process where ‘centers’ are random. In Section 9, we give an example of the use of such a process convolution model in a data example.</p>
<p>Further variants of this specification can be considered. For example, partition models can be considered.<sup><xref ref-type="bibr" rid="bibr23-0962280212446328">23</xref></sup> These models are structured around the idea that discrete partitions of the spatial study area can be assigned fixed risk levels and sampled risk levels averaged over posterior samples can mimic continuously varying risk surfaces. The first example of this was applied by Byers and Raftery<sup><xref ref-type="bibr" rid="bibr24-0962280212446328">24</xref></sup> to spatial point process data. More recently, Costain<sup><xref ref-type="bibr" rid="bibr25-0962280212446328">25</xref></sup> applied similar models to small area case–control data. One disadvantage of partitioning is that reversible jump McMC has to be considered and this usually requires special programming. In addition, the interpretation of the posterior output when the number of partitions is random is not straightforward as realizations from different numbers of partitions cannot be simply averaged. Other possible variants of these models are where Dirichlet process mixtures are employed. Dirichlet process mixtures can be defined as a nonparametric alternative to strictly parametric models. They are defined via a base distribution <inline-formula id="ilm94-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math94-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (which in this case could be a point process density) and further allow variation around this distribution. One cluster specification could be, for finite <italic>K</italic>:
<disp-formula id="disp-formula15-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math15-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mtext>with</mml:mtext><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mi>beta</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi> </mml:mi><mml:mtext>and</mml:mtext><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:munderover><mml:mo>Π</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>;</mml:mo><mml:mi> </mml:mi><mml:mtext>where</mml:mtext><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math><graphic alternate-form-of="disp-formula15-0962280212446328" xlink:href="10.1177_0962280212446328-eq15.tif"/></disp-formula>
is a point mass at <italic>h<sub>k</sub></italic>(<italic>s</italic>) and {<italic>h<sub>k</sub></italic>(<italic>s</italic>)} are a set of cluster distribution functions (densities).</p>
</sec>
</sec>
</sec>
<sec id="sec15-0962280212446328"><title>6 Multivariate extensions</title>
<p>Often, it is necessary to examine a range of diseases and their spatial distributions. When we have multi-type processes, we can still examine Bayesian hierarchical models with the additional possibility of examining correlation between diseases. Define <inline-formula id="ilm95-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math95-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>|</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>|</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> for the intensity of the <italic>k</italic>th disease. Once again, we can assume that the background intensity is nuisance but could be different for each disease i.e. <inline-formula id="ilm96-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math96-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≠</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>20</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≠</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>30</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>…</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula> We can proceed initially by assuming that the diseases could be modeled independently and simply estimate the intensity parameters separately. However, there are interesting and useful ways of incorporating relations between diseases that can be pursued.</p>
<sec id="sec16-0962280212446328"><title>6.1 Competing risk models</title>
<p>If you consider that each case could have arisen from one or other of the diseases of interest, then it may be important to consider the relative probability of having one disease over another. Hence, we could consider the discrete probability <inline-formula id="ilm97-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math97-0962280212446328"><mml:mrow><mml:mo>⪻</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>|</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>|</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>|</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and then the conditional likelihood as
<disp-formula id="disp-formula16-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math16-0962280212446328"><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>|</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>Π</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo>Π</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo/><mml:mo>/</mml:mo></mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic alternate-form-of="disp-formula16-0962280212446328" xlink:href="10.1177_0962280212446328-eq16.tif"/></disp-formula>
</p>
<p>It is straightforward to fit such an unordered categorical model, especially if the background intensities are the same. When the background intensities are different, as would more usually be the case, then they must be estimated from control diseases or further assumptions must be made. An example of this competing risk formulation is given in Lawson and Williams.<sup><xref ref-type="bibr" rid="bibr26-0962280212446328">26</xref></sup></p>
</sec>
<sec id="sec17-0962280212446328"><title>6.2 Unconditional models</title>
<p>If it is not possible to condition, then the joint occurrence of the diseases must be modeled jointly. If each disease can be assumed to have a conditional likelihood that is of the heterogeneous Poisson process form (i.e. either HPP or Cox process), then a joint model could assume at the data level:
<disp-formula id="disp-formula17-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math17-0962280212446328"><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>|</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>Π</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo>Π</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>Λ</mml:mi></mml:mrow><mml:mrow><mml:mi>Tk</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><graphic alternate-form-of="disp-formula17-0962280212446328" xlink:href="10.1177_0962280212446328-eq17.tif"/></disp-formula>
</p>
<p>The normalization is for each disease, but this does not preclude the use of common components of the intensity functions linking the diseases. This is again where a Bayesian approach allows for flexible modeling: by moving correlation between diseases up the hierarchy, we thereby avoid having to specify complex models for the joint data likelihood. For example, we could consider a shared component model whereby we assume:
<disp-formula id="disp-formula18-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math18-0962280212446328"><mml:mrow><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>θ</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable align="left"><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>01</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center" columnspan="1"><mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center" columnspan="1"><mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center" columnspan="1"><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo/></mml:mrow></mml:mrow></mml:math><graphic alternate-form-of="disp-formula18-0962280212446328" xlink:href="10.1177_0962280212446328-eq18.tif"/></disp-formula>
and <inline-formula id="ilm98-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math98-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are common components or parameters whereas elements of θ are disease-specific. An example of this might be
<disp-formula id="disp-formula19-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math19-0962280212446328"><mml:mrow><mml:mtable align="right"><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>exp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>ci</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>exp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>20</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>ci</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>exp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>ki</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>ci</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:mtext>where</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>*</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>ci</mml:mi></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>uc</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mi>  </mml:mi><mml:mtext>is</mml:mtext><mml:mi>  </mml:mi><mml:mtext>the</mml:mtext><mml:mi>  </mml:mi><mml:mtext>mean</mml:mtext><mml:mi>  </mml:mi><mml:mtext>of</mml:mtext><mml:mi>  </mml:mi><mml:mtext>the</mml:mtext><mml:mi>  </mml:mi><mml:mi>u</mml:mi><mml:mi>  </mml:mi><mml:mtext>values</mml:mtext><mml:mi>  </mml:mi><mml:mtext>in</mml:mtext><mml:mi>  </mml:mi><mml:mtext>the</mml:mtext><mml:mi>  </mml:mi><mml:mtext>neighborhood</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:mtext>of</mml:mtext><mml:mi>  </mml:mi><mml:mi>i</mml:mi><mml:mtext>th</mml:mtext><mml:mi>  </mml:mi><mml:mtext>observation</mml:mtext><mml:mo>:</mml:mo><mml:mi>  </mml:mi><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic alternate-form-of="disp-formula19-0962280212446328" xlink:href="10.1177_0962280212446328-eq19.tif"/></disp-formula>
</p>
<p>The neighborhood of each point can be defined using natural neighbors, as discussed above. Here, the uncorrelated random effects <inline-formula id="ilm100-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math100-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are disease-specific and the common effect <inline-formula id="ilm101-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math101-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>ci</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is spatially correlated with a CAR model and appears in all the disease models.</p>
<p>Of course, if one were to condition on a joint realization of cases and controls for each of a set of multiple diseases, then our joint model would convert to a multivariate binary model where
<italic>y<sub>i</sub></italic>
 is an integer label for the disease type at the <italic>i</italic>th location.</p>
<p>The probability of a case at the <italic>i</italic>th location for any disease is
<disp-formula id="disp-formula20-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math20-0962280212446328"><mml:mrow><mml:mtable align="right"><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>ki</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo/><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo/><mml:mo>{</mml:mo></mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>ki</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>ki</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo/><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:mtext>where</mml:mtext><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>ki</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi> </mml:mi><mml:mtext>and</mml:mtext><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>ki</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic alternate-form-of="disp-formula20-0962280212446328" xlink:href="10.1177_0962280212446328-eq20.tif"/></disp-formula>
</p>
<p>If the background controls are all the same, then this simplifies to <inline-formula id="ilm102-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math102-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>ki</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>ki</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>. Denote the binary case–control indicator as
<italic>z<sub>i</sub></italic>
. Conditional on there being a case at the <italic>i</italic>th location, then the probability it is from the <italic>l</italic>th disease is <inline-formula id="ilm103-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math103-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>il</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>li</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>ki</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, and this simplifies also when the controls are common. Finally, the joint probability of a case of disease <italic>l</italic> at the <italic>i</italic>th location is <inline-formula id="ilm104-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math104-0962280212446328"><mml:mrow><mml:mo>⪻</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>⪻</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>il</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>li</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo/><mml:mo>{</mml:mo></mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>ki</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>ki</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo/><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. We then simply model the probability vectors (<inline-formula id="ilm105-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math105-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>il</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) at each location.</p>
</sec>
</sec>
<sec id="sec18-0962280212446328"><title>7 Space–time Bayesian modeling</title>
<p>A natural extension to spatial case event modeling is when disease cases have attached a date or time of diagnosis so that for the <italic>i</italic>th person we have <inline-formula id="ilm106-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math106-0962280212446328"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula></p>
<p>In principle, it is possible to simply extend the notion of an intensity to the time dimension and to specify
<disp-formula id="disp-formula21-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math21-0962280212446328"><mml:mrow><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>|</mml:mo><mml:mo mathvariant="bold">θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic alternate-form-of="disp-formula21-0962280212446328" xlink:href="10.1177_0962280212446328-eq21.tif"/></disp-formula>
where the background is now time-dependent and the modeled intensity (<inline-formula id="ilm107-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math107-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) also contains temporal effects. The main complication arises when the temporal dimension is random (i.e. times of events). Then effects must be scaled by the time gap between occurrences. While there is a large range of potential topics that could be discussed under this heading, space limitations for this review preclude any further examination. Further examples of the application of space-time models within case event survival, clustering, and general modeling applications can be found in Clark and Lawson<sup><xref ref-type="bibr" rid="bibr27-0962280212446328">27</xref></sup> and Lawson<sup><xref ref-type="bibr" rid="bibr19-0962280212446328">19</xref></sup> Chapters 8 and 10, and Waller.<sup>33</sup></p>
</sec>
<sec id="sec19-0962280212446328"><title>8 Approximate likelihood inference</title>
<p>A number of approximations can be made to components in the likelihood of Bayesian models and these can lead to simplifications in the case event situation. One approximation is to use a fine mesh over the study region and to bin points from case and control disease into the grid cells. The resulting counts can be assumed to be Poisson distributed as the arbitrary segmentation of a Poisson process yield independent Poison distributed counts. Hence, both the cases and controls would be Poisson and a superposition of the counts would lead to a relative binomial model.</p>
<p>For instance, if the counts of case and control in the <italic>k</italic>th cell is <inline-formula id="ilm108-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math108-0962280212446328"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>ca</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>co</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> then the <inline-formula id="ilm109-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math109-0962280212446328"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>ca</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is binomial distributed with order <inline-formula id="ilm110-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math110-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>ca</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>co</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>. This allows the cell counts to be modeled via a logistic model. The relevance of this model depends on the grid cell size chosen. For other mesh approximation examples see Hossain and Lawson.<sup><xref ref-type="bibr" rid="bibr28-0962280212446328">28</xref></sup></p>
<p>Alternative approximations arise when the likelihood or posterior is replaced by an approximation. INLA<sup><xref ref-type="bibr" rid="bibr29-0962280212446328">29</xref></sup> attempts to approximate posterior distributions by Gaussian mixtures matched to the form of the density. As far as I am aware, this has not been applied to point process likelihoods but could be a potential tool for faster approximate inference.</p>
</sec>
<sec id="sec20-0962280212446328"><title>9 Examples</title>
<sec id="sec21-0962280212446328"><title>9.1 Putative hazard example</title>
<p>As an example of a putative hazard analysis, I will examine the larynx cancer data for NW England. There are 58 cases and 1036 in the superposition of cases and controls. The location of a waste product incinerator is known and the distance from this location is precomputed (<italic>dis<sub>i</sub></italic>). In this example, we have added a simulated covariate. For all cases and controls, we have simulated age from an age distribution matched to larynx cancer incidence within age strata for the UK. This is denoted <italic>age<sub>i</sub></italic>. The case–control indicator variable is <italic>ind<sub>i</sub></italic> which takes values. Appendix 2 displays the code for WInBUGS for this example. The regression parameters in this log linear model are gam0, gam1, gam2, with gam1 the coefficient for distance and gam2 the coefficient for age. gam0 is the log-scale intercept. In addition, there is an uncorrelated individual level random effect (<italic>v<sub>i</sub></italic>) and also a spatially correlated random effect (<italic>w<sub>i</sub></italic>). This latter effect is assumed to have a conditional CAR specification (car.normal). and is based on neighborhoods defined by Delauney triangulation derived from the DELDIR R package. All precisions are given sd-uniform prior distributions on the range 0 to 5.</p>
<p>Convergence is reached with multiple chains by 10,000 iterations. A sample of 4000 was taken and yielded the parameter estimates as shown in <xref ref-type="table" rid="table1-0962280212446328">Table 1</xref>.
<table-wrap id="table1-0962280212446328" position="float"><label>Table 1.</label><caption><p>Posterior average parameter estimates for the larynx cancer example</p></caption>
<graphic alternate-form-of="table1-0962280212446328" xlink:href="10.1177_0962280212446328-table1.tif"/>
<table frame="hsides"><thead align="left">
<tr><th>Parameter</th>
<th>Mean</th>
<th>SD</th>
<th>2.5%</th>
<th>97.5%</th></tr></thead>
<tbody align="left">
<tr>
<td>Gam0</td>
<td>−10.15</td>
<td>1.222</td>
<td>−12.21</td>
<td>−7.603</td></tr>
<tr>
<td>Gam1</td>
<td>21.45</td>
<td>20.58</td>
<td>−9.35</td>
<td>71.06</td></tr>
<tr>
<td>Gam2</td>
<td>0.0386</td>
<td>0.0141</td>
<td>0.0118</td>
<td>0.0651</td></tr>
</tbody>
</table>
</table-wrap></p>
<p><xref ref-type="fig" rid="fig3-0962280212446328">Figure 3</xref> displays the posterior sample density for gam1 and gam2. It is clear that while the intercept is well estimated, the distance coefficient has a large range and crosses zero in the posterior sample. This suggests there is a lack of significant relationship with distance, whereas the 95% credible limits for the age effect are both positive and so suggests a significant though weak relationship with age. Of course, this model could easily be extended to include other features of the data or alternative predictor links or forms. We could, for example, include directional effects around the putative source or offset a deprivation index available at locations or contextually via census units. We could employ a nonlinear or spline link function with covariates without altering the hierarchical model construction.<sup><xref ref-type="bibr" rid="bibr30-0962280212446328">30</xref></sup>
<fig id="fig3-0962280212446328" position="float"><label>Figure 3.</label><caption><p>Posterior sample average marginal density estimates for the parameters gam1 and gam2 for the larynx cancer example.</p></caption><graphic xlink:href="10.1177_0962280212446328-fig3.tif"/></fig></p>
</sec>
<sec id="sec22-0962280212446328"><title>9.2 Cluster detection example</title>
<p>In the larynx cancer example above, we might be tempted to consider a general cluster detection approach to assess whether there is in fact any support for an unusual aggregation of cases at any locale within the study region. This could be achieved by employing a cluster model such as Cox process or shot noise process described above and estimation of cluster centers. An alternative is to examine the exceedances within a posterior sample from a standard trend or random effect model. <xref ref-type="fig" rid="fig4-0962280212446328">Figure 4</xref> displays the posterior expected exceedance field for the intensity (<inline-formula id="ilm111-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math111-0962280212446328"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) for the Berman Turner integral approximation method applied to the larynx cancer example with the log-linear intensity specified as in Appendix 1, including a spatial trend. <xref ref-type="fig" rid="fig5-0962280212446328">Figure 5</xref> displays the posterior expected exceedance field for the same model but with the spatial trend removed and an uncorrelated random effect added (<inline-formula id="ilm112-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math112-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>;</mml:mo><mml:msubsup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>~</mml:mo><mml:mi>U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>). Contours delimiting higher levels of exceedance probability can represent areas of clustered risk. A threshold can be assumed for these <italic>p</italic>-value surface. It is noticeable however that areas of excess risk shift depending on the underlying model: The spatial trend model suggests trending of risk into the south-west whereas the frailty model suggests an area in the mid central southern area. In fact, the incinerator location is (3.545, 4.140) and this lies within the 0.95 contour of risk for the frailty model but lies outside the 0.95 contour for the trend model. Clearly, the goodness of fit of any putative model must be addressed when considering these highly sensitive clustering indicators.
<fig id="fig4-0962280212446328" position="float"><label>Figure 4.</label><caption><p>Posterior average intensity exceedance probability for a BT model with spatial trend with <inline-formula id="ilm113-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math113-0962280212446328"><mml:mrow><mml:mo>⪻</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> estimated from posterior sample of 2000 size.</p></caption><graphic xlink:href="10.1177_0962280212446328-fig4.tif"/></fig>
<fig id="fig5-0962280212446328" position="float"><label>Figure 5.</label><caption><p>Posterior average intensity exceedance probability for a BT model with no trend but with an uncorrelated frailty effect with <inline-formula id="ilm114-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math114-0962280212446328"><mml:mrow><mml:mo>⪻</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> estimated from posterior sample of 2000 size.</p></caption><graphic xlink:href="10.1177_0962280212446328-fig5.tif"/></fig></p>
<p>Finally, we also fitted a model with a kernel process convolution for the spatial.correlation term, using the BT integral approximation:
<disp-formula id="disp-formula22-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math22-0962280212446328"><mml:mrow><mml:mtable align="right"><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:mi>log</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ic</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mi>k</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi> </mml:mi><mml:mtext>where</mml:mtext><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ic</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>log</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>exp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>ic</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mi> </mml:mi><mml:mtext>and</mml:mtext><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:mtext>and</mml:mtext><mml:mi> </mml:mi><mml:mi>k</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>exp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mi> </mml:mi><mml:mo>‖</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>‖</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo> </mml:mo><mml:mtext>with</mml:mtext><mml:mi> </mml:mi><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn><mml:mi> </mml:mi><mml:mtext>and</mml:mtext><mml:mi> </mml:mi><mml:msubsup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>~</mml:mo><mml:mi>U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic alternate-form-of="disp-formula22-0962280212446328" xlink:href="10.1177_0962280212446328-eq22.tif"/></disp-formula>
</p>
<p><xref ref-type="fig" rid="fig6-0962280212446328">Figure 6</xref> displays the results of applying an exceedance criterion to the intensity (<inline-formula id="ilm115-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math115-0962280212446328"><mml:mrow><mml:mi>pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi> </mml:mi><mml:mtext>and</mml:mtext><mml:mi> </mml:mi><mml:mi>pr</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>) resulting from this model. It is clear that the region in the south east of the study area has elevated risk. The parameter estimates for <inline-formula id="ilm116-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math116-0962280212446328"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> under this model were 7.262 (9.122) and 30.59 (22.13), respectively. Although the <inline-formula id="ilm117-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math117-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> estimate is positive, its 95% credible interval crosses zero and so there is little support for a distance effect from the putative source under this model.
<fig id="fig6-0962280212446328" position="float"><label>Figure 6.</label><caption><p>Posterior average exceedance probability (<inline-formula id="ilm118-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math118-0962280212446328"><mml:mrow><mml:mo>⪻</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mtext>left</mml:mtext><mml:mo>,</mml:mo><mml:mo>⪻</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mtext>right</mml:mtext></mml:mrow></mml:math></inline-formula>) from a kernel convolution model fitted using an absolute distance loss kernel with 100 regularly spaced nodes and including distance from the putative source as a predictor as a covariate. Estimates based on posterior sample of 2000 size.</p></caption><graphic xlink:href="10.1177_0962280212446328-fig6.tif"/></fig></p>
</sec>
</sec>
<sec id="sec23-0962280212446328"><title>10 Environmental risk field misalignment</title>
<p>A classic problem in environmental epidemiology is the assignment of appropriate exposures to case locations when the exposure is measured at other locations. Specifically, often pollution measures are made in networks of sample sites and these measures have to be interpolated or extrapolated to the locations of cases. As case locations are fixed points and monitoring sites are fixed networks of points, then this amounts to an interpolation from one grid to another. A variety of methods can be used to achieve this. For example, Bayesian Kriging could be used to provide estimates and these estimates would have associated estimation errors. The R package spBayes can be used for this purpose. Once these estimates are obtained they can be used in a variety of estimation procedures. However, separately estimating these exposures can lead to estimation errors in the case event models. Usually, we would assume a model where the true pollutant concentration is related to the health outcome and so the use of a joint likelihood for both health outcome and observed pollutant might be proposed. This leads to a classical measurement error (ME) model formulation. Examples exist of using a conditional spatial logistic model for case event outcomes with this type of ME model.<sup><xref ref-type="bibr" rid="bibr31-0962280212446328">31</xref></sup> In principle, this could be applied to an unconditional point process model with intensity
<disp-formula id="disp-formula23-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math23-0962280212446328"><mml:mrow><mml:mtable align="right"><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>exp</mml:mi><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo>…</mml:mo><mml:mo>…</mml:mo><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:mtext>with</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi>Σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>   </mml:mi><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mi>  </mml:mi><mml:mtext>measurement</mml:mtext><mml:mi>  </mml:mi><mml:mtext>sites</mml:mtext><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" columnspan="1"><mml:mrow><mml:mtext>where</mml:mtext><mml:mi>  </mml:mi><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo><mml:mi>  </mml:mi><mml:mtext>are</mml:mtext><mml:mi>  </mml:mi><mml:mtext>the</mml:mtext><mml:mi>  </mml:mi><mml:mtext>observed</mml:mtext><mml:mi>  </mml:mi><mml:mtext>pollutant</mml:mtext><mml:mi>  </mml:mi><mml:mtext>values</mml:mtext><mml:mo>,</mml:mo><mml:mi>  </mml:mi><mml:mtext>and</mml:mtext><mml:mi>  </mml:mi><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mi>  </mml:mi><mml:mtext>denotes</mml:mtext><mml:mi>  </mml:mi><mml:mtext>a</mml:mtext><mml:mi>  </mml:mi><mml:mtext>predictor</mml:mtext><mml:mi>  </mml:mi><mml:mtext>link</mml:mtext><mml:mi>  </mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext>e</mml:mtext><mml:mo>.</mml:mo><mml:mtext>g</mml:mtext><mml:mo>.</mml:mo><mml:mi>  </mml:mi><mml:mtext>spline</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic alternate-form-of="disp-formula23-0962280212446328" xlink:href="10.1177_0962280212446328-eq23.tif"/></disp-formula>
</p>
<p>The interpolation to the case event locations is effected by using the predictive distribution for the pollutants. This has a known form when a Gaussian distribution is assumed for
<italic>x<sub>j</sub></italic>
.<sup><xref ref-type="bibr" rid="bibr32-0962280212446328">32</xref></sup> As the true value of the pollutant also appears in the health model, a joint model is usually assumed so that the true value is estimated under both models. Alternatives are to use ‘plug-in’ (Kriged) estimates or Berkson error for
<italic>x<sub>i^t</sub></italic>
. Owber</p>
</sec>
<sec id="sec24-0962280212446328"><title>11 Conclusions</title>
<p>In the above, I have attempted to summarize the current state of Bayesian modeling for point event data in spatial and environmental epidemiology. While much has been focused on the derivation of likelihoods and their approximation, it is important to realize that once a suitable data model is specified then via conditional independence we can formulate hierarchical models as more commonly found for aggregate count data analysis. The main differences are (1) the evaluation of a normalizing constant integral in likelihoods and (2) the specification of spatial correlation for events at fixed locations (rather than areas). Solutions to the first problem lie in using integral approximation/estimation methods (Monte Carlo integration or weighted sums) or conditioning and label modeling, while for the second I propose the use of either full MVN correlation prior distributions or natural neighborhoods, which allow the use of Markov random field (CAR) models.</p>
<p>For case event data, the major paradigm choice remains: whether to model the locations of events directly (via point process models) as opposed to converting to binary labels by conditioning on the locations (logistic spatial models). For most examples in epidemiology, individual level outcomes are related to individual level predictors and given that spatial location is often a contextual effect, there appears to be a strong case to be made for binary logistic regression as a panacea for spatial case–control data. In addition, the ease with which such data can be modeled within conventional software also supports the wide-spread adoption of this approach. On the other hand, for environmental risk assessment, where continuous risk fields may be affecting populations, then there may be some merit in assuming a point process approach, particularly when the underlying background risk is to be estimated.</p>
</sec>
</body>
<back>
<sec id="sec25-0962280212446328"><title>Funding</title>
<p>I would like to acknowledge funding support for this work from NIH grants: 5R21HL088654-02 “Latent Structure Modeling for Small Area Health Data” and 1R03 CA139538-01 “Development and Evaluation of Spatial Survival Models”.</p></sec>
<ref-list>
<title>References</title>
<ref id="bibr1-0962280212446328"><label>1</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Besag</surname><given-names>J</given-names></name><name><surname>York</surname><given-names>J</given-names></name><name><surname>Mollié</surname><given-names>A</given-names></name></person-group><article-title>Bayesian image restoration with two applications in spatial statistics</article-title>. <source>Ann Instit Stat Math</source> <year>1991</year>; <volume>43</volume>: <fpage>1</fpage>–<lpage>59</lpage>.</citation></ref>
<ref id="bibr2-0962280212446328"><label>2</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Knorr-Held</surname><given-names>L</given-names></name></person-group><article-title>Bayesian modeling of inseparable space-time variation in disease risk</article-title>. <source>Stat Med</source> <year>2000</year>; <volume>19</volume>: <fpage>2555</fpage>–<lpage>2567</lpage>.</citation></ref>
<ref id="bibr3-0962280212446328"><label>3</label><citation citation-type="book"><person-group person-group-type="author"><name><surname>Lawson</surname><given-names>AB</given-names></name></person-group><source>Bayesian disease mapping: hierarchical modeling in spatial epidemiology</source>, <publisher-loc>New York, NY</publisher-loc>: <publisher-name>CRC press</publisher-name>, <year>2009</year>.</citation></ref>
<ref id="bibr4-0962280212446328"><label>4</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Møller</surname><given-names>J</given-names></name><name><surname>Waagpeteresen</surname><given-names>R</given-names></name></person-group><article-title>Modern statistics for spatial point processes</article-title>. <source>Scand J Stat</source> <year>2007</year>; <volume>34</volume>: <fpage>643</fpage>–<lpage>684</lpage>.</citation></ref>
<ref id="bibr5-0962280212446328"><label>5</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Diggle</surname><given-names>PJ</given-names></name></person-group><article-title>A point process modeling approach to raised incidence of a rare phenomenon in the vicinity of a prespecified point</article-title>. <source>J Roy Stat Soc A</source> <year>1990</year>; <volume>153</volume>: <fpage>349</fpage>–<lpage>362</lpage>.</citation></ref>
<ref id="bibr6-0962280212446328"><label>6</label><citation citation-type="book"><person-group person-group-type="author"><name><surname>Lawson</surname><given-names>AB</given-names></name><name><surname>Banerjee</surname><given-names>S</given-names></name></person-group> <article-title>Bayesian spatial analysis</article-title>. In: <person-group person-group-type="editor"><name><surname>Fotheringham</surname><given-names>AS</given-names></name><name><surname>Rogerson</surname><given-names>P</given-names></name></person-group> (eds). <source>The sage handbook of spatial analysis</source>, <publisher-loc>New York, NY</publisher-loc>: <publisher-name>Sage</publisher-name>, <year>2009</year>; <fpage>321</fpage>–<lpage>342</lpage>.</citation></ref>
<ref id="bibr7-0962280212446328"><label>7</label><citation citation-type="book"><person-group person-group-type="author"><name><surname>Diggle</surname><given-names>P</given-names></name></person-group><source>Statistical analysis of spatial point patterns</source>, <edition>2nd edn</edition>. <publisher-loc>New York, NY</publisher-loc>: <publisher-name>OUP</publisher-name>, <year>2003</year>.</citation></ref>
<ref id="bibr8-0962280212446328"><label>8</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Berman</surname><given-names>M</given-names></name><name><surname>Turner</surname><given-names>R</given-names></name></person-group><article-title>Approximating point process likelihoods with GLIM</article-title>. <source>Appl Stat</source> <year>1992</year>; <volume>41</volume>: <fpage>31</fpage>–<lpage>38</lpage>.</citation></ref>
<ref id="bibr9-0962280212446328"><label>9</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lawson</surname><given-names>AB</given-names></name></person-group><article-title>GLIM and normalising constant models in spatial and directional data analysis</article-title>. <source>Comput Stat Data Anal</source> <year>1992</year>; <volume>13</volume>: <fpage>331</fpage>–<lpage>348</lpage>.</citation></ref>
<ref id="bibr10-0962280212446328"><label>10</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lawson</surname><given-names>AB</given-names></name><name><surname>Williams</surname><given-names>FLR</given-names></name></person-group><article-title>Armadale: a case study in environmental epidemiology</article-title>. <source>J Roy Stat Soc A</source> <year>1994</year>; <volume>157</volume>(<issue>2</issue>): <fpage>285</fpage>–<lpage>298</lpage>.</citation></ref>
<ref id="bibr11-0962280212446328"><label>11</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Diggle</surname><given-names>PJ</given-names></name><name><surname>Rowlingson</surname><given-names>B</given-names></name></person-group><article-title>A conditional approach to point process modelling of elevated risk</article-title>. <source>J Roy Stat Soc A</source> <year>1994</year>; <volume>157</volume>: <fpage>433</fpage>–<lpage>440</lpage>.</citation></ref>
<ref id="bibr12-0962280212446328"><label>12</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kelsall</surname><given-names>J</given-names></name><name><surname>Diggle</surname><given-names>P</given-names></name></person-group><article-title>Spatial variation in risk of disease: a nonparametric binary regression approach</article-title>. <source>Appl Stat</source> <year>1998</year>; <volume>47</volume>(<issue>4</issue>): <fpage>559</fpage>–<lpage>573</lpage>.</citation></ref>
<ref id="bibr13-0962280212446328"><label>13</label><citation citation-type="book"><person-group person-group-type="author"><name><surname>Sibson</surname><given-names>R</given-names></name></person-group> <article-title>A brief description of natural neighbor interpolation</article-title>. In: <person-group person-group-type="editor"><name><surname>Barnett</surname><given-names>V</given-names></name></person-group> (ed.) <source>Interpreting multivariate data<italic>, Chapter 2</italic></source>, <publisher-loc>Chichester</publisher-loc>: <publisher-name>John Wiley</publisher-name>, <year>1981</year>; <fpage>21</fpage>–<lpage>36</lpage>.</citation></ref>
<ref id="bibr14-0962280212446328"><label>14</label><citation citation-type="other"><comment>Preparata FP and Shamos MI. <italic>Computational geometry – an introduction</italic>. 2nd printing, corrected and expanded. Springer, 1988</comment>.</citation></ref>
<ref id="bibr15-0962280212446328"><label>15</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wakefield</surname><given-names>J</given-names></name></person-group><article-title>Disease mapping and spatial regression with count data</article-title>. <source>Biostatistics</source> <year>2007</year>; <volume>8</volume>(<issue>2</issue>): <fpage>158</fpage>–<lpage>183</lpage>.</citation></ref>
<ref id="bibr16-0962280212446328"><label>16</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Gelman</surname><given-names>A</given-names></name></person-group><article-title>Prior distributions for variance parameters in hierarchical models</article-title>. <source>Bayesian Anal</source> <year>2006</year>; <volume>1</volume>(<issue>3</issue>): <fpage>515</fpage>–<lpage>533</lpage>.</citation></ref>
<ref id="bibr17-0962280212446328"><label>17</label><citation citation-type="other"><comment>Li Y, Brown P, Gesink DC, et al. Log Gaussian Cox processes and spatially aggregated disease incidence data. <italic>Stat Meth Med Res</italic> 2012; <bold>21</bold>(5): 479--507</comment>.</citation></ref>
<ref id="bibr18-0962280212446328"><label>18</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Liang</surname><given-names>S</given-names></name><name><surname>Banerjee</surname><given-names>S</given-names></name><name><surname>Carlin</surname><given-names>B</given-names></name></person-group><article-title>Bayesian Wombling for spatial point processes</article-title>. <source>Biometrics</source> <year>2009</year>; <volume>65</volume>(<issue>4</issue>): <fpage>1243</fpage>–<lpage>1253</lpage>.</citation></ref>
<ref id="bibr19-0962280212446328"><label>19</label><citation citation-type="book"><person-group person-group-type="author"><name><surname>Lawson</surname><given-names>AB</given-names></name></person-group><source>Statistical methods in spatial epidemiology</source>, <edition>2nd edn</edition>. <publisher-loc>New York, NY</publisher-loc>: <publisher-name>Wiley</publisher-name>, <year>2006</year>.</citation></ref>
<ref id="bibr20-0962280212446328"><label>20</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Richardson</surname><given-names>S</given-names></name><name><surname>Thomson</surname><given-names>A</given-names></name><name><surname>Best</surname><given-names>NG</given-names></name><etal/></person-group><article-title>Interpreting posterior relative risk estimates in disease mapping studies</article-title>. <source>Environ Health Persp</source> <year>2004</year>; <volume>112</volume>: <fpage>1016</fpage>–<lpage>1025</lpage>.</citation></ref>
<ref id="bibr21-0962280212446328"><label>21</label><citation citation-type="book"><person-group person-group-type="author"><name><surname>Higdon</surname><given-names>D</given-names></name></person-group> <article-title>Space and space-time modeling using process convolutions</article-title>. In: <person-group person-group-type="editor"><name><surname>Anderson</surname><given-names>C</given-names></name><etal/></person-group> (eds). <source>Quantitative methods for current environmental issues</source>, <publisher-loc>London</publisher-loc>: <publisher-name>Springer</publisher-name>, <year>2002</year>.</citation></ref>
<ref id="bibr22-0962280212446328"><label>22</label><citation citation-type="book"><person-group person-group-type="author"><name><surname>Calder</surname><given-names>C</given-names></name><name><surname>Holloman</surname><given-names>C</given-names></name><name><surname>Higdon</surname><given-names>D</given-names></name></person-group> <article-title>Exploring space-time structure in ozone concentration using a dynamic process convolution model</article-title>. In: <person-group person-group-type="editor"><name><surname>Kass</surname><given-names>R</given-names></name><etal/></person-group> (ed.) <source>Bayesian case studies VI</source>, <publisher-loc>New York, NY</publisher-loc>: <publisher-name>Springer</publisher-name>, <year>2002</year>; <fpage>165</fpage>–<lpage>176</lpage>.</citation></ref>
<ref id="bibr23-0962280212446328"><label>23</label><citation citation-type="book"><person-group person-group-type="author"><name><surname>Ferreira</surname><given-names>J</given-names></name><name><surname>Denison</surname><given-names>D</given-names></name><name><surname>Holmes</surname><given-names>C</given-names></name></person-group> <article-title>Partition modelling</article-title>. In: <person-group person-group-type="editor"><name><surname>Lawson</surname><given-names>AB</given-names></name><name><surname>Denison</surname><given-names>D</given-names></name></person-group> (eds). <source>Spatial cluster modeling</source>, <publisher-loc>London</publisher-loc>: <publisher-name>CRC Press</publisher-name>, <year>2002</year>.</citation></ref>
<ref id="bibr24-0962280212446328"><label>24</label><citation citation-type="book"><person-group person-group-type="author"><name><surname>Byers</surname><given-names>SD</given-names></name><name><surname>Raftery</surname><given-names>A</given-names></name></person-group> <article-title>Bayesian estimation and segmentation of spatial point processes using Voronoi Tilings</article-title>. In: <person-group person-group-type="editor"><name><surname>Lawson</surname><given-names>AB</given-names></name><name><surname>Denison</surname><given-names>D</given-names></name></person-group> (eds). <source>Spatial cluster modeling<italic>, Chapter 6</italic></source>, <publisher-loc>London</publisher-loc>: <publisher-name>CRC Press</publisher-name>, <year>2002</year>.</citation></ref>
<ref id="bibr25-0962280212446328"><label>25</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Costain</surname><given-names>D</given-names></name></person-group><article-title>Bayesian partitioning for modeling and mapping spatial case-control data</article-title>. <source>Biometrics</source> <year>2009</year>; <volume>65</volume>: <fpage>1123</fpage>–<lpage>1132</lpage>.</citation></ref>
<ref id="bibr26-0962280212446328"><label>26</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lawson</surname><given-names>AB</given-names></name><name><surname>Williams</surname><given-names>FLR</given-names></name></person-group><article-title>Spatial competing risk models in disease mapping</article-title>. <source>Stat Med</source> <year>2000</year>; <volume>19</volume>(<issue>17/18</issue>): <fpage>2451</fpage>–<lpage>2468</lpage>.</citation></ref>
<ref id="bibr27-0962280212446328"><label>27</label><citation citation-type="book"><person-group person-group-type="author"><name><surname>Clark</surname><given-names>AB</given-names></name><name><surname>Lawson</surname><given-names>AB</given-names></name></person-group> <article-title>Spatio-temporal cluster modelling of small area health data</article-title>. In: <person-group person-group-type="editor"><name><surname>Lawson</surname><given-names>AB</given-names></name><name><surname>Denison</surname><given-names>D</given-names></name></person-group> (eds). <source>Spatial cluster modeling<italic>, Chapter 14</italic></source>, <publisher-loc>London</publisher-loc>: <publisher-name>CRC Press</publisher-name>, <year>2002</year>.</citation></ref>
<ref id="bibr28-0962280212446328"><label>28</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hossain</surname><given-names>MM</given-names></name><name><surname>Lawson</surname><given-names>AB</given-names></name></person-group><article-title>Approximate methods in Bayesian point process spatial models</article-title>. <source>Comput Stat Data Anal (spatial analysis special issue: invited paper)</source> <year>2009</year>; <volume>53</volume>(<issue>8</issue>): <fpage>2831</fpage>–<lpage>2842</lpage>.</citation></ref>
<ref id="bibr29-0962280212446328"><label>29</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Rue</surname><given-names>H</given-names></name><name><surname>Martino</surname><given-names>S</given-names></name><name><surname>Chopin</surname><given-names>N</given-names></name></person-group><article-title>Approximate Bayesian inference for latent Gaussian models by using integrated nested Laplace approximations</article-title>. <source>J Roy Stat Soc Ser B</source> <year>2009</year>; <volume>71</volume>(<issue>2</issue>): <fpage>319</fpage>–<lpage>392</lpage>.</citation></ref>
<ref id="bibr30-0962280212446328"><label>30</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Crainiceanu</surname><given-names>CM</given-names></name><name><surname>Ruppert</surname><given-names>D</given-names></name><name><surname>Carroll</surname><given-names>R</given-names></name><etal/></person-group><article-title>Spatially adaptive Bayesian P-splines with heteroscedastic errors</article-title>. <source>J Comput Graph Stat</source> <year>2007</year>; <volume>16</volume>(<issue>2</issue>): <fpage>265</fpage>–<lpage>288</lpage>.</citation></ref>
<ref id="bibr31-0962280212446328"><label>31</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>J</given-names></name><name><surname>Lawson</surname><given-names>AB</given-names></name><name><surname>McDermott</surname><given-names>S</given-names></name><etal/></person-group><article-title>Bayesian spatial modeling of disease risk in relation to multivariate environmental risk fields</article-title>. <source>Stat Med</source> <year>2010</year>; <volume>29</volume>(<issue>1</issue>): <fpage>142</fpage>–<lpage>157</lpage>.</citation></ref>
<ref id="bibr32-0962280212446328"><label>32</label><citation citation-type="book"><person-group person-group-type="author"><name><surname>Banerjee</surname><given-names>S</given-names></name><name><surname>Carlin</surname><given-names>B</given-names></name><name><surname>Gelfand</surname><given-names>A</given-names></name></person-group><source>Hierarchical modeling and analysis for spatial data</source>, <publisher-loc>New York, NY</publisher-loc>: <publisher-name>CRC press</publisher-name>, <year>2004</year>.</citation></ref>
<ref id="bibr33-0962280212446328"><label>33</label><citation citation-type="book"><person-group person-group-type="author"><name><surname>Waller</surname><given-names>LA</given-names></name><name><surname>Carlin</surname><given-names>BP</given-names></name></person-group> <article-title>Disease mapping</article-title>. In: <person-group person-group-type="editor"><name><surname>Gelfand</surname><given-names>A</given-names></name><name><surname>Diggle</surname><given-names>P</given-names></name><name><surname>Fuentes</surname><given-names>M</given-names></name><etal/></person-group> (eds). <source>Handbook of spatial statistics</source>, <publisher-loc>London</publisher-loc>: <publisher-name>CRC Press</publisher-name>, <year>2010</year>.</citation></ref>
</ref-list>
<app-group><app id="app1-0962280212446328"><title>Appendix 1</title>
<sec id="sec26-0962280212446328"><title/>
<p>WinBUGS code for zeroes trick for a heterogeneous Poisson Process Bayesian model. This will invoke a Metropolis Hastings sampler as it is an arbitrary likelihood. The model is a putative source formulation where a distance variable (d[i]) is modeled via an additive link <inline-formula id="ilm119-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math119-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>exp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mi>β</mml:mi><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and a spatial trend <inline-formula id="ilm120-0962280212446328"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math120-0962280212446328"><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mi>exp</mml:mi><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>. The weights (w[i]) kernel density estimate of background (den[i]) and indicator function (I[i]) are read input.</p>
<p>model{</p>
<p>C &lt;- 10000 # large enough to ensure all phi[i]'s &gt; 0</p>
<p>for (i in 1:N) {</p>
<p>f[i]&lt;-1.+exp(-bet1*d[i])</p>
<p>zeros[i] &lt;- 0</p>
<p>log(lam[i]) &lt; -bet0 + log(f[i]) + bet2*x[i] + bet3*y[i]</p>
<p>log(L[i]) &lt; -I[i]*log(lam[i])-w[i]*den[i]*lam[i]</p>
<p>phi[i] &lt; - -log(L[i]) + C</p>
<p>zeros[i] ∼ dpois(phi[i])}</p>
<p>bet0 ∼ dnorm(0,0.001)</p>
<p>bet1 ∼ dnorm(0,0.001)</p>
<p>bet2 ∼ dnorm(0,0.001)</p>
<p>bet3 ∼ dnorm(0,0.001)}</p>
</sec>
<sec id="sec27-0962280212446328"><title>Appendix 2</title>
<p>WinBUGS code for a logistic spatial model with binary outcome (ind[i]) with a Bernoulli 1st level data distribution and a logit link to the probability of being a case. Here, a distance model is fitted using the additive-multiplicative link (as in Appendix 1) and a linear model with intercept, age covariate (age[i]), and two random effects (v[i] and W[i]). In this case, the individual frailty effect is defined as a zero mean Gaussian prior distribution: v[i]∼dnorm(0, tauv), while the correlated effect is defined as an intrinsic conditional autoregressive (CAR) model based on Dirichlet tile neighbor adjacencies (W[1:N]∼car.normal) with adj[j] and num[i] defined from the neighborhoods of a Dirichlet tesselation of the complete superposition of cases and controls (using R package DELDIR).</p>
<p>model {</p>
<p>for (i in 1:N){</p>
<p>ind[i] ∼ dbern(p[i])</p>
<p>f[i] &lt; -(1 + exp(-gam1*dis[i]))*exp(gam0 + gam2*age[i] + v[i] + W[i]) logit(p[i]) &lt; -log(f[i])</p>
<p>v[i] ∼ dnorm(0,tauv)</p>
<p>res[i] &lt; -(ind[i]-p[i])/sqrt(p[i]*(1-p[i]))</p>
<p>x1[i] &lt; -x[i]</p>
<p>y1[i] &lt; -y[i]</p>
<p>}</p>
<p>for(k in 1:sumNumNeigh)</p>
<p> W[1:N] ∼ car.normal(adj[],wei[],num[],tauW)</p>
<p>tauW &lt; -pow(sdW,-2)</p>
<p>sdW ∼ dunif(0,10)</p>
<p>gam0 ∼ dnorm(0,0.001)</p>
<p>gam1 ∼ dnorm(0,0.001)</p>
<p>gam2 ∼ dnorm(0,0.001)</p>
<p>tauv &lt; -1/pow(sdv,2)</p>
<p>sdv ∼ dunif(0,100)}</p>
<p>Dataset:</p>
<p>Available from <ext-link ext-link-type="uri" xlink:href="http://www.musc.edu/biometry/people/lawsonab/Data%20and%20Programs.html">http://www.musc.edu/biometry/people/lawsonab/Data%20and%20Programs.html</ext-link></p>
<p>For full ODC files contact the author directly.</p>
</sec></app></app-group>
</back>
</article>