<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v2.3 20070202//EN" "journalpublishing.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">PID</journal-id>
<journal-id journal-id-type="hwp">sppid</journal-id>
<journal-title>Proceedings of the Institution of Mechanical Engineers, Part D: Journal of Automobile Engineering</journal-title>
<issn pub-type="ppub">0954-4070</issn>
<issn pub-type="epub">2041-2991</issn>
<publisher>
<publisher-name>SAGE Publications</publisher-name>
<publisher-loc>Sage UK: London, England</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1177/0954407012440217</article-id>
<article-id pub-id-type="publisher-id">10.1177_0954407012440217</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Original Articles</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>A virtual motorcycle driver to simulate real manoeuvres from experimental data</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<name><surname>Massaro</surname><given-names>Matteo</given-names></name>
</contrib>
<contrib contrib-type="author">
<name><surname>Lot</surname><given-names>Roberto</given-names></name>
</contrib>
<contrib contrib-type="author">
<name><surname>Cossalter</surname><given-names>Vittore</given-names></name>
</contrib>
<aff id="aff1-0954407012440217">Department of Industrial Engineering, University of Padova, Padova, Italy</aff>
</contrib-group>
<author-notes>
<corresp id="corresp1-0954407012440217">Matteo Massaro, Department of Industrial Engineering, University of Padova, Via Venezia 1, 35131 Padova, Italy. Email: <email>matteo.massaro@unipd.it</email></corresp>
</author-notes>
<pub-date pub-type="epub-ppub">
<month>9</month>
<year>2012</year>
</pub-date>
<volume>226</volume>
<issue>9</issue>
<fpage>1211</fpage>
<lpage>1219</lpage>
<history>
<date date-type="received">
<day>22</day>
<month>9</month>
<year>2011</year>
</date>
<date date-type="accepted">
<day>6</day>
<month>2</month>
<year>2012</year>
</date>
</history>
<permissions>
<copyright-statement>© IMechE 2012</copyright-statement>
<copyright-year>2012</copyright-year>
<copyright-holder content-type="society">Institution of Mechanical Engineers</copyright-holder>
</permissions>
<abstract>
<p>The control of single-track vehicles represents a challenging task. The stability is characterized by vibration modes which change with the vehicle speed and acceleration and may possibly become unstable under certain motion conditions. This paper presents a virtual rider who accounts for these effects by updating the control action at each instant, based on the information of the approaching road section and the current vehicle state. This approach mimics the behaviour of a real rider, who looks ahead, learning a portion of the track and continuously using this information to decide when and how to steer and accelerate or decelerate. As an example of application, the virtual rider is employed to simulate a real manoeuvre using the experimental signals (namely the speed and the roll angle) of the real vehicle as the target motion for the virtual vehicle. A comparison between the virtual rider inputs and the real rider inputs is included. The essential properties that make the behaviour of the virtual rider consistent with that of the real human rider are addressed.</p>
</abstract>
<kwd-group>
<kwd>Motorcycle dynamics</kwd>
<kwd>virtual rider</kwd>
<kwd>virtual driver</kwd>
<kwd>control</kwd>
<kwd>stability</kwd>
<kwd>multi-body</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="section1-0954407012440217" sec-type="intro">
<title>Introduction</title>
<p>Since two-wheeled vehicles are intrinsically unstable (see, for example, the work by Cossalter,<sup><xref ref-type="bibr" rid="bibr1-0954407012440217">1</xref></sup> Sharp<sup><xref ref-type="bibr" rid="bibr2-0954407012440217">2</xref></sup> and Pacejka<sup><xref ref-type="bibr" rid="bibr3-0954407012440217">3</xref></sup>), a virtual rider model is required in addition to the vehicle model to simulate the system dynamics numerically. This is a substantial difference from car and truck simulation, where the vehicle model can be used to reproduce many typical open-loop manoeuvres (e.g. steering-wheel step) without the need for a virtual driver model.</p>
<p>Different control strategies have been proposed in the past few years (see the paper by Popov et al.<sup><xref ref-type="bibr" rid="bibr4-0954407012440217">4</xref></sup> for a review), and the control of single-track vehicles remains an open research field. Non-linear optimal control theory has proven successful,<sup><xref ref-type="bibr" rid="bibr5-0954407012440217">5</xref>,<xref ref-type="bibr" rid="bibr6-0954407012440217">6</xref></sup> but computational reasons make this approach not appealing for the simulation of complex multi-body models. Classical proportional–integral–derivative approaches have been demonstrated to be effective for constant-speed or slowly varying manoeuvres only.<sup><xref ref-type="bibr" rid="bibr7-0954407012440217">7</xref>,<xref ref-type="bibr" rid="bibr8-0954407012440217">8</xref></sup> Optimal linear time-invariant controllers have been used for constant-speed manoeuvres<sup><xref ref-type="bibr" rid="bibr9-0954407012440217">9</xref></sup> and speed control.<sup><xref ref-type="bibr" rid="bibr10-0954407012440217">10</xref></sup> The linear optimal control theory using the manoeuvre regulation strategy and designed on a very simple motorcycle model has been used to control a complex multi-body code<sup><xref ref-type="bibr" rid="bibr11-0954407012440217">11</xref></sup> and a recent discussion on linear predictive control for a motorcycle with constant-speed simulations has been given.<sup><xref ref-type="bibr" rid="bibr12-0954407012440217">12</xref></sup> Most of these research studies have dealt with constant-speed or slowly varying manoeuvres.</p>
<p>A virtual rider who controls the vehicle with both strong longitudinal and lateral accelerations has been presented by Massaro.<sup><xref ref-type="bibr" rid="bibr13-0954407012440217">13</xref></sup> Such a performance is achieved by updating at each instant the control action based on the information of the approaching road section and the current vehicle state. In more detail, the approach is based on the predictive control theory framework. At each step the virtual rider computes the control action using an appropriate linear model which is derived from the full non-linear multi-body model. The virtual rider proved effective for simulating the non-linear motorcycle model while performing the simple but yet demanding manoeuvres of entering and exiting a curve, with longitudinal accelerations up to 1 <italic>g</italic> and roll angles up to 50°. The target motion is defined in terms of the speed and the roll angle. The choice of these targets is motivated by the demands of motorcycle and tyre companies to simulate cornering manoeuvres at various speeds using multi-body codes.</p>
<p>This paper extends the results obtained by Massaro<sup><xref ref-type="bibr" rid="bibr13-0954407012440217">13</xref></sup> from two points of view: first, the virtual rider model is applied to the very detailed and validated motorcycle model presented by Cossalter et al.,<sup><xref ref-type="bibr" rid="bibr14-0954407012440217">14</xref></sup> in order to prove the effectiveness of the approach in guiding complex models; second, the virtual rider is employed to reproduce complex experimental manoeuvres (instead of the simple entering or exiting a curve while undergoing accelerating or braking manoeuvres), in order to test the virtual rider’s capability to reproduce the real rider’s behaviour. As an example of application, the virtual rider is employed to simulate a real manoeuvre using the speed and the roll angle of the real vehicle as the target motion for the virtual vehicle. The comparison between the virtual rider inputs and real rider inputs is included, and the essential properties that make the behaviour of the virtual rider consistent with that of the real human rider are addressed.</p>
<p>The paper is structured as follows: in the second section the multi-body model used for simulation is described, in the third section the virtual rider model is presented and in the fourth section the performance of the virtual rider while reproducing real manoeuvres is analysed.</p>
</sec>
<sec id="section2-0954407012440217">
<title>Motorcycle model</title>
<p>Several studies on motorcycle dynamics have been presented in the past few years and different mathematical models have been proposed.<sup><xref ref-type="bibr" rid="bibr1-0954407012440217">1</xref><xref ref-type="bibr" rid="bibr2-0954407012440217"/>–<xref ref-type="bibr" rid="bibr3-0954407012440217">3</xref>,<xref ref-type="bibr" rid="bibr14-0954407012440217">14</xref><xref ref-type="bibr" rid="bibr15-0954407012440217"/><xref ref-type="bibr" rid="bibr16-0954407012440217"/><xref ref-type="bibr" rid="bibr17-0954407012440217"/><xref ref-type="bibr" rid="bibr18-0954407012440217"/><xref ref-type="bibr" rid="bibr19-0954407012440217"/>–<xref ref-type="bibr" rid="bibr20-0954407012440217">20</xref></sup> Of these, this paper employed the advanced and validated multi-body code presented by Cossalter et al.<sup><xref ref-type="bibr" rid="bibr14-0954407012440217">14</xref></sup></p>
<p>As shown in <xref ref-type="fig" rid="fig1-0954407012440217">Figure 1</xref>, the motorcycle model is made up of nine rigid bodies and nine body reference frames: the chassis, which consists of two bodies (frame T<sub>2</sub>, i.e. the rear chassis, which is the part of the chassis near the rear suspension pivots, plus frame T<sub>7</sub>, i.e. the front chassis, which is near the steering plate) elastically connected to a spring–damper element which accounts for the chassis compliance, the front frame (frame T<sub>3</sub>, i.e. the handlebar and the upper part of the front suspension), the front and rear wheels (frame T<sub>4</sub> and frame T<sub>1</sub> respectively), the front unsprung mass (frame T<sub>6</sub>, i.e. the lower part of the front suspension, the front brake caliper, etc.) and the rear unsprung mass (frame T<sub>5</sub>, e.g. the swing arm). The rider is modelled with two additional rigid bodies: the lower rider (frame T<sub>8</sub>, from feet to hip) and the upper rider (frame T<sub>9</sub>, from hip to head). The model has 11 degrees of freedom (DOFs) related to the gross motion of the motorcycle (see <xref ref-type="fig" rid="fig1-0954407012440217">Figure 1</xref>): the position and orientation of the chassis (six DOFs), the steer rotation (one DOF), the travels of the suspensions (two DOFs) and the spin rotations of the wheels (two DOFs). Several additional DOFs are included to account for the flexibilities of the vehicle, and the user may decide either to include these in the model or to lock any of these structural DOFs, increasing the number of DOFs from 11 (rigid bodies only) to 29 (all model flexibilities included). For the motorcycle considered herein, only the structural lateral flexibility of the front frame was included; this is essential for a proper modelling of the vehicle’s stability (see, for example, the paper by Cossalter et al.<sup><xref ref-type="bibr" rid="bibr19-0954407012440217">19</xref></sup>).</p>
<fig id="fig1-0954407012440217" position="float">
<label>Figure 1.</label>
<caption>
<p>Motorcycle model DOFs and frames.</p>
</caption>
<graphic xlink:href="10.1177_0954407012440217-fig1.tif"/>
</fig>
<p>The motorcycle inputs are the steering torque τ, the rear-wheel propulsive–brake torque η and the front-wheel brake torque ρ.</p>
<p>The interaction of the tyre with the road is represented by a system composed of three forces acting on the contact point C<sub>P</sub> and two torques, as depicted in <xref ref-type="fig" rid="fig3-0954407012440217">Figure 3</xref>: a longitudinal force <italic>F<sub>x</sub></italic>, a lateral force <italic>F<sub>y</sub></italic>, a force <italic>F<sub>z</sub></italic> normal to the road surface, a rolling resistance moment <italic>M<sub>y</sub></italic> and a yawing moment <italic>M<sub>z</sub></italic>. Note that no overturning moment <italic>M<sub>x</sub></italic> is listed, since the migration of the contact point on the tyre surface is accounted for and thus the related overturning contribute is automatically included (see <xref ref-type="fig" rid="fig3-0954407012440217">Figure 3</xref> where the contact point C<sub>P</sub> is clearly not in the wheel symmetry plane, thus inducing the overturning contributed from all the forces acting therein).</p>
<p>The tyre’s flexibility is included and affects the actual contact point as illustrated in <xref ref-type="fig" rid="fig2-0954407012440217">Figure 2</xref>, where both the actual contact point C<sub>P</sub> and the hypothetical contact point C<sub>P0</sub> when neglecting the tyre deflection are shown. In more detail, the tyre’s compliance is accounted for by means of the lateral deflection <italic>ζ<sub>L</sub></italic>, radial deflection <italic>ζ<sub>R</sub></italic> and circumferential deflection <italic>ζ<sub>C</sub></italic>, as depicted in <xref ref-type="fig" rid="fig1-0954407012440217">Figure 1</xref> and <xref ref-type="fig" rid="fig2-0954407012440217">Figure 2</xref>.<sup><xref ref-type="bibr" rid="bibr21-0954407012440217">21</xref></sup></p>
<fig id="fig2-0954407012440217" position="float">
<label>Figure 2.</label>
<caption>
<p>Effects of the lateral and radial deflections of the tyres on the location of the contact point.</p>
</caption>
<graphic xlink:href="10.1177_0954407012440217-fig2.tif"/>
</fig>
<p>The tyre’s contact forces and torques are computed according to the well-known <italic>magic formula</italic> for the motorcycle, and the coupling between the longitudinal and the lateral forces is computed according to the <italic>loss functions method</italic> (which is an empirical approach based on hill-shaped functions used to reduce the forces in combined slip conditions). Therefore the forces and torques depend on the longitudinal slip κ of the tyre given by</p>
<p>
<disp-formula id="disp-formula1-0954407012440217">
<label>(1)</label>
<mml:math display="block" id="math1-0954407012440217">
<mml:mrow>
<mml:mi>κ</mml:mi>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mi>ω</mml:mi>
<mml:mi>R</mml:mi>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>V</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>V</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula1-0954407012440217" xlink:href="10.1177_0954407012440217-eq1.tif"/>
</disp-formula>
</p>
<p>(where <italic>V<sub>x</sub></italic> is the longitudinal speed of the tyre and <italic>R</italic> is the rolling radius of the tyre), on the lateral slip λ of the tyre given by</p>
<p>
<disp-formula id="disp-formula2-0954407012440217">
<label>(2)</label>
<mml:math display="block" id="math2-0954407012440217">
<mml:mrow>
<mml:mi>λ</mml:mi>
<mml:mo>=</mml:mo>
<mml:mo>−</mml:mo>
<mml:mi>arctan</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>V</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>y</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>V</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula2-0954407012440217" xlink:href="10.1177_0954407012440217-eq2.tif"/>
</disp-formula>
</p>
<p>(where <italic>V<sub>y</sub></italic> is the lateral speed of the tyre), on the camber angle φ of the tyre (see <xref ref-type="fig" rid="fig3-0954407012440217">Figure 3</xref>), on the lateral deflection <italic>ζ<sub>L</sub></italic> and radial deflection <italic>ζ<sub>R</sub></italic> and on the spin rate ω of the tyre (see <xref ref-type="fig" rid="fig2-0954407012440217">Figure 3</xref>). Summarizing this gives</p>
<p>
<disp-formula id="disp-formula3-0954407012440217">
<label>(3)</label>
<mml:math display="block" id="math3-0954407012440217">
<mml:mrow>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mtable>
<mml:mtr>
<mml:mtd>
<mml:mrow>
<mml:msub>
<mml:mi>F</mml:mi>
<mml:mi>x</mml:mi>
</mml:msub>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd>
<mml:mrow>
<mml:msub>
<mml:mi>F</mml:mi>
<mml:mi>y</mml:mi>
</mml:msub>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd>
<mml:mrow>
<mml:msub>
<mml:mi>F</mml:mi>
<mml:mi>z</mml:mi>
</mml:msub>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd>
<mml:mrow>
<mml:msub>
<mml:mi>M</mml:mi>
<mml:mi>y</mml:mi>
</mml:msub>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd>
<mml:mrow>
<mml:msub>
<mml:mi>M</mml:mi>
<mml:mi>z</mml:mi>
</mml:msub>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>=</mml:mo>
<mml:mi mathvariant="script">T</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mi>κ</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>λ</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>ϕ</mml:mi>
<mml:mo>,</mml:mo>
<mml:msub>
<mml:mi>ζ</mml:mi>
<mml:mi>R</mml:mi>
</mml:msub>
<mml:mo>,</mml:mo>
<mml:msub>
<mml:mi>ζ</mml:mi>
<mml:mi>L</mml:mi>
</mml:msub>
<mml:mo>,</mml:mo>
<mml:mi>ω</mml:mi>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula3-0954407012440217" xlink:href="10.1177_0954407012440217-eq3.tif"/></disp-formula>
</p>
<p>where <italic>T</italic> consists of the equations reported in section 11.6.1 of the book by Pacejka,<sup><xref ref-type="bibr" rid="bibr3-0954407012440217">3</xref></sup> which are not reported herein because they are long and complex.</p>
<p>It is worth noting that no relaxation equation is included in the tyre model to account for the fact that the tyre does not generate forces instantaneously. Indeed, when considering the actual contact point and the tyre’s flexibility in the computation of the tyre slippage (κ and λ), this effect is automatically accounted for (see also the papers by Massar et al.<sup><xref ref-type="bibr" rid="bibr17-0954407012440217">17</xref></sup> and Lot<sup><xref ref-type="bibr" rid="bibr21-0954407012440217">21</xref></sup>). Further details of the motorcycle model have been reported previously.<sup><xref ref-type="bibr" rid="bibr14-0954407012440217">14</xref></sup></p>
<fig id="fig3-0954407012440217" position="float">
<label>Figure 3.</label>
<caption>
<p>Forces and torques of the tyres</p>
</caption>
<graphic xlink:href="10.1177_0954407012440217-fig3.tif"/>
</fig>
<p>The main parameters of the street motorcycle tested on the road and simulated are given in <xref ref-type="app" rid="app2-0954407012440217">Appendix 2</xref> (<xref ref-type="table" rid="table1-0954407012440217">Table 1</xref>) while the geometry and the characteristics of the tyres are also reported in <xref ref-type="app" rid="app2-0954407012440217">Appendix 2</xref> (<xref ref-type="fig" rid="fig7-0954407012440217">Figures 7</xref> to <xref ref-type="fig" rid="fig11-0954407012440217">11</xref>).</p>
<table-wrap id="table1-0954407012440217" position="float">
<label>Table 1.</label>
<caption>
<p>Main vehicle parameters (static trim).</p>
</caption>
<graphic alternate-form-of="table1-0954407012440217" xlink:href="10.1177_0954407012440217-table1.tif"/>
<table>
<colgroup>
<col align="left"/>
<col align="left"/>
</colgroup>
<tbody>
<tr>
<td>Mass of the whole vehicle mass (i.e. vehicle + rider)</td>
<td>302 kg</td>
</tr>
<tr>
<td>Height of the centre of gravity (from the ground)</td>
<td>0.649 m</td>
</tr>
<tr>
<td>Longitudinal position of the centre of gravity (from the rear contact point)</td>
<td>0.724 m</td>
</tr>
<tr>
<td>Wheelbase</td>
<td>1.634 m</td>
</tr>
<tr>
<td>Normal trail</td>
<td>0.111 m</td>
</tr>
<tr>
<td>Caster angle</td>
<td>30.5°</td>
</tr>
<tr>
<td>Roll moment of inertia</td>
<td>27.4 kg m<sup>2</sup></td>
</tr>
<tr>
<td>Pitch moment of inertia</td>
<td>78.9 kg m<sup>2</sup></td>
</tr>
<tr>
<td>Yaw moment of inertia</td>
<td>57.3 kg m<sup>2</sup></td>
</tr>
<tr>
<td>Rear-tyre radial stiffness</td>
<td>192 kN/m</td>
</tr>
<tr>
<td>Rear-tyre lateral stiffness</td>
<td>170 kN/m</td>
</tr>
<tr>
<td>Rear-tyre circumferential stiffness</td>
<td>120 kN/m</td>
</tr>
<tr>
<td>Front-tyre radial stiffness</td>
<td>170 kN/m</td>
</tr>
<tr>
<td>Front-tyre lateral stiffness</td>
<td>170 kN/m</td>
</tr>
<tr>
<td>Front-tyre circumferential stiffness</td>
<td>150 kN/m</td>
</tr>
<tr>
<td>Front-frame twist stiffness</td>
<td>45 kN m/rad</td>
</tr>
<tr>
<td>Steering damping coefficient</td>
<td>2 N m s/rad</td>
</tr>
</tbody>
</table>
</table-wrap>
</sec>
<sec id="section3-0954407012440217">
<title>Virtual rider model</title>
<p>The virtual rider presented herein is designed to guide the continuous non-linear motorcycle model described in the second section along generic target roll and target speed profiles. The synthesis of the virtual rider is based on the discrete predictive control theory framework. In particular, at each instant <italic>t<sub>i</sub></italic> the non-linear motorcycle model is linearized about a quasi-steady state condition having a roll <inline-formula id="inline-formula1-0954407012440217">
<mml:math display="inline" id="math4-0954407012440217">
<mml:mrow>
<mml:mi>ϕ</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>i</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math></inline-formula>, a speed <inline-formula id="inline-formula2-0954407012440217">
<mml:math display="inline" id="math5-0954407012440217">
<mml:mrow>
<mml:mi>v</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>i</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math></inline-formula> and a longitudinal acceleration <inline-formula id="inline-formula3-0954407012440217">
<mml:math display="inline" id="math6-0954407012440217">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>v</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>i</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math></inline-formula> of the target motion at that instant, and the resulting linear model is used for synthesis of the virtual rider. Note that, when the vehicle’s speed is changing, the motion is no longer strictly steady state; however, this condition was modelled as a steady state motion in the presence of an additional inertia force field, as well as the gravity plus the spin inertia effect on the wheels (see also the paper by Cossalter et al.<sup><xref ref-type="bibr" rid="bibr14-0954407012440217">14</xref></sup> where the same approach was used).</p>
<p>It is important to consider the longitudinal acceleration when extracting the linear model because it changes significantly the tyre’s normal load and the vehicle’s trim, and therefore the modal properties of the system. The virtual rider is employed to simulate the non-linear model for the next simulation step, i.e. from <italic>t<sub>i</sub></italic> to <italic>t<sub>i</sub></italic> + Δ, where Δ is the integration time step. The procedure is repeated at each step, and therefore the virtual rider always uses an appropriate linear model for computation of the control action: when the vehicle is upright, the linear model obtained in the straight motion condition is used; when the vehicle is cornering, the linear model in the leaned condition is used; etc. More precisely, the virtual rider synthesis is computed with a time step <italic>T</italic>, while the non-linear model is simulated with a time step Δ, with <italic>T</italic> &gt; Δ for efficiency purposes.</p>
<p>In more detail, at each synthesis step <italic>k</italic>, which corresponds to the simulation time <italic>t<sub>i</sub></italic> = (<italic>k</italic> − 1)<italic>T</italic>, the non-linear model is solved for equilibrium in the corresponding target motion condition <inline-formula id="inline-formula4-0954407012440217">
<mml:math display="inline" id="math7-0954407012440217">
<mml:mrow>
<mml:mi mathvariant="bold-italic">r</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math></inline-formula> given by</p>
<p>
<disp-formula id="disp-formula4-0954407012440217">
<label>(4)</label>
<mml:math display="block" id="math8-0954407012440217">
<mml:mrow>
<mml:mi mathvariant="bold-italic">r</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mrow>
<mml:mo>{</mml:mo>
<mml:mtable align="left">
<mml:mtr>
<mml:mtd columnalign="center">
<mml:mrow>
<mml:mi>ϕ</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="center" columnspan="1">
<mml:mrow>
<mml:mi>v</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
<mml:mo>}</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula4-0954407012440217" xlink:href="10.1177_0954407012440217-eq4.tif"/>
</disp-formula>
</p>
<p>to give the equilibrium state <inline-formula id="inline-formula5-0954407012440217">
<mml:math display="inline" id="math9-0954407012440217">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi mathvariant="bold-italic">x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math></inline-formula> and equilibrium input <inline-formula id="inline-formula6-0954407012440217">
<mml:math display="inline" id="math10-0954407012440217">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi mathvariant="bold-italic">u</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math></inline-formula>. More precisely, also the longitudinal acceleration <inline-formula id="inline-formula7-0954407012440217">
<mml:math display="inline" id="math11-0954407012440217">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>v</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math></inline-formula> is considered when computing the quasi-steady state configuration, as explained above. Afterwards, the non-linear model is linearized about <inline-formula id="inline-formula8-0954407012440217">
<mml:math display="inline" id="math12-0954407012440217">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi mathvariant="bold-italic">x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula> and <inline-formula id="inline-formula9-0954407012440217">
<mml:math display="inline" id="math13-0954407012440217">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi mathvariant="bold-italic">u</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula> and converted into its discrete formulation with the discretization time step <italic>T</italic> to give</p>
<p>
<disp-formula id="disp-formula5-0954407012440217">
<label>(5)</label>
<mml:math display="block" id="math14-0954407012440217">
<mml:mrow>
<mml:mtable align="right" width="80%">
<mml:mtr>
<mml:mtd columnalign="right" columnspan="1">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">x</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mi mathvariant="bold">A</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">x</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>+</mml:mo>
<mml:mi mathvariant="bold">B</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">u</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="right" columnspan="1">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">y</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mi mathvariant="bold">C</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">x</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula5-0954407012440217" xlink:href="10.1177_0954407012440217-eq5.tif"/>
</disp-formula>
</p>
<p>where <inline-formula id="inline-formula10-0954407012440217">
<mml:math display="inline" id="math15-0954407012440217">
<mml:mrow>
<mml:mi mathvariant="bold">A</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math></inline-formula>, <inline-formula id="inline-formula11-0954407012440217">
<mml:math display="inline" id="math16-0954407012440217">
<mml:mrow>
<mml:mi mathvariant="bold">B</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math></inline-formula> and <inline-formula id="inline-formula12-0954407012440217">
<mml:math display="inline" id="math17-0954407012440217">
<mml:mrow>
<mml:mi mathvariant="bold">C</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math></inline-formula> are the discrete state space matrices, <inline-formula id="inline-formula13-0954407012440217">
<mml:math display="inline" id="math18-0954407012440217">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">x</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math></inline-formula> is the vector of the state variables, <inline-formula id="inline-formula14-0954407012440217">
<mml:math display="inline" id="math19-0954407012440217">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">u</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math></inline-formula> is the input vector and <inline-formula id="inline-formula15-0954407012440217">
<mml:math display="inline" id="math20-0954407012440217">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">y</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math></inline-formula> is the vector of the observed variables (the roll <inline-formula id="inline-formula16-0954407012440217">
<mml:math display="inline" id="math21-0954407012440217">
<mml:mrow>
<mml:mi>ϕ</mml:mi>
</mml:mrow>
</mml:math></inline-formula> and the speed <italic>v</italic>). More precisely, <inline-formula id="inline-formula17-0954407012440217">
<mml:math display="inline" id="math22-0954407012440217">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">x</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
</mml:mrow>
</mml:math></inline-formula> is the difference between the state variables <inline-formula id="inline-formula18-0954407012440217">
<mml:math display="inline" id="math23-0954407012440217">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi mathvariant="bold-italic">x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>NL</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula> of the non-linear system and the steady state variables <inline-formula id="inline-formula19-0954407012440217">
<mml:math display="inline" id="math24-0954407012440217">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi mathvariant="bold-italic">x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula>, <inline-formula id="inline-formula20-0954407012440217">
<mml:math display="inline" id="math25-0954407012440217">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">u</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
</mml:mrow>
</mml:math></inline-formula> is the difference between the inputs <inline-formula id="inline-formula21-0954407012440217">
<mml:math display="inline" id="math26-0954407012440217">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi mathvariant="bold-italic">u</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>NL</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula> of the non-linear system and the steady state inputs <inline-formula id="inline-formula22-0954407012440217">
<mml:math display="inline" id="math27-0954407012440217">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi mathvariant="bold-italic">u</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula>, and <inline-formula id="inline-formula23-0954407012440217">
<mml:math display="inline" id="math28-0954407012440217">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">y</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
</mml:mrow>
</mml:math></inline-formula> is the difference between the observed variables <inline-formula id="inline-formula24-0954407012440217">
<mml:math display="inline" id="math29-0954407012440217">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi mathvariant="bold-italic">y</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>NL</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula> of the non-linear system and the target motion <inline-formula id="inline-formula25-0954407012440217">
<mml:math display="inline" id="math30-0954407012440217">
<mml:mrow>
<mml:mi mathvariant="bold-italic">r</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math></inline-formula>.</p>
<p>The predictive approach requires the definition of a prediction horizon (see <xref ref-type="fig" rid="fig4-0954407012440217">Figure 4</xref>, where the prediction horizon is depicted together with the synthesis time step <italic>T</italic>, the target roll φ and the target speed <italic>v</italic>), i.e. the number of steps <italic>N</italic> ahead of the vehicle (corresponding to a preview time <italic>T<sub>p</sub> = NT</italic>) where the motion is predicted and used for the synthesis of the controller, and the cost function <italic>V</italic> which will be used for the optimization is given by</p>
<p>
<disp-formula id="disp-formula6-0954407012440217">
<label>(6)</label>
<mml:math display="block" id="math31-0954407012440217">
<mml:mrow>
<mml:mi>V</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mo stretchy="false">‖</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">Y</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>−</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">T</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:msubsup>
<mml:mrow>
<mml:mo stretchy="false">‖</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mi mathvariant="bold">Q</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msubsup>
<mml:mo>+</mml:mo>
<mml:mo stretchy="false">‖</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">U</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:msubsup>
<mml:mrow>
<mml:mo stretchy="false">‖</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mi mathvariant="bold">R</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msubsup>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula6-0954407012440217" xlink:href="10.1177_0954407012440217-eq6.tif"/>
</disp-formula>
</p>
<fig id="fig4-0954407012440217" position="float">
<label>Figure 4.</label>
<caption>
<p>The virtual rider computes the optimal control at the simulation time <italic>t<sub>i</sub></italic> based on the current vehicle state and the target motion along the prediction horizon.</p>
</caption>
<graphic xlink:href="10.1177_0954407012440217-fig4.tif"/>
</fig>
<p>The cost function <italic>V</italic> accounts for the tracking error (<inline-formula id="inline-formula26-0954407012440217">
<mml:math display="inline" id="math32-0954407012440217">
<mml:mrow>
<mml:mo stretchy="false">‖</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">Y</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>−</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">T</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:msubsup>
<mml:mrow>
<mml:mo stretchy="false">‖</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mi mathvariant="bold">Q</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msubsup>
</mml:mrow>
</mml:math></inline-formula>, with the <bold>Q</bold> weight matrix) and the input effort (<inline-formula id="inline-formula27-0954407012440217">
<mml:math display="inline" id="math33-0954407012440217">
<mml:mrow>
<mml:mo stretchy="false">‖</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">U</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:msubsup>
<mml:mrow>
<mml:mo stretchy="false">‖</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mi mathvariant="bold">R</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msubsup>
</mml:mrow>
</mml:math></inline-formula>, with the <bold>R</bold> weight matrix). In more detail,</p>
<p>
<disp-formula id="disp-formula7-0954407012440217">
<mml:math display="block" id="math34-0954407012440217">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">Y</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mrow>
<mml:mo>{</mml:mo>
<mml:mtable align="left">
<mml:mtr>
<mml:mtd columnalign="center">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">y</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="center" columnspan="1">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">y</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo>+</mml:mo>
<mml:mn>2</mml:mn>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="center" columnspan="1">
<mml:mrow>
<mml:mo>⋮</mml:mo>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="center" columnspan="1">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">y</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo>+</mml:mo>
<mml:mi>N</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
<mml:mo>}</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula7-0954407012440217" xlink:href="10.1177_0954407012440217-eq7.tif"/>
</disp-formula>
</p>
<p>
<disp-formula id="disp-formula8-0954407012440217">
<mml:math display="block" id="math35-0954407012440217">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">T</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mrow>
<mml:mo>{</mml:mo>
<mml:mtable align="left">
<mml:mtr>
<mml:mtd columnalign="center">
<mml:mrow>
<mml:mi mathvariant="bold-italic">r</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>−</mml:mo>
<mml:mi mathvariant="bold-italic">r</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="center" columnspan="1">
<mml:mrow>
<mml:mo>⋮</mml:mo>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="center" columnspan="1">
<mml:mrow>
<mml:mi mathvariant="bold-italic">r</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo>+</mml:mo>
<mml:mi>N</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>−</mml:mo>
<mml:mi mathvariant="bold-italic">r</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
<mml:mo>}</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula8-0954407012440217" xlink:href="10.1177_0954407012440217-eq8.tif"/>
</disp-formula>
</p>
<p>
<disp-formula id="disp-formula9-0954407012440217">
<label>(7)</label>
<mml:math display="block" id="math36-0954407012440217">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">U</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mrow>
<mml:mo>{</mml:mo>
<mml:mtable align="left">
<mml:mtr>
<mml:mtd columnalign="center">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">u</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="center" columnspan="1">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">u</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="center" columnspan="1">
<mml:mrow>
<mml:mo>⋮</mml:mo>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="center" columnspan="1">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">u</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo>+</mml:mo>
<mml:mi>N</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
<mml:mo>}</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula9-0954407012440217" xlink:href="10.1177_0954407012440217-eq9.tif"/>
</disp-formula>
</p>
<p>It can be shown<sup><xref ref-type="bibr" rid="bibr13-0954407012440217">13</xref>,<xref ref-type="bibr" rid="bibr22-0954407012440217">22</xref></sup> that the optimal control input at step <italic>k</italic> is</p>
<p>
<disp-formula id="disp-formula10-0954407012440217">
<label>(8)</label>
<mml:math display="block" id="math37-0954407012440217">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">u</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>opt</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mi mathvariant="bold">K</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mrow>
<mml:mo>{</mml:mo>
<mml:mtable align="left">
<mml:mtr>
<mml:mtd columnalign="center">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">x</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="center" columnspan="1">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">T</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
<mml:mo>}</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula10-0954407012440217" xlink:href="10.1177_0954407012440217-eq10.tif"/>
</disp-formula>
</p>
<p>where <inline-formula id="inline-formula28-0954407012440217">
<mml:math display="inline" id="math38-0954407012440217">
<mml:mrow>
<mml:mi mathvariant="bold">K</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math></inline-formula> is the optimal gain matrix which depends on <inline-formula id="inline-formula29-0954407012440217">
<mml:math display="inline" id="math39-0954407012440217">
<mml:mrow>
<mml:mi mathvariant="bold">A</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math></inline-formula>, <inline-formula id="inline-formula30-0954407012440217">
<mml:math display="inline" id="math40-0954407012440217">
<mml:mrow>
<mml:mi mathvariant="bold">B</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math></inline-formula>, <inline-formula id="inline-formula31-0954407012440217">
<mml:math display="inline" id="math41-0954407012440217">
<mml:mrow>
<mml:mi mathvariant="bold">C</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math></inline-formula>, <bold>Q</bold> and <bold>R</bold>. Therefore the non-linear control input which is used to guide the non-linear motorcycle model is the sum of a quasi-steady state component <inline-formula id="inline-formula32-0954407012440217">
<mml:math display="inline" id="math42-0954407012440217">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi mathvariant="bold-italic">u</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula> and a dynamic optimal component <inline-formula id="inline-formula33-0954407012440217">
<mml:math display="inline" id="math43-0954407012440217">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">u</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>opt</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula> according to</p>
<p>
<disp-formula id="disp-formula11-0954407012440217">
<label>(9)</label>
<mml:math display="block" id="math44-0954407012440217">
<mml:mrow>
<mml:mrow>
<mml:mo>{</mml:mo>
<mml:mtable align="left">
<mml:mtr>
<mml:mtd columnalign="center">
<mml:mrow>
<mml:mi>τ</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="center" columnspan="1">
<mml:mrow>
<mml:mi>η</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="center" columnspan="1">
<mml:mrow>
<mml:mi>ρ</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
<mml:mo>}</mml:mo>
</mml:mrow>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi mathvariant="bold-italic">u</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">u</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>opt</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>k</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula11-0954407012440217" xlink:href="10.1177_0954407012440217-eq11.tif"/>
</disp-formula>
</p>
</sec>
<sec id="section4-0954407012440217">
<title>Non-linear simulation</title>
<p>In this section the virtual rider presented in the third section is used to control the non-linear motorcycle model described in the second section. The target motion is defined by the target roll angle and the target speed logged from a real motorcycle equipped with a Global Positioning System (GPS) and an inertial measurement unit with three accelerometers and three gyrometers mounted behind the saddle. While the vehicle’s speed was provided by the GPS, the roll angle was computed using an extended Kalman filter fed with the vehicle’s speed and the roll and yaw angular velocities from gyrometers, as explained in detail by Lot et al.<sup><xref ref-type="bibr" rid="bibr23-0954407012440217">23</xref></sup></p>
<p>In addition, the steering torque was measured with a torsiometer mounted on the vehicle’s handlebar for comparison with the simulation results.</p>
<p>The prediction horizon used by the virtual rider is set to <italic>T<sub>p</sub> = </italic>2.00 s, the virtual rider synthesis is computed with the time step <italic>T = </italic>0.10 s, the continuous non-linear motorcycle model is simulated with the time step Δ = 0.02 s, the weights of <xref ref-type="disp-formula" rid="disp-formula6-0954407012440217">equation (6)</xref> associated with the tracking error are <inline-formula id="inline-formula34-0954407012440217">
<mml:math display="inline" id="math45-0954407012440217">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>q</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>ϕ</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mn>10</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mn>7</mml:mn>
</mml:mrow>
</mml:msup>
</mml:mrow>
</mml:math></inline-formula> (the roll weight) and <inline-formula id="inline-formula35-0954407012440217">
<mml:math display="inline" id="math46-0954407012440217">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>q</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>v</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mn>10</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msup>
</mml:mrow>
</mml:math></inline-formula> (the speed weight), while the weights associated with the inputs are <inline-formula id="inline-formula36-0954407012440217">
<mml:math display="inline" id="math47-0954407012440217">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>τ</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:math></inline-formula> (the steering torque weight), <inline-formula id="inline-formula37-0954407012440217">
<mml:math display="inline" id="math48-0954407012440217">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>η</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mn>10</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msup>
</mml:mrow>
</mml:math></inline-formula> (the rear-wheel torque weight) and <inline-formula id="inline-formula38-0954407012440217">
<mml:math display="inline" id="math49-0954407012440217">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>ρ</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mn>10</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mn>12</mml:mn>
</mml:mrow>
</mml:msup>
</mml:mrow>
</mml:math></inline-formula> (the front-wheel weight). In particular, the length of the prediction horizon was chosen on the basis of the results obtained by Massaro,<sup><xref ref-type="bibr" rid="bibr13-0954407012440217">13</xref></sup> who showed that the effective prediction horizon when controlling the vehicle’s roll and speed, i.e. the length of time where the optimal gains are not negligible, is less than 2 s. Therefore there is no advantage in further extension of the horizon. On the contrary, using a horizon shorter than the effective length may lead to poor control performance and even instability.<sup><xref ref-type="bibr" rid="bibr22-0954407012440217">22</xref></sup></p>
<p>From the practical point of view the virtual rider adds corrections to the steady state steering torque and rear-wheel torque, while the front-wheel torque always has a steady state value (since the related weight is sufficiently high to prevent the virtual rider from using it). The steady state inputs are computed at the target roll angle, the target speed and the target longitudinal acceleration (derived from the speed profile). It is worth noting that, since the motorcycle can brake with both the front wheel and the rear wheel, the same deceleration may be performed with many different braking ratios, e.g. only the front brake, only the rear brake, 50% front brake and 50% rear brake. An ideal braking ratio, which engages the longitudinal adherence of both tyres equally,<sup><xref ref-type="bibr" rid="bibr24-0954407012440217">24</xref></sup> was chosen for the computation of the quasi-steady state configuration. More precisely, the front-wheel brake torque consists of only the quasi-steady state component <inline-formula id="inline-formula39-0954407012440217">
<mml:math display="inline" id="math50-0954407012440217">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi mathvariant="bold-italic">u</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula>, while the rear-wheel brake torque consists of both the quasi-steady state component <inline-formula id="inline-formula40-0954407012440217">
<mml:math display="inline" id="math51-0954407012440217">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi mathvariant="bold-italic">u</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula> and the dynamic optimal component <inline-formula id="inline-formula41-0954407012440217">
<mml:math display="inline" id="math52-0954407012440217">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">u</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>opt</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula>.</p>
<p>When designing a virtual rider, it is important to check whether the behaviour of the virtual rider is consistent with that of the real human rider. It is well known that it is rather hard for a real human rider to control the vehicle with frequencies higher than 5 Hz, this limit being reached by very experienced and skilled riders. Moreover, also the maximum steering effort is limited by physiological limits, the value of 100 N m being hardly ever exceeded. It can be concluded that two essential properties of a virtual rider consistent with the behaviour of the real rider are the limited inputs magnitude and the frequency content.</p>
<p>When considering the virtual rider presented in this paper, <xref ref-type="fig" rid="fig5-0954407012440217">Figure 5</xref> shows that the steering torque used by the virtual rider to control the multi-body model (solid red curves) is close to that employed by the real human rider to control the real vehicle (dotted blue curves). To make the comparison even more effective, <xref ref-type="fig" rid="fig6-0954407012440217">Figure 6</xref> depicts the frequency content of the inputs employed by the virtual rider to control the vehicle; it can be observed that most of the signal components are in the range 0–2 Hz, and thus the behaviour is consistent with that of the real human rider.</p>
<fig id="fig5-0954407012440217" position="float">
<label>Figure 5.</label>
<caption>
<p>Simulation results of the multi-body model with virtual rider (solid red curves and dotted grey curves) and experimental data from the real vehicle (dotted blue curves).</p>
</caption>
<graphic xlink:href="10.1177_0954407012440217-fig5.tif"/>
</fig>
<fig id="fig6-0954407012440217" position="float">
<label>Figure 6.</label>
<caption>
<p>Normalized |FFT| of the inputs used by the virtual rider, where FFT is the fast Fourier transform.</p>
</caption>
<graphic xlink:href="10.1177_0954407012440217-fig6.tif"/>
</fig>
<p>From the practical point of view, the presented approach gives smooth inputs when the target is smooth. Therefore it is suggested to low-pass the target when necessary, to avoid following the noise instead of the real motion (this was not necessary in the present work). Another option is to include a low-pass filter in the virtual rider, to make sure that the inputs used to control the vehicle are always limited in bandwidth. This was done in a early version of the controller but then removed since it was shown to be not necessary. A further option is to reduce the controller weights to prevent the virtual rider from following spikes and noise in the signal; however, this approach has the disadvantage of reducing the tracking performance (see, for example, the papers by Sharp<sup><xref ref-type="bibr" rid="bibr9-0954407012440217">9</xref>,<xref ref-type="bibr" rid="bibr10-0954407012440217">10</xref></sup>).</p>
<p>It should be mentioned that the motion of the body of the virtual rider presented in this paper is not used to control the vehicle dynamics; this may be a limitation when replicating extreme manoeuvres on track, where the rider’s lateral displacement may advance the cornering and the rider’s forward and rearward displacements change both the position of the centre of gravity and the drag coefficient of the whole vehicle; hence it is important to avoid wheelies (when the front tyre loses contact with the road surface) and stoppies (when the rear tyre loses contact with the road surface). Also, path planning is not yet included, i.e. the virtual driver is capable of following a generic complex manoeuvre but is not able to decide the path, given the road and the vehicle’s characteristics. However, the implementation of a path-planning layer is currently under way.</p>
<p>In more detail, <xref ref-type="fig" rid="fig5-0954407012440217">Figure 5</xref> depicts the simulation results in terms of the longitudinal speed (solid red curve), the roll angle (solid red curve), the steering torque (solid red curve), the rear-wheel torque (dotted grey curve) and the front-wheel torque (solid red curve) together with the experimental data (dotted blue curve). It is worth noting that the tracking is almost perfect, in terms of both the speed and the roll angle, while the simulated steering torque has only slight differences from the experimental value. The simulation starts at a speed of 80 km/h with the vehicle decelerating and rolling to the left-hand side (negative roll angles). At <italic>t</italic> = 4 s and a speed of 60 km/h the vehicle starts to roll to the right-hand side (positive roll angles). In the transient phase the steering torque reaches a peak value of −40 N m (<italic>t = </italic>5.3 s). In the range <italic>t</italic> = 8−11 s the vehicle keeps a roll angle close to 40° while the speed is rising from 50  km/h to 65 km/h. Then the roll becomes negative again (vehicle leaned on the left-hand side), −28° at 13.5 s, with a steering torque peak of +60 N m at 12 s (transient phase). Finally, from <italic>t = </italic>14 s the roll angle is reduced while accelerating up to 107 km/h at 18 s.</p>
</sec>
<sec id="section5-0954407012440217" sec-type="conclusions">
<title>Conclusions</title>
<p>An advanced virtual rider who is able to reproduce experimental manoeuvres in terms of the roll angle and the longitudinal speed was presented. The virtual rider was implemented in a validated and detailed motorcycle multi-body code and its performance was proven using the experimental data of real manoeuvres as the target motion of the virtual model. The tracking is almost perfect and the inputs (the steering torque, the rear-wheel torque and the front-wheel torque) employed by the virtual rider are consistent with those of the real human rider, both in magnitude and in bandwidth. The behaviour of the virtual rider presented in the paper mimics that of a real rider, by updating the control action at each instant, based on the information of the approaching road section and the current vehicle state.</p>
<p>However, it should be mentioned that the motion of the body of the virtual rider presented in this paper is not used to control the vehicle dynamics; this may become significant for replicating extreme manoeuvres on track. Also, path planning is not included yet. However, these aspects are currently being implemented in a more sophisticated rider model.</p>
</sec>
</body>
<back>
<app-group>
<app id="app1-0954407012440217">
<title>Appendix 1</title>
<sec id="section6-0954407012440217">
<title>Notation</title>
<p>
<bold>A</bold> dynamic matrix</p>
<p>
<bold>B</bold> input matrix</p>
<p>C<sub>P</sub> tyre contact point</p>
<p>C<sub>P0</sub> tyre contact point when neglecting the tyre deflection</p>
<p>
<bold>C</bold> output matrix</p>
<p>
<italic>F<sub>x</sub></italic> longitudinal force of the tyre</p>
<p>
<italic>F<sub>y</sub></italic> lateral force of the tyre</p>
<p>
<italic>F<sub>z</sub></italic> normal force of the tyre</p>
<p>
<italic>k</italic> synthesis step</p>
<p>
<bold>K</bold> optimal gain matrix</p>
<p>
<italic>M<sub>y</sub></italic> rolling moment of the tyre</p>
<p>
<italic>M<sub>z</sub></italic> yawing moment of the tyre</p>
<p>
<italic>N</italic> number of preview steps</p>
<p>
<inline-formula id="inline-formula42-0954407012440217">
<mml:math display="inline" id="math53-0954407012440217">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>q</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>ϕ</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> roll weight</p>
<p>
<inline-formula id="inline-formula43-0954407012440217">
<mml:math display="inline" id="math54-0954407012440217">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>q</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>v</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> speed weight</p>
<p>
<bold>Q</bold> trajectory weight matrix</p>
<p>
<inline-formula id="inline-formula44-0954407012440217">
<mml:math display="inline" id="math55-0954407012440217">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>ρ</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> front-wheel torque weight</p>
<p>
<inline-formula id="inline-formula45-0954407012440217">
<mml:math display="inline" id="math56-0954407012440217">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>η</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> rear-wheel torque weight</p>
<p>
<inline-formula id="inline-formula46-0954407012440217">
<mml:math display="inline" id="math57-0954407012440217">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>τ</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> steering torque weight</p>
<p>
<bold>
<italic>r</italic>
</bold> target motion</p>
<p>
<italic>R</italic> rolling radius of the tyre</p>
<p>
<bold>R</bold> input weight matrix</p>
<p>
<italic>t</italic> time</p>
<p>T<italic><sub>i</sub></italic> reference frame <italic>i</italic></p>
<p>
<italic>T</italic> synthesis time step</p>
<p>
<italic>T<sub>p</sub></italic> preview length</p>
<p>
<inline-formula id="inline-formula47-0954407012440217">
<mml:math display="inline" id="math58-0954407012440217">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">T</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
</mml:mrow>
</mml:math>
</inline-formula> target motion in the preview horizon</p>
<p><italic>T</italic> model function of the tyre</p>
<p>
<inline-formula id="inline-formula48-0954407012440217">
<mml:math display="inline" id="math59-0954407012440217">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi mathvariant="bold-italic">u</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>NL</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> non-linear input vector</p>
<p>
<bold>
<italic>u</italic>
</bold>
<sub>0</sub> input vector at equilibrium</p>
<p>
<inline-formula id="inline-formula49-0954407012440217">
<mml:math display="inline" id="math60-0954407012440217">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">u</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
</mml:mrow>
</mml:math>
</inline-formula> input vector with respect to the equilibrium</p>
<p>
<inline-formula id="inline-formula50-0954407012440217">
<mml:math display="inline" id="math61-0954407012440217">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">u</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>opt</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> optimal input vector with respect to the equilibrium</p>
<p>
<inline-formula id="inline-formula51-0954407012440217">
<mml:math display="inline" id="math62-0954407012440217">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">U</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
</mml:mrow>
</mml:math>
</inline-formula> input vector with respect to the equilibrium in the preview horizon</p>
<p>
<italic>v</italic> speed</p>
<p>
<italic>V</italic> cost function</p>
<p>
<italic>V<sub>x</sub></italic> longitudinal velocity of the tyre</p>
<p>
<italic>V<sub>y</sub></italic> lateral velocity of the tyre</p>
<p>
<inline-formula id="inline-formula52-0954407012440217">
<mml:math display="inline" id="math63-0954407012440217">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi mathvariant="bold-italic">x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>NL</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> non-linear state vector</p>
<p>
<bold>
<italic>x</italic>
</bold>
<sub>0</sub> state vector at equilibrium</p>
<p>
<inline-formula id="inline-formula53-0954407012440217">
<mml:math display="inline" id="math64-0954407012440217">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">x</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
</mml:mrow>
</mml:math>
</inline-formula> state vector with respect to the equilibrium</p>
<p>
<inline-formula id="inline-formula54-0954407012440217">
<mml:math display="inline" id="math65-0954407012440217">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi mathvariant="bold-italic">y</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>NL</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula> non-linear output vector</p>
<p>
<inline-formula id="inline-formula55-0954407012440217">
<mml:math display="inline" id="math66-0954407012440217">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">y</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
</mml:mrow>
</mml:math>
</inline-formula> output vector with respect to the equilibrium</p>
<p>
<inline-formula id="inline-formula56-0954407012440217">
<mml:math display="inline" id="math67-0954407012440217">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">Y</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
</mml:mrow>
</mml:math>
</inline-formula> output vector with respect to the equilibrium in the preview horizon</p>
<p>Δ simulation time step</p>
<p>
<italic>ζ<sub>C</sub></italic> circumferential deflection of the tyre</p>
<p>
<italic>ζ<sub>L</sub></italic> lateral deflection of the tyre</p>
<p>
<italic>ζ<sub>R</sub></italic> radial deflection of the tyre</p>
<p>η rear-wheel propulsive–brake torque</p>
<p>κ longitudinal slip of the tyre</p>
<p>λ lateral slip of the tyre</p>
<p>ρ front-wheel brake torque</p>
<p>τ steering torque</p>
<p>φ roll angle</p>
</sec>
<sec id="section7-0954407012440217">
<title>Abbreviation</title>
<p>DOF degree of freedom</p>
</sec>
</app>
<app id="app2-0954407012440217">
<title>Appendix 2</title>
<p>The main parameters of the street motorcycle tested on the road and simulated are given in <xref ref-type="table" rid="table1-0954407012440217">Table 1</xref> while the geometry and the characteristics of the tyres are reported in <xref ref-type="fig" rid="fig7-0954407012440217">Figures 7</xref> to <xref ref-type="fig" rid="fig11-0954407012440217">11</xref>.</p>
<fig id="fig7-0954407012440217" position="float">
<label>Figure 7.</label>
<caption>
<p>Rear tyre profile (unloaded).</p>
</caption>
<graphic xlink:href="10.1177_0954407012440217-fig7.tif"/>
</fig>
<fig id="fig8-0954407012440217" position="float">
<label>Figure 8.</label>
<caption>
<p>Front tyre profile (unloaded).</p>
</caption>
<graphic xlink:href="10.1177_0954407012440217-fig8.tif"/>
</fig>
<fig id="fig9-0954407012440217" position="float">
<label>Figure 9.</label>
<caption>
<p>Normalized lateral forces of (a) the rear tyre and (b) the front tyre as functions of the sideslip angle at different camber angles.</p>
</caption>
<graphic xlink:href="10.1177_0954407012440217-fig9.tif"/>
</fig>
<fig id="fig10-0954407012440217" position="float">
<label>Figure 10.</label>
<caption>
<p>Normalized yawing torques of (a) the rear tyre and (b) the front tyre as functions of the sideslip angle at different camber angles.</p>
</caption>
<graphic xlink:href="10.1177_0954407012440217-fig10.tif"/>
</fig>
<fig id="fig11-0954407012440217" position="float">
<label>Figure 11.</label>
<caption>
<p>Normalized longitudinal forces (a) the rear tyre and (b) the front tyre as functions of longitudinal slip.</p>
</caption>
<graphic xlink:href="10.1177_0954407012440217-fig11.tif"/>
</fig>
<p>In particular, <xref ref-type="fig" rid="fig7-0954407012440217">Figure 7</xref> and <xref ref-type="fig" rid="fig8-0954407012440217">Figure 8</xref> show the profile of the rear tyre and the profile of the front tyre respectively (note that a toroid shape is assumed for the tyre’s surface), <xref ref-type="fig" rid="fig9-0954407012440217">Figure 9</xref> reports the lateral forces of the rear and front tyres (normalized by the normal load on the tyres) as functions of the lateral slip and the roll angle (note that the lateral slip angle is limited to ±5° while the roll angle reaches ±50°; indeed these are the typical ranges for motorcycle tyres under normal working conditions), <xref ref-type="fig" rid="fig10-0954407012440217">Figure 10</xref> shows the yawing torques of the rear and front tyres (normalized by the normal load on the tyres) as functions of the lateral slip and the roll angle (note that the lateral slip gives an aligning contribute whereas the roll angle gives a misaligning contribute; indeed this is the typical behaviour of motorcycle tyres) and <xref ref-type="fig" rid="fig11-0954407012440217">Figure 11</xref> depicts the longitudinal forces of the rear and front tyres as functions of the longitudinal slip (note that the peak of the curves is in the neighbourhood of 0.1, as usual).</p>
</app>
</app-group>
<fn-group>
<fn fn-type="financial-disclosure">
<label>Funding</label>
<p>This work was partially supported by the University of Padova (grant no. MAS1PRGR10).</p>
</fn>
</fn-group>
<ref-list>
<title>References</title>
<ref id="bibr1-0954407012440217">
<label>1.</label>
<citation citation-type="web">
<person-group person-group-type="author">
<name><surname>Cossalter</surname><given-names>V</given-names></name>
</person-group>. <source>Motorcycle dynamics</source>, <edition>2nd edition.</edition> <publisher-loc>Padua</publisher-loc>: <publisher-name>Vittore Cossalter</publisher-name>, <year>2007</year>, <comment>available from <ext-link ext-link-type="uri" xlink:href="http://www.lulu.com">http://www.lulu.com</ext-link></comment>.</citation>
</ref>
<ref id="bibr2-0954407012440217">
<label>2.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Sharp</surname><given-names>RS</given-names></name>
</person-group>. <article-title>Stability, control and steering responses of motorcycles</article-title>. <source>Veh System Dynamics</source>, <year>2001</year>; <volume>35</volume>: <fpage>291</fpage>–<lpage>318</lpage>.</citation>
</ref>
<ref id="bibr3-0954407012440217">
<label>3.</label>
<citation citation-type="book">
<person-group person-group-type="author">
<name><surname>Pacejka</surname><given-names>HB</given-names></name>
</person-group>. <source>Tire and vehicle dynamics</source>, <edition>2nd edition.</edition> <publisher-loc>Oxford</publisher-loc>: <publisher-name>Butterworth–Heinemann</publisher-name>, <year>2005</year>.</citation>
</ref>
<ref id="bibr4-0954407012440217">
<label>4.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Popov</surname><given-names>AA</given-names></name>
<name><surname>Rowell</surname><given-names>S</given-names></name>
<name><surname>Meijaard</surname><given-names>JP</given-names></name>
</person-group>. <article-title>A review on motorcycle and rider modelling for steering control</article-title>. <source>Veh System Dynamics</source> <year>2010</year>; <volume>48</volume> (<issue>6</issue>): <fpage>775</fpage>–<lpage>792</lpage>.</citation>
</ref>
<ref id="bibr5-0954407012440217">
<label>5.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Cossalter</surname><given-names>V</given-names></name>
<name><surname>Da Lio</surname><given-names>M</given-names></name>
<name><surname>Lot</surname><given-names>R</given-names></name>
<name><surname>Fabbri</surname><given-names>L</given-names></name>
</person-group>. <article-title>A general method for the evaluation of vehicle manoeuvrability with special emphasis on motorcycles</article-title>. <source>Veh System Dynamics</source> <year>1999</year>; <volume>31</volume>: <fpage>113</fpage>–<lpage>135</lpage>.</citation>
</ref>
<ref id="bibr6-0954407012440217">
<label>6.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Bobbo</surname><given-names>S</given-names></name>
<name><surname>Cossalter</surname><given-names>V</given-names></name>
<name><surname>Massaro</surname><given-names>M</given-names></name>
<name><surname>Peretto</surname><given-names>M</given-names></name>
</person-group>. <article-title>Application of the optimal maneuver method for enhancing racing motorcycle performance</article-title>. <source>SAE Int J Passenger Cars – Mech Syst</source> <year>2009</year>; <volume>1</volume>: <fpage>1311</fpage>–<lpage>1318</lpage>.</citation>
</ref>
<ref id="bibr7-0954407012440217">
<label>7.</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Cossalter</surname><given-names>V</given-names></name>
<name><surname>Lot</surname><given-names>R</given-names></name>
</person-group>. <article-title>A non linear rider model for motorcycles</article-title>. In: <conf-name>FISITA 2006 world automotive congress</conf-name>, <conf-loc>Yokohama, Japan</conf-loc>, <conf-date>22–27 October 2006</conf-date>, <comment>paper F20006V075</comment>. <publisher-loc>Tokyo</publisher-loc>: <publisher-name>JSAE</publisher-name>.</citation>
</ref>
<ref id="bibr8-0954407012440217">
<label>8.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Lot</surname><given-names>R</given-names></name>
<name><surname>Massaro</surname><given-names>M</given-names></name>
<name><surname>Sartori</surname><given-names>R</given-names></name>
</person-group>. <article-title>Advanced motorcycle virtual rider</article-title>. <source>Veh System Dynamics</source> <year>2008</year>; <volume>46</volume>: <fpage>215</fpage>–<lpage>224</lpage>.</citation>
</ref>
<ref id="bibr9-0954407012440217">
<label>9.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Sharp</surname><given-names>RS</given-names></name>
</person-group>. <article-title>Optimal linear time-invariant preview steering control for motorcycles</article-title>. <source>Veh System Dynamics</source> <year>2006</year>; <volume>44</volume>: <fpage>329</fpage>–<lpage>340</lpage>.</citation>
</ref>
<ref id="bibr10-0954407012440217">
<label>10.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Sharp</surname><given-names>RS</given-names></name>
</person-group>. <article-title>Optimal preview speed-tracking control for motorcycles</article-title>. <source>Multibody System Dynamics</source> <year>2007</year>; <volume>18</volume>: <fpage>397</fpage>–<lpage>411</lpage>.</citation>
</ref>
<ref id="bibr11-0954407012440217">
<label>11.</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Saccon</surname><given-names>A</given-names></name>
<name><surname>Hauser</surname><given-names>J</given-names></name>
<name><surname>Beghi</surname><given-names>A</given-names></name>
</person-group>. <article-title>A virtual rider for motorcycles: an approach based on optimal control and maneuver regulation</article-title>. In: <conf-name>3rd international symposium on communications, control, and signal processing</conf-name>, <conf-loc>St Julians, Malta</conf-loc>, <conf-date>12–14 March 2008</conf-date>, pp. <fpage>243</fpage>–<lpage>248</lpage>. <publisher-loc>New York</publisher-loc>: <publisher-name>IEEE</publisher-name>.</citation>
</ref>
<ref id="bibr12-0954407012440217">
<label>12.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Rowell</surname><given-names>S</given-names></name>
<name><surname>Popov</surname><given-names>AA</given-names></name>
<name><surname>Meijaard</surname><given-names>JP</given-names></name>
</person-group>. <article-title>Application of predictive control strategies to the motorcycle riding task</article-title>. <source>Veh System Dynamics</source> <year>2008</year>; <volume>46</volume>: <fpage>805</fpage>–<lpage>814</lpage>.</citation>
</ref>
<ref id="bibr13-0954407012440217">
<label>13.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Massaro</surname><given-names>M</given-names></name>
</person-group>. <article-title>A nonlinear virtual rider for motorcycles</article-title>. <source>Veh System Dynamics</source> <year>2011</year>; <volume>49</volume>(<issue>9</issue>): <fpage>1477</fpage>–<lpage>1496</lpage>.</citation>
</ref>
<ref id="bibr14-0954407012440217">
<label>14.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Cossalter</surname><given-names>V</given-names></name>
<name><surname>Lot</surname><given-names>R</given-names></name>
<name><surname>Massaro</surname><given-names>M</given-names></name>
</person-group>. <article-title>An advanced multibody code for handling and stability analysis of motorcycles</article-title>. <source>Meccanica</source> <year>2011</year>; <volume>46</volume>(<issue>5</issue>): <fpage>943</fpage>–<lpage>958</lpage>.</citation>
</ref>
<ref id="bibr15-0954407012440217">
<label>15.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Cossalter</surname><given-names>V</given-names></name>
<name><surname>Doria</surname><given-names>A</given-names></name>
<name><surname>Lot</surname><given-names>R</given-names></name>
<name><surname>Massaro</surname><given-names>M</given-names></name>
</person-group>. <article-title>The effect of rider’s passive steering impedance on motorcycle stability: identification and analysis</article-title>. <source>Meccanica</source> <year>2011</year>; <volume>46</volume>(<issue>2</issue>): <fpage>279</fpage>–<lpage>292</lpage>.</citation>
</ref>
<ref id="bibr16-0954407012440217">
<label>16.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Massaro</surname><given-names>M</given-names></name>
<name><surname>Sartori</surname><given-names>R</given-names></name>
<name><surname>Lot</surname><given-names>R</given-names></name>
</person-group>. <article-title>Numerical investigation of engine-to-slip dynamics for motorcycle traction control applications</article-title>. <source>Veh System Dynamics</source> <year>2011</year>; <volume>49</volume>(<issue>3</issue>): <fpage>419</fpage>–<lpage>432</lpage>.</citation>
</ref>
<ref id="bibr17-0954407012440217">
<label>17.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Massaro</surname><given-names>M</given-names></name>
<name><surname>Lot</surname><given-names>R</given-names></name>
<name><surname>Cossalter</surname><given-names>V</given-names></name>
</person-group>. <article-title>On engine-to-slip modelling for motorcycle traction control design</article-title>. <source>Proc IMechE Part D: J Automobile Engineering</source> <year>2011</year>; <volume>225</volume>(<issue>1</issue>): <fpage>15</fpage>–<lpage>27</lpage>.</citation>
</ref>
<ref id="bibr18-0954407012440217">
<label>18.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Cossalter</surname><given-names>V</given-names></name>
<name><surname>Lot</surname><given-names>R</given-names></name>
<name><surname>Massaro</surname><given-names>M</given-names></name>
</person-group>. <article-title>The chatter of racing motorcycle</article-title>. <source>Veh System Dynamics</source> <year>2008</year>; <volume>46</volume>(<issue>4</issue>): <fpage>339</fpage>–<lpage>353</lpage>.</citation>
</ref>
<ref id="bibr19-0954407012440217">
<label>19.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Cossalter</surname><given-names>V</given-names></name>
<name><surname>Lot</surname><given-names>R</given-names></name>
<name><surname>Massaro</surname><given-names>M</given-names></name>
</person-group>. <article-title>The influence of frame compliance and rider mobility on the scooter stability</article-title>. <source>Veh System Dynamics</source> <year>2007</year>; <volume>45</volume>(<issue>4</issue>): <fpage>315</fpage>–<lpage>326</lpage>.</citation>
</ref>
<ref id="bibr20-0954407012440217">
<label>20.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Cossalter</surname><given-names>V</given-names></name>
<name><surname>Lot</surname><given-names>R</given-names></name>
<name><surname>Massaro</surname><given-names>M</given-names></name>
<name><surname>Sartori</surname><given-names>R</given-names></name>
</person-group>. <article-title>Development and validation of an advanced motorcycle riding simulator</article-title>. <source>Proc IMechE Part D: J Automobile Engineering</source> <year>2011</year>; <volume>225</volume>(<issue>6</issue>): <fpage>705</fpage>–<lpage>720</lpage>.</citation>
</ref>
<ref id="bibr21-0954407012440217">
<label>21.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Lot</surname><given-names>R</given-names></name>
</person-group>. <article-title>A motorcycle tire model for dynamic simulations: theoretical and experimental aspects</article-title>. <source>Meccanica</source> <year>2004</year>; <volume>39</volume>(<issue>3</issue>): <fpage>207</fpage>–<lpage>220</lpage>.</citation>
</ref>
<ref id="bibr22-0954407012440217">
<label>22.</label>
<citation citation-type="book">
<person-group person-group-type="author">
<name><surname>Maciejowski</surname><given-names>JM</given-names></name>
</person-group>. <source>Predictive control: with constraints</source>. <publisher-loc>Harlow, Essex</publisher-loc>: <publisher-name>Prentice Hall</publisher-name>, <year>2002</year>.</citation>
</ref>
<ref id="bibr23-0954407012440217">
<label>23.</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Lot</surname><given-names>R</given-names></name>
<name><surname>Cossalter</surname><given-names>V</given-names></name>
<name><surname>Massaro</surname><given-names>M</given-names></name>
</person-group>. <article-title>Real-time roll angle estimation for two-wheeled vehicles</article-title>. In: <conf-name>ASME 2012 11th biennial conference on engineering systems design and analysis</conf-name>, <conf-loc>Nantes, France</conf-loc>, <conf-date>2–4 July 2012</conf-date>, <comment>paper no. ESDA2012-82182</comment> (<comment>in press</comment>). <publisher-loc>New York</publisher-loc>: <publisher-name>ASME</publisher-name>.</citation>
</ref>
<ref id="bibr24-0954407012440217">
<label>24.</label>
<citation citation-type="other">
<person-group person-group-type="author">
<name><surname>Cossalter</surname><given-names>V</given-names></name>
<name><surname>Lot</surname><given-names>R</given-names></name>
<name><surname>Maggio</surname><given-names>F</given-names></name>
</person-group>. <article-title>On the braking behavior of motorcycles</article-title>. <comment>SAE paper 2004-32-0018</comment>, <year>2004</year>.</citation>
</ref>
</ref-list>
</back>
</article>