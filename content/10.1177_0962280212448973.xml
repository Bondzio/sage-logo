<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v2.3 20070202//EN" "journalpublishing.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">SMM</journal-id>
<journal-id journal-id-type="hwp">spsmm</journal-id>
<journal-id journal-id-type="nlm-ta">Stat Methods Med Res</journal-id>
<journal-title>Statistical Methods in Medical Research</journal-title>
<issn pub-type="ppub">0962-2802</issn>
<issn pub-type="epub">1477-0334</issn>
<publisher>
<publisher-name>SAGE Publications</publisher-name>
<publisher-loc>Sage UK: London, England</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1177/0962280212448973</article-id>
<article-id pub-id-type="publisher-id">10.1177_0962280212448973</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Articles</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Comparing variational Bayes with Markov chain Monte Carlo for Bayesian computation in neuroimaging</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<name><surname>Nathoo</surname><given-names>FS</given-names></name>
<xref ref-type="aff" rid="aff1-0962280212448973">1</xref>
<xref ref-type="corresp" rid="corresp1-0962280212448973"/>
</contrib>
<contrib contrib-type="author">
<name><surname>Lesperance</surname><given-names>ML</given-names></name>
<xref ref-type="aff" rid="aff1-0962280212448973">1</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Lawson</surname><given-names>AB</given-names></name>
<xref ref-type="aff" rid="aff2-0962280212448973">2</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Dean</surname><given-names>CB</given-names></name>
<xref ref-type="aff" rid="aff3-0962280212448973">3</xref>
</contrib>
<aff id="aff1-0962280212448973"><label>1</label>Department of Mathematics and Statistics, University of Victoria, Canada</aff>
<aff id="aff2-0962280212448973"><label>2</label>Department of Biostatistics, Bioinformatics, and Epidemiology, Medical University of South Carolina, USA</aff>
<aff id="aff3-0962280212448973"><label>3</label>Department of Statistics and Actuarial Science, University of Western Ontario, Canada</aff>
</contrib-group>
<contrib-group content-type="issue">
<contrib contrib-type="guest-editor">
<name><surname>Nathoo</surname><given-names>Farouk</given-names></name>
</contrib>
<contrib contrib-type="guest-editor">
<name><surname>Lawson</surname><given-names>Andrew B</given-names></name>
</contrib>
<contrib contrib-type="guest-editor">
<name><surname>Dean</surname><given-names>Charmaine B</given-names></name>
</contrib>
</contrib-group>
<author-notes>
<corresp id="corresp1-0962280212448973">FS Nathoo, Department of Mathematics and Statistics, University of Victoria, Victoria BC V8W 2Y2, Canada. Email: <email>nathoo@math.uvic.ca</email></corresp>
</author-notes>
<pub-date pub-type="epub-ppub">
<month>8</month>
<year>2013</year>
</pub-date>
<volume>22</volume>
<issue>4</issue>
<issue-title>Special Issue: GEOMED 2011 Imaging</issue-title>
<fpage>398</fpage>
<lpage>423</lpage>
<permissions>
<copyright-statement>© The Author(s) 2012 Reprints and permissions: sagepub.co.uk/journalsPermissions.nav</copyright-statement>
<copyright-year>2012</copyright-year>
<copyright-holder content-type="sage">SAGE Publications</copyright-holder>
</permissions>
<abstract>
<p>In this article, we consider methods for Bayesian computation within the context of brain imaging studies. In such studies, the complexity of the resulting data often necessitates the use of sophisticated statistical models; however, the large size of these data can pose significant challenges for model fitting. We focus specifically on the neuroelectromagnetic inverse problem in electroencephalography, which involves estimating the neural activity within the brain from electrode-level data measured across the scalp. The relationship between the observed scalp-level data and the unobserved neural activity can be represented through an underdetermined dynamic linear model, and we discuss Bayesian computation for such models, where parameters represent the unknown neural sources of interest. We review the inverse problem and discuss variational approximations for fitting hierarchical models in this context. While variational methods have been widely adopted for model fitting in neuroimaging, they have received very little attention in the statistical literature, where Markov chain Monte Carlo is often used. We derive variational approximations for fitting two models: a simple distributed source model and a more complex spatiotemporal mixture model. We compare the approximations to Markov chain Monte Carlo using both synthetic data as well as through the analysis of a real electroencephalography dataset examining the evoked response related to face perception. The computational advantages of the variational method are demonstrated and the accuracy associated with the resulting approximations are clarified.</p>
</abstract>
<kwd-group>
<kwd>electroencephalography</kwd>
<kwd>Metropolis–Hastings algorithm</kwd>
<kwd>neuroelectromagnetic inverse problem</kwd>
<kwd>variational Bayes</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="sec1-0962280212448973"><title>1 Introduction</title>
<p>Functional neuroimaging is an important research tool in neuroscience, and imaging modalities such as electroencephalography (EEG), magnetoencephalography (MEG), functional magnetic resonance imaging (fMRI), and positron emission tomography (PET) have been used extensively to study brain function. The complexity of the resulting data often necessitates the use of sophisticated statistical modeling techniques that can allow for spatial dependence structure and flexibly model signal and noise and accommodate the complex experimental paradigms and physics associated with the underlying imaging modality.</p>
<p>Spatial modeling of fMRI and PET data has been considered by several authors (see e.g. Bowman,<sup><xref ref-type="bibr" rid="bibr1-0962280212448973">1</xref>,<xref ref-type="bibr" rid="bibr2-0962280212448973">2</xref></sup> Brezger et al.,<sup><xref ref-type="bibr" rid="bibr3-0962280212448973">3</xref></sup> Derado et al.,<sup><xref ref-type="bibr" rid="bibr4-0962280212448973">4</xref></sup> Johnson et al.<sup><xref ref-type="bibr" rid="bibr5-0962280212448973">5</xref></sup>). For the analysis of EEG and MEG data, spatial models based on Markov random field priors have been considered extensively for solving the associated inverse problem,<sup><xref ref-type="bibr" rid="bibr6-0962280212448973">6</xref>–<xref ref-type="bibr" rid="bibr8-0962280212448973">8</xref></sup> as well as for analysis at the sensor level in group studies (see Ismail et al.<sup><xref ref-type="bibr" rid="bibr9-0962280212448973">9</xref></sup>).</p>
<p>With the need for statistical models describing complex features, the large size of the associated data can pose significant challenges for model fitting and computation. In this article, we focus specifically on the neuroelectromagnetic inverse problem associated with EEG, which involves estimating the neural activity within the brain from electrode-level data measured across the scalp. The relationship between the observed scalp-level data and the unobserved neural activity can be represented through an underdetermined dynamic linear model, and we discuss Bayesian computation for such models, where parameters represent the unknown neural sources of interest.</p>
<p>In the neuroimaging literature, <italic>variational approximations</italic>, which arose in statistical physics,<sup><xref ref-type="bibr" rid="bibr10-0962280212448973">10</xref></sup> have been widely adopted for fast Bayesian inference with complex models.<sup><xref ref-type="bibr" rid="bibr11-0962280212448973">11</xref></sup> Conversely, variational methods have received relatively little attention in the statistical literature, where Markov chain Monte Carlo (MCMC) is often used. Comparison of these two approaches for Bayesian computation with spatial models for the EEG inverse problem is an interesting issue which has received little attention in the literature. An exception is the work of Nummenmaa et al.<sup><xref ref-type="bibr" rid="bibr12-0962280212448973">12</xref></sup> who compare variational Bayes with MCMC for fitting the EEG source reconstruction model developed by Sato et al.<sup><xref ref-type="bibr" rid="bibr13-0962280212448973">13</xref></sup> In addition to emphasizing the sensitivity of the results to the choice of hyperparameters, these authors use empirical investigations to demonstrate a primarily qualitative similarity in the resulting source estimates obtained from the two approaches. Importantly, the model considered in the comparisons made by Nummenmaa et al.<sup><xref ref-type="bibr" rid="bibr12-0962280212448973">12</xref></sup> is a non-spatial model, with the hierarchical prior assuming independent brain activity across different cortical locations. In contrast, our comparison of computational methods, and subsequent data application, is unique in that it includes an explicitly spatiotemporal model. In addition, our presentation is geared toward a statistical audience for whom variational methods are relatively unfamiliar.</p>
<p>We begin in <xref ref-type="sec" rid="sec2-0962280212448973">Section 2</xref> by reviewing the EEG inverse problem, and discuss imaging-based solutions, which can be formulated as underdetermined linear or dynamic linear models. The associated posterior distributions are complex, and computing these distributions requires numerical approximations over a high-dimensional parameter space, while accommodating the large size of the data. With this in mind, <xref ref-type="sec" rid="sec3-0962280212448973">Section 3</xref> provides a review of variational methods for computing complex models in a general setting. In <xref ref-type="sec" rid="sec4-0962280212448973">Section 4</xref>, we make comparisons with MCMC using two models for EEG source reconstruction. We begin with a rather simple model, and carefully derive a variational approximation to the posterior distribution. Using simulated data, this approximation is then compared to the results obtained from fitting the model with a Gibbs sampling algorithm. We then consider a more complex spatiotemporal model recently developed by Nathoo et al.<sup><xref ref-type="bibr" rid="bibr14-0962280212448973">14</xref></sup> and compare a variational approximation to the results obtained from a Metropolis–Hastings algorithm. <xref ref-type="sec" rid="sec5-0962280212448973">Section 5</xref> presents an analysis of a real EEG dataset examining the evoked response to face perception, and <xref ref-type="sec" rid="sec6-0962280212448973">Section 6</xref> concludes with a discussion.</p>
</sec>
<sec id="sec2-0962280212448973"><title>2 The EEG inverse problem</title>
<p>EEG is an imaging technique that enables recording of the electrical activity along the scalp, and measures the scalp electric potentials produced by electrical activity within the brain, in the neural cell assemblies. In a typical EEG experiment examining an evoked response, the subject is presented with a stimulus, and this stimulus causes synchronous activation of neurons in a functional region of the brain, generating small electric currents within the brain. This current flow produces a small electric field that can be measured at different spatial locations on the scalp, producing a time series at each EEG electrode.</p>
<p>As an example, <xref ref-type="fig" rid="fig1-0962280212448973">Figure 1(a) and (b)</xref>, illustrates the data collected from a single subject in an EEG study examining the evoked response in a study of face perception.<sup><xref ref-type="bibr" rid="bibr15-0962280212448973">15</xref></sup> In each trial of this experiment, the subject is presented with a stimulus (either a face or scrambled face), and is thereafter required to make a four-way symmetry judgment. The experiment consists of 172 trials in total (86 faces; 86 scrambled faces), and the data recorded at each scalp location are averaged across trials separately for faces and scrambled faces. The trial-averaged series corresponding to faces and scrambled faces are then subtracted to produce the differential evoked response depicted in <xref ref-type="fig" rid="fig1-0962280212448973">Figure 1</xref>, with (a) depicting the time series collected at each electrode and (b) the spatial profile of the scalp level data at <italic>t</italic> = 200 ms following the stimulus onset. Reconstructing sources associated with the differential evoked response can reveal how the brain processes the recognition of faces in contrast to the processing of scrambled faces.
<fig id="fig1-0962280212448973" position="float"><label>Figure 1.</label><caption><p>Observed EEG data: (a) EEG time series corresponding to differences between faces and scrambled faces (Note <italic>t</italic> = 0 corresponds to the presentation of the stimulus); (b) spatial profile of the scalp-level data at <italic>t</italic> = 200 ms after presentation of stimulus; (c) cortical surface with vertices grouped into 50 clusters using a K-means algorithm; and (d) cortical surface grouped into 500 clusters using a K-means algorithm. EEG: electroencephalography.</p></caption><graphic xlink:href="10.1177_0962280212448973-fig1.tif"/>
</fig></p>
<p>Data collected using EEG typically allow for a very high temporal resolution, relative to fMRI and PET; however, the spatial resolution of EEG is relatively limited, with at most a few hundred electrodes measuring electrical activity at the scalp-level. Moreover, while the scalp level measurements are typically used in clinical settings, the neural source activity within the brain that underlies the observed EEG data is of far greater interest in scientific studies examining brain activity. More specifically, given the scalp-level EEG time series, it is of interest to infer upon the location within the brain, the extent, and the dynamic behavior of the current sources that gave rise to the scalp-level data.</p>
<p>The problem of using the EEG measurements to infer the spatial distribution and dynamics of the latent neural sources is an ill-posed inverse problem<sup><xref ref-type="bibr" rid="bibr16-0962280212448973">16</xref></sup> in the sense that the observed data cannot uniquely determine the underlying neural activity, and a large number of different configurations for this activity may describe the observed data equally well. When working with statistical models in this context, the ill-posed nature of this inverse problem will typically lead to identification issues with overparameterized models necessitating some form of regularization, either through penalization schemes or priors specified within a hierarchical Bayes framework.</p>
<p>For tractability, the problem is discretized over space, and the vector field of interest is represented through a finite number of point sources known as electric dipoles. Each dipole is a representation of the coherent activation of many neurons covering a small patch of gray matter, and the neural activity is then represented by: (a) the number of dipoles <italic>p</italic>; (b) the locations of these dipoles <bold><italic>s</italic></bold><sub>1</sub>, … , <bold><italic>s</italic></bold><sub><italic>p</italic></sub> ∈ <italic>R</italic><sup>3</sup>; and (c) the temporal dynamics at each location (magnitude and orientation of neuronal current flow over time), which, for each dipole, is characterized by a vector-valued function <bold><italic>q</italic></bold><sub><italic>j</italic></sub>(<italic>t</italic>) ∈ <italic>R</italic><sup>3</sup>, <italic>j</italic> = 1, … , <italic>p</italic>, known as an electric dipole moment.</p>
<p>While there are various general approaches to this estimation problem (see Baillet et al.<sup><xref ref-type="bibr" rid="bibr16-0962280212448973">16</xref></sup> for a general overview), we will focus our discussion of computational issues on the imaging-based methods, also known as <italic>distributed methods</italic>, which tend to be more statistical in nature. The imaging methods assume, in addition to the EEG data, the availability of a cortical surface extracted from the subject's structural MRI (see <xref ref-type="fig" rid="fig1-0962280212448973">Figure 1(c) and (d)</xref> for examples of such a surface). This cortical surface is tesselated with a triangular mesh, and a single dipole is assigned to each of a large number of vertices covering the surface, so that, <italic>p</italic>, the number of dipoles is fixed, and the locations <bold><italic>s</italic></bold><sub>1</sub>, … , <bold><italic>s</italic></bold><sub><italic>p</italic></sub> are also fixed and constrained to lie on the cortex.</p>
<p>With the dipoles constrained to lie on the surface of the cortex, it is reasonable to assume based on the underlying neurophysiology<sup><xref ref-type="bibr" rid="bibr16-0962280212448973">16</xref></sup> that the corresponding moments <bold><italic>q</italic></bold><sub><italic>j</italic></sub>(<italic>t</italic>) have a fixed (time-constant) orientation that is perpendicular to the cortical surface at each location. In this case, each dipole moment can be expressed as <bold><italic>q</italic></bold><sub><italic>j</italic></sub>(<italic>t</italic>) = <italic>S</italic><sub><italic>j</italic></sub>(<italic>t</italic>)<bold>φ</bold><sub><italic>j</italic></sub>, where <bold>φ</bold><sub><italic>j</italic></sub> denotes the known orientation, and the scalar-valued function <italic>S</italic><sub><italic>j</italic></sub>(<italic>t</italic>) is an unknown function of time representing the magnitude |<italic>S</italic><sub><italic>j</italic></sub>(<italic>t</italic>)| and polarity sgn(<italic>S</italic><sub><italic>j</italic></sub>(<italic>t</italic>)) of the dipole moment at the <italic>j</italic>th cortical location.</p>
<p>Under these assumptions, the data can be related to the underlying neuronal sources through a dynamic linear model<sup><xref ref-type="bibr" rid="bibr17-0962280212448973">17</xref></sup>
<disp-formula id="disp-formula1-0962280212448973"><label>(1)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math1-0962280212448973"><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold">S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi mathvariant="bold">ε</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">,</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn><mml:mo mathvariant="bold">,</mml:mo><mml:mo mathvariant="bold">…</mml:mo><mml:mo mathvariant="bold">,</mml:mo><mml:mtext mathvariant="bold">T</mml:mtext></mml:mrow></mml:math><graphic alternate-form-of="disp-formula1-0962280212448973" xlink:href="10.1177_0962280212448973-eq1.tif"/></disp-formula>
where <bold><italic>Y</italic></bold>(<italic>t</italic>) = (<italic>Y</italic><sub>1</sub>(<italic>t</italic>), … , <italic>Y</italic><sub><italic>n</italic></sub>(<italic>t</italic>))′ is the EEG at time <italic>t</italic>, with <italic>n</italic> being the number of EEG electrodes; <bold><italic>S</italic></bold>(<italic>t</italic>) = (<italic>S</italic><sub>1</sub>(<italic>t</italic>), … , <italic>S</italic><sub><italic>p</italic></sub>(<italic>t</italic>))′ the unknown neuronal activity at time <italic>t</italic>; <bold>ε</bold>(<italic>t</italic>) the sensor noise, typically assumed Gaussian with a structured covariance matrix; and <bold><italic>X</italic></bold> the <italic>n</italic> × <italic>p</italic> matrix, also known as the forward operator, which encodes the EEG physics; it is governed by Maxwell's equations of electrodynamics, in addition to various assumptions regarding the shape and conductivity of the head. The forward operator <bold><italic>X</italic></bold> depends on the EEG sensor locations on the scalp as well as both the locations and orientations of the <italic>p</italic> dipole moments on the cortex; however, these are assumed known under the distributed framework, so that this matrix can be precomputed once and subsequently treated as a fixed design matrix. Estimation and inference on the neural activity <bold><italic>S</italic></bold>(<italic>t</italic>) in equation (<xref ref-type="disp-formula" rid="disp-formula1-0962280212448973">1</xref>) thus constitutes a solution to the EEG inverse problem; however, the dimension and structure of <bold><italic>X</italic></bold> makes this a difficult task.</p>
<p>Each column of <bold><italic>X</italic></bold> corresponds to a particular location on the cortical surface and represents the value <italic>Y</italic> that would be observed at the scalp level, given a unit current source <italic>S</italic><sub><italic>j</italic></sub>(<italic>t</italic>) = 1 at this location. It is typical to assume a very large number of sources so that <italic>p</italic> &gt; <italic>n</italic> (for instance, <italic>p</italic> = 8196 and <italic>n</italic> = 128 in Section 4.1), and the linear model is thus underdetermined. In addition, different columns of <bold><italic>X</italic></bold> will correspond to neighboring cortical locations so that these columns of <bold><italic>X</italic></bold> can be very highly correlated, leading to multicollinearity. For these reasons, fitting the model (<xref ref-type="disp-formula" rid="disp-formula1-0962280212448973">1</xref>) can be very challenging and requires regularization of some form, either through penalization schemes,<sup><xref ref-type="bibr" rid="bibr17-0962280212448973">17</xref>–<xref ref-type="bibr" rid="bibr19-0962280212448973">19</xref></sup> or priors incorporated in a hierarchical Bayes framework.<sup><xref ref-type="bibr" rid="bibr20-0962280212448973">20</xref>,<xref ref-type="bibr" rid="bibr21-0962280212448973">21</xref></sup></p>
<p>Bayesian model based approaches to the inverse problem impose regularization through priors on the unknown source activity <bold><italic>S</italic></bold> = {<italic>S</italic><sub><italic>j</italic></sub>(<italic>t</italic>), <italic>j</italic> = 1…, <italic>p</italic>, <italic>t</italic> = 1, … , <italic>T</italic>} in equation (<xref ref-type="disp-formula" rid="disp-formula1-0962280212448973">1</xref>). These priors can take various forms, for example, simple independent Gaussian priors imposing a global penalty through a single hyperparameter; independent Gaussian priors that allow for an adaptive penalty by allowing a separate hyperparameter at each brain location;<sup><xref ref-type="bibr" rid="bibr13-0962280212448973">13</xref></sup> spatial smoothing priors based on Gaussian or non-Gaussian Markov random fields;<sup><xref ref-type="bibr" rid="bibr6-0962280212448973">6</xref>,<xref ref-type="bibr" rid="bibr7-0962280212448973">7</xref>,<xref ref-type="bibr" rid="bibr22-0962280212448973">22</xref></sup> or more complex multiple sparse priors.<sup><xref ref-type="bibr" rid="bibr20-0962280212448973">20</xref>,<xref ref-type="bibr" rid="bibr21-0962280212448973">21</xref></sup> Given the number of unknown parameters characterizing the neural activity, with <italic>p</italic> &gt; <italic>n</italic>, and with a high degree of multicollinearity in <bold><italic>X</italic></bold>, the associated posterior distribution can be difficult to summarize, and doing this in a computationally efficient manner suggests the need for analytic approximations.</p>
</sec>
<sec id="sec3-0962280212448973"><title>3 Variational Bayes approximations</title>
<p>Variational methods are commonly employed for fitting complex models in machine learning<sup><xref ref-type="bibr" rid="bibr23-0962280212448973">23</xref>,<xref ref-type="bibr" rid="bibr24-0962280212448973">24</xref></sup> and have also gained popularity for Bayesian computing in neuroimaging.<sup><xref ref-type="bibr" rid="bibr11-0962280212448973">11</xref>,<xref ref-type="bibr" rid="bibr20-0962280212448973">20</xref></sup> The approximation of the posterior distribution <italic>P</italic>(<bold><italic>θ</italic></bold>|<bold><italic>Y</italic></bold>) = <italic>P</italic>(<bold><italic>θ</italic></bold>,<bold><italic>Y</italic></bold>)/<italic>P</italic>(<bold><italic>Y</italic></bold>) is based on deriving and optimizing a lower bound for log <italic>P</italic>(<bold><italic>Y</italic></bold>), the log-marginal likelihood of the data. For simplicity of presentation, we will assume that all components of <bold><italic>θ</italic></bold> are continuous. To provide a lower bound to the log-marginal likelihood <inline-formula id="ilm1-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math1-0962280212448973"><mml:mrow><mml:mi>log</mml:mi><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>log</mml:mi><mml:mo stretchy="false">{</mml:mo><mml:mi>P/</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">θ</mml:mi><mml:mo mathvariant="bold">,</mml:mo><mml:mtext mathvariant="bold">Y</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">θ</mml:mi><mml:mo mathvariant="bold">|</mml:mo><mml:mtext mathvariant="bold">Y</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>, we let <italic>q</italic>(<bold><italic>θ</italic></bold>) be any density having the same support as the posterior and express the log-marginal likelihood as <inline-formula id="ilm2-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math2-0962280212448973"><mml:mrow><mml:mi>log</mml:mi><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:mi>log</mml:mi><mml:mo stretchy="false">{</mml:mo><mml:mi>P/</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">θ</mml:mi><mml:mo mathvariant="bold">,</mml:mo><mml:mtext mathvariant="bold">Y</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">θ</mml:mi><mml:mo mathvariant="bold">|</mml:mo><mml:mtext mathvariant="bold">Y</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">}</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext>d</mml:mtext><mml:mi mathvariant="bold">θ</mml:mi><mml:mo mathvariant="bold">=</mml:mo></mml:mrow></mml:math></inline-formula> <inline-formula id="ilm3-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math3-0962280212448973"><mml:mrow><mml:mo>∫</mml:mo><mml:mi>log</mml:mi><mml:mo stretchy="false">{</mml:mo><mml:mi>P/</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">θ</mml:mi><mml:mo mathvariant="bold">,</mml:mo><mml:mtext mathvariant="bold">Y</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mtext mathvariant="bold">q</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">θ</mml:mi><mml:mo mathvariant="bold">|</mml:mo><mml:mtext mathvariant="bold">Y</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mtext mathvariant="bold">q</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">}</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext>d</mml:mtext><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow></mml:math></inline-formula> so that
<disp-formula id="disp-formula2-0962280212448973"><label>(2)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math2-0962280212448973"><mml:mrow><mml:mi>log</mml:mi><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:mi>log</mml:mi><mml:mo stretchy="false">{</mml:mo><mml:mi>P/</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">θ</mml:mi><mml:mo mathvariant="bold">,</mml:mo><mml:mtext mathvariant="bold">Y</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo> </mml:mo><mml:mo>}</mml:mo></mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext>d</mml:mtext><mml:mi mathvariant="bold">θ</mml:mi><mml:mo mathvariant="bold">+</mml:mo><mml:mo mathvariant="bold">∫</mml:mo><mml:mtext mathvariant="bold">log</mml:mtext><mml:mo stretchy="false">{</mml:mo><mml:mtext mathvariant="bold">q</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext mathvariant="bold">P</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">θ</mml:mi><mml:mo mathvariant="bold">|</mml:mo><mml:mtext mathvariant="bold">Y</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">}</mml:mo></mml:mrow><mml:mtext mathvariant="bold">q</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext>d</mml:mtext><mml:mi mathvariant="bold">θ</mml:mi><mml:mo mathvariant="bold">=</mml:mo><mml:mtext mathvariant="bold">F</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mtext mathvariant="bold">KL</mml:mtext></mml:mrow></mml:math><graphic alternate-form-of="disp-formula2-0962280212448973" xlink:href="10.1177_0962280212448973-eq2.tif"/></disp-formula>
The second term on the right-hand side of equation (<xref ref-type="disp-formula" rid="disp-formula2-0962280212448973">2</xref>) is the Kullback–Leibler divergence <inline-formula id="ilm4-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math4-0962280212448973"><mml:mrow><mml:mi>KL</mml:mi><mml:mo>=</mml:mo></mml:mrow></mml:math></inline-formula> <inline-formula id="ilm5-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math5-0962280212448973"><mml:mrow><mml:mo>∫</mml:mo><mml:mi>log</mml:mi><mml:mo stretchy="false">{</mml:mo><mml:mi>q/</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">θ</mml:mi><mml:mo mathvariant="bold">|</mml:mo><mml:mtext mathvariant="bold">Y</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">}</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext>d</mml:mtext><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow></mml:math></inline-formula> between <italic>q</italic>(<bold><italic>θ</italic></bold>) and the posterior distribution <italic>P</italic>(<bold><italic>θ</italic></bold>|<bold><italic>Y</italic></bold>). Since this divergence is always non-negative, we have <inline-formula id="ilm6-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math6-0962280212448973"><mml:mrow><mml:mi>log</mml:mi><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≥</mml:mo><mml:mo>∫</mml:mo><mml:mi>log</mml:mi><mml:mo stretchy="false">{</mml:mo><mml:mi>P/</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">θ</mml:mi><mml:mo mathvariant="bold">,</mml:mo><mml:mtext mathvariant="bold">Y</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">}</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext>d</mml:mtext><mml:mi mathvariant="bold">θ</mml:mi><mml:mo mathvariant="bold">=</mml:mo><mml:mtext mathvariant="bold">F</mml:mtext></mml:mrow></mml:math></inline-formula> so that <italic>F</italic> is a lower bound.</p>
<p>When <italic>q</italic>(<bold><italic>θ</italic></bold>) = <italic>P</italic>(<bold><italic>θ</italic></bold>|<bold><italic>Y</italic></bold>), the Kullback–Leibler divergence is zero, and the lower bound becomes exact. When <italic>q</italic>(<bold><italic>θ</italic></bold>) ≠ <italic>P</italic>(<bold><italic>θ</italic></bold>|<bold><italic>Y</italic></bold>), we can view <italic>q</italic>(<bold><italic>θ</italic></bold>) as an approximation to the posterior distribution, with <italic>KL</italic> quantifying the degree of separation between the exact and approximate posterior distributions. The variational approach is based on restricting <italic>q</italic>(<bold><italic>θ</italic></bold>) to a manageable class of distributions and minimizing <italic>KL</italic> within this class. From equation (<xref ref-type="disp-formula" rid="disp-formula2-0962280212448973">2</xref>), this is equivalent to maximizing the functional <italic>F</italic> with respect to <italic>q</italic>(<bold><italic>θ</italic></bold>).</p>
<p>To make the maximization of <italic>F</italic> tractable, it is common to separate the parameter vector into components <bold><italic>θ</italic></bold> = (<bold><italic>θ</italic></bold><sub>1</sub>, … , <bold><italic>θ</italic></bold><sub><italic>k</italic></sub>) and assume that the approximate posterior factorizes
<disp-formula id="disp-formula3-0962280212448973"><label>(3)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math3-0962280212448973"><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">=</mml:mo><mml:munderover><mml:mo>Π</mml:mo><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mtext mathvariant="bold">k</mml:mtext></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mtext mathvariant="bold">q</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><graphic alternate-form-of="disp-formula3-0962280212448973" xlink:href="10.1177_0962280212448973-eq3.tif"/></disp-formula>
which is referred to as a ‘mean-field approximation.’ Importantly, the individual variational distributions <italic>q</italic><sub><italic>l</italic></sub>(<bold><italic>θ</italic></bold><sub><italic>l</italic></sub>) are left unspecified and only the factorization is assumed, making this a type of non-parametric approximation.<sup><xref ref-type="bibr" rid="bibr25-0962280212448973">25</xref></sup></p>
<p>The functional <italic>F</italic> = <italic>F</italic>(<italic>q</italic><sub>1</sub>(<bold><italic>θ</italic></bold><sub>1</sub>), … , <italic>q</italic><sub><italic>k</italic></sub>(<bold><italic>θ</italic></bold><sub><italic>k</italic></sub>)) is maximized with respect to the free distributions <italic>q</italic><sub>1</sub>(<bold><italic>θ</italic></bold><sub>1</sub>), … , <italic>q</italic><sub><italic>k</italic></sub>(<bold><italic>θ</italic></bold><sub><italic>k</italic></sub>) and the maximizers, in conjunction with equation (<xref ref-type="disp-formula" rid="disp-formula3-0962280212448973">3</xref>), yield the analytic approximation to the posterior. The optimization of <italic>F</italic> is based on the calculus of variations, which is used to derive an iterative procedure that maximizes <italic>F</italic> using a coordinate ascent in the function space of variational distributions. More specifically, if we assume that only <italic>q</italic><sub><italic>i</italic></sub>(<bold><italic>θ</italic></bold><sub><italic>i</italic></sub>) is unknown and that <italic>q</italic><sub>1</sub>(<bold><italic>θ</italic></bold><sub>1</sub>), … , <italic>q</italic><sub><italic>i</italic>−1</sub>(<bold><italic>θ</italic></bold><sub><italic>i</italic>−1</sub>), <italic>q</italic><sub><italic>i</italic>+1</sub>(<bold><italic>θ</italic></bold><sub><italic>i</italic>+1</sub>), … , <italic>q</italic><sub><italic>k</italic></sub>(<bold><italic>θ</italic></bold><sub><italic>k</italic></sub>) are fixed, the density <italic>q</italic><sub><italic>i</italic></sub>(<bold><italic>θ</italic></bold><sub><italic>i</italic></sub>) that maximizes <italic>F</italic> is obtained by taking a functional derivative of <italic>F</italic> and equating <inline-formula id="ilm7-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math7-0962280212448973"><mml:mrow><mml:mo>∂/</mml:mo><mml:mi>F</mml:mi><mml:mo>∂</mml:mo><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">i</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> to zero, and this Euler–Lagrange differential equation can be solved (see e.g. Ghahramani and Beal<sup><xref ref-type="bibr" rid="bibr23-0962280212448973">23</xref></sup>) to yield
<disp-formula id="disp-formula4-0962280212448973"><label>(4)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math4-0962280212448973"><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">i</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">∝</mml:mo><mml:mtext mathvariant="bold">exp</mml:mtext><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">E</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">q</mml:mtext></mml:mrow><mml:mrow><mml:mo mathvariant="bold">-</mml:mo><mml:mtext mathvariant="bold">i</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mtext mathvariant="bold">logP</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">i</mml:mtext></mml:mrow></mml:msub><mml:mo mathvariant="bold">|</mml:mo><mml:mtext mathvariant="bold">Y</mml:mtext><mml:mo mathvariant="bold">,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mrow><mml:mo mathvariant="bold">-</mml:mo><mml:mtext mathvariant="bold">i</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><graphic alternate-form-of="disp-formula4-0962280212448973" xlink:href="10.1177_0962280212448973-eq4.tif"/></disp-formula>
where <italic>P</italic>(<bold><italic>θ</italic></bold><sub><italic>i</italic></sub>|<bold><italic>Y</italic></bold>, <bold><italic>θ</italic></bold><sub>−<italic>i</italic></sub>) is the full conditional distribution of <bold><italic>θ</italic></bold><sub><italic>i</italic></sub>, and the expectation in equation (<xref ref-type="disp-formula" rid="disp-formula4-0962280212448973">4</xref>) is taken with respect to <italic>q</italic><sub>−<italic>i</italic></sub> = ∏<sub><italic>l</italic>≠<italic>i</italic></sub> <italic>q</italic><sub><italic>l</italic></sub>(<bold><italic>θ</italic></bold><sub><italic>l</italic></sub>). After initializing the variational distributions <inline-formula id="ilm8-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math8-0962280212448973"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">,</mml:mo><mml:mo mathvariant="bold">…</mml:mo><mml:mo mathvariant="bold">,</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">q</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">k</mml:mtext> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">k</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, each iteration of the variational Bayes algorithm cycles through the <italic>k</italic> components of <bold><italic>θ</italic></bold> = (<bold><italic>θ</italic></bold><sub>1</sub>, … , <bold><italic>θ</italic></bold><sub><italic>k</italic></sub>) and updates the corresponding variational distribution according to equation (<xref ref-type="disp-formula" rid="disp-formula4-0962280212448973">4</xref>). At the end of each iteration, an updated value of the lower bound <italic>F</italic> is computed, and the algorithm is iterated until convergence of <italic>F</italic> to its maximum.</p>
<p>We note that while the forms of the variational distributions <italic>q</italic><sub><italic>l</italic></sub>(<bold><italic>θ</italic></bold><sub><italic>l</italic></sub>), <italic>l</italic> = 1, … , <italic>k</italic> are left unspecified in equation (<xref ref-type="disp-formula" rid="disp-formula3-0962280212448973">3</xref>), the structure of the statistical model itself will often lead to a solution that lies in a particular parametric family for each <italic>q</italic><sub><italic>l</italic></sub>(<bold><italic>θ</italic></bold><sub><italic>l</italic></sub>), in which case the update step (<xref ref-type="disp-formula" rid="disp-formula4-0962280212448973">4</xref>) reduces to simply updating the parameters characterizing the members of this family. For example, this is typically the case when conjugate or conditionally conjugate priors are adopted, which makes the variational approach well suited to models amenable to Gibbs sampling. For non-conjugate settings (where MCMC typically employs Metropolis–Hastings steps), the normalizing constant in equation (<xref ref-type="disp-formula" rid="disp-formula4-0962280212448973">4</xref>) must be computed numerically, or further analytic approximations (e.g. a Taylor approximation) are made. This issue is illustrated in Section 3.2.</p>
<p>Finally, we note that the mean-field factorization (<xref ref-type="disp-formula" rid="disp-formula3-0962280212448973">3</xref>) implies posterior independence between the various components of <bold><italic>θ</italic></bold>, and depending on the chosen partition of <bold><italic>θ</italic></bold>, this independence assumption may be rather untenable in many settings (e.g. models with spatial random effects). Despite this stochastic independence, the moments of the variational distributions <italic>q</italic><sub><italic>l</italic></sub>(<bold><italic>θ</italic></bold><sub><italic>l</italic></sub>) are tightly coupled through the update equations defined by (<xref ref-type="disp-formula" rid="disp-formula4-0962280212448973">4</xref>), and as a result, the variational approximation replaces stochastic dependence in the posterior distribution with deterministic dependence between posterior moments.</p>
</sec>
<sec id="sec4-0962280212448973"><title>4 EEG source reconstruction based on synthetic data</title>
<p>To compare variational approximations with MCMC for Bayesian source reconstruction, we begin by making comparisons within the context of simulated data, and we consider two cases. In the first, we work with a relatively simple model and simulate the scalp-level data for a single time point. This model, due to its simplicity, will serve primarily to illustrate the derivations required to implement the variational approximation. In the second case, we will work with a complex spatiotemporal mixture model, recently proposed by Nathoo et al.<sup><xref ref-type="bibr" rid="bibr14-0962280212448973">14</xref></sup> and fit this model to simulated data using both variational Bayes and MCMC.</p>
<p>In both cases, the forward fields in <bold><italic>X</italic></bold> are computed based on a boundary element model<sup><xref ref-type="bibr" rid="bibr26-0962280212448973">26</xref></sup> using the SPM8 software<sup><xref ref-type="bibr" rid="bibr27-0962280212448973">27</xref></sup> based on <italic>n</italic> = 128 EEG sensor locations and <italic>p</italic> = 8196 brain locations on the cortical surface. The large number of cortical locations can be grouped to reduce the computational burden associated with model fitting. Zariffa and Popovic,<sup><xref ref-type="bibr" rid="bibr28-0962280212448973">28</xref></sup> within the context of peripheral nerve source localization, suggest reduction through combining the columns of <bold><italic>X</italic></bold> corresponding to spatial clusters of vertices. We employ this technique here and choose to cluster the vertex locations on each hemisphere into <italic>p</italic>′/2 groups using a K-means algorithm, leading to a total of <italic>p</italic>′ clusters covering the cortical surface. The columns of <bold><italic>X</italic></bold> corresponding to each cluster are then summed to produce a reduced <bold><italic>X</italic></bold> with <italic>p</italic>′ &lt; <italic>p</italic> columns. Reducing <bold><italic>X</italic></bold> in this way is equivalent to assuming that the source activity is identical for each vertex in a given cluster. In practice the choice of <italic>p</italic>′ depends on the desired spatial resolution; however, <italic>p</italic>′ &gt; <italic>n</italic> would still be necessary to achieve the resolution required in most applications.</p>
<sec id="sec5-0962280212448973"><title>4.1 Single time point with distributed sources: Minimum-norm solution</title>
<p>Assuming that the scalp-level data are collected at only a single time point, the model relating the EEG to the source values (<xref ref-type="disp-formula" rid="disp-formula1-0962280212448973">1</xref>) simplifies to an underdetermined linear model <bold><italic>Y</italic></bold> = <bold><italic>XS</italic></bold> + <bold>ε</bold>, where <bold><italic>S</italic></bold> = (<italic>S</italic><sub>1</sub>, … , <italic>S</italic><sub><italic>p</italic></sub>)′ is the vector of source values underlying the observed EEG; and <bold><italic>X</italic></bold> the <italic>n</italic> × <italic>p</italic> forward operator as before. A rather simplistic, though commonly used model, is the minimum norm model, which assumes <inline-formula id="ilm9-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math9-0962280212448973"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>λ</mml:mi><mml:mfrac linethickness="0"><mml:mrow><mml:mi>iid</mml:mi></mml:mrow><mml:mrow><mml:mo>~</mml:mo></mml:mrow></mml:mfrac><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula>, with the precision λ either estimated using empirical Bayes or assigned a conditionally conjugate prior λ ∼ gamma(<italic>a</italic><sub>λ</sub>, <italic>b</italic><sub>λ</sub>). From a statistical perspective, this model is a Bayesian ridge regression,<sup><xref ref-type="bibr" rid="bibr29-0962280212448973">29</xref></sup> with the exchangeable prior on the source values serving to counter the instability arising from the highly correlated columns of <bold><italic>X</italic></bold>, in addition to penalizing for overfitting when <italic>p</italic>′ &gt; <italic>n</italic>. The model imposes a quadratic penalty that arises from the assumed Gaussian prior assigned to the source values. For the sensor level errors, we assume <inline-formula id="ilm10-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math10-0962280212448973"><mml:mrow><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>τ</mml:mi><mml:mfrac linethickness="0"><mml:mrow><mml:mi>iid</mml:mi></mml:mrow><mml:mrow><mml:mo>~</mml:mo></mml:mrow></mml:mfrac><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> with τ ∼ gamma(<italic>a</italic><sub>τ</sub>, <italic>b</italic><sub>τ</sub>), and we simulate the true values of <bold><italic>S</italic></bold> and <bold>ε</bold> based on fixed values λ = 1 and τ = 2. These are then combined with <bold><italic>X</italic></bold> to obtain the simulated EEG data.</p>
<p>The penalty associated with the minimum norm model is rather simplistic as it does not encourage sparsity, which is a common feature in the true source configurations underlying evoked response brain activity, and in addition, does not encourage any spatial smoothing. Such a model may be suitable when the underlying neural activity is highly distributed across the cortex, with little structure in the distribution. As such, it may be a suitable model for spontaneous brain activity, where study subjects simply remain in a resting state.</p>
<p>In our study, we simulate two datasets, the first based on a coarse resolution <italic>p</italic>′ = 50 and the second based on a much finer resolution <italic>p</italic>′ = 500. The two resolutions are depicted in <xref ref-type="fig" rid="fig1-0962280212448973">Figure 1(c) and (d)</xref> and enable us to compare the relative performance of variational Bayes and MCMC in the <italic>p</italic>′ &lt; <italic>n</italic> and the <italic>p</italic>′ &gt; <italic>n</italic> cases.</p>
<p>The model parameters are <bold><italic>θ</italic></bold> = {<bold><italic>S</italic></bold>, λ, τ} and the posterior density function
<disp-formula id="disp-formula5-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math5-0962280212448973"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">θ</mml:mi><mml:mo mathvariant="bold">|</mml:mo><mml:mtext mathvariant="bold">Y</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">∝</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:munderover><mml:mo>Π</mml:mo><mml:mrow><mml:mtext mathvariant="bold">i</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mtext mathvariant="bold">n</mml:mtext></mml:mrow></mml:munderover><mml:mtext mathvariant="bold">N</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Y</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">i</mml:mtext></mml:mrow></mml:msub><mml:mo mathvariant="bold">|</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext><mml:mo mathvariant="bold">'</mml:mo></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mtext mathvariant="bold">X</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">ij</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mtext mathvariant="bold">S</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold">τ</mml:mi><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">)</mml:mo></mml:mrow><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">]</mml:mo></mml:mrow><mml:mo mathvariant="bold">×</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:munderover><mml:mo>Π</mml:mo><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext><mml:mo mathvariant="bold">'</mml:mo></mml:mrow></mml:munderover><mml:mtext mathvariant="bold">N</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">S</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub><mml:mo mathvariant="bold">|</mml:mo><mml:mn>0</mml:mn><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold">λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">]</mml:mo></mml:mrow><mml:mo mathvariant="bold">×</mml:mo><mml:mtext mathvariant="bold">gamma</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">λ</mml:mi><mml:mo mathvariant="bold">|</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">a</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">λ</mml:mi></mml:mrow></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">b</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">λ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">×</mml:mo><mml:mtext mathvariant="bold">gamma</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">τ</mml:mi><mml:mo mathvariant="bold">|</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">a</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">τ</mml:mi></mml:mrow></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">b</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">τ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><graphic alternate-form-of="disp-formula5-0962280212448973" xlink:href="10.1177_0962280212448973-eq5.tif"/></disp-formula>
is easily sampled using a Gibbs sampling algorithm. The variational approximation <italic>q</italic>(<bold><italic>θ</italic></bold>) is based on the mean-field factorization
<disp-formula id="disp-formula6-0962280212448973"><label>(5)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math6-0962280212448973"><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:munderover><mml:mo>Π</mml:mo><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext><mml:mo mathvariant="bold">'</mml:mo></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mtext mathvariant="bold">q</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">S</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">S</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">]</mml:mo></mml:mrow><mml:mo mathvariant="bold">×</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">q</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">τ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">τ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">×</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">q</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">λ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><graphic alternate-form-of="disp-formula6-0962280212448973" xlink:href="10.1177_0962280212448973-eq6.tif"/></disp-formula>
and the variational updates are derived based on equation (<xref ref-type="disp-formula" rid="disp-formula4-0962280212448973">4</xref>). To implement these updates, we assume at the start of iteration <italic>r</italic> + 1 that the values of the variational distributions in the algorithm are <inline-formula id="ilm11-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math11-0962280212448973"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
<p>We begin by updating the variational distribution for τ which has full conditional distribution <inline-formula id="ilm12-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math12-0962280212448973"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mrow><mml:mo mathvariant="bold">-</mml:mo><mml:mi mathvariant="bold">τ</mml:mi></mml:mrow></mml:msub><mml:mo mathvariant="bold">~</mml:mo><mml:mtext mathvariant="bold">gamma</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">a</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">τ</mml:mi></mml:mrow></mml:msub><mml:mo mathvariant="bold">+</mml:mo><mml:mtext mathvariant="bold">n</mml:mtext><mml:mo mathvariant="bold">/</mml:mo><mml:mn>2</mml:mn><mml:mo mathvariant="bold">,</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">b</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">τ</mml:mi></mml:mrow></mml:msub><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1/2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">Y</mml:mtext><mml:mo mathvariant="bold">-</mml:mo><mml:mtext mathvariant="bold">XS</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">'</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">Y</mml:mtext><mml:mo mathvariant="bold">-</mml:mo><mml:mtext mathvariant="bold">XS</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The log-full conditional density takes the form
<disp-formula id="disp-formula7-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math7-0962280212448973"><mml:mrow><mml:mi>log</mml:mi><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mrow><mml:mo mathvariant="bold">-</mml:mo><mml:mi mathvariant="bold">τ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">=</mml:mo><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">(</mml:mo></mml:mrow><mml:mtext mathvariant="bold">n</mml:mtext><mml:mn>2</mml:mn><mml:mo mathvariant="bold">+</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">a</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">τ</mml:mi></mml:mrow></mml:msub><mml:mo mathvariant="bold">-</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">)</mml:mo></mml:mrow><mml:mtext mathvariant="bold">log</mml:mtext><mml:mi mathvariant="bold">τ</mml:mi><mml:mo mathvariant="bold">-</mml:mo><mml:mi mathvariant="bold">τ/</mml:mi><mml:mn>2</mml:mn><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">i</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mtext mathvariant="bold">n</mml:mtext></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Y</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">i</mml:mtext></mml:mrow></mml:msub><mml:mo mathvariant="bold">-</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mtext mathvariant="bold">X</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">ij</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mtext mathvariant="bold">S</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi/><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo mathvariant="bold">-</mml:mo><mml:mi mathvariant="bold">τ</mml:mi><mml:msub><mml:mrow><mml:mtext mathvariant="bold">b</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">τ</mml:mi></mml:mrow></mml:msub><mml:mo mathvariant="bold">+</mml:mo><mml:mtext mathvariant="bold">C</mml:mtext></mml:mrow></mml:math><graphic alternate-form-of="disp-formula7-0962280212448973" xlink:href="10.1177_0962280212448973-eq7.tif"/></disp-formula>
where <italic>C</italic> is an additive constant not depending on τ. From equation (<xref ref-type="disp-formula" rid="disp-formula4-0962280212448973">4</xref>), we have
<disp-formula id="disp-formula8-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math8-0962280212448973"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∝</mml:mo><mml:mi>exp</mml:mi><mml:mrow><mml:mo> </mml:mo><mml:mo>{</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo> </mml:mo><mml:mo>[</mml:mo></mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mo>(</mml:mo></mml:mrow><mml:mi>n/</mml:mi><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo> </mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mi>log</mml:mi><mml:mi>τ</mml:mi><mml:mo>-</mml:mo><mml:mi>τ</mml:mi><mml:mn>2</mml:mn><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mo> </mml:mo><mml:mo>(</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo> </mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:mi>τ</mml:mi><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo> </mml:mo><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math><graphic alternate-form-of="disp-formula8-0962280212448973" xlink:href="10.1177_0962280212448973-eq8.tif"/></disp-formula>
where the expectation is taken with respect to <inline-formula id="ilm13-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math13-0962280212448973"><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:munderover><mml:mo>Π</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>×</mml:mo><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Taking this expectation and simplifying yields
<disp-formula id="disp-formula9-0962280212448973"><label>(6)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math9-0962280212448973"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∝</mml:mo><mml:msup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mi>exp</mml:mi><mml:mo stretchy="false">{</mml:mo><mml:mo>-</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><graphic alternate-form-of="disp-formula9-0962280212448973" xlink:href="10.1177_0962280212448973-eq9.tif"/></disp-formula>
where
<disp-formula id="disp-formula10-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math10-0962280212448973"><mml:mrow><mml:msup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi> </mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>il</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>ij</mml:mi> </mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>Var</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><graphic alternate-form-of="disp-formula10-0962280212448973" xlink:href="10.1177_0962280212448973-eq10.tif"/></disp-formula>
It thus follows from equation (<xref ref-type="disp-formula" rid="disp-formula9-0962280212448973">6</xref>) that
<disp-formula id="disp-formula11-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math11-0962280212448973"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≡</mml:mo><mml:mi>gamma</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><graphic alternate-form-of="disp-formula11-0962280212448973" xlink:href="10.1177_0962280212448973-eq11.tif"/></disp-formula>
with <inline-formula id="ilm14-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math14-0962280212448973"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>.</p>
<p>To update <inline-formula id="ilm15-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math15-0962280212448973"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> we note that the full conditional distribution is <inline-formula id="ilm16-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math16-0962280212448973"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mrow><mml:mo mathvariant="bold">-</mml:mo><mml:mi mathvariant="bold">λ</mml:mi></mml:mrow></mml:msub><mml:mo mathvariant="bold">~</mml:mo></mml:mrow></mml:math></inline-formula> <inline-formula id="ilm17-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math17-0962280212448973"><mml:mrow><mml:mi>gamma</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>'</mml:mo><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>1/2</mml:mn><mml:mi mathvariant="bold">S</mml:mi><mml:mo>'</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> so that
<disp-formula id="disp-formula12-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math12-0962280212448973"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∝</mml:mo><mml:mi>exp</mml:mi><mml:mrow><mml:mo> </mml:mo><mml:mo>{</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo> </mml:mo><mml:mo>[</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>'</mml:mo><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>log</mml:mi><mml:mi>λ</mml:mi><mml:mo>-</mml:mo><mml:mi>λ</mml:mi><mml:mrow><mml:mo> </mml:mo><mml:mo>(</mml:mo></mml:mrow><mml:mn>1/2</mml:mn><mml:mi mathvariant="bold">S</mml:mi><mml:mo>'</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo> </mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math><graphic alternate-form-of="disp-formula12-0962280212448973" xlink:href="10.1177_0962280212448973-eq12.tif"/></disp-formula>
where the expectation is taken with respect to <inline-formula id="ilm18-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math18-0962280212448973"><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:munderover><mml:mo>Π</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>×</mml:mo><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Taking this expectation and simplifying the resulting expression yields
<disp-formula id="disp-formula13-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math13-0962280212448973"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∝</mml:mo><mml:msup><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>'</mml:mo><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>exp</mml:mi><mml:mrow><mml:mo> </mml:mo><mml:mo>{</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>λ</mml:mi><mml:mrow><mml:mo> </mml:mo><mml:mo>[</mml:mo></mml:mrow><mml:mn>1/2</mml:mn><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>Var</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi/><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo> </mml:mo><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math><graphic alternate-form-of="disp-formula13-0962280212448973" xlink:href="10.1177_0962280212448973-eq13.tif"/></disp-formula>
From this it follows that
<disp-formula id="disp-formula14-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math14-0962280212448973"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≡</mml:mo><mml:mi>gamma</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:mo>'</mml:mo><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><graphic alternate-form-of="disp-formula14-0962280212448973" xlink:href="10.1177_0962280212448973-eq14.tif"/></disp-formula>
where <inline-formula id="ilm19-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math19-0962280212448973"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1/2</mml:mn><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>Var</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi/><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>.</p>
<p>To update the variational distribution for the source value <inline-formula id="ilm20-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math20-0962280212448973"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, we note that the corresponding full conditional distribution is Gaussian
<disp-formula id="disp-formula15-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math15-0962280212448973"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mrow><mml:mo mathvariant="bold">-</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">S</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo mathvariant="bold">~</mml:mo><mml:mtext mathvariant="bold">N</mml:mtext><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">(</mml:mo></mml:mrow><mml:mi mathvariant="bold">τ</mml:mi><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">{</mml:mo></mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">i</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mtext mathvariant="bold">n</mml:mtext></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mtext mathvariant="bold">X</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">ij</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">(</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Y</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">i</mml:mtext></mml:mrow></mml:msub><mml:mo mathvariant="bold">-</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext><mml:mo mathvariant="bold">≠</mml:mo><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mtext mathvariant="bold">X</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">il</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mtext mathvariant="bold">S</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">)</mml:mo></mml:mrow><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">}</mml:mo></mml:mrow><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">(</mml:mo></mml:mrow><mml:mi mathvariant="bold">λ</mml:mi><mml:mo mathvariant="bold">+</mml:mo><mml:mi mathvariant="bold">τ</mml:mi><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">i</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mtext mathvariant="bold">n</mml:mtext></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">X</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">ij</mml:mtext> </mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">)</mml:mo></mml:mrow><mml:mrow><mml:mo mathvariant="bold">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo mathvariant="bold">,</mml:mo><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">(</mml:mo></mml:mrow><mml:mi mathvariant="bold">λ</mml:mi><mml:mo mathvariant="bold">+</mml:mo><mml:mi mathvariant="bold">τ</mml:mi><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">i</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mtext mathvariant="bold">n</mml:mtext></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">X</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">ij</mml:mtext> </mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">)</mml:mo></mml:mrow><mml:mrow><mml:mo mathvariant="bold">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">)</mml:mo></mml:mrow></mml:mrow></mml:math><graphic alternate-form-of="disp-formula15-0962280212448973" xlink:href="10.1177_0962280212448973-eq15.tif"/></disp-formula>
so that equation (<xref ref-type="disp-formula" rid="disp-formula4-0962280212448973">4</xref>) implies
<disp-formula id="disp-formula16-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math16-0962280212448973"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∝</mml:mo><mml:mi>exp</mml:mi><mml:mrow><mml:mo> </mml:mo><mml:mo>{</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo> </mml:mo><mml:mo>[</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mn>1/2</mml:mn><mml:mrow><mml:mo> </mml:mo><mml:mo>(</mml:mo></mml:mrow><mml:mi>λ</mml:mi><mml:mo>+</mml:mo><mml:mi>τ</mml:mi><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>ij</mml:mi> </mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo> </mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mrow><mml:mo> </mml:mo><mml:mo>(</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>τ</mml:mi><mml:mrow><mml:mo> </mml:mo><mml:mo>(</mml:mo></mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo> </mml:mo><mml:mo>(</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>il</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo> </mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mo>(</mml:mo></mml:mrow><mml:mi>λ</mml:mi><mml:mo>+</mml:mo><mml:mi>τ</mml:mi><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>ij</mml:mi> </mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mo> </mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo> </mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo> </mml:mo><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math><graphic alternate-form-of="disp-formula16-0962280212448973" xlink:href="10.1177_0962280212448973-eq16.tif"/></disp-formula>
where the expectation is taken with respect to
<disp-formula id="disp-formula17-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math17-0962280212448973"><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo> </mml:mo><mml:mo>[</mml:mo></mml:mrow><mml:munder><mml:mo>Π</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>&lt;###</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo> </mml:mo><mml:mo>]</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mrow><mml:mo> </mml:mo><mml:mo>[</mml:mo></mml:mrow><mml:munder><mml:mo>Π</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo> </mml:mo><mml:mo>]</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><graphic alternate-form-of="disp-formula17-0962280212448973" xlink:href="10.1177_0962280212448973-eq17.tif"/></disp-formula>
Upon taking this expectation and applying a considerable amount of algebraic simplification, we find that the variational distribution is itself Gaussian <inline-formula id="ilm21-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math21-0962280212448973"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>≡</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo></mml:mrow></mml:msup><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> where
<disp-formula id="disp-formula18-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math18-0962280212448973"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo></mml:mrow></mml:msup><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo> </mml:mo><mml:mo>{</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>ij</mml:mi> </mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mo> </mml:mo><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><graphic alternate-form-of="disp-formula18-0962280212448973" xlink:href="10.1177_0962280212448973-eq18.tif"/></disp-formula>
and
<disp-formula id="disp-formula19-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math19-0962280212448973"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo></mml:mrow></mml:msup><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>×</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo> </mml:mo><mml:mo>{</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>&lt;###</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>il</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>-</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>il</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mrow><mml:mo> </mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math><graphic alternate-form-of="disp-formula19-0962280212448973" xlink:href="10.1177_0962280212448973-eq19.tif"/></disp-formula>
</p>
<p>To summarize, the (<italic>r</italic> + 1)st iteration of the algorithm updates the variational distributions as
<disp-formula id="disp-formula20-0962280212448973"><label>(7)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math20-0962280212448973"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≡</mml:mo><mml:mi>gamma</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≡</mml:mo><mml:mi>gamma</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:mo>'</mml:mo><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>≡</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo></mml:mrow></mml:msup><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:mrow></mml:math><graphic alternate-form-of="disp-formula20-0962280212448973" xlink:href="10.1177_0962280212448973-eq20.tif"/></disp-formula>
where the ‘variational parameters’ <inline-formula id="ilm22-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math22-0962280212448973"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mtext> and </mml:mtext><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo></mml:mrow></mml:msup><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> are updated through a set of highly coupled non-linear equations which will converge (see e.g. Ghahramani and Beal<sup><xref ref-type="bibr" rid="bibr23-0962280212448973">23</xref></sup>) to yield, in conjunction with equations (<xref ref-type="disp-formula" rid="disp-formula6-0962280212448973">5</xref>) and (<xref ref-type="disp-formula" rid="disp-formula20-0962280212448973">7</xref>), the analytic approximation to the posterior distribution. The variational algorithm is initialized with randomly generated starting values <inline-formula id="ilm23-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math23-0962280212448973"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo></mml:mrow></mml:msup><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:math></inline-formula>, and convergence is assessed by computing the lower bound <italic>F</italic> at each iteration and terminating the algorithm when the increase in <italic>F</italic> satisfies a convergence criteria. In our study, we terminate the algorithm when the relative increase in <italic>F</italic> is below 0.005% for five consecutive iterations.</p>
<p>Upon completion of the three update steps, the variational posterior at iteration <italic>r</italic> + 1 is <inline-formula id="ilm24-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math24-0962280212448973"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:munderover><mml:mo>Π</mml:mo><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext><mml:mo mathvariant="bold">'</mml:mo></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">q</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">S</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">S</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo mathvariant="bold">×</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">q</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">τ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">τ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">×</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">q</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">λ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and the value of the lower bound is computed as <inline-formula id="ilm25-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math25-0962280212448973"><mml:mrow><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>log</mml:mi><mml:mi>P/</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. Taking the expectation and simplifying a rather lengthy derivation yields
<disp-formula id="disp-formula21-0962280212448973"><label>(8)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math21-0962280212448973"><mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi>n/</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mn>2</mml:mn><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo> </mml:mo><mml:mo>{</mml:mo></mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi> </mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>il</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>ij</mml:mi> </mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo></mml:mrow></mml:msup><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo> </mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>   </mml:mi><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>'</mml:mo><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:munderover><mml:mi>log</mml:mi><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mrow><mml:mi>   </mml:mi><mml:mo>-</mml:mo><mml:mi>p/</mml:mi><mml:mo>'</mml:mo><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:msub><mml:mn>2</mml:mn><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:munderover><mml:mo stretchy="false">{</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi/><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo></mml:mrow></mml:msup><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">}</mml:mo><mml:mo>-</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>log</mml:mi><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">}</mml:mo><mml:mo>-</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>'</mml:mo><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>log</mml:mi><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><graphic alternate-form-of="disp-formula21-0962280212448973" xlink:href="10.1177_0962280212448973-eq21.tif"/></disp-formula>
The algorithm is summarized below.</p>
<p><bold>Variational Bayes algorithm: Minimum-norm EEG source reconstruction</bold></p>
<p><italic>Initialize variational parameters</italic> <inline-formula id="ilm26-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math26-0962280212448973"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi> </mml:mi><mml:mi>and</mml:mi><mml:mi> </mml:mi><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo></mml:mrow></mml:msup><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:math></inline-formula>, <italic>compute the value of F based on</italic> <italic>equation (8)</italic> <italic>and set r</italic> = 0.
<list id="list1-0962280212448973" list-type="simple">
<list-item><p><bold>Step 1:</bold> Compute:
<disp-formula id="disp-formula22-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math22-0962280212448973"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo> </mml:mo><mml:mo>{</mml:mo></mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi> </mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>il</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>ij</mml:mi> </mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo></mml:mrow></mml:msup><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo> </mml:mo><mml:mo>}</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><graphic alternate-form-of="disp-formula22-0962280212448973" xlink:href="10.1177_0962280212448973-eq22.tif"/></disp-formula>
</p></list-item>
<list-item><p><bold>Step 2:</bold> Compute:
<disp-formula id="disp-formula23-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math23-0962280212448973"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1/2</mml:mn><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo></mml:mrow></mml:msup><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi/><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><graphic alternate-form-of="disp-formula23-0962280212448973" xlink:href="10.1177_0962280212448973-eq23.tif"/></disp-formula>
</p></list-item>
<list-item><p><bold>Step 3:</bold> For <italic>j</italic> = 1, … , <italic>p</italic>′, compute:
<disp-formula id="disp-formula24-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math24-0962280212448973"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo></mml:mrow></mml:msup><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo> </mml:mo><mml:mo>{</mml:mo></mml:mrow><mml:mi>p/</mml:mi><mml:mo>'</mml:mo><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>n/</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>ij</mml:mi> </mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mo> </mml:mo><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><graphic alternate-form-of="disp-formula24-0962280212448973" xlink:href="10.1177_0962280212448973-eq24.tif"/></disp-formula>
and
<disp-formula id="disp-formula25-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math25-0962280212448973"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo></mml:mrow></mml:msup><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>×</mml:mo><mml:mi>n/</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>×</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>ij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>&lt;###</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>il</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>il</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><graphic alternate-form-of="disp-formula25-0962280212448973" xlink:href="10.1177_0962280212448973-eq25.tif"/></disp-formula>
</p></list-item>
<list-item><p><bold>Step 4:</bold> Compute the updated value of <italic>F</italic> based on equation (<xref ref-type="disp-formula" rid="disp-formula21-0962280212448973">8</xref>). Check for convergence. If required increment <italic>r</italic> and return to Step 1.</p></list-item>
</list></p>
<p>We set <italic>a</italic><sub>τ</sub> = <italic>b</italic><sub>τ</sub> = <italic>a</italic><sub>λ</sub> = <italic>b</italic><sub>λ</sub> = 0.1 and fit the model to both simulated datasets using both variational Bayes and a standard Gibbs sampling algorithm. Both algorithms are implemented in 64-bit Matlab (R2010b) and run on a MacBook Pro with 2.2 GHz Intel core processor with 4 GB memory. For <italic>p</italic>′ = 50, the Gibbs sampling algorithm is run for a total of 11,000 iterations (1000 burn-in) and requires a computing time of 47 s; for the same dataset, the variational Bayes algorithm converges in 329 iterations and requires 0.68 s to complete. For the second dataset where <italic>p</italic>′ = 500, the Gibbs sampler is again run for 11,000 iterations (4000 burn-in) and requires 641 s to complete; whereas, the variational Bayes algorithm converges in 57 iterations and requires less than 3 s to converge. While all of the computing times are low in this simple example, it is clear that the variational approach yields significant computational benefits. <xref ref-type="fig" rid="fig2-0962280212448973">Figure 2</xref> illustrates the convergence of both algorithms at both resolutions by plotting the values of the lower bound <italic>F</italic> at each iteration of the variational Bayes algorithm and the unnormalized log-posterior density at each iteration of the MCMC algorithm.
<fig id="fig2-0962280212448973" position="float"><label>Figure 2.</label><caption><p>Convergence of algorithms for minimum-norm model: (a) variational lower bound – <italic>p</italic>′ = 50; (b) unnormalized log-posterior at each MCMC iteration – <italic>p</italic>′ = 50; (c) variational lower bound – <italic>p</italic>′ = 500; and (d) unnormalized log-posterior at each MCMC iteration – <italic>p</italic>′ = 500. MCMC: Markov chain Monte Carlo.</p></caption><graphic xlink:href="10.1177_0962280212448973-fig2.tif"/>
</fig></p>
<p>The posterior mean of the source values <bold><italic>S</italic></bold> are mapped onto the cortical surface in <xref ref-type="fig" rid="fig3-0962280212448973">Figure 3</xref>, comparing the two methods at both resolutions. When <italic>p</italic>′ = 50, the maps depicted in Figure 3(a) and (b) indicate that both methods yield similar point estimates, with the maps showing a strong similarity. At the higher resolution depicted in Figure 3(c) and (d) where <italic>p</italic>′ = 500, the estimated maps also reveal the same general trends; however, the estimates obtained from the variational method exhibit a lower degree of scatter across the map. The posterior mean estimates obtained from the two algorithms are further compared in <xref ref-type="fig" rid="fig4-0962280212448973">Figure 4(a) and (c)</xref> through scatter plots which indicate not only a positive correlation in both cases, but also that the variational approximation clearly underestimates the degree of variability in the source values at the higher resolution. Moving to measures of posterior variability, <xref ref-type="fig" rid="fig4-0962280212448973">Figure 4(b) and (d)</xref> displays scatter plots comparing the posterior SDs <inline-formula id="ilm27-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math27-0962280212448973"><mml:mrow><mml:msqrt><mml:mrow><mml:mo stretchy="false">{</mml:mo></mml:mrow></mml:msqrt><mml:mi>Var</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> obtained from both methods. Here, it is clear that variational Bayes underestimates the posterior variability considerably, and this is seen at both the coarse and fine resolutions.
<fig id="fig3-0962280212448973" position="float"><label>Figure 3.</label><caption><p>Posterior means for minimum-norm model: (a) MCMC – <italic>p</italic>′ = 50; (b) variational Bayes – <italic>p</italic>′ = 50; (c) MCMC – <italic>p</italic>′ = 500; and (d) variational Bayes – <italic>p</italic>′ = 500. Note for this example that separate sets of true values were simulated for the low- and high-resolution scenarios. MCMC: Markov chain Monte Carlo.</p></caption><graphic xlink:href="10.1177_0962280212448973-fig3.tif"/>
</fig>
<fig id="fig4-0962280212448973" position="float"><label>Figure 4.</label><caption><p>Posterior source comparisons for minimum-norm model: (a) posterior means – <italic>p</italic>′ = 50; (b) posterior SDs – <italic>p</italic>′ = 50; (c) posterior means – <italic>p</italic>′ = 500; (d) Posterior SDs – <italic>p</italic>′ = 500.</p></caption><graphic xlink:href="10.1177_0962280212448973-fig4.tif"/>
</fig></p>
<p>While typically not of great interest in EEG source reconstruction problems, <xref ref-type="fig" rid="fig5-0962280212448973">Figure 5(a) to (d)</xref> compare the two approaches with respect to the posterior distributions of the hyperparameters τ and λ, by comparing the marginal posterior distributions obtained from variational Bayes with normalized histograms depicting posterior samples obtained from MCMC, alongside the true values of these parameters. In all cases, the posterior distribution obtained from Gibbs sampling seems to put a considerable mass within the vicinity of the true values; however, the same cannot be said for the variational approximations, which overestimate λ and underestimate τ. As before, the performance of the variational approximation seems to degrade as the resolution increases.
<fig id="fig5-0962280212448973" position="float"><label>Figure 5.</label><caption><p>Hyperparameters: (a) τ − <italic>p</italic>′ = 50; (b) λ − <italic>p</italic>′ = 50; (c) τ − <italic>p</italic>′ = 500; (d) λ − <italic>p</italic>′ = 500; (e) ω<sub><italic>S</italic></sub> − <italic>p</italic>′ = 50; (f) ω<sub><italic>B</italic></sub> − <italic>p</italic>′ = 50; (g) ω<sub><italic>S</italic></sub> − <italic>p</italic>′ = 500; and (h) ω<sub><italic>B</italic></sub> − <italic>p</italic>′ = 500. Note histograms are normalized and obtained through MCMC sampling. Solid curves are the variational approximations and vertical lines correspond to true values. MCMC: Markov chain Monte Carlo.</p></caption><graphic xlink:href="10.1177_0962280212448973-fig5.tif"/>
</fig></p>
</sec>
<sec id="sec6-0962280212448973"><title>4.2 Spatiotemporal data with sparse sources: Finite mixture model</title>
<p>We next consider a comparison of the two computational approaches in a more complex setting with multiple temporal observations and where an explicitly spatial model is employed for source reconstruction. The simulated EEG data are based upon a realistic sparse configuration of active sources based on spatially clustered cortical activity in the frontal and occipital lobes on both brain hemispheres, leading to four clusters of activity depicted in <xref ref-type="fig" rid="fig6-0962280212448973">Figure 6(a) and (b)</xref>.
<fig id="fig6-0962280212448973" position="float"><label>Figure 6.</label><caption><p>Simulated spatiotemporal data: (a) true cortical activity at <italic>t</italic> = 0.35; (b)true cortical activity at <italic>t</italic> = 0.59; (c) true temporal signals; (d) scalp-level signals at <italic>T</italic> = 161 time points; (e) scalp-level noise at <italic>T</italic> = 161 time points; and (f) simulated EEG data at <italic>T</italic> = 161 time points. EEG: electroencephalography.</p></caption><graphic xlink:href="10.1177_0962280212448973-fig6.tif"/>
</fig></p>
<p>We simulate the underlying neural signal at these active locations according to a normalized sinc function <italic>S</italic><sub><italic>j</italic></sub>(<italic>t</italic>) = <italic>a</italic><sub><italic>j</italic></sub>sinc{<italic>c</italic><sub><italic>j</italic></sub>(<italic>t</italic> − <italic>b</italic><sub><italic>j</italic></sub>)}, where <italic>a</italic><sub><italic>j</italic></sub> controls the amplitude, <italic>c</italic><sub><italic>j</italic></sub> the frequency of zero-crossings, and <italic>b</italic><sub><italic>j</italic></sub> the location of the peak. We assume that these signals are recorded over <italic>T</italic> = 161 time points equally spaced within the unit interval and set <italic>b</italic><sub><italic>j</italic></sub> = 0.34 for active locations in the frontal lobes and <italic>b</italic><sub><italic>j</italic></sub> = 0.59 for active locations in the occipital lobes, corresponding to later activation in the occipital regions. The resulting four clusters of activation have <italic>a</italic><sub><italic>j</italic></sub> = 1 at their central vertex and <italic>a</italic><sub><italic>j</italic></sub> = 0.75 at all surrounding vertices within a 20 mm radius. In addition, we set <italic>c</italic><sub><italic>j</italic></sub> = 20 in the frontal regions and <italic>c</italic><sub><italic>j</italic></sub> = 40 in the occipital regions, so that the signals arising from the latter have a higher frequency. <xref ref-type="fig" rid="fig6-0962280212448973">Figure 6(a) and (b)</xref> map the assumed source activity at <italic>t</italic> = 0.34 and 0.59, respectively, and the corresponding temporal signals are depicted in <xref ref-type="fig" rid="fig6-0962280212448973">Figure 6(c)</xref>.</p>
<p>Using the 128 × 8196 forward operator <bold><italic>X</italic></bold>, the cortical signals are projected onto sensor space at the scalp level, and the EEG data obtained as <bold><italic>Y</italic></bold>(<italic>t</italic>) = <bold><italic>XS</italic></bold>(<italic>t</italic>) + <bold>ε</bold>(<italic>t</italic>), <italic>t</italic> = 1, … , 161 where <inline-formula id="ilm28-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math28-0962280212448973"><mml:mrow><mml:mi mathvariant="bold">ε</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mfrac linethickness="0"><mml:mrow><mml:mtext mathvariant="bold">iid</mml:mtext></mml:mrow><mml:mrow><mml:mo mathvariant="bold">~</mml:mo></mml:mrow></mml:mfrac><mml:mtext mathvariant="bold">MVN</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold">Σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The true value of the 128 × 128 sensor covariance matrix <bold>Σ</bold> is set at <bold>Σ</bold> = diag{<italic>s</italic><sub>1</sub>, … , <italic>s</italic><sub>128</sub>}, where the noise variance <italic>s</italic><sub><italic>i</italic></sub> is set to be 5% of the signal variance at the <italic>i</italic>th sensor. The three time series depicting the (scalp level) signals, noise, and the simulated EEG data are depicted in <xref ref-type="fig" rid="fig6-0962280212448973">Figure 6(d) to (f)</xref>.</p>
<p>To reconstruct the sources from the simulated EEG data <bold><italic>Y</italic></bold>(<italic>t</italic>), <italic>t</italic> = 1, … , 161, we apply the spatiotemporal model recently proposed by Nathoo et al.<sup><xref ref-type="bibr" rid="bibr14-0962280212448973">14</xref></sup> <bold><italic>Y</italic></bold>(<italic>t</italic>) = <bold><italic>XS</italic></bold>(<italic>t</italic>) + <bold>ε</bold>(<italic>t</italic>), <italic>t</italic> = 1, … , 161, where <inline-formula id="ilm29-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math29-0962280212448973"><mml:mrow><mml:mi mathvariant="bold">ε</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">|</mml:mo><mml:mi mathvariant="bold">Σ</mml:mi><mml:mfrac linethickness="0"><mml:mrow><mml:mtext mathvariant="bold">iid</mml:mtext></mml:mrow><mml:mrow><mml:mo mathvariant="bold">~</mml:mo></mml:mrow></mml:mfrac><mml:mtext mathvariant="bold">MVN</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold">Σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and the signal at each cortical location is represented as <inline-formula id="ilm30-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math30-0962280212448973"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">η</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub><mml:mo mathvariant="bold">'</mml:mo><mml:mtext mathvariant="bold">B</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <bold><italic>B</italic></bold>(<italic>t</italic>) is a temporal basis of dimension <italic>m</italic>, and the weights are assigned a spatially correlated spike and slab prior
<disp-formula id="disp-formula26-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math26-0962280212448973"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">η</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub><mml:mo mathvariant="bold">|</mml:mo><mml:mtext mathvariant="bold">Z</mml:mtext><mml:mfrac linethickness="0"><mml:mrow><mml:mtext mathvariant="bold">ind</mml:mtext></mml:mrow><mml:mrow><mml:mo mathvariant="bold">~</mml:mo></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo mathvariant="bold">-</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mtext mathvariant="bold">I</mml:mtext><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">η</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub><mml:mo mathvariant="bold">=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">}</mml:mo><mml:mo mathvariant="bold">+</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub><mml:mtext mathvariant="bold">MVN</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo mathvariant="bold">,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">η</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><graphic alternate-form-of="disp-formula26-0962280212448973" xlink:href="10.1177_0962280212448973-eq26.tif"/></disp-formula>
where the latent variable <italic>Z</italic><sub><italic>j</italic></sub> ∈ {0, 1} indicates activity at the <italic>j</italic>th cortical region, with <italic>Z</italic><sub><italic>j</italic></sub> = 0 corresponding to <italic>S</italic><sub><italic>j</italic></sub>(<italic>t</italic>) ≡ 0, and <bold>Σ</bold><sub>η</sub> a known matrix representing the prior variability of signals at active locations. Here, each brain region is modeled with two neuronal subpopulations, an excitatory and an inhibitory population, represented by the latent variable <italic>Z</italic><sub><italic>j</italic></sub>.</p>
<p>The latent variables <bold><italic>Z</italic></bold> = (<italic>Z</italic><sub>1</sub>, … , <italic>Z</italic><sub><italic>p</italic></sub>)′ are assigned an autologistic prior that incorporates spatial dependence as well as bilateral dependence across the left and right brain hemispheres. The prior is specified through the full conditional probabilities<sup><xref ref-type="bibr" rid="bibr30-0962280212448973">30</xref></sup>
<disp-formula id="disp-formula27-0962280212448973"><label>(9)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math27-0962280212448973"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Z</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">ω</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">=</mml:mo><mml:mtext mathvariant="bold">exp</mml:mtext><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo mathvariant="bold">+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">q</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mtext mathvariant="bold">Q</mml:mtext></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">q</mml:mtext></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">F</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">q</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo mathvariant="bold">+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">S</mml:mtext></mml:mrow></mml:msub><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext><mml:mo mathvariant="bold">∈</mml:mo><mml:mo mathvariant="bold">∂</mml:mo><mml:msub><mml:mi/><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">S</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext></mml:mrow></mml:msub><mml:mo mathvariant="bold">/</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">n</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">S</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo mathvariant="bold">+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">B</mml:mtext></mml:mrow></mml:msub><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext><mml:mo mathvariant="bold">∈</mml:mo><mml:mo mathvariant="bold">∂</mml:mo><mml:msub><mml:mi/><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">B</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext></mml:mrow></mml:msub><mml:mo mathvariant="bold">/</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">n</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">B</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">}</mml:mo><mml:mn>1</mml:mn><mml:mo mathvariant="bold">+</mml:mo><mml:mtext mathvariant="bold">exp</mml:mtext><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo mathvariant="bold">+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">q</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mtext mathvariant="bold">Q</mml:mtext></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">q</mml:mtext></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">F</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">q</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo mathvariant="bold">+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">S</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext><mml:mo mathvariant="bold">∈</mml:mo><mml:mo mathvariant="bold">∂</mml:mo><mml:msub><mml:mi/><mml:mrow><mml:mtext mathvariant="bold">S</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext></mml:mrow></mml:msub><mml:mo mathvariant="bold">/</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">n</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">S</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo mathvariant="bold">+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">B</mml:mtext></mml:mrow></mml:msub><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext><mml:mo mathvariant="bold">∈</mml:mo><mml:mo mathvariant="bold">∂</mml:mo><mml:msub><mml:mi/><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">B</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext></mml:mrow></mml:msub><mml:mo mathvariant="bold">/</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">n</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">B</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo><mml:mo mathvariant="bold">,</mml:mo><mml:mtext mathvariant="bold">j</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn><mml:mo mathvariant="bold">,</mml:mo><mml:mo mathvariant="bold">…</mml:mo><mml:mo mathvariant="bold">,</mml:mo><mml:mtext mathvariant="bold">J</mml:mtext></mml:mrow></mml:math><graphic alternate-form-of="disp-formula27-0962280212448973" xlink:href="10.1177_0962280212448973-eq27.tif"/></disp-formula>
where <inline-formula id="ilm31-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math31-0962280212448973"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> are covariates derived from fMRI (or PET) studies, and obtained by projecting a three-dimensional statistical parametric map onto the cortical surface;<sup><xref ref-type="bibr" rid="bibr31-0962280212448973">31</xref></sup> ω<sub><italic>S</italic></sub> a spatial smoothing parameter based on a set of adjacent spatial neighbors, with ∂<sub><italic>S</italic><sub><italic>j</italic></sub></sub> being the set of such neighbors for the <italic>j</italic>th region and <italic>n</italic><sub><italic>S</italic><sub><italic>j</italic></sub></sub> the number of these neighbors; and ω<sub><italic>B</italic></sub> a bilateral or ‘cross-cortical’ smoothing parameter based on a set of neighbors in the same cortical region but on the <italic>opposite</italic> brain hemisphere, with ∂<sub><italic>B</italic><sub><italic>j</italic></sub></sub> being the set of such neighbors for the <italic>j</italic>th region, and <italic>n</italic><sub><italic>B</italic><sub><italic>j</italic></sub></sub> the number of these neighbors.</p>
<p>Including the fMRI data in equation (<xref ref-type="disp-formula" rid="disp-formula27-0962280212448973">9</xref>) allows for the integration of information from alternative imaging modalities into the spatial priors driving the source reconstruction. In this study, we will ignore this component of the model, so that ω<sub>0</sub>, ω<sub><italic>S</italic></sub>, and ω<sub><italic>B</italic></sub> are the only hyperparameters characterizing the autologistic prior. Given the ill-posedness of the inverse problem at hand, primarily data-driven inference for these smoothing parameters is not possible, and informative priors are required to help guide the solution. We assume here that <inline-formula id="ilm32-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math32-0962280212448973"><mml:mrow><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mover><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula id="ilm33-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math33-0962280212448973"><mml:mrow><mml:mover><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is the average number of neighbors, so that, roughly, an additional active neighbor increases the conditional odds of activation by a factor of 2 and the prior variance of 0.5 allows for some fidelity to the data. The intercept is also assigned an informative prior ω<sub>0</sub> ∼ <italic>N</italic>(−3, 0.1), corresponding to a sparse configuration of sources, where each vertex has a low (<italic>p</italic> ≈ 0.05) baseline probability of activation.</p>
<p>The temporal basis is based on the singular value decomposition (SVD) (though any suitable basis is easily incorporated) of the data matrix <bold><italic>Y</italic></bold> = <bold><italic>USV</italic></bold>′ where <bold><italic>S</italic></bold> is an <italic>n</italic> × <italic>n</italic> diagonal matrix of singular values and <bold><italic>U</italic></bold> and <bold><italic>V</italic></bold> unitary matrices containing spatial and temporal patterns, respectively. A subset of the columns in <bold><italic>V</italic></bold> can be used to form a temporal basis, and the corresponding singular values describe the importance of these patterns to describing the temporal variability. The number of basis functions can be chosen by examining a plot of the corresponding singular values. Here, we use <italic>m</italic> = 2 basis functions corresponding to the two sinc functions chosen to simulate the data.</p>
<p>For the purpose of fitting the model, the zero-inflated basis coefficients can be represented as the product <bold>η</bold><sub><italic>j</italic></sub> = <italic>Z</italic><sub><italic>j</italic></sub> <bold>β</bold><sub><italic>j</italic></sub>, with <inline-formula id="ilm34-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math34-0962280212448973"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub><mml:mfrac linethickness="0"><mml:mrow><mml:mtext mathvariant="bold">iid</mml:mtext></mml:mrow><mml:mrow><mml:mo mathvariant="bold">~</mml:mo></mml:mrow></mml:mfrac><mml:mtext mathvariant="bold">MVN</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo mathvariant="bold">,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">η</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and we assume a fairly diffuse prior <bold>Σ</bold><sub>η</sub> = 100 × <bold>I</bold> and <inline-formula id="ilm35-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math35-0962280212448973"><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi><mml:mo mathvariant="bold">~</mml:mo><mml:mtext mathvariant="bold">IW</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">S</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi> </mml:mrow><mml:mrow><mml:mo mathvariant="bold">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo mathvariant="bold">,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">ν</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> with <inline-formula id="ilm36-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math36-0962280212448973"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow><mml:mrow><mml:mi>Σ</mml:mi> </mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mtext mathvariant="bold">I</mml:mtext></mml:mrow></mml:math></inline-formula>, ν<sub>Σ</sub> = <italic>n</italic> = 128 completing the model specification.</p>
<p>The model parameters are <bold>Θ</bold> = {<bold><italic>Z</italic></bold>, {<bold>β</bold><sub><italic>j</italic></sub>}, <bold>Σ</bold>, ω<sub>0</sub>, ω<sub><italic>S</italic></sub>, ω<sub><italic>B</italic></sub>} and the posterior takes the general form
<disp-formula id="disp-formula28-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math28-0962280212448973"><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">Θ</mml:mi><mml:mo mathvariant="bold">|</mml:mo><mml:mtext mathvariant="bold">Y</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">∝</mml:mo><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">[</mml:mo></mml:mrow><mml:munderover><mml:mo>Π</mml:mo><mml:mrow><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mtext mathvariant="bold">T</mml:mtext></mml:mrow></mml:munderover><mml:mtext mathvariant="bold">MVN</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">Y</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">|</mml:mo><mml:mtext mathvariant="bold">XS</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold">Σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">]</mml:mo></mml:mrow><mml:mo mathvariant="bold">×</mml:mo><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">[</mml:mo></mml:mrow><mml:munderover><mml:mo>Π</mml:mo><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext></mml:mrow></mml:munderover><mml:mtext mathvariant="bold">MVN</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub><mml:mo mathvariant="bold">|</mml:mo><mml:mn>0</mml:mn><mml:mo mathvariant="bold">,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">η</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">]</mml:mo></mml:mrow><mml:mo mathvariant="bold">×</mml:mo><mml:mtext mathvariant="bold">autologit</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">Z</mml:mtext><mml:mo mathvariant="bold">|</mml:mo><mml:mi mathvariant="bold">ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">   </mml:mi><mml:mo mathvariant="bold">×</mml:mo><mml:mtext mathvariant="bold">IW</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">Σ</mml:mi><mml:mo mathvariant="bold">|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">ν</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">S</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi> </mml:mrow><mml:mrow><mml:mo mathvariant="bold">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">×</mml:mo><mml:mtext mathvariant="bold">MVN</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">ω</mml:mi><mml:mo mathvariant="bold">|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi></mml:mrow></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><graphic alternate-form-of="disp-formula28-0962280212448973" xlink:href="10.1177_0962280212448973-eq28.tif"/></disp-formula>
where autologit(<bold><italic>Z</italic></bold>|<bold>ω</bold>) is a notation used to represent the joint probability mass function associated with the conditional specifications (<xref ref-type="disp-formula" rid="disp-formula27-0962280212448973">9</xref>) and <bold>ω</bold> = (ω<sub>0</sub>, ω<sub><italic>S</italic></sub>, ω<sub><italic>B</italic></sub>)′ with prior mean <bold>μ</bold><sub>ω</sub> and covariance Σ<sub>ω</sub> defined by the informative prior. The variational Bayes approximation proceeds through a mean field factorization
<disp-formula id="disp-formula29-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math29-0962280212448973"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">Θ</mml:mi><mml:mo mathvariant="bold">|</mml:mo><mml:mtext mathvariant="bold">Y</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">≈</mml:mo><mml:mtext mathvariant="bold">q</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">Θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">=</mml:mo><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">[</mml:mo></mml:mrow><mml:munderover><mml:mo>Π</mml:mo><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mtext mathvariant="bold">J</mml:mtext></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mtext mathvariant="bold">q</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">q</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">z</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">]</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">q</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">Σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">q</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><graphic alternate-form-of="disp-formula29-0962280212448973" xlink:href="10.1177_0962280212448973-eq29.tif"/></disp-formula>
and employs the pseudo-likelihood approximation to the joint prior for <bold><italic>Z</italic></bold>.<sup><xref ref-type="bibr" rid="bibr32-0962280212448973">32</xref></sup> Interestingly, the pseudo-likelihood approximation fits well within the variational Bayes framework, since it itself is a mean field approximation to the joint prior distribution of <bold><italic>Z</italic></bold>.</p>
<p>The derivation of the variational Bayes algorithm for this model is considerably more involved than the derivations considered in Section 3.1 and entails additional analytic approximations (e.g. Taylor approximations to second order) beyond the mean field and pseudo-likelihood approximations. For example, this is required for deriving the approximate posterior <italic>q</italic><sub>ω</sub>(<bold>ω</bold>) as a tractable conjugate prior does not exist, and therefore, the normalizing constant in equation (<xref ref-type="disp-formula" rid="disp-formula4-0962280212448973">4</xref>) must itself be approximated. A detailed discussion of these approximations is beyond the scope of this article, and we refer the reader to Nathoo et al.<sup><xref ref-type="bibr" rid="bibr14-0962280212448973">14</xref></sup> for a detailed treatment, where the approximate variational distributions at iteration <italic>r</italic> + 1 are derived as
<disp-formula id="disp-formula30-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math30-0962280212448973"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">≡</mml:mo><mml:mtext mathvariant="bold">MVN</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo mathvariant="bold">,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">,</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">q</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">z</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">≡</mml:mo><mml:mtext>Bernoulli</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">,</mml:mo><mml:mtext mathvariant="bold">j</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn><mml:mo mathvariant="bold">,</mml:mo><mml:mo mathvariant="bold">…</mml:mo><mml:mo mathvariant="bold">,</mml:mo><mml:mtext mathvariant="bold">p</mml:mtext></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">q</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">ω</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">≡</mml:mo><mml:mtext mathvariant="bold">MVN</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo mathvariant="bold">,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">,</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">q</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">Σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">≡</mml:mo><mml:mtext mathvariant="bold">IW</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">T</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">ν</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">S</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi/><mml:mrow><mml:mo mathvariant="bold">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><graphic alternate-form-of="disp-formula30-0962280212448973" xlink:href="10.1177_0962280212448973-eq30.tif"/></disp-formula>
The algorithm for updating the variational parameters <inline-formula id="ilm37-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math37-0962280212448973"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo mathvariant="bold">,</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo mathvariant="bold">,</mml:mo><mml:mtext mathvariant="bold">j</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn><mml:mo mathvariant="bold">,</mml:mo><mml:mo mathvariant="bold">…</mml:mo><mml:mtext mathvariant="bold">p</mml:mtext><mml:mo stretchy="false">}</mml:mo><mml:mo mathvariant="bold">,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo mathvariant="bold">,</mml:mo></mml:mrow></mml:math></inline-formula> <inline-formula id="ilm38-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math38-0962280212448973"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo mathvariant="bold">,</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">S</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi/><mml:mrow><mml:mo mathvariant="bold">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and computing the lower bound <italic>F</italic> using these updates is presented in the Appendix.</p>
<p>The implementation of an MCMC algorithm, even based on a pseudo-likelihood approximation for <italic>P</italic>(<bold><italic>Z</italic></bold>), is also somewhat challenging. A standard Gibbs sampling algorithm incorporating random walk Metropolis–Hastings steps where required does not perform well, with poor mixing and slow convergence. The poor performance of a standard sampler in this context arises from the high posterior correlations between <italic>Z</italic><sub><italic>j</italic></sub> and <bold>β</bold><sub><italic>j</italic></sub>, which appear as a product <italic>Z</italic><sub><italic>j</italic></sub> <bold>β</bold><sub><italic>j</italic></sub> in the terms of the likelihood. As a remedy, we implement a collapsed Gibbs sampler<sup><xref ref-type="bibr" rid="bibr33-0962280212448973">33</xref></sup> where the basis coefficients <bold>β</bold><sub><italic>j</italic></sub> are sampled, not from the corresponding full conditional distribution, but from the conditional distribution marginalized over <italic>Z</italic><sub><italic>j</italic></sub>, ∑<sub><italic>Z</italic><sub><italic>j</italic></sub></sub> <italic>P</italic>(<italic>Z</italic><sub><italic>j</italic></sub>, <bold>β</bold><sub><italic>j</italic></sub>|<bold><italic>Y</italic></bold>, <bold><italic>θ</italic></bold><sub>−{<italic>Z</italic><sub><italic>j</italic></sub>,<bold>β</bold><sub><italic>j</italic></sub>}</sub>), and this can be derived as a mixture of two multivariate normal distributions
<disp-formula id="disp-formula31-0962280212448973"><label>(10)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math31-0962280212448973"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub><mml:mo mathvariant="bold">|</mml:mo><mml:mtext mathvariant="bold">Y</mml:mtext><mml:mo mathvariant="bold">,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:mrow><mml:mrow><mml:mo mathvariant="bold">-</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:msub><mml:mo mathvariant="bold">~</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub><mml:mtext mathvariant="bold">MVN</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo mathvariant="bold">,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">η</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo mathvariant="bold">-</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mtext mathvariant="bold">MVN</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><graphic alternate-form-of="disp-formula31-0962280212448973" xlink:href="10.1177_0962280212448973-eq31.tif"/></disp-formula>
where
<disp-formula id="disp-formula32-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math32-0962280212448973"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">η</mml:mi></mml:mrow></mml:msub><mml:mo mathvariant="bold">|</mml:mo><mml:msup><mml:mi/><mml:mrow><mml:mn>1/2</mml:mn></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">η</mml:mi></mml:mrow></mml:msub><mml:mo mathvariant="bold">|</mml:mo><mml:msup><mml:mi/><mml:mrow><mml:mn>1/2</mml:mn></mml:mrow></mml:msup><mml:mo mathvariant="bold">+</mml:mo><mml:mo mathvariant="bold">|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo mathvariant="bold">|</mml:mo><mml:msup><mml:mi/><mml:mrow><mml:mn>1/2</mml:mn></mml:mrow></mml:msup><mml:mtext mathvariant="bold">exp</mml:mtext><mml:mo stretchy="false">{</mml:mo><mml:mi mathvariant="bold">ω</mml:mi><mml:mo mathvariant="bold">'</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">u</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1/2</mml:mn><mml:msub><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo mathvariant="bold">'</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo mathvariant="bold">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo> </mml:mo><mml:mo>(</mml:mo></mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>∈</mml:mo><mml:mo>∂</mml:mo><mml:msub><mml:mi/><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>∈</mml:mo><mml:mo>∂</mml:mo><mml:msub><mml:mi/><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo> </mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>'</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo mathvariant="bold">=</mml:mo><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">[</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">η</mml:mi> </mml:mrow><mml:mrow><mml:mo mathvariant="bold">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo mathvariant="bold">+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">X</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub><mml:mo mathvariant="bold">'</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mo mathvariant="bold">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mtext mathvariant="bold">X</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mtext mathvariant="bold">T</mml:mtext></mml:mrow></mml:munderover><mml:mtext mathvariant="bold">B</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mtext mathvariant="bold">B</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">'</mml:mo><mml:msup><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">]</mml:mo></mml:mrow><mml:mrow><mml:mo mathvariant="bold">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo mathvariant="bold">=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">[</mml:mo></mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mtext mathvariant="bold">T</mml:mtext></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">Y</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">'</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mo mathvariant="bold">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mtext mathvariant="bold">X</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mtext mathvariant="bold">B</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">'</mml:mo><mml:mo mathvariant="bold">-</mml:mo><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">{</mml:mo></mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext><mml:mo mathvariant="bold">≠</mml:mo><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">X</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub><mml:mo mathvariant="bold">'</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mo mathvariant="bold">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mtext mathvariant="bold">X</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext></mml:mrow></mml:msub><mml:mo mathvariant="bold">'</mml:mo><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">}</mml:mo></mml:mrow><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">{</mml:mo></mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mtext mathvariant="bold">T</mml:mtext></mml:mrow></mml:munderover><mml:mtext mathvariant="bold">B</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mtext mathvariant="bold">B</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">'</mml:mo><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">}</mml:mo></mml:mrow><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">]</mml:mo></mml:mrow><mml:mo mathvariant="bold">'</mml:mo></mml:mrow></mml:mrow></mml:math><graphic alternate-form-of="disp-formula32-0962280212448973" xlink:href="10.1177_0962280212448973-eq32.tif"/></disp-formula>
The sampler based on the collapsed updates for <bold>β</bold><sub><italic>j</italic></sub> exhibits considerably improved performance.</p>
<p>As before, we fit the model based on two resolutions <italic>p</italic>′ = 50 and <italic>p</italic>′ = 500 and both algorithms are implemented in Matlab under the same computing specifications discussed in the previous example. For <italic>p</italic>′ = 50, the MCMC sampling algorithm is run for a total of 55,000 iterations (5000 burn-in) and requires 1.45 h computing time; for the same dataset, the variational Bayes algorithm converges in 630 iterations and requires less than 105 s to complete. For the second dataset where <italic>p</italic>′ = 500, the MCMC sampler is again run for 55,000 iterations (5000 burn-in) and requires just over 12 h of computing time; whereas, the variational Bayes algorithm converges in 532 iterations and requires less than 9 min to converge. <xref ref-type="fig" rid="fig7-0962280212448973">Figure 7</xref> illustrates the convergence of both algorithms at both resolutions by plotting the values of the lower bound <italic>F</italic> at each iteration of the variational Bayes algorithm and the unnormalized log-posterior density at each iteration of the MCMC algorithm.
<fig id="fig7-0962280212448973" position="float"><label>Figure 7.</label><caption><p>Convergence of algorithms for spatiotemporal model: (a) variational lower bound – <italic>p</italic>′ = 50; (b) unnormalized log-posterior at each MCMC iteration – <italic>p</italic>′ = 50; (c) variational lower bound – <italic>p</italic>′ = 500; and (d) unnormalized log-posterior at each MCMC iteration – <italic>p</italic>′ = 500.</p></caption><graphic xlink:href="10.1177_0962280212448973-fig7.tif"/>
</fig></p>
<p>The posterior mean source values <bold><italic>S</italic></bold>(<italic>t</italic>) are mapped at two time points, <italic>t</italic> = 0.34 and <italic>t</italic> = 0.59, and comparisons between the variational approximation and MCMC made at the low resolution <italic>p</italic>′ = 50 in <xref ref-type="fig" rid="fig8-0962280212448973">Figure 8</xref> and at the high resolution <italic>p</italic>′ = 500 in <xref ref-type="fig" rid="fig9-0962280212448973">Figure 9</xref>. In all cases, the estimated source reconstructions are quite similar, indicating that variational Bayes is able to produce good approximations to the posterior mean in a significantly lower amount of computational time. Along similar lines, the posterior mean point estimates of the sensor variance components <bold>Σ</bold><sub><italic>ii</italic></sub>, <italic>i</italic> = 1, … , 128 obtained from the two methods are compared in the scatter plots depicted in <xref ref-type="fig" rid="fig10-0962280212448973">Figure 10(e) and (f)</xref>, and these comparisons indicate a good agreement in the estimates. Unfortunately, the severe underestimation of posterior variability seen in Section 3.1 is also seen in <xref ref-type="fig" rid="fig10-0962280212448973">Figure 10(a) to (d)</xref>, which present scatter plots comparing the posterior SDs of the source values at <italic>t</italic> = 0.34 and 0.59. The variational approximations appear to be accurately located; however, the distributions are underdispersed relative to the true posterior. This underestimation of variability may arise from the product form (<xref ref-type="disp-formula" rid="disp-formula3-0962280212448973">3</xref>) assumed by the mean-field approximation. <xref ref-type="fig" rid="fig5-0962280212448973">Figure 5(e) to (h)</xref> examine the posterior distributions of the smoothing parameters ω<sub><italic>S</italic></sub> and ω<sub><italic>B</italic></sub> and compare the variational densities with the normalized histograms of the posterior samples obtained from the MCMC algorithm. These comparisons indicate a good agreement between the variational approximation and the posterior distributions estimated using MCMC. This can likely be attributed to the use of informative priors for these parameters.
<fig id="fig8-0962280212448973" position="float"><label>Figure 8.</label><caption><p>Simulation with spatiotemporal model, <italic>p</italic>′ = 50, posterior means: (a) MCMC, <italic>t</italic> = 0.35; (b) variational Bayes, <italic>t</italic> = 0.35; (c) MCMC, <italic>t</italic> = 0.59; and (d) variational Bayes, <italic>t</italic> = 0.59. MCMC: Markov chain Monte Carlo.</p></caption><graphic xlink:href="10.1177_0962280212448973-fig8.tif"/>
</fig>
<fig id="fig9-0962280212448973" position="float"><label>Figure 9.</label><caption><p>Simulation with spatiotemporal model, <italic>p</italic>′ = 500, posterior means: (a) MCMC, <italic>t</italic> = 0.35; (b) variational Bayes, <italic>t</italic> = 0.35; (c) MCMC, <italic>t</italic> = 0.59; and (d) variational Bayes, <italic>t</italic> = 0.59. MCMC: Markov chain Monte Carlo.</p></caption><graphic xlink:href="10.1177_0962280212448973-fig9.tif"/>
</fig>
<fig id="fig10-0962280212448973" position="float"><label>Figure 10.</label><caption><p>Simulation with spatiotemporal model – comparisons: (a) posterior SDs, <italic>t</italic> = 0.35, <italic>p</italic>′ = 50; (b) posterior SDs, <italic>t</italic> = 0.59, <italic>p</italic>′ = 50; (c) posterior SDs, <italic>t</italic> = 0.35, <italic>p</italic>′ = 500; (d) posterior SDs, <italic>t</italic> = 0.59, <italic>p</italic>′ = 500; (e) posterior means <bold>Σ</bold><sub><italic>ii</italic></sub>, <italic>p</italic>′ = 50; and (f) posterior means <bold>Σ</bold><sub><italic>ii</italic></sub>, <italic>p</italic>′ = 500.</p></caption><graphic xlink:href="10.1177_0962280212448973-fig10.tif"/>
</fig>
</p>
</sec>
</sec>
<sec id="sec7-0962280212448973"><title>5 Application to face perception study: EEG data</title>
<p>Here, we apply the spatiotemporal model of Section 3.2 to reconstruct the neural sources underlying activation in the face perception study described in <xref ref-type="sec" rid="sec2-0962280212448973">Section 2</xref>. The differential evoked response based on 172 trials of the experiment (86 faces and 86 scrambled faces) is depicted in <xref ref-type="fig" rid="fig1-0962280212448973">Figure 1(a) and (b)</xref>. Localizing sources in this context can provide insight into the differences associated with the neural processing of faces versus the processing associated with scrambled faces.</p>
<p>Examination of the singular values of the data matrix <bold><italic>Y</italic></bold> suggests that four basis functions obtained from the SVD are adequate for explaining the temporal signal. Prior to the analysis, each time series is low-pass filtered with a fourth-order Butterworth filter, with cut-off at 20 Hz removing higher frequency components that are not related to the evoked response under study. The spatiotemporal mixture model is applied with a spatial resolution of <italic>p</italic>′ = 500 (with <italic>n</italic> = 128 sensors), and both the variational Bayes and MCMC algorithms are applied.</p>
<p>The variational Bayes algorithm converges in 418 iterations and requires 420 s of computing time. As with Section 3.2, the MCMC algorithm is run for 55,000 iterations (5000 burn-in) and requires just over 12 h to complete. Posterior means of the source values <bold><italic>S</italic></bold>(<italic>t</italic>) are obtained from both methods, and <xref ref-type="fig" rid="fig11-0962280212448973">Figure 11(a) to (d)</xref> presents maps of the absolute value of the estimates at <italic>t</italic> = 180 ms after the stimulus is presented. Both methods reveal bilateral activation in the occipital lobes, revealing regions which appear to be more strongly activated when faces (as opposed to scrambled faces) are presented as the stimulus. We note that the scale of the estimated map obtained from the MCMC algorithm is considerably larger than the scale obtained from variational Bayes; however, a qualitative similarity in the regions of activation revealed by the two methods is again apparent.
<fig id="fig11-0962280212448973" position="float"><label>Figure 11.</label><caption><p>Results from face perception study. Absolute value of posterior mean estimates: (a) MCMC; (b) variational Bayes; (c) MCMC; and (d) variational Bayes. Posterior mean temporal signal with 95% CI at representative location: (e) MCMC; and (f) variational Bayes. MCMC: Markov chain Monte Carlo; CI: credible interval.</p></caption><graphic xlink:href="10.1177_0962280212448973-fig11.tif"/>
</fig></p>
<p><xref ref-type="fig" rid="fig11-0962280212448973">Figure 11(e) and (f)</xref> shows the estimated (posterior mean) time course, along with pointwise equal-tail 95% credible intervals (CIs), for a single representative region, obtained from both the variational approximation and the MCMC algorithm. The estimated temporal patterns obtained from both methods show a strong similarity; however; comparing the widths of the CIs shown in each figure, it is clear, as with previous examples, that the variational approach underestimates posterior variability.</p>
</sec>
<sec id="sec8-0962280212448973"><title>6 Discussion</title>
<p>In this article, we have reviewed the ill-posed inverse problem associated with EEG, as well as the variational Bayes method for developing analytic approximations to complex posterior distributions in hierarchical models. While both the inverse problem and variational Bayesian methods have received considerable attention in the neuroimaging and machine learning literature, they have both received relatively little attention in statistics, which to date has focused primarily on developing statistical models for fMRI or PET, and computing these models using MCMC algorithms.</p>
<p>Comparing variational Bayes with MCMC in two settings involving simulated EEG data, we have found that the resulting estimated maps of cortical activity exhibit similar patterns; however, the variational approach tends to underestimate the posterior SDs of the source values, and this underestimation occurred in all the examples considered. The underestimation of variability arising from the variational approach may be the result of the product factorization (<xref ref-type="disp-formula" rid="disp-formula3-0962280212448973">3</xref>) assumed by the mean-field approximation. It should be noted that both the variational Bayes algorithms as well as the MCMC algorithms considered here are susceptible to converging or remaining stuck in local optima. To insure that our results were not being heavily influenced by local optima, all analyses were repeated with additional sets of randomly chosen starting values, and the results were virtually identical in all cases.</p>
<p>These results also echo the findings of Nummenmaa et al.<sup><xref ref-type="bibr" rid="bibr12-0962280212448973">12</xref></sup> who considered similar comparisons for a non-spatial model. With the minimum-norm model, we found that the posterior distribution of the hyperparameters was not adequately approximated by variational Bayes as well, though this is not of great interest for source reconstruction. This was less of an issue with the mixture model, where informative hyperpriors were used. Thus, while the variational method offers significant computational benefits and reasonable estimated source reconstructions, the resulting analytic approximations, at least for the examples, settings, and models considered here, seem to underestimate posterior variability rather significantly.</p>
<p>This underestimation of posterior variability may be less of an issue in group studies involving multiple subjects, where estimates of cortical source activity are obtained separately for each subject by solving the inverse problem in the first stage and the resulting point estimates are then used in a separate second-stage analysis to compare groups. This two-stage procedure is a fairly common approach for analysis in group studies, and the primary contribution of the inverse methods is to obtain point estimates at the first stage of the analysis. In this case, the qualitative similarity in the source estimates obtained from the variational Bayes procedures may be sufficient to conduct population-level inference at the second stage.</p>
</sec>
</body>
<back><ack>
<title>Acknowledgments</title>
<p>The authors thank Dr Rik Henson, MRC CBSU, Cambridge, for providing the face perception EEG data.</p></ack>
<sec>
<title>Funding</title>
<p>FS Nathoo is funded by a grant from the Natural Sciences and Engineering Research Council of Canada.</p></sec>
<ref-list>
<title>References</title>
<ref id="bibr1-0962280212448973"><label>1</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Bowman</surname><given-names>FD</given-names></name></person-group>. <article-title>Spatio-temporal modeling of localized brain activity</article-title>. <source>NeuroImage</source> <year>2005</year>; <volume>6</volume>: <fpage>558</fpage>–<lpage>575</lpage>.</citation></ref>
<ref id="bibr2-0962280212448973"><label>2</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Bowman</surname><given-names>FD</given-names></name><name><surname>Cafo</surname><given-names>B</given-names></name><name><surname>Bassett</surname><given-names>S</given-names></name><etal/></person-group>. <article-title>A Bayesian hierarchical framework for spatial modeling of fMRI data</article-title>. <source>NeuroImage</source> <year>2008</year>; <volume>39</volume>: <fpage>146</fpage>–<lpage>156</lpage>.</citation></ref>
<ref id="bibr3-0962280212448973"><label>3</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Brezger</surname><given-names>A</given-names></name><name><surname>Fahrmeir</surname><given-names>L</given-names></name><name><surname>Hennerfeind</surname><given-names>A</given-names></name></person-group>. <article-title>Adaptive Gaussian Markov random fields with applications in human brain mapping</article-title>. <source>J R Stat Soc Ser C</source> <year>2007</year>; <volume>56</volume>: <fpage>327</fpage>–<lpage>345</lpage>.</citation></ref>
<ref id="bibr4-0962280212448973"><label>4</label><citation citation-type="other"><comment>Derado G, Bowman FD and Zhang L. Predicting Brain Activity using a Bayesian Spatial Model. <italic>Statistical Methods in Medical Research</italic> 2013; 22: 382--397.</comment>.</citation></ref>
<ref id="bibr5-0962280212448973"><label>5</label><citation citation-type="other"><comment>Johnson TD, Liu Z, Bartsch AJ et al. A Bayesian Non-Parametric Potts Model with Application to Pre-Surgical FMRI Data. <italic>Statistical Methods in Medical Research</italic> 2013; 22: 364--381.</comment>.</citation></ref>
<ref id="bibr6-0962280212448973"><label>6</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Baillet</surname><given-names>S</given-names></name><name><surname>Garnero</surname><given-names>L</given-names></name></person-group>. <article-title>A Bayesian approach to introducing anatomo-functional priors in the EEG/MEG inverse problem</article-title>. <source>IEEE Trans Biomed Eng</source> <year>1997</year>; <volume>44</volume>: <fpage>374</fpage>–<lpage>385</lpage>.</citation></ref>
<ref id="bibr7-0962280212448973"><label>7</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Phillips</surname><given-names>JW</given-names></name><name><surname>Leahy</surname><given-names>RM</given-names></name><name><surname>Mosher</surname><given-names>JC</given-names></name></person-group>. <article-title>MEG based imaging of focal neuronal current sources</article-title>. <source>IEEE Trans Biomed Eng</source> <year>1997</year>; <volume>44</volume>: <fpage>338</fpage>–<lpage>348</lpage>.</citation></ref>
<ref id="bibr8-0962280212448973"><label>8</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Jun</surname><given-names>SC</given-names></name><name><surname>George</surname><given-names>JS</given-names></name><name><surname>Pare-Blagoev</surname><given-names>J</given-names></name><etal/></person-group>. <article-title>Spatiotemporal Bayesian inference dipole analysis for MEG neuroimaging data</article-title>. <source>NeuroImage</source> <year>2005</year>; <volume>29</volume>: <fpage>84</fpage>–<lpage>98</lpage>.</citation></ref>
<ref id="bibr9-0962280212448973"><label>9</label><citation citation-type="other"><comment>Ismail S, Sun W, Nathoo FS, et al. A Skew-t Space-Varying Regression Model for the Spectral Analysis of Resting State Brain Activity. <italic>Statistical Methods in Medical Research</italic> 2013; 22: 424--438.</comment>.</citation></ref>
<ref id="bibr10-0962280212448973"><label>10</label><citation citation-type="book"><person-group person-group-type="author"><name><surname>Parisi</surname><given-names>G</given-names></name></person-group>. <source>Statistical field theory</source>, <publisher-loc>New York</publisher-loc>: <publisher-name>Addison-Wesley</publisher-name>, <year>1988</year>.</citation></ref>
<ref id="bibr11-0962280212448973"><label>11</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Friston</surname><given-names>K</given-names></name><name><surname>Mattout</surname><given-names>J</given-names></name><name><surname>Trujillo-Barreto</surname><given-names>N</given-names></name><etal/></person-group>. <article-title>Variational free energy and the Laplace approximation</article-title>. <source>NeuroImage</source> <year>2007</year>; <volume>34</volume>: <fpage>220</fpage>–<lpage>234</lpage>.</citation></ref>
<ref id="bibr12-0962280212448973"><label>12</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Nummenmaa</surname><given-names>A</given-names></name><name><surname>Auranen</surname><given-names>T</given-names></name><name><surname>Hamalainen</surname><given-names>MS</given-names></name><etal/></person-group>. <article-title>Hierarchical Bayesian estimates of distributed MEG sources: theoretical aspects and comparison of variational and MCMC methods</article-title>. <source>NeuroImage</source> <year>2007</year>; <volume>35</volume>: <fpage>669</fpage>–<lpage>685</lpage>.</citation></ref>
<ref id="bibr13-0962280212448973"><label>13</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Sato</surname><given-names>MA</given-names></name><name><surname>Yoshioka</surname><given-names>T</given-names></name><name><surname>Kajihara</surname><given-names>S</given-names></name><etal/></person-group>. <article-title>Hierarchical Bayesian estimation for MEG inverse problem</article-title>. <source>NeuroImage</source> <year>2004</year>; <volume>23</volume>: <fpage>806</fpage>–<lpage>826</lpage>.</citation></ref>
<ref id="bibr14-0962280212448973"><label>14</label><citation citation-type="book"><person-group person-group-type="author"><name><surname>Nathoo</surname><given-names>FS</given-names></name><name><surname>Babul</surname><given-names>A</given-names></name><name><surname>Moiseev</surname><given-names>A</given-names></name><etal/></person-group>. <source>A variational Bayes spatiotemporal hidden Markov model for electromagnetic brain mapping</source>, <publisher-name>Technical Report, Department of Mathematics and Statistics, University of Victoria, Canada</publisher-name>, <year>2012</year>.</citation></ref>
<ref id="bibr15-0962280212448973"><label>15</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Henson</surname><given-names>RN</given-names></name><name><surname>Goshen-Gottstein</surname><given-names>Y</given-names></name><name><surname>Ganel</surname><given-names>T</given-names></name><etal/></person-group>. <article-title>Electro- physiological and haemodynamic correlates of face perception, recognition and priming</article-title>. <source>Cereb Cortex</source> <year>2003</year>; <volume>13</volume>: <fpage>793</fpage>–<lpage>805</lpage>.</citation></ref>
<ref id="bibr16-0962280212448973"><label>16</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Baillet</surname><given-names>S</given-names></name><name><surname>Mosher</surname><given-names>JC</given-names></name><name><surname>Leahy</surname><given-names>RM</given-names></name></person-group>. <article-title>Electromagnetic brain mapping</article-title>. <source>IEEE Signal Process Mag</source> <year>2001</year>; <volume>18</volume>: <fpage>14</fpage>–<lpage>30</lpage>.</citation></ref>
<ref id="bibr17-0962280212448973"><label>17</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Tian</surname><given-names>TS</given-names></name><name><surname>Li</surname><given-names>Z</given-names></name></person-group>. <article-title>A spatio-temporal solution for the EEG/MEG inverse problem using group penalization methods</article-title>. <source>Stat Interf</source> <year>2011</year>; <volume>4</volume>: <fpage>521</fpage>–<lpage>534</lpage>.</citation></ref>
<ref id="bibr18-0962280212448973"><label>18</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pascual-Marquia</surname><given-names>RD</given-names></name><name><surname>Michel</surname><given-names>CM</given-names></name><name><surname>Lehmann</surname><given-names>D</given-names></name></person-group>. <article-title>Low resolution electromagnetic tomog- raphy: a new method for localizing electrical activity in the brain</article-title>. <source>Int J Psychophysiol</source> <year>1994</year>; <volume>18</volume>: <fpage>49</fpage>–<lpage>65</lpage>.</citation></ref>
<ref id="bibr19-0962280212448973"><label>19</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>FH</given-names></name><name><surname>Belliveau</surname><given-names>JW</given-names></name><name><surname>Dale</surname><given-names>AM</given-names></name><etal/></person-group>. <article-title>Distributed current estimates using cortical orientation constraints</article-title>. <source>Hum Brain Mapp</source> <year>2006</year>; <volume>27</volume>: <fpage>1</fpage>–<lpage>13</lpage>.</citation></ref>
<ref id="bibr20-0962280212448973"><label>20</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Friston</surname><given-names>KL</given-names></name><name><surname>Harrison</surname><given-names>J</given-names></name><name><surname>Daunizeau</surname><given-names>S</given-names></name><etal/></person-group>. <article-title>Multiple sparse priors for the M/EEG inverse problem</article-title>. <source>NeuroImage</source> <year>2008</year>; <volume>39</volume>: <fpage>1104</fpage>–<lpage>1120</lpage>.</citation></ref>
<ref id="bibr21-0962280212448973"><label>21</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wipf</surname><given-names>DP</given-names></name><name><surname>Nagarajan</surname><given-names>S</given-names></name></person-group>. <article-title>A Unified Bayesian framework for MEG/EEG source imaging</article-title>. <source>NeuroImage</source> <year>2009</year>; <volume>44</volume>: <fpage>944</fpage>–<lpage>966</lpage>.</citation></ref>
<ref id="bibr22-0962280212448973"><label>22</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Geman</surname><given-names>S</given-names></name><name><surname>Geman</surname><given-names>D</given-names></name></person-group>. <article-title>Stochastic relaxation, Gibbs distributions and the Bayesian restoration of images</article-title>. <source>IEEE Trans Pattern Anal Mach Intell</source> <year>1984</year>; <volume>6</volume>: <fpage>721</fpage>–<lpage>741</lpage>.</citation></ref>
<ref id="bibr23-0962280212448973"><label>23</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ghahramani</surname><given-names>Z</given-names></name><name><surname>Beal</surname><given-names>MJ</given-names></name></person-group>. <article-title>Variational inference for Bayesian mixture of factor analysers</article-title>. <source>Adv Neural Inf Process Syst</source> <year>2000</year>; <volume>12</volume>: <fpage>449</fpage>–<lpage>455</lpage>.</citation></ref>
<ref id="bibr24-0962280212448973"><label>24</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Attias</surname><given-names>H</given-names></name></person-group>. <article-title>A variational Bayesian framework for graphical models</article-title>. <source>Adv Neural Inf Process Syst</source> <year>2000</year>; <volume>12</volume>: <fpage>206</fpage>–<lpage>212</lpage>.</citation></ref>
<ref id="bibr25-0962280212448973"><label>25</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ormerod</surname><given-names>JT</given-names></name><name><surname>Wand</surname><given-names>MP</given-names></name></person-group>. <article-title>Explaining variational approximations</article-title>. <source>Am Stat</source> <year>2010</year>; <volume>64</volume>: <fpage>140</fpage>–<lpage>153</lpage>.</citation></ref>
<ref id="bibr26-0962280212448973"><label>26</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ermer</surname><given-names>JJ</given-names></name><name><surname>Mosher</surname><given-names>JC</given-names></name><name><surname>Baillet</surname><given-names>S</given-names></name><etal/></person-group>. <article-title>Rapidly recomputable EEG forward models for realistic head shapes</article-title>. <source>Phys Med Biol</source> <year>2001</year>; <volume>46</volume>: <fpage>1265</fpage>–<lpage>1281</lpage>.</citation></ref>
<ref id="bibr27-0962280212448973"><label>27</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Litvak</surname><given-names>V</given-names></name><name><surname>Mattout</surname><given-names>J</given-names></name><name><surname>Kiebel</surname><given-names>SJ</given-names></name><etal/></person-group>. <article-title>EEG and MEG data analysis in SPM8</article-title>. <source>Comput Intell Neurosci</source> <year>2011</year>; <volume>2011</volume>: <fpage>852961</fpage>–<lpage>852961</lpage>.</citation></ref>
<ref id="bibr28-0962280212448973"><label>28</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Zariffa</surname><given-names>J</given-names></name><name><surname>Popovic</surname><given-names>MR</given-names></name></person-group>. <article-title>Solution space reduction in the peripheral nerve source localization problem using forward field similarities</article-title>. <source>J Neural Eng</source> <year>2008</year>; <volume>5</volume>: <fpage>191</fpage>–<lpage>202</lpage>.</citation></ref>
<ref id="bibr29-0962280212448973"><label>29</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lindley</surname><given-names>DV</given-names></name><name><surname>Smith</surname><given-names>AFM</given-names></name></person-group>. <article-title>Bayes estimates for the linear model</article-title>. <source>J R Stat Soc Ser B</source> <year> 1972</year>; <volume>34</volume>: <fpage>1</fpage>–<lpage>72</lpage>.</citation></ref>
<ref id="bibr30-0962280212448973"><label>30</label><citation citation-type="book"><person-group person-group-type="author"><name><surname>Cressie</surname><given-names>N</given-names></name></person-group>. <source>Statistics for spatial data</source>, <publisher-loc>New York</publisher-loc>: <publisher-name>Wiley Interscience</publisher-name>, <year>1993</year>.</citation></ref>
<ref id="bibr31-0962280212448973"><label>31</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Henson</surname><given-names>RNA</given-names></name><name><surname>Flandin</surname><given-names>G</given-names></name><name><surname>Friston</surname><given-names>KJ</given-names></name><etal/></person-group>. <article-title>A parametric empirical Bayesian framework for fMRI-constrained MEG/EEG source reconstruction</article-title>. <source>Hum Brain Mapp</source> <year>2010</year>; <volume>31</volume>: <fpage>1512</fpage>–<lpage>1531</lpage>.</citation></ref>
<ref id="bibr32-0962280212448973"><label>32</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Besag</surname><given-names>J</given-names></name></person-group>. <article-title>Statistical analysis of non-lattice data</article-title>. <source>Statistician</source> <year>1975</year>; <volume>24</volume>: <fpage>179</fpage>–<lpage>195</lpage>.</citation></ref>
<ref id="bibr33-0962280212448973"><label>33</label><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>JS</given-names></name></person-group>. <article-title>The collapsed Gibbs sampler with applications to a gene regulation problem</article-title>. <source>J Am Stat Assoc</source> <year>1994</year>; <volume>89</volume>: <fpage>958</fpage>–<lpage>966</lpage>.</citation></ref>
</ref-list><app-group><app>
<title/>
<sec>
<title>Appendix</title>
<sec id="sec10-0962280212448973">
<title>Variational Bayes algorithm: Spatiotemporal mixture model for EEG</title>
<p><italic>Initialize variational parameters</italic> <inline-formula id="ilm39-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math39-0962280212448973"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo mathvariant="bold">,</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo mathvariant="bold">,</mml:mo><mml:mtext mathvariant="bold">j</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn><mml:mo mathvariant="bold">,</mml:mo><mml:mo mathvariant="bold">…</mml:mo><mml:mtext mathvariant="bold">p</mml:mtext><mml:mo stretchy="false">}</mml:mo><mml:mo mathvariant="bold">,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo mathvariant="bold">,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo mathvariant="bold">,</mml:mo><mml:mtext> and </mml:mtext><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">S</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi/><mml:mrow><mml:mo mathvariant="bold">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, <italic>compute the value of F from equation</italic> <italic>(<xref ref-type="disp-formula" rid="disp-formula40-0962280212448973">11</xref>)</italic> <italic>below</italic>, <italic>and set r</italic> = 0.
<list id="list2-0962280212448973" list-type="simple">
<list-item>
<p><bold>Step 1:</bold> Compute:
<disp-formula id="disp-formula33-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math33-0962280212448973"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>Σ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="bold">μ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">Y</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">-</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">E</mml:mtext></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">q</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold">β</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="bold">μ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">'</mml:mo><mml:mo mathvariant="bold">+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mtext mathvariant="bold">T</mml:mtext></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Var</mml:mtext></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">q</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold">β</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="bold">μ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><graphic alternate-form-of="disp-formula33-0962280212448973" xlink:href="10.1177_0962280212448973-eq33.tif"/></disp-formula>
where
<disp-formula id="disp-formula34-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math34-0962280212448973"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="bold">μ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo mathvariant="bold">=</mml:mo><mml:mtext mathvariant="bold">Xdiag</mml:mtext><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo mathvariant="bold">,</mml:mo><mml:mo mathvariant="bold">…</mml:mo><mml:mo mathvariant="bold">,</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">}</mml:mo><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">(</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">'</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo>:</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">'</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">)</mml:mo></mml:mrow><mml:mtext mathvariant="bold">B</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Var</mml:mtext></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">q</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold">β</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="bold">μ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo mathvariant="bold">=</mml:mo><mml:mtext mathvariant="bold">Xdiag</mml:mtext><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mtext mathvariant="bold">B</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">'</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mtext mathvariant="bold">B</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">+</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">'</mml:mo></mml:mrow></mml:msubsup><mml:mtext mathvariant="bold">B</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:msup><mml:mi/><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo mathvariant="bold">-</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">}</mml:mo><mml:mtext mathvariant="bold">X</mml:mtext><mml:mo mathvariant="bold">'</mml:mo></mml:mrow></mml:mrow></mml:math><graphic alternate-form-of="disp-formula34-0962280212448973" xlink:href="10.1177_0962280212448973-eq34.tif"/></disp-formula>
</p></list-item>
<list-item>
<p><bold>Step 2:</bold> For <italic>j</italic> = 1, … , <italic>p</italic>, compute:
<disp-formula id="disp-formula35-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math35-0962280212448973"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo mathvariant="bold">=</mml:mo><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">[</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">η</mml:mi> </mml:mrow><mml:mrow><mml:mo mathvariant="bold">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo mathvariant="bold">+</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">T</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">ν</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">X</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub><mml:mo mathvariant="bold">'</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">S</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi/><mml:mrow><mml:mo mathvariant="bold">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mtext mathvariant="bold">X</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mtext mathvariant="bold">T</mml:mtext></mml:mrow></mml:munderover><mml:mtext mathvariant="bold">B</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mtext mathvariant="bold">B</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">'</mml:mo><mml:msup><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">]</mml:mo></mml:mrow><mml:mrow><mml:mo mathvariant="bold">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo mathvariant="bold">=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">T</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">ν</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">[</mml:mo></mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mtext mathvariant="bold">T</mml:mtext></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">Y</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">'</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">S</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi/><mml:mrow><mml:mo mathvariant="bold">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mtext mathvariant="bold">X</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mtext mathvariant="bold">B</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">-</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">{</mml:mo></mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mtext mathvariant="bold">T</mml:mtext></mml:mrow></mml:munderover><mml:mtext mathvariant="bold">B</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mtext mathvariant="bold">B</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">'</mml:mo><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">}</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="bold">   </mml:mi><mml:mo mathvariant="bold">×</mml:mo><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">{</mml:mo></mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext><mml:mo>&lt;###</mml:mo><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">X</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub><mml:mo mathvariant="bold">'</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">S</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi/><mml:mrow><mml:mo mathvariant="bold">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mtext mathvariant="bold">X</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo mathvariant="bold">+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext><mml:mo>&gt;</mml:mo><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">X</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub><mml:mo mathvariant="bold">'</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">S</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi/><mml:mrow><mml:mo mathvariant="bold">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mtext mathvariant="bold">X</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">}</mml:mo></mml:mrow><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math><graphic alternate-form-of="disp-formula35-0962280212448973" xlink:href="10.1177_0962280212448973-eq35.tif"/></disp-formula>
where <bold><italic>X</italic></bold><sub><italic>j</italic></sub> is the <italic>j</italic>th column of <bold><italic>X</italic></bold></p></list-item>
<list-item>
<p><bold>Step 3:</bold> For <italic>j</italic> = 1, … , <italic>p</italic>, compute:
<disp-formula id="disp-formula36-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math36-0962280212448973"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>exp/</mml:mi><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">}</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>exp</mml:mi><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><graphic alternate-form-of="disp-formula36-0962280212448973" xlink:href="10.1177_0962280212448973-eq36.tif"/></disp-formula>
where
<disp-formula id="disp-formula37-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math37-0962280212448973"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ν</mml:mi></mml:mrow><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>'</mml:mo><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>Σ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi/><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>'</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">-</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">T</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">ν</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">X</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub><mml:mo mathvariant="bold">'</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">S</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi/><mml:mrow><mml:mo mathvariant="bold">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mtext mathvariant="bold">X</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">   </mml:mi><mml:mo mathvariant="bold">×</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mtext mathvariant="bold">T</mml:mtext></mml:mrow></mml:munderover><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">{</mml:mo></mml:mrow><mml:mtext mathvariant="bold">B</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">'</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mtext mathvariant="bold">B</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">B</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">'</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi/><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">}</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="bold">   </mml:mi><mml:mo mathvariant="bold">-</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">T</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">ν</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mtext mathvariant="bold">T</mml:mtext></mml:mrow></mml:munderover><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">{</mml:mo></mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext><mml:mo>&lt;###</mml:mo><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:munder><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">B</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">'</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">B</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">'</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">X</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub><mml:mo mathvariant="bold">'</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">S</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi/><mml:mrow><mml:mo mathvariant="bold">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mtext mathvariant="bold">X</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo mathvariant="bold"> </mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="bold">   </mml:mi><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold"> </mml:mo></mml:mrow><mml:mo mathvariant="bold">+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext><mml:mo>&gt;</mml:mo><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:munder><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">B</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">'</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">B</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">'</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">X</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub><mml:mo mathvariant="bold">'</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">S</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi/><mml:mrow><mml:mo mathvariant="bold">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mtext mathvariant="bold">X</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">}</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="bold">   </mml:mi><mml:mo mathvariant="bold">+</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo mathvariant="bold">+</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">S</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">{</mml:mo></mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext><mml:mo mathvariant="bold">∈</mml:mo><mml:mo mathvariant="bold">∂</mml:mo><mml:msub><mml:mi/><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">S</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:mtext mathvariant="bold">l</mml:mtext><mml:mo>&lt;###</mml:mo><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo mathvariant="bold">/</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">n</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">S</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo mathvariant="bold">+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext><mml:mo mathvariant="bold">∈</mml:mo><mml:mo mathvariant="bold">∂</mml:mo><mml:msub><mml:mi/><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">S</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:mtext mathvariant="bold">l</mml:mtext><mml:mo>&gt;</mml:mo><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo mathvariant="bold">/</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">n</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">S</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">}</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="bold">   </mml:mi><mml:mo mathvariant="bold">+</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">B</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">{</mml:mo></mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext><mml:mo mathvariant="bold">∈</mml:mo><mml:mo mathvariant="bold">∂</mml:mo><mml:msub><mml:mi/><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">B</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:mtext mathvariant="bold">l</mml:mtext><mml:mo>&lt;###</mml:mo><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo mathvariant="bold">/</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">n</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">B</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo mathvariant="bold">+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext><mml:mo mathvariant="bold">∈</mml:mo><mml:mo mathvariant="bold">∂</mml:mo><mml:msub><mml:mi/><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">B</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:mtext mathvariant="bold">l</mml:mtext><mml:mo>&gt;</mml:mo><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">l</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo mathvariant="bold">/</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">n</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">B</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">}</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math><graphic alternate-form-of="disp-formula37-0962280212448973" xlink:href="10.1177_0962280212448973-eq37.tif"/></disp-formula>
</p></list-item>
<list-item>
<p><bold>Step 4:</bold> Compute:
<disp-formula id="disp-formula38-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math38-0962280212448973"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo mathvariant="bold">=</mml:mo><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">(</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi> </mml:mrow><mml:mrow><mml:mo mathvariant="bold">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo mathvariant="bold">+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mtext mathvariant="bold">H</mml:mtext></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">f</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">)</mml:mo></mml:mrow><mml:mrow><mml:mo mathvariant="bold">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo mathvariant="bold">=</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">{</mml:mo></mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mtext mathvariant="bold">E</mml:mtext></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">q</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">u</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">Z</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">]</mml:mo><mml:mo mathvariant="bold">+</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi> </mml:mrow><mml:mrow><mml:mo mathvariant="bold">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi></mml:mrow></mml:msub><mml:mo mathvariant="bold">-</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext></mml:mrow></mml:munderover><mml:mo mathvariant="bold">∇</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">f</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">+</mml:mo><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">(</mml:mo></mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mtext mathvariant="bold">H</mml:mtext></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">f</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">)</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">}</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math><graphic alternate-form-of="disp-formula38-0962280212448973" xlink:href="10.1177_0962280212448973-eq38.tif"/></disp-formula>
</p>
<p>where
<disp-formula id="disp-formula39-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math39-0962280212448973"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>Z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo> </mml:mo><mml:mo>(</mml:mo></mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>∈</mml:mo><mml:mo>∂</mml:mo><mml:msub><mml:mi/><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>∈</mml:mo><mml:mo>∂</mml:mo><mml:msub><mml:mi/><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo> </mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>'</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">ω</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">=</mml:mo><mml:mtext mathvariant="bold">log</mml:mtext><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo mathvariant="bold">+</mml:mo><mml:mtext mathvariant="bold">exp</mml:mtext><mml:mo stretchy="false">{</mml:mo><mml:mi mathvariant="bold">ω</mml:mi><mml:mo mathvariant="bold">'</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">E</mml:mtext></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">q</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">u</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">Z</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">}</mml:mo><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mrow><mml:mo mathvariant="bold">∇</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">f</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">ω</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">=</mml:mo><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">(</mml:mo></mml:mrow><mml:mtext mathvariant="bold">exp</mml:mtext><mml:mo stretchy="false">{</mml:mo><mml:mi mathvariant="bold">ω</mml:mi><mml:mo mathvariant="bold">'</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">E</mml:mtext></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">q</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">u</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">Z</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">}</mml:mo><mml:mn>1</mml:mn><mml:mo mathvariant="bold">+</mml:mo><mml:mtext mathvariant="bold">exp</mml:mtext><mml:mo stretchy="false">{</mml:mo><mml:mi mathvariant="bold">ω</mml:mi><mml:mo mathvariant="bold">'</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">E</mml:mtext></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">q</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">u</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">Z</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">}</mml:mo><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">E</mml:mtext></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">q</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">u</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">Z</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">H</mml:mtext></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">f</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">ω</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">=</mml:mo><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">(</mml:mo></mml:mrow><mml:mtext mathvariant="bold">exp</mml:mtext><mml:mo stretchy="false">{</mml:mo><mml:mi mathvariant="bold">ω</mml:mi><mml:mo mathvariant="bold">'</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">E</mml:mtext></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">q</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">u</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">Z</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">}</mml:mo><mml:mn>1</mml:mn><mml:mo mathvariant="bold">+</mml:mo><mml:mtext mathvariant="bold">exp</mml:mtext><mml:mo stretchy="false">{</mml:mo><mml:mi mathvariant="bold">ω</mml:mi><mml:mo mathvariant="bold">'</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">E</mml:mtext></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">q</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">u</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">Z</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">}</mml:mo><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">)</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">E</mml:mtext></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">q</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">u</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">Z</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">E</mml:mtext></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">q</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">u</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">Z</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">'</mml:mo></mml:mrow></mml:mrow></mml:math><graphic alternate-form-of="disp-formula39-0962280212448973" xlink:href="10.1177_0962280212448973-eq39.tif"/></disp-formula>
</p></list-item>
<list-item>
<p><bold>Step 5:</bold> Compute the updated value of <italic>F</italic>. Check for convergence. If required, increment <italic>r</italic> and return to Step 1. The value of <italic>F</italic> at iteration <italic>r</italic> + 1 is given by <inline-formula id="ilm40-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="mml-math40-0962280212448973"><mml:mrow><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>log</mml:mi><mml:mi>P/</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>, which up to an additive constant takes the form 
<disp-formula id="disp-formula40-0962280212448973"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline" id="math40-0962280212448973"><mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ν</mml:mi></mml:mrow><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn><mml:mi>log</mml:mi><mml:mo>det</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow><mml:mrow><mml:mi>Σ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>1/2</mml:mn><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:munderover><mml:mi>log</mml:mi><mml:mo>det</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1/2</mml:mn><mml:mtext mathvariant="bold">log</mml:mtext><mml:mo>det</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">   </mml:mi><mml:mo mathvariant="bold">-</mml:mo><mml:mn>1/2</mml:mn><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mtext mathvariant="bold">T</mml:mtext></mml:mrow></mml:munderover><mml:mtext mathvariant="bold">trace</mml:mtext><mml:mo stretchy="false">{</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">T</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">ν</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">S</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi/><mml:mrow><mml:mo mathvariant="bold">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Var</mml:mtext></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">q</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold">β</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="bold">μ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">   </mml:mi><mml:mo mathvariant="bold">-</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">T</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">ν</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mtext mathvariant="bold">T</mml:mtext></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">Y</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">-</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">E</mml:mtext></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">q</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold">β</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="bold">μ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">'</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">S</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi/><mml:mrow><mml:mo mathvariant="bold">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">Y</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">-</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">E</mml:mtext></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">q</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold">β</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="bold">μ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">t</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">   </mml:mi><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1/2</mml:mn><mml:mtext mathvariant="bold">trace</mml:mtext><mml:mo stretchy="false">{</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">T</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">ν</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">S</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo mathvariant="bold">-</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">S</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">S</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi/><mml:mrow><mml:mo mathvariant="bold">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">   </mml:mi><mml:mo mathvariant="bold">-</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mtext mathvariant="bold">log</mml:mtext><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">}</mml:mo><mml:mo mathvariant="bold">-</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo mathvariant="bold">-</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mtext mathvariant="bold">log</mml:mtext><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo mathvariant="bold">-</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">   </mml:mi><mml:mo mathvariant="bold">-</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext></mml:mrow></mml:munderover><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">{</mml:mo></mml:mrow><mml:mtext mathvariant="bold">trace</mml:mtext><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">η</mml:mi> </mml:mrow><mml:mrow><mml:mo mathvariant="bold">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">}</mml:mo><mml:mo mathvariant="bold">+</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">'</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">η</mml:mi> </mml:mrow><mml:mrow><mml:mo mathvariant="bold">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo mathvariant="bold"> </mml:mo><mml:mo mathvariant="bold">}</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="bold">   </mml:mi><mml:mo mathvariant="bold">-</mml:mo><mml:mn>1/2</mml:mn><mml:mtext mathvariant="bold">trace</mml:mtext><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi> </mml:mrow><mml:mrow><mml:mo mathvariant="bold">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">}</mml:mo><mml:mo mathvariant="bold">-</mml:mo><mml:mn>1/2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo mathvariant="bold">-</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">'</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi> </mml:mrow><mml:mrow><mml:mo mathvariant="bold">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo mathvariant="bold">-</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext></mml:mrow></mml:msub> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">'</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mtext mathvariant="bold">E</mml:mtext></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">q</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">Z</mml:mtext> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">u</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">Z</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">   </mml:mi><mml:mo mathvariant="bold">-</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">f</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">-</mml:mo><mml:mn>1/2</mml:mn><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext><mml:mo mathvariant="bold">=</mml:mo><mml:mn>1</mml:mn> </mml:mrow><mml:mrow><mml:mtext mathvariant="bold">p</mml:mtext></mml:mrow></mml:munderover><mml:mtext mathvariant="bold">trace</mml:mtext><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="bold">H</mml:mtext></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mtext mathvariant="bold">f</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="bold">j</mml:mtext> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo mathvariant="bold">'</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">ω</mml:mi> </mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext mathvariant="bold">r</mml:mtext><mml:mo mathvariant="bold">+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><graphic alternate-form-of="disp-formula40-0962280212448973" xlink:href="10.1177_0962280212448973-eq40.tif"/></disp-formula>
</p></list-item>
</list></p>
</sec>
</sec></app></app-group>
</back>
</article>