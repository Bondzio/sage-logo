<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v2.3 20070202//EN" "journalpublishing.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">PID</journal-id>
<journal-id journal-id-type="hwp">sppid</journal-id>
<journal-title>Proceedings of the Institution of Mechanical Engineers, Part D: Journal of Automobile Engineering</journal-title>
<issn pub-type="ppub">0954-4070</issn>
<issn pub-type="epub">2041-2991</issn>
<publisher>
<publisher-name>SAGE Publications</publisher-name>
<publisher-loc>Sage UK: London, England</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1177/0954407011433535</article-id>
<article-id pub-id-type="publisher-id">10.1177_0954407011433535</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Original Articles</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Nonlinear lithium-ion diffusion dynamics conscious power management strategy in hybrid electric vehicles for battery downsizing</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<name><surname>Lee</surname><given-names>Tae-Kyung</given-names></name>
<xref ref-type="aff" rid="aff1-0954407011433535">1</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Filipi</surname><given-names>Zoran S</given-names></name>
<xref ref-type="aff" rid="aff2-0954407011433535">2</xref>
</contrib>
</contrib-group>
<aff id="aff1-0954407011433535"><label>1</label>Department of Mechanical Engineering, University of Michigan, Ann Arbor, MI, USA</aff>
<aff id="aff2-0954407011433535"><label>2</label>Department of Automotive Engineering, Clemson University, Greenville, SC, USA</aff>
<author-notes>
<corresp id="corresp1-0954407011433535">Tae-Kyung Lee, Mechanical Engineering, University of MI, Ann Arbor, MI 48109, USA.Email: <email>kteel@umich.edu</email></corresp>
</author-notes>
<pub-date pub-type="epub-ppub">
<month>7</month>
<year>2012</year>
</pub-date>
<volume>226</volume>
<issue>7</issue>
<fpage>857</fpage>
<lpage>868</lpage>
<history>
<date date-type="received">
<day>1</day>
<month>8</month>
<year>2011</year>
</date>
<date date-type="accepted">
<day>30</day>
<month>11</month>
<year>2011</year>
</date>
</history>
<permissions>
<copyright-statement>© IMechE 2012</copyright-statement>
<copyright-year>2012</copyright-year>
<copyright-holder content-type="society">Institution of Mechanical Engineers</copyright-holder>
</permissions>
<abstract>
<p>This paper proposes a battery power management strategy using the estimated lithium-ion concentration in the electrodes to prevent battery over-charging and over-discharging under aggressive driving conditions. Excessive battery operation is moderated by adjusting the allowable battery power limits through the feedback of information on the electrode-averaged lithium-ion concentration estimated by the extended Kalman filter. Uneven discretization of the radii of the solid electrode particles is used in the extended Kalman filter to reduce the computation effort. Safe battery operation with a relatively small size of the battery is possible with the proposed battery power management strategy by preventing extreme conditions, thus providing more flexibility for the development of robust and cost-effective hybrid electric vehicles.</p>
</abstract>
<kwd-group>
<kwd>Lithium-ion battery</kwd>
<kwd>power management</kwd>
<kwd>extended Kalman filter</kwd>
<kwd>estimation</kwd>
<kwd>hybrid electric vehicle</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="section1-0954407011433535" sec-type="intro">
<title>Introduction</title>
<p>Emphasis on fuel economy improvement and emission reduction has accelerated research on vehicle hybridization and electrification. Hybrid vehicles provide more design and control flexibility than conventional vehicles do, owing to the presence of additional power sources and on-board energy storage. Combination of optimized engine operation and regeneration of braking energy provides a significant potential for improving the fuel economy. This makes vehicle hybridization attractive in heavy-duty vehicles and military vehicles accompanied by the advance in battery technologies and gradual battery cost reduction.<sup><xref ref-type="bibr" rid="bibr1-0954407011433535">1</xref></sup> However, heavy-duty and military vehicles require a huge battery pack for hybridization to satisfy the performance targets under aggressive driving schedules and to prevent battery damage under extreme operations. Furthermore, large batteries increase the total vehicle mass and cost, and they act as obstacles in vehicle hybridization.</p>
<p>Sophisticated battery management must incorporate critical pathways to prevent battery oversizing while satisfying the required performance targets with acceptable cost and reliability. Safe battery operation is often achieved through oversizing the battery pack, but the cost penalty becomes unbeatable in the case of heavy-duty vehicles. Recent advances in lithium-ion batteries have realized a high specific power and a high energy density for electric vehicle and hybrid electric vehicle (HEV) applications.<sup><xref ref-type="bibr" rid="bibr2-0954407011433535">2</xref></sup> However, lithium-ion batteries are exposed to the potential risks of damage or explosion under extreme operating conditions, such as high temperatures, over-charging and over-discharging. Hence, those conditions must be avoided to ensure a long battery life and stability. A cost-effective way to resolve these problems is to maximize battery utilization within the design capacity while simultaneously avoiding harmful battery operations through the development of sophisticated battery control.</p>
<p>Accurate prediction of battery behavior in heavy-duty HEVs is a prerequisite for the development of sophisticated control design capable of preventing battery degradation and damage. Most previous studies on simulation-based HEV design optimization and control design have relied on equivalent-circuit battery models because they have a simple structure and allow fast computation.<sup><xref ref-type="bibr" rid="bibr3-0954407011433535">3</xref><xref ref-type="bibr" rid="bibr4-0954407011433535"/><xref ref-type="bibr" rid="bibr5-0954407011433535"/><xref ref-type="bibr" rid="bibr6-0954407011433535"/><xref ref-type="bibr" rid="bibr7-0954407011433535"/>–<xref ref-type="bibr" rid="bibr8-0954407011433535">8</xref></sup> However, the equivalent-circuit models lack the predictiveness of lithium-ion electrochemical diffusion dynamics. Full-order electrochemical models of the lithium-ion battery are the other extreme of battery models that predict lithium-ion diffusion dynamics with high accuracy. Full-order lithium-ion battery models were developed by Doyle et al.<sup><xref ref-type="bibr" rid="bibr9-0954407011433535">9</xref></sup> and further improved in the follow-up studies by Fuller et al.<sup><xref ref-type="bibr" rid="bibr10-0954407011433535">10</xref></sup> and by Gu and Wang.<sup><xref ref-type="bibr" rid="bibr11-0954407011433535">11</xref></sup> The full-order models can predict the solid concentration profiles across the electrodes and the electrolyte. However, their long computational time and the model complexity prevent their application in control design or real-time on-board estimators. In this paper, an electrode-averaged lithium-ion battery model proposed by Di Domenico et al.<sup><xref ref-type="bibr" rid="bibr12-0954407011433535">12</xref>,<xref ref-type="bibr" rid="bibr13-0954407011433535">13</xref></sup> is further modified by introducing uneven discretization, to enable fast computation for model-based control design. The prediction capability of lithium-ion concentration profiles in the electrodes under dynamic conditions is subsequently used as feedback in the proposed battery management strategy.</p>
<p>Electrode-averaged battery models are valid when the concentration distribution along the length of the electrodes and separator is negligible. Nevertheless, the averaged models are useful in control design, since they can predict the lithium-ion concentration profiles in the electrodes and can produce state-space system models with linear dynamics of spherical diffusion in the solid material and a nonlinear voltage output equation.<sup><xref ref-type="bibr" rid="bibr12-0954407011433535">12</xref>,<xref ref-type="bibr" rid="bibr13-0954407011433535">13</xref></sup> The averaged models tend to exaggerate lithium-ion diffusion dynamics under high-current discharging and charging conditions owing to the lack of electrolyte information. However, the exaggerated responses can be beneficially used in model-based control design in the sense of a safety margin in designing the control strategy.</p>
<p>This paper proposes a control strategy that moderates excessive battery operations through feedback of the predicted lithium-ion concentration profile along the radius of the electrode particle estimated by an extended Kalman filter (EKF) in real time. The EKF uses uneven discretization of the particle radius to reduce the computational time. The proposed control strategy adjusts the allowable power limits of the battery using the EKF and feeds them into the rule-based controller. The strategy uses the lithium-ion concentration profile information along the entire particle radius as well as the lithium-ion concentration at the electrode particle surface. Then, the impact of the proposed strategy on battery operation and fuel economy is investigated with respect to different battery sizes under an aggressive real-world military driving cycle.</p>
<p>This paper is organized as follows. First, an HEV simulation framework is presented in the second section. Then, an electrode-averaged lithium-ion battery model is introduced in the third section. The effect of the initial lithium-ion concentration profiles on the battery behavior is investigated in the fourth section. The rule-based supervisory control structure including the thermostatic control strategy is explained. A new battery power management strategy using the lithium-ion concentration profile along the radius of the solid particle estimated by the EKF is proposed in the fifth section. The simulation results show the effectiveness of the proposed controller, and the fuel economy trends are characterized with respect to the battery size in the sixth section. Finally, summary and conclusions are presented.</p>
</sec>
<sec id="section2-0954407011433535">
<title>Series HEV simulation framework</title>
<p>A heavy-duty series HEV equipped with a lithium-ion battery is selected as the target vehicle to investigate the effect of the electrochemical battery dynamics on control design. <xref ref-type="table" rid="table1-0954407011433535">Table 1</xref> shows the specifications of the selected heavy-duty vehicle. The series HEV is a particularly interesting platform because the electric driveline is sized to provide full propulsion power. A large electric motor implies the ability to absorb large amount of braking energy. The simulation framework for HEV analysis is constructed by integrating component models into a high-level vehicle model. The series HEV simulation framework is shown in <xref ref-type="fig" rid="fig1-0954407011433535">Figure 1</xref>. Each component model is computationally efficient with an acceptable accuracy for control design to deal with long and various driving cycles in the simulation. Detailed modeling is described in Appendices 1 and 2.</p>
<table-wrap id="table1-0954407011433535" position="float">
<label>Table 1.</label>
<caption>
<p>Heavy-duty series HEV specification: hybridized mine-resistant ambush-protected all-terrain vehicle.</p>
</caption>
<graphic alternate-form-of="table1-0954407011433535" xlink:href="10.1177_0954407011433535-table1.tif"/>
<table>
<colgroup>
<col align="left"/>
<col align="left"/>
</colgroup>
<thead>
<tr>
<th/>
<th align="left">Specification</th>
</tr>
</thead>
<tbody>
<tr>
<td>Vehicle</td>
<td>Hybridized mine-resistant ambush-protected all-terrain vehicle</td>
</tr>
<tr>
<td>Mass</td>
<td>13,400 kg</td>
</tr>
<tr>
<td>Payload</td>
<td>1814 kgf (4000 lbf)</td>
</tr>
<tr>
<td>Frontal area</td>
<td>5.72 m<sup>2</sup> (width: 2.49 m; height: 2.70 m)</td>
</tr>
<tr>
<td>Engine</td>
<td>I6 turbo-diesel engine, 275 kW</td>
</tr>
<tr>
<td>Generator</td>
<td>Permanent magnet, 275 kW</td>
</tr>
<tr>
<td>Battery</td>
<td>Lithium-ion battery, 5.0–13.0 kW h</td>
</tr>
<tr>
<td>Motors</td>
<td>Permanent magnet, 380 kW</td>
</tr>
</tbody>
</table>
</table-wrap>
<fig id="fig1-0954407011433535" position="float">
<label>Figure 1.</label>
<caption>
<p>Simulation framework of the series HEV in Simulink with a forward-looking approach.</p>
</caption>
<graphic xlink:href="10.1177_0954407011433535-fig1.tif"/>
</fig>
</sec>
<sec id="section3-0954407011433535">
<title>Lithium-ion battery model</title>
<p>The electrode-averaged lithium-ion battery model provides relatively fast computation and captures lithium-ion diffusion dynamics, thus enabling the lithium-ion concentration profiles to be estimated along the radius of the solid electrode particles. In the averaged electrochemistry model, the change in the lithium-ion concentration in the solid particles along the electrode is neglected, and the concentration in the electrolyte is assumed to be constant. Although this simplification may reduce the prediction accuracy under high charging and discharging conditions, the important diffusion dynamics of the solid particles are captured. In this paper, the electrode-averaged model proposed by Di Domenico et al.<sup><xref ref-type="bibr" rid="bibr12-0954407011433535">12</xref>,<xref ref-type="bibr" rid="bibr13-0954407011433535">13</xref></sup> is modified to improve the computation speed and the prediction accuracy by using uneven discretization, while constructing a set of ordinary differential equations (ODEs). <xref ref-type="fig" rid="fig2-0954407011433535">Figure 2</xref> shows the conceptual illustration of the battery model reduction from the full-order model, which is represented as a macroscopic (<italic>x-</italic>direction) cell model with a coupled microscopic solid diffusion (<italic>r-</italic>direction) model to the electrode-averaged model.</p>
<fig id="fig2-0954407011433535" position="float">
<label>Figure 2.</label>
<caption>
<p>Illustration of lithium-ion battery models: (a) the macroscopic (<italic>x-</italic>direction) cell model with the coupled microscopic solid diffusion (<italic>r-</italic>direction) model; (b) the electrode-averaged cell model with the coupled microscopic solid diffusion (<italic>r-</italic>direction) model.</p>
</caption>
<graphic xlink:href="10.1177_0954407011433535-fig2.tif"/>
</fig>
<p>The averaged-electrode battery model is derived from the complete set of equations describing the lithium-ion battery system by the solid concentration <italic>c<sub>s</sub></italic>, the electrolyte concentration <italic>c<sub>e</sub></italic>, the solid potential φ<italic><sub>s</sub></italic>, and the electrolyte potential φ<italic><sub>e</sub></italic>, as reported by Fuller and co-workers.<sup><xref ref-type="bibr" rid="bibr9-0954407011433535">9</xref>,<xref ref-type="bibr" rid="bibr10-0954407011433535">10</xref></sup> The accuracy of the electrode-averaged lithium-ion battery model is validated through comparisons with the full-order electrochemical battery model developed by Smith and Wang.<sup><xref ref-type="bibr" rid="bibr14-0954407011433535">14</xref></sup> With the assumptions that <inline-formula id="inline-formula1-0954407011433535">
<mml:math display="inline" id="math1-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mo>∇</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mrow>
<mml:mi>ϕ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>e</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mtext>constant</mml:mtext>
</mml:mrow>
</mml:math></inline-formula>, <inline-formula id="inline-formula2-0954407011433535">
<mml:math display="inline" id="math2-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mo>∇</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mrow>
<mml:mi>ϕ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mtext>constant</mml:mtext>
</mml:mrow>
</mml:math></inline-formula>, and <inline-formula id="inline-formula3-0954407011433535">
<mml:math display="inline" id="math3-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mo>∇</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>e</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:math></inline-formula>, the governing equations are reduced to the diffusion dynamics equation in the solid electrode, which is given by</p>
<p>
<disp-formula id="disp-formula1-0954407011433535">
<label>(1)</label>
<mml:math display="block" id="math4-0954407011433535">
<mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:mo>∂</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:mo>∂</mml:mo>
<mml:mi>t</mml:mi>
</mml:mrow>
</mml:mfrac>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mo>∇</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>D</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.25em"/>
<mml:msub>
<mml:mrow>
<mml:mo>∇</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula1-0954407011433535" xlink:href="10.1177_0954407011433535-eq1.tif"/>
</disp-formula>
</p>
<p>where <italic>D<sub>s</sub></italic> is the effective diffusion coefficient of lithium ions in the electrodes, and the boundary conditions of <xref ref-type="disp-formula" rid="disp-formula1-0954407011433535">equation (1)</xref> are</p>
<p>
<disp-formula id="disp-formula2-0954407011433535">
<label>(2a)</label>
<mml:math display="block" id="math5-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:mo>∂</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:mo>∂</mml:mo>
<mml:mi>r</mml:mi>
</mml:mrow>
</mml:mfrac>
<mml:mo>|</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mi>r</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula2-0954407011433535" xlink:href="10.1177_0954407011433535-eq2.tif"/>
</disp-formula>
</p>
<p>
<disp-formula id="disp-formula3-0954407011433535">
<label>(2b)</label>
<mml:math display="block" id="math6-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:mo>∂</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:mo>∂</mml:mo>
<mml:mi>r</mml:mi>
</mml:mrow>
</mml:mfrac>
<mml:mo>|</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mi>r</mml:mi>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>R</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mo>−</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>j</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>Li</mml:mi>
</mml:mrow>
</mml:msup>
</mml:mrow>
<mml:mrow>
<mml:mi>F</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mi>a</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mrow>
<mml:mi>D</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula3-0954407011433535" xlink:href="10.1177_0954407011433535-eq3.tif"/>
</disp-formula>
</p>
<p>In an averaged electrochemistry model represented by one solid particle for each electrode (anode and cathode), the Butler–Volmer current is assumed to be constant and equal to <inline-formula id="inline-formula4-0954407011433535">
<mml:math display="inline" id="math7-0954407011433535">
<mml:mrow>
<mml:msubsup>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>j</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>n</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>Li</mml:mi>
</mml:mrow>
</mml:msubsup>
</mml:mrow>
</mml:math></inline-formula> regardless of the spatial locations, and it is evaluated from the spatial integral</p>
<p>
<disp-formula id="disp-formula4-0954407011433535">
<label>(3)</label>
<mml:math display="block" id="math8-0954407011433535">
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>j</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>Li</mml:mi>
</mml:mrow>
</mml:msup>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mn>1</mml:mn>
<mml:mi>δ</mml:mi>
</mml:mfrac>
<mml:mfrac>
<mml:mi>I</mml:mi>
<mml:mi>A</mml:mi>
</mml:mfrac>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mn>1</mml:mn>
<mml:mi>δ</mml:mi>
</mml:mfrac>
<mml:msubsup>
<mml:mrow>
<mml:mo>∫</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>δ</mml:mi>
</mml:mrow>
</mml:msubsup>
<mml:msup>
<mml:mrow>
<mml:mi>j</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>Li</mml:mi>
</mml:mrow>
</mml:msup>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mi>x</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mspace width="0.25em"/>
<mml:mi>d</mml:mi>
<mml:mi>x</mml:mi>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula4-0954407011433535" xlink:href="10.1177_0954407011433535-eq4.tif"/>
</disp-formula>
</p>
<p>where δ is the electrode thickness.</p>
<p>The model is then expressed as a set of ODEs using the finite difference method for the spatial variable <italic>r</italic>. The model is suitable for the development of a model-based battery control strategy. The sphere radius is divided into <bold><italic>r</italic></bold> = (<italic>r</italic><sub>1</sub>, <italic>r</italic><sub>2</sub>, …, <italic>r<sub>Mr</sub></italic><sub>−1</sub>) with uneven discretization to speed up computation, while preserving resolution near the solid particle surface. The derived ODE is</p>
<p>
<disp-formula id="disp-formula5-0954407011433535">
<label>(4)</label>
<mml:math display="block" id="math9-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>α</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>[</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mfrac>
<mml:mn>1</mml:mn>
<mml:mrow>
<mml:mi>Δ</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>k</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mo>−</mml:mo>
<mml:mfrac>
<mml:mn>1</mml:mn>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>k</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mfrac>
<mml:mn>1</mml:mn>
<mml:mrow>
<mml:mi>Δ</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mo>+</mml:mo>
<mml:mfrac>
<mml:mn>1</mml:mn>
<mml:mrow>
<mml:mi>Δ</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>k</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mfrac>
<mml:mn>1</mml:mn>
<mml:mrow>
<mml:mi>Δ</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mo>+</mml:mo>
<mml:mfrac>
<mml:mn>1</mml:mn>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>k</mml:mi>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>]</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula5-0954407011433535" xlink:href="10.1177_0954407011433535-eq5.tif"/>
</disp-formula>
</p>
<p>for <italic>k</italic> = 2, …, <italic>Mr</italic>− 2, where <inline-formula id="inline-formula5-0954407011433535">
<mml:math display="inline" id="math10-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>α</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mn>2</mml:mn>
<mml:msub>
<mml:mrow>
<mml:mi>D</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">/</mml:mo>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>Δ</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>k</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:mi>Δ</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math></inline-formula> and <inline-formula id="inline-formula6-0954407011433535">
<mml:math display="inline" id="math11-0954407011433535">
<mml:mrow>
<mml:mi>Δ</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>k</mml:mi>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula>. Also</p>
<p>
<disp-formula id="disp-formula6-0954407011433535">
<label>(5)</label>
<mml:math display="block" id="math12-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
<mml:mo>,</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>2</mml:mn>
<mml:msub>
<mml:mrow>
<mml:mi>D</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msup>
</mml:mrow>
</mml:mfrac>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
<mml:mo>,</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
<mml:mo>,</mml:mo>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula6-0954407011433535" xlink:href="10.1177_0954407011433535-eq6.tif"/>
</disp-formula>
</p>
<p>for <italic>k</italic> = 1 from the boundary condition at the solid center, <inline-formula id="inline-formula7-0954407011433535">
<mml:math display="inline" id="math13-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mo stretchy="false">(</mml:mo>
<mml:mo>∂</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">/</mml:mo>
<mml:mo>∂</mml:mo>
<mml:mi>r</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>|</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mi>r</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:math></inline-formula>, and</p>
<p>
<disp-formula id="disp-formula7-0954407011433535">
<label>(6)</label>
<mml:math display="block" id="math14-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>Mr</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>α</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>Mr</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>[</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mfrac>
<mml:mn>1</mml:mn>
<mml:mrow>
<mml:mi>Δ</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>Mr</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mo>−</mml:mo>
<mml:mfrac>
<mml:mn>1</mml:mn>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>Mr</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>Mr</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>Mr</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>−</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mi>Δ</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>Mr</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>Mr</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>j</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>Li</mml:mi>
</mml:mrow>
</mml:msup>
</mml:mrow>
<mml:mrow>
<mml:mi>F</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mi>a</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mrow>
<mml:mi>D</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mrow>
<mml:mo>]</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula7-0954407011433535" xlink:href="10.1177_0954407011433535-eq7.tif"/>
</disp-formula>
</p>
<p>for <italic>k</italic> = <italic>Mr</italic>− 1from the boundary condition at the solid surface, <inline-formula id="inline-formula8-0954407011433535">
<mml:math display="inline" id="math15-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mo stretchy="false">(</mml:mo>
<mml:mo>∂</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">/</mml:mo>
<mml:mo>∂</mml:mo>
<mml:mi>r</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>|</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mi>r</mml:mi>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>R</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mo>−</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>j</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>Li</mml:mi>
</mml:mrow>
</mml:msup>
<mml:mo stretchy="false">/</mml:mo>
<mml:mi>F</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mi>a</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mrow>
<mml:mi>D</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula>.</p>
<p><xref ref-type="disp-formula" rid="disp-formula5-0954407011433535">Equations (4)</xref> to <xref ref-type="disp-formula" rid="disp-formula7-0954407011433535">(6)</xref> can be expressed as the state-space equations</p>
<p>
<disp-formula id="disp-formula8-0954407011433535">
<label>(7)</label>
<mml:math display="block" id="math16-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">c</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mi mathvariant="bold">A</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mi mathvariant="bold-italic">c</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:mi mathvariant="bold">B</mml:mi>
<mml:mi mathvariant="bold-italic">u</mml:mi>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula8-0954407011433535" xlink:href="10.1177_0954407011433535-eq8.tif"/>
</disp-formula>
</p>
<p>where <bold><italic>c</italic></bold><italic><sub>s</sub></italic> = (<italic>c</italic><sub><italic>s</italic>,1</sub>, <italic>c</italic><sub><italic>s</italic>,2</sub>, …, <italic>c</italic><sub><italic>s</italic>,<italic>Mr</italic>−1</sub>)<sup>T</sup> is the distributed lithium-ion concentration, |<bold><italic>u</italic></bold>| = <italic>R<sub>f</sub></italic><italic>I</italic>/<italic>A</italic>, <bold>A</bold> is a constant tridiagonal matrix expressed as</p>
<p>
<disp-formula id="disp-formula9-0954407011433535">
<label>(8a)</label>
<mml:math display="block" id="math17-0954407011433535">
<mml:mrow>
<mml:mi mathvariant="bold">A</mml:mi>
<mml:mo>=</mml:mo>
<mml:mrow>
<mml:mo>[</mml:mo>
<mml:mtable align="left">
<mml:mtr>
<mml:mtd columnalign="center">
<mml:mrow>
<mml:mo>−</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>2</mml:mn>
<mml:msub>
<mml:mrow>
<mml:mi>D</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msup>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:mtd>
<mml:mtd>
<mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:mn>2</mml:mn>
<mml:msub>
<mml:mrow>
<mml:mi>D</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msup>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:mtd>
<mml:mtd>
<mml:mrow>
<mml:mo>⋯</mml:mo>
</mml:mrow>
</mml:mtd>
<mml:mtd>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:mtd>
<mml:mtd>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="center">
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:mtd>
<mml:mtd columnalign="center">
<mml:mrow>
<mml:mo>⋱</mml:mo>
</mml:mrow>
</mml:mtd>
<mml:mtd columnalign="center">
<mml:mrow>
</mml:mrow>
</mml:mtd>
<mml:mtd columnalign="center">
<mml:mrow>
</mml:mrow>
</mml:mtd>
<mml:mtd>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="center">
<mml:mrow>
<mml:mo>⋮</mml:mo>
</mml:mrow>
</mml:mtd>
<mml:mtd>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>α</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>Δ</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>k</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mo>−</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:mtd>
<mml:mtd>
<mml:mrow>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>α</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>Δ</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mo>+</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>Δ</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>k</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:mtd>
<mml:mtd>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>α</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>Δ</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mo>+</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:mtd>
<mml:mtd>
<mml:mrow>
<mml:mo>⋮</mml:mo>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="center">
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:mtd>
<mml:mtd columnalign="center">
<mml:mrow>
</mml:mrow>
</mml:mtd>
<mml:mtd columnalign="center">
<mml:mrow>
</mml:mrow>
</mml:mtd>
<mml:mtd>
<mml:mrow>
<mml:mo>⋱</mml:mo>
</mml:mrow>
</mml:mtd>
<mml:mtd>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="center">
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:mtd>
<mml:mtd>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:mtd>
<mml:mtd>
<mml:mrow>
<mml:mo>⋯</mml:mo>
</mml:mrow>
</mml:mtd>
<mml:mtd>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>α</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>Mr</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>Δ</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>Mr</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mo>−</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>Mr</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:mtd>
<mml:mtd>
<mml:mrow>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>α</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>Mr</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>Δ</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>Mr</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mo>−</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>Mr</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
<mml:mo>]</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula9-0954407011433535" xlink:href="10.1177_0954407011433535-eq9.tif"/>
</disp-formula>
</p>
<p>and</p>
<p>
<disp-formula id="disp-formula10-0954407011433535">
<label>(8b)</label>
<mml:math display="block" id="math18-0954407011433535">
<mml:mrow>
<mml:mi mathvariant="bold">B</mml:mi>
<mml:mo>=</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mo>[</mml:mo>
<mml:mtable>
<mml:mtr>
<mml:mtd>
<mml:mn>0</mml:mn>
</mml:mtd>
<mml:mtd>
<mml:mo>⋯</mml:mo>
</mml:mtd>
<mml:mtd>
<mml:mn>0</mml:mn>
<mml:mo>−</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>α</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>Mr</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:mi>F</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mi>a</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mrow>
<mml:mi>D</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mi>Δ</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>Mr</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>r</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>Mr</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
<mml:mo>]</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mtext>T</mml:mtext>
</mml:mrow>
</mml:msup>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula10-0954407011433535" xlink:href="10.1177_0954407011433535-eq10.tif"/>
</disp-formula>
</p>
<p>The battery voltage, using the average values at the anode and the cathode, can be written as</p>
<p>
<disp-formula id="disp-formula11-0954407011433535">
<label>(9)</label>
<mml:math display="block" id="math19-0954407011433535">
<mml:mrow>
<mml:mi>V</mml:mi>
<mml:mo>=</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>η</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>p</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>η</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>n</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>+</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>ϕ</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>e</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>p</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>ϕ</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>e</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>n</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>+</mml:mo>
<mml:mrow>
<mml:mo>[</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>U</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>p</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>θ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>p</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>U</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>n</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>θ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>n</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>]</mml:mo>
</mml:mrow>
<mml:mo>−</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>R</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>f</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:mi>A</mml:mi>
</mml:mrow>
</mml:mfrac>
<mml:mi>I</mml:mi>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula11-0954407011433535" xlink:href="10.1177_0954407011433535-eq11.tif"/>
</disp-formula>
</p>
<p>where <inline-formula id="inline-formula9-0954407011433535">
<mml:math display="inline" id="math20-0954407011433535">
<mml:mrow>
<mml:mi>θ</mml:mi>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>se</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">/</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
<mml:mo>,</mml:mo>
<mml:mo>max</mml:mo>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula> is the normalized solid-electrolyte concentration, and <inline-formula id="inline-formula10-0954407011433535">
<mml:math display="inline" id="math21-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>η</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>p</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>η</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>n</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula> can be expressed as</p>
<p>
<disp-formula id="disp-formula12-0954407011433535">
<label>(10)</label>
<mml:math display="block" id="math22-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>η</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>p</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>η</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>n</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mi>RT</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>α</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>a</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mi>F</mml:mi>
</mml:mrow>
</mml:mfrac>
<mml:mi>ln</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>ξ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>p</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:msqrt>
<mml:mrow>
<mml:msubsup>
<mml:mrow>
<mml:mi>ξ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>p</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msubsup>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msqrt>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>ξ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>n</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:msqrt>
<mml:mrow>
<mml:msubsup>
<mml:mrow>
<mml:mi>ξ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>n</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msubsup>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msqrt>
</mml:mrow>
</mml:mfrac>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula12-0954407011433535" xlink:href="10.1177_0954407011433535-eq12.tif"/>
</disp-formula>
</p>
<p>where<sup><xref ref-type="bibr" rid="bibr13-0954407011433535">13</xref></sup></p>
<p>
<disp-formula id="disp-formula13-0954407011433535">
<mml:math display="block" id="math23-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>ξ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>p</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:msubsup>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>j</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>p</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>Li</mml:mi>
</mml:mrow>
</mml:msubsup>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
<mml:msub>
<mml:mrow>
<mml:mi>a</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mrow>
<mml:mi>j</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>o</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>p</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mo>,</mml:mo>
<mml:mspace width="0.25em"/>
<mml:msub>
<mml:mrow>
<mml:mi>ξ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>n</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:msubsup>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>j</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>n</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>Li</mml:mi>
</mml:mrow>
</mml:msubsup>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
<mml:msub>
<mml:mrow>
<mml:mi>a</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mrow>
<mml:mi>j</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>o</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>n</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula13-0954407011433535" xlink:href="10.1177_0954407011433535-eq13.tif"/>
</disp-formula>
</p>
<p>and where</p>
<p>
<disp-formula id="disp-formula14-0954407011433535">
<label>(11)</label>
<mml:math display="block" id="math24-0954407011433535">
<mml:mrow>
<mml:mtable align="right" width="80%">
<mml:mtr>
<mml:mtd columnalign="right">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>ϕ</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>e</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>p</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>ϕ</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>e</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>n</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>ϕ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>e</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>L</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>ϕ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>e</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="right">
<mml:mrow>
<mml:mo>=</mml:mo>
<mml:mo>−</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mi>I</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
<mml:mi>A</mml:mi>
<mml:msup>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>eff</mml:mi>
</mml:mrow>
</mml:msup>
</mml:mrow>
</mml:mfrac>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>δ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>n</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:mn>2</mml:mn>
<mml:msub>
<mml:mrow>
<mml:mi>δ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>sep</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>δ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>p</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula14-0954407011433535" xlink:href="10.1177_0954407011433535-eq14.tif"/>
</disp-formula>
</p>
<p>Here δ is the electrode thickness with the subscripts <italic>p, sep</italic>, and <italic>n</italic> referring to the cathode, the separator, and the anode respectively, and <inline-formula id="inline-formula11-0954407011433535">
<mml:math display="inline" id="math25-0954407011433535">
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>eff</mml:mi>
</mml:mrow>
</mml:msup>
</mml:mrow>
</mml:math></inline-formula> is the effective electrolyte-phase conductivity.</p>
</sec>
<sec id="section4-0954407011433535">
<title>Effect of the lithium-ion concentration profile</title>
<p>The battery responses are affected by the lithium-ion concentration profiles along the radius of the solid particles. The allowable battery power limits vary depending on the applied current, the initial state of charge (SOC) of the battery, and the lithium-ion concentration profiles. When an excessive discharging current is applied to the battery, the lithium-ion surface concentration drops rapidly until the battery is depleted, although the bulk SOC estimated by integration of the current (i.e. ‘coulomb counting’) remains high for providing current. Lithium-ion diffusion toward the center of the solid electrode particles varies depending on the initial lithium-ion concentration profiles. Variations in the diffusion responses result in different lithium-ion concentrations at the surface of the electrode particle and different terminal voltages.</p>
<p>The battery responses under discharging at different initial lithium-ion concentration profiles are investigated to present the key concept for the development of a battery management strategy. To assess the effect of the initial profiles on the allowable battery power limits, the responses of a battery with different initial lithium-ion concentration profiles, while having the same SOC as calculated by coulomb counting (SOC<italic><sub>ini,bulk</sub></italic>) and the same lithium-ion concentration at the solid surface, are investigated under the same discharging condition with a constant current.</p>
<p>The variations in the lithium-ion concentration at the solid surface resulting from different initial lithium-ion concentration profiles are shown in <xref ref-type="fig" rid="fig3-0954407011433535">Figure 3</xref>. The simulation results show that the lithium-ion diffusion process to the center of the particle is accelerated when the initial lithium-ion concentration profile is smoother after long and slow discharging events. The smoother profiles result in larger lithium-ion concentration changes at the surface of the solid electrode particle, and the different lithium-ion concentrations lead to different terminal voltages, as shown in <xref ref-type="fig" rid="fig4-0954407011433535">Figure 4</xref>. In other words, the lithium-ion concentration profiles are sensitive to the terminal voltage; thus, the allowable battery power limits are determined by the lithium-ion concentration profile along the radius of the solid particle.</p>
<fig id="fig3-0954407011433535" position="float">
<label>Figure 3.</label>
<caption>
<p>Lithium-ion concentration profile changes of the battery with different initial lithium-ion concentration profiles along the electrode particles under the same constant discharging current: (a) cathode; (b) anode.</p>
</caption>
<graphic xlink:href="10.1177_0954407011433535-fig3.tif"/>
</fig>
<fig id="fig4-0954407011433535" position="float">
<label>Figure 4.</label>
<caption>
<p>Terminal voltage trajectories under the same constant-current discharging condition with different initial lithium-ion concentration profiles.</p>
</caption>
<graphic xlink:href="10.1177_0954407011433535-fig4.tif"/>
</fig>
</sec>
<sec id="section5-0954407011433535">
<title>Supervisory control design</title>
<p>Thermostatic SOC control strategy with an additional logic for limiting the allowable battery charging/discharging power is proposed for a supervisory controller. The controller consists of four operating modes, as illustrated in <xref ref-type="fig" rid="fig5-0954407011433535">Figure 5</xref>. The controller distributes the power demand between the engine and the battery depending on both the battery SOC and the demanded power. Under the charge-sustaining mode, the thermostatic SOC control strategy is applied. The thermostatic control strategy has been used in series hybrid hydraulic vehicle and HEV control design.<sup><xref ref-type="bibr" rid="bibr8-0954407011433535">8</xref>,<xref ref-type="bibr" rid="bibr15-0954407011433535">15</xref></sup> The strategy determines engine operation based on the driving power demand and the battery SOC level (SOC<italic><sub>batt</sub></italic>). It is effective in managing the SOC and providing significant efficiency gains when combined with the optimal engine operating scheme.</p>
<fig id="fig5-0954407011433535" position="float">
<label>Figure 5.</label>
<caption>
<p>Operation modes of the series HEV supervisory controller.</p>
</caption>
<graphic xlink:href="10.1177_0954407011433535-fig5.tif"/>
</fig>
<p>The basic operations of the thermostatic SOC control are illustrated in <xref ref-type="fig" rid="fig6-0954407011433535">Figure 6</xref>. Whenever the battery SOC reaches the lower limit, denoted SOC<italic><sub>lb</sub></italic>, the engine begins to charge the battery with the predetermined threshold power until the battery SOC reaches the upper bound of the SOC, denoted SOC<italic><sub>ub</sub></italic>. If the battery SOC dips below the SOC<italic><sub>lb</sub></italic>, the engine power demand is increased proportionally to SOC<italic><sub>batt</sub></italic>− SOC<italic><sub>lb</sub></italic>, as shown in <xref ref-type="fig" rid="fig6-0954407011433535">Figure 6</xref>. The engine speed and torque are determined to keep the engine on the best brake specific fuel consumption (BSFC) line with any desired engine power demand. In most previous studies, the maximum allowable battery power <italic>P<sub>batt,max</sub></italic> has been expressed as a function of the SOC<italic><sub>batt</sub></italic> and the battery current. However, the investigation of the battery responses in the previous section indicates that the allowable battery power is affected by the lithium-ion concentration profile along the radius of the solid particle. Thus, we introduce a battery management strategy that adjusts <italic>P<sub>batt,max</sub></italic> by utilizing the estimated lithium-ion concentration profiles and ensures battery operation within the safe operating range. The detailed strategy is shown in the section on the battery power management strategy.</p>
<fig id="fig6-0954407011433535" position="float">
<label>Figure 6.</label>
<caption>
<p>Illustration of the thermostatic SOC power management strategy.</p>
</caption>
<graphic xlink:href="10.1177_0954407011433535-fig6.tif"/>
</fig>
<p>The battery management strategy increases the role of the supervisory controller in order to prevent excessive battery operations. The augmented controller accounts for the battery diffusion dynamics in determining the allowable battery power limits <italic>P<sub>batt,max</sub></italic> and <italic>P<sub>batt,min</sub></italic>. When the driving power demand <italic>P<sub>dem</sub></italic> exceeds the battery power limits, the operation is shifted to ‘power mode’, thus preventing battery over-charging and over-discharging. If the battery power demand is determined without consideration of the battery diffusion dynamics, the lithium-ion concentration profiles and voltage may exceed the battery capability, and the battery could be eventually damaged.</p>
<p>The key to successful implementation of the battery management strategy is real-time adjustment of the allowable battery power limits using the estimated instantaneous lithium-ion concentration profile along the radius of the solid particle. The estimation is realized by the electrochemical model-driven EKF, and the unevenly discretized electrode-averaged battery model is introduced to the EKF to reduce computational efforts. The lithium-ion concentration <inline-formula id="inline-formula12-0954407011433535">
<mml:math display="inline" id="math26-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
<mml:mo>^</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula> is estimated by the EKF from the measured battery terminal voltage. Then, the allowable power limits are adjusted by manipulating the estimated profile <inline-formula id="inline-formula13-0954407011433535">
<mml:math display="inline" id="math27-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
<mml:mo>^</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula>. The schematic diagram of the controller structure is shown in <xref ref-type="fig" rid="fig7-0954407011433535">Figure 7</xref>. The allowable battery power limits are adjusted. When the battery power demand exceeds the adjusted allowable battery power limits, the operating mode is changed to the power mode and the battery operation is kept within the allowable range.</p>
<fig id="fig7-0954407011433535" position="float">
<label>Figure 7.</label>
<caption>
<p>Schematic diagram of the controller structure for the battery management strategy using an electrochemistry battery model-driven EKF.</p>
</caption>
<graphic xlink:href="10.1177_0954407011433535-fig7.tif"/>
</fig>
<sec id="section6-0954407011433535">
<title>Extended Kalman filter</title>
<p>The lithium-ion concentration profiles along the radius of the solid electrode particle are estimated by the model-based EKF proposed by Di Domenico et al.,<sup><xref ref-type="bibr" rid="bibr13-0954407011433535">13</xref></sup> modified in this paper to reduce the computation effort while maintaining the estimation accuracy. The radius of the solid particle is discretized with a small number of uneven steps after reviewing the lithium-ion concentration profiles under various operations. The Kalman gains are limited so that they do not have excessively large values in order to avoid unrealistically large estimation errors under high transient operations. The number of uneven discretization steps in each electrode is set to eight, and the estimated lithium-ion concentration profiles are compared with the reference profiles predicted by the battery model evenly discretized in each electrode.</p>
<p>The model is expressed as</p>
<p>
<disp-formula id="disp-formula15-0954407011433535">
<label>(12)</label>
<mml:math display="block" id="math28-0954407011433535">
<mml:mrow>
<mml:mtable align="left" width="80%">
<mml:mtr>
<mml:mtd columnalign="left">
<mml:mrow>
<mml:mover>
<mml:mover>
<mml:mi mathvariant="bold-italic">x</mml:mi>
<mml:mo>^</mml:mo>
</mml:mover>
<mml:mo>·</mml:mo>
</mml:mover>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi mathvariant="bold">A</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>p</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">x</mml:mi>
</mml:mrow>
<mml:mo>^</mml:mo>
</mml:mover>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi mathvariant="bold">B</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>p</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mi mathvariant="bold-italic">u</mml:mi>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi mathvariant="bold">K</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>e</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi mathvariant="bold-italic">y</mml:mi>
<mml:mo>−</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">y</mml:mi>
</mml:mrow>
<mml:mo>^</mml:mo>
</mml:mover>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="left">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">y</mml:mi>
</mml:mrow>
<mml:mo>^</mml:mo>
</mml:mover>
<mml:mo>=</mml:mo>
<mml:mi>V</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">x</mml:mi>
</mml:mrow>
<mml:mo>^</mml:mo>
</mml:mover>
<mml:mo>,</mml:mo>
<mml:mi mathvariant="bold-italic">u</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula15-0954407011433535" xlink:href="10.1177_0954407011433535-eq15.tif"/>
</disp-formula>
</p>
<p>where <inline-formula id="inline-formula14-0954407011433535">
<mml:math display="inline" id="math29-0954407011433535">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">x</mml:mi>
</mml:mrow>
<mml:mo>^</mml:mo>
</mml:mover>
</mml:mrow>
</mml:math></inline-formula> and <inline-formula id="inline-formula15-0954407011433535">
<mml:math display="inline" id="math30-0954407011433535">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">y</mml:mi>
</mml:mrow>
<mml:mo>^</mml:mo>
</mml:mover>
</mml:mrow>
</mml:math></inline-formula> are the estimated state <bold><italic>x</italic></bold> and output <bold><italic>y</italic></bold>, the state vector is <inline-formula id="inline-formula16-0954407011433535">
<mml:math display="inline" id="math31-0954407011433535">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold-italic">x</mml:mi>
</mml:mrow>
<mml:mo>^</mml:mo>
</mml:mover>
</mml:mrow>
</mml:math></inline-formula> = <inline-formula id="inline-formula17-0954407011433535">
<mml:math display="inline" id="math32-0954407011433535">
<mml:mrow>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
<mml:mo>^</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>p</mml:mi>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>,</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
<mml:mo>^</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>p</mml:mi>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>,</mml:mo><mml:mo>…</mml:mo>
<mml:mo>,</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
<mml:mo>^</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>p</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>Mr</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:msub>
<mml:msup>
<mml:mrow>
<mml:mo stretchy="false">) </mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mtext>T</mml:mtext>
</mml:mrow>
</mml:msup>
</mml:mrow>
</mml:math></inline-formula>, and the output is <bold><italic>y</italic></bold> = <italic>V</italic>(<bold><italic>x</italic></bold>, <bold><italic>u</italic></bold>). The matrices <bold>A</bold><italic><sub>p</sub></italic> and <bold>B</bold><italic><sub>p</sub></italic> are obtained from <xref ref-type="disp-formula" rid="disp-formula9-0954407011433535">equation (8a)</xref> and <xref ref-type="disp-formula" rid="disp-formula10-0954407011433535">equation (8b)</xref> respectively. The nonlinear output is linearized by <italic>C<sub>i</sub></italic> = ∂<italic>V</italic>/∂<italic>x<sub>i</sub></italic>, which is a row matrix with zeros in its first <italic>Mr</italic>− 2 elements. The last non-zero term <italic>C<sub>Mr</sub></italic><sub>−1</sub> is numerically computed from <inline-formula id="inline-formula18-0954407011433535">
<mml:math display="inline" id="math33-0954407011433535">
<mml:mrow>
<mml:mo>∂</mml:mo>
<mml:mi>V</mml:mi>
<mml:mo stretchy="false">/</mml:mo>
<mml:mo>∂</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
<mml:mo>^</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>p</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>Mr</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula>, thus constructing <bold>C</bold> = (<italic>C</italic><sub>1</sub>, …, <italic>C<sub>Mr</sub></italic><sub>−1</sub>) in the EKF.</p>
<p>The Kalman gain is obtained from</p>
<p>
<disp-formula id="disp-formula16-0954407011433535">
<label>(13)</label>
<mml:math display="block" id="math34-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi mathvariant="bold">K</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>e</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mi mathvariant="bold">PC</mml:mi>
<mml:msup>
<mml:mrow>
<mml:mi mathvariant="bold">R</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula16-0954407011433535" xlink:href="10.1177_0954407011433535-eq16.tif"/>
</disp-formula>
</p>
<p>where <bold>P</bold> is the solution of the Ricatti equation</p>
<p>
<disp-formula id="disp-formula17-0954407011433535">
<label>(14)</label>
<mml:math display="block" id="math35-0954407011433535">
<mml:mrow>
<mml:mtable align="left" width="80%">
<mml:mtr>
<mml:mtd columnalign="left">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi mathvariant="bold">P</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi mathvariant="bold">A</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>p</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mi mathvariant="bold">P</mml:mi>
<mml:mo>+</mml:mo>
<mml:msubsup>
<mml:mrow>
<mml:mi mathvariant="bold">PA</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>p</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext mathvariant="bold">T</mml:mtext>
</mml:mrow>
</mml:msubsup>
<mml:mo>−</mml:mo>
<mml:mi mathvariant="bold">PC</mml:mi>
<mml:msup>
<mml:mrow>
<mml:mi mathvariant="bold">R</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
<mml:msup>
<mml:mrow>
<mml:mi mathvariant="bold">C</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mtext>T</mml:mtext>
</mml:mrow>
</mml:msup>
<mml:mi mathvariant="bold">P</mml:mi>
<mml:mo>+</mml:mo>
<mml:mi mathvariant="bold">Q</mml:mi>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="left">
<mml:mrow>
<mml:mi mathvariant="bold">P</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi mathvariant="bold">P</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula17-0954407011433535" xlink:href="10.1177_0954407011433535-eq17.tif"/>
</disp-formula>
</p>
<p>where <bold>Q</bold> and <bold>R</bold> are positive definite matrices to obtain small battery voltage prediction errors. While solving the Ricatti equation, the <bold>P</bold> matrix is reinitialized whenever the battery current direction is changed. <inline-formula id="inline-formula19-0954407011433535">
<mml:math display="inline" id="math36-0954407011433535">
<mml:mrow>
<mml:mo>∂</mml:mo>
<mml:mi>V</mml:mi>
<mml:mo stretchy="false">/</mml:mo>
<mml:mo>∂</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>p</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>Mr</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula> frequently has a large value under transient or pulsating charging and discharging conditions, thus resulting in abnormally large Kalman gains and causing large estimation errors. The ranges of <bold>P</bold> and <bold>K</bold><italic><sub>e</sub></italic> are limited to avoid high estimation errors in the lithium-ion concentration. The designed filter is capable of estimating the lithium-ion concentration with sufficient accuracy over the entire battery operating range.</p>
<p>The voltage outputs from the EKF and the reference battery model under a fast transient are shown in <xref ref-type="fig" rid="fig8-0954407011433535">Figure 8</xref>. The estimation results under severe transients (up to 30 C) are presented at both charging and discharging. The estimated lithium-ion concentration profiles are compared with the reference profiles under high discharging and charging conditions, and an accurate tracking performance is demonstrated. We note that a sudden discharging operation has a significant impact on the lithium-ion concentration profile near the solid boundary (see <xref ref-type="fig" rid="fig9-0954407011433535">Figure 9(a)</xref>), while the lithium-ion concentrations closer to the center remain almost constant. <xref ref-type="fig" rid="fig9-0954407011433535">Figure 9(b)</xref> shows that the concentration profile has multiple curvatures along the particle’s radius under sequential charging and discharging events or vice versa. The designed EKF can capture the overall patterns of the lithium-ion concentration profiles.</p>
<fig id="fig8-0954407011433535" position="float">
<label>Figure 8.</label>
<caption>
<p>Comparisons of the transient response of the terminal voltage predicted by the EKF and by the reference electrode-averaged battery model.</p>
</caption>
<graphic xlink:href="10.1177_0954407011433535-fig8.tif"/>
</fig>
<fig id="fig9-0954407011433535" position="float">
<label>Figure 9.</label>
<caption>
<p>Comparison of the lithium-ion concentrations at the cathode between the estimated profile and the reference profile under (a) discharging and (b) charging.</p>
</caption>
<graphic xlink:href="10.1177_0954407011433535-fig9.tif"/>
</fig>
</sec>
<sec id="section7-0954407011433535">
<title>Battery power management strategy</title>
<p>The proposed battery power management strategy adjusts the amount of the battery power utilizing the estimated lithium-ion concentration profile along the direction of the radius of the solid particle and the averaged lithium-ion concentration computed from the bulk SOC. When the estimated lithium-ion profile is apart from the averaged lithium-ion profile, the allowable battery power is also different from the reference allowable power determined for the averaged profile. Thus, the allowable battery power is directly affected by the lithium-ion concentration profile along the solid particle. The cost function <italic>J</italic> is defined to reflect the effect of the lithium-ion concentration profile on the allowable battery power limits as</p>
<p>
<disp-formula id="disp-formula18-0954407011433535">
<label>(15)</label>
<mml:math display="block" id="math37-0954407011433535">
<mml:mrow>
<mml:mi>J</mml:mi>
<mml:mo>=</mml:mo>
<mml:munderover>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>Mr</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:munderover>
<mml:msub>
<mml:mrow>
<mml:mi>w</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>i</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>bulk</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
<mml:mo>^</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>i</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula18-0954407011433535" xlink:href="10.1177_0954407011433535-eq18.tif"/>
</disp-formula>
</p>
<p>where <inline-formula id="inline-formula20-0954407011433535">
<mml:math display="inline" id="math38-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
<mml:mo>¯</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>bulk</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula> is the averaged lithium-ion concentration corresponding to the battery SOC calculated by coulomb counting, <inline-formula id="inline-formula21-0954407011433535">
<mml:math display="inline" id="math39-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
<mml:mo>^</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>i</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula> is the estimated lithium-ion concentration at the <italic>i</italic>th radial segment of the solid, and <italic>w<sub>i</sub></italic> is the weighting at the <italic>i</italic>th element. The lithium-ion concentration near the surface of the solid particle has more impact on the battery’s terminal voltage. Thus, the weighting vector <bold><italic>w</italic></bold> = (<inline-formula id="inline-formula22-0954407011433535">
<mml:math display="inline" id="math40-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>w</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula>,<inline-formula id="inline-formula23-0954407011433535">
<mml:math display="inline" id="math41-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>w</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula>, …, <inline-formula id="inline-formula24-0954407011433535">
<mml:math display="inline" id="math42-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>w</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>Mr</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula>) is tuned to reflect the impact by assigning a higher weight to the estimated lithium-ion concentration near the surface of the solid particle.</p>
<p>The adjusted allowable battery power limit is computed through the proportional–integral (PI) feedback of the cost function <italic>J</italic>, according to</p>
<p>
<disp-formula id="disp-formula19-0954407011433535">
<label>(16)</label>
<mml:math display="block" id="math43-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>P</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>batt</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>limit</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>adj</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>P</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>batt</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>limit</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>ref</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>K</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>P</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mi>J</mml:mi>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>K</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>I</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>∫</mml:mo>
<mml:mi>J</mml:mi>
<mml:mspace width="0.25em"/>
<mml:mi>dt</mml:mi>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula19-0954407011433535" xlink:href="10.1177_0954407011433535-eq19.tif"/>
</disp-formula>
</p>
<p>where <italic>P<sub>batt,limit,adj</sub></italic> is the adjusted battery power limit, <italic>P<sub>batt,limit,ref</sub></italic> is the battery power limit without consideration of the lithium-ion diffusion dynamics, <italic>K<sub>p</sub></italic> is the proportional control gain, and <italic>K<sub>I</sub></italic> is the integral control gain. The reference allowable battery power limit <italic>P<sub>batt,limit,ref</sub></italic> is a function of the SOC and the current of the battery. The gains are determined heuristically to maintain the terminal voltage of the battery within the safe operating range.</p>
</sec>
</sec>
<sec id="section8-0954407011433535" sec-type="results">
<title>Simulation results</title>
<p>The effectiveness of the proposed battery power management strategy is assessed through series HEV simulation under an aggressive military cycle (an urban assault cycle). The cycle includes frequent acceleration and deceleration events, as shown in <xref ref-type="fig" rid="fig10-0954407011433535">Figure 10</xref>. To assess the effect of the proposed strategy, simulations with and without the allowable battery power adjustment are executed with various battery sizes under the urban assault cycle.</p>
<fig id="fig10-0954407011433535" position="float">
<label>Figure 10.</label>
<caption>
<p>Urban assault driving cycle velocity profile.</p>
</caption>
<graphic xlink:href="10.1177_0954407011433535-fig10.tif"/>
</fig>
<p>
<xref ref-type="fig" rid="fig11-0954407011433535">Figure 11</xref> shows the effect of the battery size on the fuel economy with different battery management strategies. The fuel economy with a relatively large battery (13 kW h) is not affected by the battery control strategies. In contrast, the fuel economy becomes more sensitive with a smaller size of battery. With a 6 kW h battery, the fuel economy is reduced from 8.56 miles/gal to 8.10 miles/gal (5.3% reduction) under the proposed battery management strategy. The deterioration in the fuel economy is caused by more frequent engine interventions to prevent battery over-discharging by compensating the reduced battery power output in real time. A further battery size reduction to 5 kW h without real-time power limit adjustment results in severe voltage drops below the lower limit (2.7 V), and complete battery depletion will occur. The proposed strategy avoids excessive battery operation and manages the battery’s terminal voltage within the safe range (2.7–3.9 V) with a small battery.</p>
<fig id="fig11-0954407011433535" position="float">
<label>Figure 11.</label>
<caption>
<p>Fuel economy change with respect to the battery size and the battery power limit management strategy.</p>
</caption>
<graphic xlink:href="10.1177_0954407011433535-fig11.tif"/>
</fig>
<p>To illustrate the performance of the proposed control design, the simulation results with a 5 kW h battery are presented in <xref ref-type="fig" rid="fig12-0954407011433535">Figure 12</xref>. During sudden acceleration and deceleration events, the magnitudes of the power limits are significantly contracted by up to 80% (<xref ref-type="fig" rid="fig12-0954407011433535">Figure 12(a)</xref>). If the battery power demand is not constrained by the adjusted battery power limits, the battery will be over-discharged by the power demand that exceeds the battery’s discharging capability. The current inputs and voltage outputs of the battery are compared in <xref ref-type="fig" rid="fig12-0954407011433535">Figure 12(b)</xref> and <xref ref-type="fig" rid="fig12-0954407011433535">12(c)</xref>. Under aggressive driving, the proposed controller limits the instantaneous battery power. Consequently, the voltage range is kept within the safe operating range. Without adjustment of the battery power limit, the terminal voltage exceeds the upper bound (3.9 V) at around 47 s by excessive regenerative braking. Under severe acceleration events, the uncontrolled battery current inputs result in severe voltage drop below the lower bound (2.7 V) at 207 s. In contrast, the proposed strategy maintains battery operation within the safe voltage range.</p>
<fig id="fig12-0954407011433535" position="float">
<label>Figure 12.</label>
<caption>
<p>Comparisons of the battery responses under the baseline strategy and the proposed battery management strategy with the 5 kW h lithium-ion battery: (a) the battery power limits; (b) the battery current inputs; (c) the battery voltage outputs.</p>
</caption>
<graphic xlink:href="10.1177_0954407011433535-fig12.tif"/>
</fig>
<p>The impact of the battery size on the fuel economy with the proposed strategy is investigated by reviewing the battery and engine operation within the most aggressive section (400–800 s) of the cycle. Within the mild driving duration (400–550 s), the battery current shows no significant difference (in <xref ref-type="fig" rid="fig13-0954407011433535">Figure 13(a)</xref>) regardless of the battery size. In contrast, higher current extraction from the smaller battery is observed during aggressive operation (550–750 s in <xref ref-type="fig" rid="fig13-0954407011433535">Figure 13(a)</xref>), and it is caused by faster voltage drops with a smaller battery (in <xref ref-type="fig" rid="fig13-0954407011433535">Figure 13(b)</xref>). Nevertheless, the terminal voltage does not violate the lower limit because of adjustment of the allowable battery power. The resulting SOC trajectories are shown in <xref ref-type="fig" rid="fig14-0954407011433535">Figure 14(a)</xref>. The fluctuation amplitude of the smaller battery is larger than that of the larger battery, but the fluctuation is well regulated within the deadband. Engine operation is more frequent with a smaller battery, since the significantly reduced allowable battery power limits (see <xref ref-type="fig" rid="fig12-0954407011433535">Figure 12(a)</xref>) under aggressive driving require more power from the engine to compensate the reduced battery power output (see <xref ref-type="fig" rid="fig14-0954407011433535">Figure 14(b)</xref>). As results, the fuel economy becomes worse with a smaller battery while ensuring safe battery operation.</p>
<fig id="fig13-0954407011433535" position="float">
<label>Figure 13.</label>
<caption>
<p>Comparisons of the battery responses under the proposed battery management strategy with different battery sizes of 5 kW h and 9 kW h: (a) the battery current inputs; (b) the battery voltage outputs.</p>
</caption>
<graphic xlink:href="10.1177_0954407011433535-fig13.tif"/>
</fig>
<fig id="fig14-0954407011433535" position="float">
<label>Figure 14.</label>
<caption>
<p>Effect of the battery size on the controlled responses of the battery and the engine: (a) the battery SOC; (b) the engine power output.</p>
</caption>
<graphic xlink:href="10.1177_0954407011433535-fig14.tif"/>
</fig>
</sec>
<sec id="section9-0954407011433535" sec-type="conclusions">
<title>Conclusions</title>
<p>This paper proposes a model-based lithium-ion battery control strategy designed to prevent excessive battery charging and discharging using the estimated lithium-ion concentration profiles. The battery lithium-ion concentration profiles are estimated from the electrochemical model-driven EKF and used in the control design. The EKF is designed using the electrode-averaged electrochemistry model with uneven discretization of the radius of the solid electrode particle for fast and accurate prediction of the lithium intercalation dynamics. The allowable battery power limits are then adjusted through the PI feedback of the weighted average difference between the estimated lithium-ion concentration profile and the bulk lithium-ion concentration.</p>
<p>The proposed control strategy is implemented in the simulation of the hybridized heavy-duty series HEV. The simulation framework includes a finely discretized electrode-averaged lithium-ion battery model to capture the terminal voltage of the battery accurately. Although the electrode-averaged model tends to overestimate the lithium-ion diffusion dynamics under high current discharging and charging conditions, the overestimation will be beneficial for control design since it acts as an additional control margin. The proposed strategy successfully prevents over-charging and over-discharging under aggressive driving. Further battery size reduction is obtainable at the expense of the fuel economy. The conscious power management strategy of the lithium-ion diffusion dynamics provides more flexibility in determining the battery size with consideration of the fuel economy and the battery cost of series HEVs.</p>
</sec>
</body>
<back>
<app-group>
<app id="app1-0954407011433535">
<title>Appendix 1</title>
<sec id="section10-0954407011433535">
<title>Battery parameters</title>
<p>The battery parameters given by Smith and Wang<sup><xref ref-type="bibr" rid="bibr16-0954407011433535">16</xref></sup> are used for constructing the electrode-averaged lithium-ion battery model and are listed in <xref ref-type="table" rid="table2-0954407011433535">Table 2</xref>.</p>
<table-wrap id="table2-0954407011433535" position="float">
<label>Table 2.</label>
<caption>
<p>Battery parameters.<sup><xref ref-type="bibr" rid="bibr16-0954407011433535">16</xref></sup></p>
</caption>
<graphic alternate-form-of="table2-0954407011433535" xlink:href="10.1177_0954407011433535-table2.tif"/>
<table>
<colgroup>
<col align="left"/>
<col align="left"/>
<col align="left"/>
<col align="left"/>
</colgroup>
<thead>
<tr>
<th/>
<th align="left" colspan="3">Value for the following</th>
</tr>
<tr>
<th align="left">Parameter (units)</th>
<th align="left">Anode (n)</th>
<th align="left">Separator</th>
<th align="left">Cathode (p)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Thickness <inline-formula id="inline-formula25-0954407011433535">
<mml:math display="inline" id="math44-0954407011433535">
<mml:mrow>
<mml:mi>δ</mml:mi>
<mml:mspace width="0.25em"/>
</mml:mrow>
</mml:math></inline-formula>(cm)</td>
<td>50.0 × 10<sup>−4</sup></td>
<td>24.4 × 10<sup>−4</sup></td>
<td>36.4 × 10<sup>−4</sup></td>
</tr>
<tr>
<td>Particle radius <inline-formula id="inline-formula26-0954407011433535">
<mml:math display="inline" id="math45-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>R</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula>(cm)</td>
<td>1 × 10<sup>−4</sup></td>
<td>—</td>
<td>1 × 10<sup>−4</sup></td>
</tr>
<tr>
<td>Active material volume fraction <inline-formula id="inline-formula27-0954407011433535">
<mml:math display="inline" id="math46-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>ε</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula></td>
<td>0.580</td>
<td>—</td>
<td>0.500</td>
</tr>
<tr>
<td>Electrolyte-phase volume fraction <inline-formula id="inline-formula28-0954407011433535">
<mml:math display="inline" id="math47-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>ε</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>e</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula></td>
<td>0.332</td>
<td>0.5</td>
<td>0.330</td>
</tr>
<tr>
<td>Active surface area <inline-formula id="inline-formula29-0954407011433535">
<mml:math display="inline" id="math48-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>a</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula> per electrode unit volume (cm<sup>−1</sup>)</td>
<td colspan="3">
<inline-formula id="inline-formula30-0954407011433535">
<mml:math display="inline" id="math49-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>a</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mn>3</mml:mn>
<mml:msub>
<mml:mrow>
<mml:mi>ε</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">/</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>R</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</inline-formula>
</td>
</tr>
<tr>
<td>Solid-phase conductivity <inline-formula id="inline-formula31-0954407011433535">
<mml:math display="inline" id="math50-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>σ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula>(S/cm)</td>
<td>1</td>
<td>—</td>
<td>0.1</td>
</tr>
<tr>
<td>Effective solid-phase conductivity <inline-formula id="inline-formula32-0954407011433535">
<mml:math display="inline" id="math51-0954407011433535">
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mi>σ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>eff</mml:mi>
</mml:mrow>
</mml:msup>
</mml:mrow>
</mml:math></inline-formula> (S/cm)</td>
<td colspan="3">
<inline-formula id="inline-formula33-0954407011433535">
<mml:math display="inline" id="math52-0954407011433535">
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mi>σ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>eff</mml:mi>
</mml:mrow>
</mml:msup>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>ε</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mi>σ</mml:mi>
</mml:mrow>
</mml:math>
</inline-formula>
</td>
</tr>
<tr>
<td>Electrolyte-phase conductivity <italic>κ</italic> (S/cm)</td>
<td colspan="3">
<inline-formula id="inline-formula34-0954407011433535">
<mml:math display="inline" id="math53-0954407011433535">
<mml:mrow>
<mml:mi>κ</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>15</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>8</mml:mn>
<mml:msub>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>e</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mi>exp</mml:mi>
<mml:mo stretchy="false">[</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>85</mml:mn>
<mml:mo stretchy="false">(</mml:mo>
<mml:mn>1000</mml:mn>
<mml:msub>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>e</mml:mi>
</mml:mrow>
</mml:msub>
<mml:msup>
<mml:mrow>
<mml:mo stretchy="false">) </mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>4</mml:mn>
</mml:mrow>
</mml:msup>
<mml:mo stretchy="false">]</mml:mo>
</mml:mrow>
</mml:math>
</inline-formula>
</td>
</tr>
<tr>
<td>Effective electrolyte-phase conductivity <inline-formula id="inline-formula35-0954407011433535">
<mml:math display="inline" id="math54-0954407011433535">
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mi>κ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>eff</mml:mi>
</mml:mrow>
</mml:msup>
</mml:mrow>
</mml:math></inline-formula>(S/cm)</td>
<td colspan="3">
<inline-formula id="inline-formula36-0954407011433535">
<mml:math display="inline" id="math55-0954407011433535">
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mi>κ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>eff</mml:mi>
</mml:mrow>
</mml:msup>
<mml:mo>=</mml:mo>
<mml:msubsup>
<mml:mrow>
<mml:mi>ε</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>e</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>5</mml:mn>
</mml:mrow>
</mml:msubsup>
<mml:mi>κ</mml:mi>
</mml:mrow>
</mml:math>
</inline-formula>
</td>
</tr>
<tr>
<td>Solid-phase lithium diffusion coefficient <inline-formula id="inline-formula37-0954407011433535">
<mml:math display="inline" id="math56-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>D</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula>(cm<sup>2</sup> /s)</td>
<td>2.0 × 10<sup>−12</sup></td>
<td>—</td>
<td>3.7 × 10<sup>−12</sup></td>
</tr>
<tr>
<td>Electrolyte-phase lithium diffusion coefficient <inline-formula id="inline-formula38-0954407011433535">
<mml:math display="inline" id="math57-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>D</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>e</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula> (cm<sup>2</sup>/s)</td>
<td>2.6 × 10<sup>−6</sup></td>
<td>2.6 × 10<sup>−6</sup></td>
<td>2.6 × 10<sup>−6</sup></td>
</tr>
<tr>
<td>Charge transfer coefficients <inline-formula id="inline-formula39-0954407011433535">
<mml:math display="inline" id="math58-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>α</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>a</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula>, <inline-formula id="inline-formula40-0954407011433535">
<mml:math display="inline" id="math59-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>α</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula></td>
<td>0.5, 0.5</td>
<td>—</td>
<td>0.5, 0.5</td>
</tr>
<tr>
<td>Maximum solid-phase concentration <inline-formula id="inline-formula41-0954407011433535">
<mml:math display="inline" id="math60-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
<mml:mo>,</mml:mo>
<mml:mo>max</mml:mo>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula> (mol/cm<sup>3</sup>)</td>
<td>16.1 × 10<sup>−3</sup></td>
<td>—</td>
<td>23.9 × 10<sup>−3</sup></td>
</tr>
<tr>
<td>Stoichiometry <inline-formula id="inline-formula42-0954407011433535">
<mml:math display="inline" id="math61-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>θ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
<mml:mi>%</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula> at 0%</td>
<td>0.126</td>
<td>—</td>
<td>0.936</td>
</tr>
<tr>
<td>Stoichiometry <inline-formula id="inline-formula43-0954407011433535">
<mml:math display="inline" id="math62-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>θ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>100</mml:mn>
<mml:mi>%</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula> at 100%</td>
<td>0.676</td>
<td>—</td>
<td>0.442</td>
</tr>
<tr>
<td>Average electrolyte concentration <inline-formula id="inline-formula44-0954407011433535">
<mml:math display="inline" id="math63-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>c</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>e</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula> (mol/cm<sup>3</sup>)</td>
<td>1.2 × 10<sup>−3</sup></td>
<td>1.2 × 10<sup>−3</sup></td>
<td>1.2 × 10<sup>−3</sup></td>
</tr>
<tr>
<td>Exchange current density <inline-formula id="inline-formula45-0954407011433535">
<mml:math display="inline" id="math64-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>j</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula>(A/cm<sup>2</sup>)</td>
<td>3.6 × 10<sup>−3</sup></td>
<td>—</td>
<td>2.6 × 10<sup>−3</sup></td>
</tr>
<tr>
<td>Electrode plate area <italic>A</italic> (cm<sup>2</sup>)</td>
<td colspan="3">10,452</td>
</tr>
<tr>
<td>Film resistance <italic>R<sub>f</sub></italic> (Ω cm<sup>2</sup>)</td>
<td colspan="3">20</td>
</tr>
<tr>
<td>Universal gas constant <italic>R</italic> (J/mol K)</td>
<td colspan="3">8.3144</td>
</tr>
<tr>
<td>Faraday constant <italic>F</italic> (C/mol)</td>
<td colspan="3">96,485</td>
</tr>
<tr>
<td>Open-circuit voltage <italic>U<sub>n</sub></italic> for the anode (V)</td>
<td colspan="3">
<inline-formula id="inline-formula46-0954407011433535">
<mml:math display="inline" id="math65-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>U</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>n</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mi>θ</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>=</mml:mo>
<mml:mn>8</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>002</mml:mn>
<mml:mspace width="0.25em"/>
<mml:mn>29</mml:mn>
<mml:mo>+</mml:mo>
<mml:mn>5</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>0647</mml:mn>
<mml:mi>θ</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>12</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>578</mml:mn>
<mml:msup>
<mml:mrow>
<mml:mi>θ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>5</mml:mn>
</mml:mrow>
</mml:msup>
<mml:mo>−</mml:mo>
<mml:mn>8</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>6322</mml:mn>
<mml:mo>×</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mn>10</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mo>−</mml:mo>
<mml:mn>4</mml:mn>
</mml:mrow>
</mml:msup>
<mml:msup>
<mml:mrow>
<mml:mi>θ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
<mml:mo>+</mml:mo>
<mml:mn>2</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>1765</mml:mn>
<mml:mo>×</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mn>10</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mo>−</mml:mo>
<mml:mn>5</mml:mn>
</mml:mrow>
</mml:msup>
<mml:msup>
<mml:mrow>
<mml:mi>θ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>5</mml:mn>
</mml:mrow>
</mml:msup>
<mml:mo>−</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>460</mml:mn>
<mml:mspace width="0.25em"/>
<mml:mn>16</mml:mn>
<mml:mi>exp</mml:mi>
<mml:mrow>
<mml:mo>[</mml:mo>
<mml:mn>15</mml:mn>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>06</mml:mn>
<mml:mo>−</mml:mo>
<mml:mi>θ</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>]</mml:mo>
</mml:mrow>
<mml:mo>−</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>553</mml:mn>
<mml:mspace width="0.75em"/>
<mml:mn>64</mml:mn>
<mml:mi>exp</mml:mi>
<mml:mrow>
<mml:mo>[</mml:mo>
<mml:mo>−</mml:mo>
<mml:mn>2</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>4326</mml:mn>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mi>θ</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>92</mml:mn>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>]</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
</inline-formula>
</td>
</tr>
<tr>
<td>Open-circuit voltage <italic>U<sub>p</sub></italic> (for the cathode V)</td>
<td colspan="3">
<inline-formula id="inline-formula47-0954407011433535">
<mml:math display="inline" id="math66-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>U</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>p</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mi>θ</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>=</mml:mo>
<mml:mn>85</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>681</mml:mn>
<mml:msup>
<mml:mrow>
<mml:mi>θ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>6</mml:mn>
</mml:mrow>
</mml:msup>
<mml:mo>−</mml:mo>
<mml:mn>357</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>70</mml:mn>
<mml:msup>
<mml:mrow>
<mml:mi>θ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>5</mml:mn>
</mml:mrow>
</mml:msup>
<mml:mo>+</mml:mo>
<mml:mn>613</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>89</mml:mn>
<mml:msup>
<mml:mrow>
<mml:mi>θ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>4</mml:mn>
</mml:mrow>
</mml:msup>
<mml:mo>−</mml:mo>
<mml:mn>555</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>65</mml:mn>
<mml:msup>
<mml:mrow>
<mml:mi>θ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>3</mml:mn>
</mml:mrow>
</mml:msup>
<mml:mo>+</mml:mo>
<mml:mn>281</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>06</mml:mn>
<mml:msup>
<mml:mrow>
<mml:mi>θ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msup>
<mml:mo>−</mml:mo>
<mml:mn>76</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>648</mml:mn>
<mml:mi>θ</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>309</mml:mn>
<mml:mspace width="0.25em"/>
<mml:mn>87</mml:mn>
<mml:mi>exp</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mn>5</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>657</mml:mn>
<mml:msup>
<mml:mrow>
<mml:mi>θ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>115</mml:mn>
</mml:mrow>
</mml:msup>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
</inline-formula>
</td>
</tr>
</tbody>
</table>
</table-wrap>
</sec>
</app>
<app id="app2-0954407011433535">
<title>Appendix 2</title>
<sec id="section11-0954407011433535">
<title>Series HEV simulation modeling</title>
<p>A series HEV is modeled with the balance of computational efficiency and accuracy for control design. The engine and the motor models are map-based models with the assumption that their dynamics are much faster than vehicle dynamics. In contrast, the battery model is constructed to reflect nonlinear lithium-ion diffusion dynamics as shown in the third section. The battery model can estimate the lithium-ion concentration profile along the radius of the solid electrode particle for the proposed battery management strategy.</p>
<p>The vehicle simulation is forward looking, as the driver determines the control commands to follow the desired velocity profiles. The supervisory controller distributes the propulsion and braking power to the engine and the motor respectively. The component sizes were determined to satisfy the performance targets: maximum speed, gradeability, and acceleration. The overall vehicle longitudinal dynamics are expressed with consideration of the propulsion power, rolling resistance, drag, and grade terms according to</p>
<p>
<disp-formula id="disp-formula20-0954407011433535">
<label>(17)</label>
<mml:math display="block" id="math67-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>e</mml:mi>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>v</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>veh</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>F</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>prop</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>F</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>RR</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>F</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>WR</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>F</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>GR</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula20-0954407011433535" xlink:href="10.1177_0954407011433535-eq20.tif"/>
</disp-formula>
</p>
<p>where <italic>F<sub>prop</sub></italic> is the propulsion force from the powertrain, <italic>F<sub>RR</sub></italic> is the rolling resistance force, <italic>F<sub>WR</sub></italic> is the wind resistance force, <italic>F<sub>GR</sub></italic> is the grade resistance force and all other external forces applied to the vehicle, <italic>m<sub>e</sub></italic> is the equivalent mass of the vehicle, and <italic>v<sub>veh</sub></italic> is the velocity of the vehicle.</p>
<sec id="section12-0954407011433535">
<title>Engine</title>
<p>A map-based engine model is used to reduce the computation time. Engine operating points are controlled to follow the best BSFC line at a given power demand. When the engine power demand <italic>P<sub>eng</sub></italic> is given, the engine speed <inline-formula id="inline-formula48-0954407011433535">
<mml:math display="inline" id="math68-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>ω</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>e</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula> and the engine torque <inline-formula id="inline-formula49-0954407011433535">
<mml:math display="inline" id="math69-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>e</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula> are determined by <italic>T<sub>e</sub></italic> = <italic>P<sub>eng</sub></italic>/ω<italic><sub>e</sub></italic>. To realize feedforward control of the engine, the amount of fuel to produce the engine torque is determined by inverting the torque function <inline-formula id="inline-formula50-0954407011433535">
<mml:math display="inline" id="math70-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>e</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>f</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>eng</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>ω</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>e</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>,</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>f</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math></inline-formula> and is expressed as a function of the engine speed and the engine torque according to</p>
<p>
<disp-formula id="disp-formula21-0954407011433535">
<label>(18)</label>
<mml:math display="block" id="math71-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>m</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>f</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:msup>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>f</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>eng</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>ω</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>e</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>,</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>e</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>f</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>eng</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>fuel</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>ω</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>e</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>,</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>e</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula21-0954407011433535" xlink:href="10.1177_0954407011433535-eq21.tif"/>
</disp-formula>
</p>
<p>The total fuel consumption is calculated by integrating the fuel consumption rate over the entire driving cycle. The engine speed is calculated on the basis of</p>
<p>
<disp-formula id="disp-formula22-0954407011433535">
<label>(19)</label>
<mml:math display="block" id="math72-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>ω</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>e</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>eng</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>gen</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>J</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>eff</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>eng</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula22-0954407011433535" xlink:href="10.1177_0954407011433535-eq22.tif"/>
</disp-formula>
</p>
<p>where <italic>T<sub>gen</sub></italic> is the generator torque and <italic>J<sub>eff,eng</sub></italic> is the combined effective rotational inertia of the engine and the generator.</p>
</sec>
<sec id="section13-0954407011433535">
<title>Electric motor–generator</title>
<p>The electric motor and generator are represented by map-based models, since the motor torque dynamics are much faster than the vehicle dynamics. The efficiency of electric machines is a function of the operating speed ω<italic><sub>elec</sub></italic> and the torque <italic>T<sub>elec</sub></italic> (or the power <italic>P<sub>elec</sub></italic>). In the simulation work, quasi-steady state nonlinear efficiency maps are used to compute the output power expressed as</p>
<p>
<disp-formula id="disp-formula23-0954407011433535">
<label>(20a)</label>
<mml:math display="block" id="math73-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>P</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>mech</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>P</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>elec</mml:mi>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mrow>
<mml:mi>η</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>em</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.50em"/>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mtext>discharging</mml:mtext>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula23-0954407011433535" xlink:href="10.1177_0954407011433535-eq23.tif"/>
</disp-formula>
</p>
<p>
<disp-formula id="disp-formula24-0954407011433535">
<label>(20b)</label>
<mml:math display="block" id="math74-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>P</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>elec</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>P</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>mech</mml:mi>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mrow>
<mml:mi>η</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>em</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.50em"/>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mtext>charging</mml:mtext>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula24-0954407011433535" xlink:href="10.1177_0954407011433535-eq24.tif"/>
</disp-formula>
</p>
<p>where <inline-formula id="inline-formula51-0954407011433535">
<mml:math display="inline" id="math75-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>η</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>em</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>η</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>em</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>ω</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>elec</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>,</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>elec</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math></inline-formula> or <inline-formula id="inline-formula52-0954407011433535">
<mml:math display="inline" id="math76-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>η</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>em</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>η</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>em</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>ω</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>elec</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>,</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>P</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>elec</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math></inline-formula> is the electric motor efficiency, and the motor torque is expressed by <inline-formula id="inline-formula53-0954407011433535">
<mml:math display="inline" id="math77-0954407011433535">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>mot</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>P</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>mot</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">/</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>ω</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>mot</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math></inline-formula>.</p>
</sec>
</sec>
</app>
</app-group>
<ack>
<p>The authors are grateful to Youngki Kim of the University of Michigan for his support in preparing the simulation model. The authors also acknowledge Anna Stefanopoulou of the University of Michigan for valuable discussions.</p>
</ack>
<fn-group>
<fn fn-type="financial-disclosure">
<label>Funding</label>
<p>This work was partially supported by the Automotive Research Center, a US Army center of excellence in modeling and simulation of ground vehicles (grant no. W56HZV-04-2-0001).</p>
</fn>
</fn-group>
<ref-list>
<title>References</title>
<ref id="bibr1-0954407011433535">
<label>1.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Carns</surname><given-names>MPC</given-names></name>
<name><surname>Schlesinger</surname><given-names>J</given-names></name>
</person-group>. <article-title>Final Report of the Defense Science Board Task Force on DoD Energy Strategy, Memorandum for the Chairman, Defense Science Board, Washington, DC</article-title>, <day>14</day> <month>January</month> <year>2008</year>, pp. <fpage>3</fpage>–<lpage>5</lpage>.</citation>
</ref>
<ref id="bibr2-0954407011433535">
<label>2.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Karden</surname><given-names>E</given-names></name>
<name><surname>Ploumen</surname><given-names>S</given-names></name>
<name><surname>Fricke</surname><given-names>B</given-names></name><etal/>
</person-group>. <article-title>Energy storage devices for future hybrid electric vehicles</article-title>. <source>J Power Sources</source> <year>2007</year>; <volume>168</volume>: <fpage>2</fpage>–<lpage>11</lpage>.</citation>
</ref>
<ref id="bibr3-0954407011433535">
<label>3.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Lin</surname><given-names>C-C</given-names></name>
<name><surname>Peng</surname><given-names>H</given-names></name>
<name><surname>Grizzle</surname><given-names>JW</given-names></name>
<name><surname>Kang</surname><given-names>J-M</given-names></name>
</person-group>. <article-title>Power management strategy for a parallel hybrid electric truck</article-title>. <source>IEEE Trans Control Systems Technol</source> <year>2003</year>; <volume>11</volume>(<issue>6</issue>): <fpage>830</fpage>–<lpage>849</lpage>.</citation>
</ref>
<ref id="bibr4-0954407011433535">
<label>4.</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Lin</surname><given-names>C-C</given-names></name>
<name><surname>Peng</surname><given-names>H</given-names></name>
<name><surname>Grizzle</surname><given-names>JW</given-names></name>
</person-group>. <article-title>A stochastic control strategy for hybrid electric vehicles</article-title>. In: <conf-name>American control conference</conf-name>, <conf-loc>Boston, MA, USA</conf-loc>, <year>2004</year>, pp. <fpage>4710</fpage>–<lpage>4715</lpage>. <publisher-loc>New York</publisher-loc>: <publisher-name>IEEE</publisher-name>.</citation>
</ref>
<ref id="bibr5-0954407011433535">
<label>5.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Sciarretta</surname><given-names>A</given-names></name>
<name><surname>Back</surname><given-names>M</given-names></name>
<name><surname>Guzzella</surname><given-names>L</given-names></name>
</person-group>. <article-title>Optimal control of parallel hybrid electric vehicles</article-title>. <source>IEEE Trans Control Systems Technol</source> <year>2004</year>; <volume>12</volume>(<issue>3</issue>): <fpage>352</fpage>–<lpage>363</lpage>.</citation>
</ref>
<ref id="bibr6-0954407011433535">
<label>6.</label>
<citation citation-type="other">
<person-group person-group-type="author">
<name><surname>Sharer</surname><given-names>P</given-names></name>
<name><surname>Rousseau</surname><given-names>A</given-names></name>
<name><surname>Pagerit</surname><given-names>S</given-names></name>
<name><surname>Nelson</surname><given-names>P</given-names></name>
</person-group>. <article-title>Midsize and SUV vehicle results for plug-in HEV component requirements</article-title>. <comment>SAE paper 2007-01-0295</comment>, <year>2007</year>.</citation>
</ref>
<ref id="bibr7-0954407011433535">
<label>7.</label>
<citation citation-type="other">
<person-group person-group-type="author">
<name><surname>Patil</surname><given-names>R</given-names></name>
<name><surname>Adornato</surname><given-names>B</given-names></name>
<name><surname>Filipi</surname><given-names>Z</given-names></name>
</person-group>. <article-title>Impact of naturalistic driving patterns on PHEV performance and system design</article-title>. <comment>SAE paper 2009-01-2715</comment>, <year>2009</year>.</citation>
</ref>
<ref id="bibr8-0954407011433535">
<label>8.</label>
<citation citation-type="other">
<person-group person-group-type="author">
<name><surname>Patil</surname><given-names>R</given-names></name>
<name><surname>Adornato</surname><given-names>B</given-names></name>
<name><surname>Filipi</surname><given-names>Z</given-names></name>
</person-group>. <article-title>Design optimizaion of a series plug-in hybrid electric vehicle for real-world driving conditions</article-title>. <comment>SAE paper 2010-01-0840</comment>, <year>2010</year>.</citation>
</ref>
<ref id="bibr9-0954407011433535">
<label>9.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Doyle</surname><given-names>M</given-names></name>
<name><surname>Fuller</surname><given-names>T</given-names></name>
<name><surname>Newman</surname><given-names>J</given-names></name>
</person-group>. <article-title>Modeling of galvanostatic charge and discharge of the lithium/polymer/insertion cell</article-title>. <source>J Electrochem Soc</source> <year>1993</year>; <volume>140</volume>: <fpage>1526</fpage>–<lpage>1533</lpage>.</citation>
</ref>
<ref id="bibr10-0954407011433535">
<label>10.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Fuller</surname><given-names>TF</given-names></name>
<name><surname>Doyle</surname><given-names>M</given-names></name>
<name><surname>Newman</surname><given-names>J</given-names></name>
</person-group>. <article-title>Simulation and optimization of the dual lithium ion insertion cell</article-title>. <source>J Electrochem Soc</source> <year>1994</year>; <volume>141</volume>(<issue>1</issue>): <fpage>1</fpage>–<lpage>10</lpage>.</citation>
</ref>
<ref id="bibr11-0954407011433535">
<label>11.</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Gu</surname><given-names>WB</given-names></name>
<name><surname>Wang</surname><given-names>CY</given-names></name>
</person-group>. <article-title>Thermal and electrochemical coupled modeling of a lithium-ion cell</article-title>. In: <conf-name>196th meeting of The Electrochemical Society</conf-name>, <conf-loc>Honolulu, HI, USA</conf-loc>, <conf-date>17–22 October 1999</conf-date>, <comment>ECS Proceedings</comment>, <volume>vol 99-25</volume>(<issue>1</issue>), pp. <fpage>748</fpage>–<lpage>762</lpage>. <publisher-loc>Pennington, NJ</publisher-loc>: <publisher-name>Electrochemical Society</publisher-name>.</citation>
</ref>
<ref id="bibr12-0954407011433535">
<label>12.</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Di Domenico</surname><given-names>D</given-names></name>
<name><surname>Fiengo</surname><given-names>G</given-names></name>
<name><surname>Stefanopoulou</surname><given-names>A</given-names></name>
</person-group>. <article-title>Lithium-ion battery state of charge estimation with a Kalman filter based on a electrochemical model</article-title>. In: <conf-name>17th IEEE conference on control applications</conf-name>, <conf-loc>San Antonio, TX, USA</conf-loc>, <conf-date>3–5 September 2008</conf-date>, <volume>vol 1</volume>, pp.<fpage>702</fpage>–<lpage>707</lpage>. <publisher-loc>New York</publisher-loc>: <publisher-name>IEEE</publisher-name>.</citation>
</ref>
<ref id="bibr13-0954407011433535">
<label>13.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Di Domenico</surname><given-names>D</given-names></name>
<name><surname>Stefanopoulou</surname><given-names>A</given-names></name>
<name><surname>Fiengo</surname><given-names>G</given-names></name>
</person-group>. <article-title>Reduced order lithium-ion battery electrochemical model and extended Kalman filter state of charge estimation</article-title>. <source>Trans ASME, J Dynamic Systems, Measmt Control</source> <year>2010</year>; <volume>132</volume>(<issue>6</issue>): <fpage>061302</fpage>.</citation>
</ref>
<ref id="bibr14-0954407011433535">
<label>14.</label>
<citation citation-type="other">
<person-group person-group-type="author">
<name><surname>Smith</surname><given-names>K</given-names></name>
<name><surname>Wang</surname><given-names>C-Y</given-names></name>
</person-group>. <article-title>Pulse discharge power availability of a lithium-ion hybrid vehicle battery pack</article-title>. <comment>SAE paper 2005-01-3464</comment>, <year>2005</year>.</citation>
</ref>
<ref id="bibr15-0954407011433535">
<label>15.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Filipi</surname><given-names>Z</given-names></name>
<name><surname>Kim</surname><given-names>YJ</given-names></name>
</person-group>. <article-title>Hydraulic hybrid propulsion for heavy vehicles: combining the simulation and engine-in-the-loop techniques to maximize the fuel economy and emission benefits</article-title>. <source>Oil Gas Sci Technol</source> <year>2009</year>; <volume>65</volume>(<issue>1</issue>): <fpage>155</fpage>–<lpage>178</lpage>.</citation>
</ref>
<ref id="bibr16-0954407011433535">
<label>16.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Smith</surname><given-names>K</given-names></name>
<name><surname>Wang</surname><given-names>C-Y</given-names></name>
</person-group>. <article-title>Solid state diffusion limitations on pulse operation of a lithium ion cell for hybrid electric vehicles</article-title>. <source>J Power Sources</source> <year>2006</year>; <volume>161</volume>: <fpage>628</fpage>–<lpage>639</lpage>.</citation>
</ref>
</ref-list>
</back>
</article>