<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v2.3 20070202//EN" "journalpublishing.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">PID</journal-id>
<journal-id journal-id-type="hwp">sppid</journal-id>
<journal-title>Proceedings of the Institution of Mechanical Engineers, Part D: Journal of Automobile Engineering</journal-title>
<issn pub-type="ppub">0954-4070</issn>
<issn pub-type="epub">2041-2991</issn>
<publisher>
<publisher-name>SAGE Publications</publisher-name>
<publisher-loc>Sage UK: London, England</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1177/0954407012438304</article-id>
<article-id pub-id-type="publisher-id">10.1177_0954407012438304</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Original Articles</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Sufficient conditions of optimal control based on Pontryagin’s minimum principle for use in hybrid electric vehicles</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<name><surname>Kim</surname><given-names>Namwook</given-names></name>
</contrib>
<contrib contrib-type="author">
<name><surname>Rousseau</surname><given-names>Aymeric</given-names></name>
</contrib>
<aff id="aff1-0954407012438304">Argonne National Laboratory, Argonne, IL, USA</aff>
</contrib-group>
<author-notes>
<corresp id="corresp1-0954407012438304">Namwook Kim, Argonne National Laboratory, 9700 S. Cass Avenue, Argonne, IL 60439, USA. Email: <email>nakim@anl.gov</email></corresp>
</author-notes>
<pub-date pub-type="epub-ppub">
<month>9</month>
<year>2012</year>
</pub-date>
<volume>226</volume>
<issue>9</issue>
<fpage>1160</fpage>
<lpage>1170</lpage>
<history>
<date date-type="received">
<day>7</day>
<month>6</month>
<year>2011</year>
</date>
<date date-type="accepted">
<day>12</day>
<month>1</month>
<year>2012</year>
</date>
</history>
<permissions>
<copyright-statement>© Argonne, LLC, Operator of Argonne National Laboratory 2012</copyright-statement>
<copyright-year>2012</copyright-year>
<copyright-holder content-type="society">Institution of Mechanical Engineers</copyright-holder>
</permissions>
<abstract>
<p>Over 10 years ago, the equivalent consumption minimization strategy was introduced as an effective approach, using the concept of equivalent fuel consumption for electricity use, to solve a control problem for hybrid electric vehicles. Although numerous studies have documented outstanding results as a consequence of applying the concept and have shown that the equivalent consumption minimization strategy could be explained on the basis of an optimal control concept such as Pontryagin’s minimum principle, few studies have proven, mathematically, its optimal performance when solving the control problem of hybrid electric vehicles. The present research builds upon previous research studies that proved that the control based on Pontryagin’s minimum principle can be a global optimal solution for hybrid electric vehicles under the assumption that the battery efficiency is not a function of the state of charge. In this paper, we expand upon the original concept, deriving the optimality within more generalized cases than previously reported. In conclusion, if the battery efficiency is a concave function of the state of charge, which is possibly a natural characteristic of the battery, the optimal control based on Pontryagin’s minimum principle enables optimal performance to be achieved. We can therefore apply this control concept to hybrid electric vehicles which use a wide range of states of charge, such as plug-in hybrid electric vehicles.</p>
</abstract>
<kwd-group>
<kwd>Hybrid electric vehicles</kwd>
<kwd>optimal control</kwd>
<kwd>sufficient condition</kwd>
<kwd>Pontryagin’s minimum principle</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="section1-0954407012438304" sec-type="intro">
<title>Introduction</title>
<p>In contrast with a conventional vehicle that has only a fuel tank, hybrid electric vehicles (HEVs)<sup><xref ref-type="bibr" rid="bibr1-0954407012438304">1</xref><xref ref-type="bibr" rid="bibr2-0954407012438304"/>–<xref ref-type="bibr" rid="bibr3-0954407012438304">3</xref></sup> need an intelligent and sophisticated control strategy because the hybridization of multiple energy resources requires an increase in the complexity of control schemes. As in conventional vehicles, controllers aim to keep the system operating efficiently to save fuel, but, additionally, the hybrid controller needs to incorporate optimal energy management among multiple energy resources.<sup><xref ref-type="bibr" rid="bibr4-0954407012438304">4</xref><xref ref-type="bibr" rid="bibr5-0954407012438304"/><xref ref-type="bibr" rid="bibr6-0954407012438304"/>–<xref ref-type="bibr" rid="bibr7-0954407012438304">7</xref></sup> In this paper, we mathematically prove that a control concept based on Pontryagin’s minimum principle (PMP)<sup><xref ref-type="bibr" rid="bibr8-0954407012438304">8</xref><xref ref-type="bibr" rid="bibr9-0954407012438304"/>–<xref ref-type="bibr" rid="bibr10-0954407012438304">10</xref></sup> could be a promising solution that achieves optimal results and is very feasible in real-world applications.</p>
<p>A number of studies on energy management strategies for HEVs have been published in the last two decades. Early studies primarily used heuristic concepts to sustain the battery’s state of charge (SOC) while the engine was primarily controlled for optimal operation. In later studies, advanced ideas adopting optimal control theories, such as dynamic programming (DP) or PMP, were introduced for solving the energy management problem. Control based on heuristic concepts could be easily applied to the real world, but such concepts for control possibly include obscure decision processes and would not guarantee the optimal solution. On the other hand, it has not been considered feasible to apply control concepts based on optimal control theories in a real-time implementation.<sup><xref ref-type="bibr" rid="bibr5-0954407012438304">5</xref>,<xref ref-type="bibr" rid="bibr7-0954407012438304">7</xref></sup> Several recent studies, however, showed that PMP could be considered to be an effective energy management strategy not only for achieving optimal fuel savings but also for widespread global application. Further, as a realization of PMP, application of the equivalent consumption minimization strategy (ECMS)<sup><xref ref-type="bibr" rid="bibr1-0954407012438304">1</xref><xref ref-type="bibr" rid="bibr2-0954407012438304"/>–<xref ref-type="bibr" rid="bibr3-0954407012438304">3</xref></sup> has yielded excellent, nearly optimal results.<sup><xref ref-type="bibr" rid="bibr7-0954407012438304">7</xref>,<xref ref-type="bibr" rid="bibr9-0954407012438304">9</xref></sup> The present work builds on the study that demonstrated the optimal performance of PMP-based control;<sup><xref ref-type="bibr" rid="bibr10-0954407012438304">10</xref></sup> in that study, the battery efficiency was assumed to be constant, which means that the resistance and the open-circuit voltage are not functions of the SOC, but constants. Although this assumption is very reasonable when using a small range of SOCs, it is not sufficient to extend the idea to other control problems, such as control for plug-in hybrid electric vehicles (PHEVs), because they use a wider range of SOCs than HEVs do, and so the co-state of the control idea is no longer a constant. As one step forward, we show that the optimal performance of PMP, especially for the global optimality, can be explained in terms of the battery characteristics rather than the constant efficiency; therefore, the control idea is available for a wide range of SOCs such as those used by PHEVs. We believe that our study will benefit researchers by providing a mathematical foundation for applying the control concept to both HEVs and PHEVs.</p>
</sec>
<sec id="section2-0954407012438304">
<title>Optimal control for HEVs</title>
<p>In HEVs, applying optimal control in real-time vehicles is necessary not only for improving performance but also for optimizing system parameters, such as the engine size, the motor size, and the gear ratio. For example, optimization of the engine size can be accomplished by comparing the best performance demonstrated by each system when operating under different engine sizes; therefore, optimal control to obtain the best performance is a prerequisite for parametric optimization.<sup><xref ref-type="bibr" rid="bibr11-0954407012438304">11</xref></sup> On the other hand, although applying optimal control can yield the best performance, the control concept would not be a good approach if it were not available in the real world. Therefore, the ideal control concept must meet two conditions: optimality and feasibility.</p>
<sec id="section3-0954407012438304">
<title>PMP control idea</title>
<p>The main idea of PMP is to minimize a performance measure, which is defined as a Hamiltonian. The detailed derivation of the Hamiltonian and the realization of the control idea for HEVs were introduced in previous work,<sup><xref ref-type="bibr" rid="bibr10-0954407012438304">10</xref>,<xref ref-type="bibr" rid="bibr12-0954407012438304">12</xref></sup> and we simply introduce the final results of the idea from those studies. When the only objective of control is achieving the minimum fuel consumption, the optimal control problem is defined as</p>
<p>
<disp-formula id="disp-formula1-0954407012438304">
<label>(1)</label>
<mml:math display="block" id="math1-0954407012438304">
<mml:mrow>
<mml:mo>min</mml:mo>
<mml:mi>J</mml:mi>
<mml:mo>=</mml:mo>
<mml:msubsup>
<mml:mrow>
<mml:mo>∫</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>f</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:msubsup>
<mml:mi>g</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>P</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>bat</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>,</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mspace width="0.25em"/>
<mml:mtext>d</mml:mtext>
<mml:mi>t</mml:mi>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula1-0954407012438304" xlink:href="10.1177_0954407012438304-eq1.tif"/>
</disp-formula>
</p>
<p>subject to</p>
<p>
<disp-formula id="disp-formula2-0954407012438304">
<label>(2)</label>
<mml:math display="block" id="math2-0954407012438304">
<mml:mrow>
<mml:mtext>S</mml:mtext>
<mml:mover>
<mml:mrow>
<mml:mtext>O</mml:mtext>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
<mml:mtext>C</mml:mtext>
<mml:mo>=</mml:mo>
<mml:mi>f</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mtext>SOC</mml:mtext>
<mml:mo>,</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>P</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>bat</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula2-0954407012438304" xlink:href="10.1177_0954407012438304-eq2.tif"/>
</disp-formula>
</p>
<p>and also subject to</p>
<p>
<disp-formula id="disp-formula3-0954407012438304">
<label>(3)</label>
<mml:math display="block" id="math3-0954407012438304">
<mml:mrow>
<mml:mtext>SOC</mml:mtext>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>=</mml:mo>
<mml:mtext>SOC</mml:mtext>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>f</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula3-0954407012438304" xlink:href="10.1177_0954407012438304-eq3.tif"/>
</disp-formula>
</p>
<p>where <italic>P<sub>bat</sub></italic> and SOC are the admissible electrical power of a battery and the available SOC of the battery respectively and <italic>g</italic> is the best fuel consumption rate according to <italic>P<sub>bat</sub></italic> when the output speed is given and the requested output torque is determined. The Hamiltonian is defined as<sup><xref ref-type="bibr" rid="bibr13-0954407012438304">13</xref></sup></p>
<p>
<disp-formula id="disp-formula4-0954407012438304">
<label>(4)</label>
<mml:math display="block" id="math4-0954407012438304">
<mml:mrow>
<mml:mi>H</mml:mi>
<mml:mo>=</mml:mo>
<mml:mi>g</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>P</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>bat</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>,</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>+</mml:mo>
<mml:mi>λ</mml:mi>
<mml:mi>f</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mtext>SOC</mml:mtext>
<mml:mo>,</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>P</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>bat</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula4-0954407012438304" xlink:href="10.1177_0954407012438304-eq4.tif"/>
</disp-formula>
</p>
<p>where λ is a co-state variable and <italic>f</italic>(SOC, <italic>P<sub>bat</sub></italic>) is a time-derivative function of SOC in <xref ref-type="disp-formula" rid="disp-formula2-0954407012438304">equation (2)</xref>. The optimal control can be obtained from</p>
<p>
<disp-formula id="disp-formula5-0954407012438304">
<label>(5)</label>
<mml:math display="block" id="math5-0954407012438304">
<mml:mrow>
<mml:msubsup>
<mml:mrow>
<mml:mi>P</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>bat</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msubsup>
<mml:mo>=</mml:mo>
<mml:mi>arg</mml:mi>
<mml:munder>
<mml:mrow>
<mml:mo>min</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>P</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>bat</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:munder>
<mml:mi>H</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mtext>SO</mml:mtext>
<mml:msup>
<mml:mrow>
<mml:mtext>C</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>,</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>λ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>,</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>P</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>bat</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>,</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula5-0954407012438304" xlink:href="10.1177_0954407012438304-eq5.tif"/>
</disp-formula>
</p>
<p>where the optimal co-state λ<sup>*</sup> is calculated as</p>
<p>
<disp-formula id="disp-formula6-0954407012438304">
<label>(6)</label>
<mml:math display="block" id="math6-0954407012438304">
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>λ</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>=</mml:mo>
<mml:mo>−</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>λ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mfrac>
<mml:mrow>
<mml:mo>∂</mml:mo>
<mml:mi>f</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mtext>SO</mml:mtext>
<mml:msup>
<mml:mrow>
<mml:mtext>C</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>,</mml:mo>
<mml:msubsup>
<mml:mrow>
<mml:mi>P</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>bat</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msubsup>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
<mml:mrow>
<mml:mo>∂</mml:mo>
<mml:mtext>SOC</mml:mtext>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula6-0954407012438304" xlink:href="10.1177_0954407012438304-eq6.tif"/>
</disp-formula>
</p>
<p>In the optimal-control problem, we need to find the optimal trajectory SOC<italic><sup>*</sup></italic> that satisfies <xref ref-type="disp-formula" rid="disp-formula2-0954407012438304">equations (2)</xref> and <xref ref-type="disp-formula" rid="disp-formula3-0954407012438304">(3)</xref>, and the optimal co-state λ<sup>*</sup> that satisfies <xref ref-type="disp-formula" rid="disp-formula6-0954407012438304">equation (6)</xref>, while the optimal control <inline-formula id="inline-formula1-0954407012438304">
<mml:math display="inline" id="math7-0954407012438304">
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>P</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>bat</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
</mml:mrow>
</mml:math></inline-formula> is determined by <xref ref-type="disp-formula" rid="disp-formula5-0954407012438304">equation (5)</xref>. The beauty of this control idea is that we can instantaneously determine the optimal control <inline-formula id="inline-formula2-0954407012438304">
<mml:math display="inline" id="math8-0954407012438304">
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>P</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>bat</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
</mml:mrow>
</mml:math></inline-formula> with current information when an optimal co-state λ<sup>*</sup> is given, thus enabling this control concept to be applied to real-time vehicles, although a wrong co-state could cause a failure in sustaining the SOC. Fortunately, the optimal co-state could be predicted if we had information on the driving pattern available before a vehicle was driven.<sup><xref ref-type="bibr" rid="bibr12-0954407012438304">12</xref></sup> On the other hand, it has already been proven that PMP control guarantees global optimality if the SȮC (<xref ref-type="disp-formula" rid="disp-formula2-0954407012438304">equation (2)</xref>) is not a function of the SOC in optimal-control problems in HEVs.<sup><xref ref-type="bibr" rid="bibr10-0954407012438304">10</xref></sup> In addition to the study, we shall show that the control idea is also globally optimal if the SȮC is a concave function of the SOC, which is a more realistic condition than the condition given by Kim et al.<sup><xref ref-type="bibr" rid="bibr10-0954407012438304">10</xref></sup></p>
</sec>
<sec id="section4-0954407012438304">
<title>Forward-looking control</title>
<p>Both PMP and DP can be utilized to evaluate the performance of HEVs, but PMP-based control can be directly applied to the control model, whereas DP needs to be realized by stochastic models or needs another process to mimic the optimal results in real-time controllers.<sup><xref ref-type="bibr" rid="bibr14-0954407012438304">14</xref>,<xref ref-type="bibr" rid="bibr15-0954407012438304">15</xref></sup> In simulations, system models that realize the control ideas can be distinguished by the direction of their signal flows. One is a backward-looking model, and the other is a forward-looking model.</p>
<p>In the backward-looking model, as shown in <xref ref-type="fig" rid="fig1-0954407012438304">Figure 1</xref>, the dynamic model calculates the exact input required for producing a desired behavior, and so the controller could test various control sets that satisfy the required input. This model is very favorable when there are multiple power resources because various combinations of power split among the engine and the motors can be tested in a single backward-looking model in the control problems for HEVs. In contrast with the backward-looking model, only one control input is naturally allowed for simulations when using a forward-looking model, as shown in <xref ref-type="fig" rid="fig2-0954407012438304">Figure 2</xref>. Multiple inputs require parallel calculations, and different control inputs could result in different dynamic behaviors. In addition, this model needs an observer that produces a required input by comparing the dynamic behaviors and the desired behaviors. In the simplest terms, the observer can be interpreted as a driver model that generates pedal signals.</p>
<fig id="fig1-0954407012438304" position="float">
<label>Figure 1.</label>
<caption>
<p>Backward-looking model schematic. There can be various control inputs for one model output.</p>
</caption>
<graphic xlink:href="10.1177_0954407012438304-fig1.tif"/>
</fig>
<fig id="fig2-0954407012438304" position="float">
<label>Figure 2.</label>
<caption>
<p>Forward-looking model schematic. In general, only one control input can be solved by the dynamic model.</p>
</caption>
<graphic xlink:href="10.1177_0954407012438304-fig2.tif"/>
</fig>
<p>To show clearly the difference between the dynamic models of the two cases, we can consider a simple state equation with control and state signals, as shown in <xref ref-type="fig" rid="fig3-0954407012438304">Figure 3</xref>. The state equation can be expressed as a function <italic>f</italic>, where the state and the control of the system are <bold><italic>x</italic></bold> and <bold><italic>u</italic></bold> respectively. Applying the equations in <xref ref-type="fig" rid="fig3-0954407012438304">Figure 3</xref>, the dynamic model in the backward-looking system should solve an implicit differential equation, whereas the dynamic model in the forward-looking system can explicitly calculate the behavior of the system. The implicit equation could need iterative calculations that demand more computational loads than the other, and so the backward-looking application often (perhaps most of the time) uses simplified models, such as static models.<sup><xref ref-type="bibr" rid="bibr15-0954407012438304">15</xref></sup> Considering that DP should evaluate all possible control sets approaching a single state to retain optimal trajectories, the backward-looking model is very appropriate for the application of DP. However, DP also requires a substantial computational load because it should solve a partial differential equation, and so obtaining optimal-control trajectories from DP is still considered a burden. For this reason, it is not easy to incorporate a sophisticated model into the backward-looking model. It is easier to incorporate realistic models into the forward-looking model than into the backward-looking model because, even though they may be highly nonlinear or very complicated such as a friction model or a hydraulic model, the mathematical models of realistic phenomena are customarily defined as functions of the state and the control input. This fact enables the realistic model to be implemented in the global dynamic model because the dynamic model is also defined as a function of the state and the control (see <xref ref-type="fig" rid="fig3-0954407012438304">Figure 3(b)</xref>). Therefore, the control idea deployed in the forward-looking model could be considered to be a more realistic controller for application in real-time vehicles than the backward-looking model is. Although λ<sup>*</sup> for the global optimal solution of PMP should be obtained in iterative simulations, the concept of instantaneous optimal solution in <xref ref-type="disp-formula" rid="disp-formula5-0954407012438304">equation (5)</xref> can be easily applied to the forward-looking model because the controller instantaneously produces the optimal-control demand <italic>P<sub>bat</sub></italic>, based on the current SOC and co-state λ; therefore, it is reasonable to assume that PMP-based control is a feasible solution. In the PMP, the controller does not require an iterative process to determine the optimal target, and the decision is made in a time-forward approach. Therefore, as a very feasible solution, PMP should play an influential role in the control for HEVs. PMP-based control is not a fully causal solution because the optimal co-state <italic>λ<sup>*</sup></italic> is not exactly determined at the start of the driving. However, other studies have introduced very effective methodologies, first, that promptly estimate the optimal co-state when future driving information is provided<sup><xref ref-type="bibr" rid="bibr12-0954407012438304">12</xref>,<xref ref-type="bibr" rid="bibr16-0954407012438304">16</xref></sup> or, second, that use adaptive concepts for λ according to the current SOC,<sup><xref ref-type="bibr" rid="bibr17-0954407012438304">17</xref><xref ref-type="bibr" rid="bibr18-0954407012438304"/><xref ref-type="bibr" rid="bibr19-0954407012438304"/><xref ref-type="bibr" rid="bibr20-0954407012438304"/>–<xref ref-type="bibr" rid="bibr21-0954407012438304">21</xref></sup> which could be real applications for the control concept of PMP.</p>
<fig id="fig3-0954407012438304" position="float">
<label>Figure 3.</label>
<caption>
<p>Differences in the calculation methods between the backward-looking model and the forward-looking model.</p>
</caption>
<graphic xlink:href="10.1177_0954407012438304-fig3.tif"/>
</fig>
</sec>
</sec>
<sec id="section5-0954407012438304">
<title>Sufficient conditions for optimality</title>
<p>As stated in the section on the PMP control idea, the control based on PMP could be a global optimal solution when both the battery resistance and the voltage are not functions of the SOC, and the assumption is reasonable if the SOC stays in the middle range, such as<sup><xref ref-type="bibr" rid="bibr10-0954407012438304">10</xref></sup> 0.5–0.7. In this section, we expand the idea to a more generalized condition than the conclusion and show that the necessary conditions associated with PMP should be sufficient, especially if the battery efficiency is a concave function of the SOC.</p>
<sec id="section6-0954407012438304">
<title>Global optimality</title>
<p>PMP produces only the necessary conditions that an optimal-control trajectory must satisfy, but additional information on the Hamiltonian could turn the necessary conditions into sufficient conditions. For example, we know that the Euler–Lagrange equation derived from calculus of variation guarantees global optimality in conservative dynamic systems; the world does not allow an alternative behavior in the conservative systems. In a similar way, it has been proven that optimality of the control for HEVs is guaranteed on the basis of the uniqueness of the optimal trajectory,<sup><xref ref-type="bibr" rid="bibr10-0954407012438304">10</xref></sup> in which researchers assumed that the fuel consumption rate <italic>g</italic>(<italic>P<sub>bat</sub></italic>) and the state equation <italic>f</italic>(SOC, <italic>P<sub>bat</sub></italic>) are not functions of the SOC. The assumption for the state equation <italic>f</italic> is reasonable when a small range of SOCs is used, but it could be an inappropriate assumption when the controller utilizes a wide range of SOCs. Taking a small step forward, we shall show that the necessary conditions produced by PMP are still sufficient if the fuel consumption rate <italic>g</italic> is a convex function of <italic>P<sub>bat</sub></italic>, and if the state equation <italic>f</italic> is a concave function of the SOC. This idea enables the control concept to have a variable co-state and to be used over a wide range of SOCs. To prove this statement, we introduce Mangasarian’s<sup><xref ref-type="bibr" rid="bibr22-0954407012438304">22</xref></sup> work into the optimal control problem for HEVs, for which the idea based on differentiable functions is extended to generalized cases, and we use the concavity of the battery characteristic to prove optimality. First, if a surface <italic>S</italic> is differentiable and is a concave function of the two variables <italic>x</italic> and <italic>u</italic>, then it must naturally satisfy the condition for any <italic>x<sup>*</sup></italic> and <italic>u<sup>*</sup></italic>, which can be expressed as</p>
<p>
<disp-formula id="disp-formula7-0954407012438304">
<label>(7)</label>
<mml:math display="block" id="math9-0954407012438304">
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mi>S</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>−</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi>S</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo>≥</mml:mo>
<mml:msubsup>
<mml:mrow>
<mml:mi>S</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msubsup>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>−</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>+</mml:mo>
<mml:msubsup>
<mml:mrow>
<mml:mi>S</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>u</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msubsup>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>u</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>−</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi>u</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula7-0954407012438304" xlink:href="10.1177_0954407012438304-eq7.tif"/>
</disp-formula>
</p>
<p>where <italic>S<sup>*</sup></italic> is the value of the function <italic>S</italic> on <italic>x<sup>*</sup></italic> and <italic>u</italic><sup>*</sup>, and is the value of <italic>S</italic> on <inline-formula id="inline-formula3-0954407012438304">
<mml:math display="inline" id="math10-0954407012438304">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
</mml:mrow>
</mml:math></inline-formula> and <inline-formula id="inline-formula4-0954407012438304">
<mml:math display="inline" id="math11-0954407012438304">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>u</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
</mml:mrow>
</mml:math></inline-formula>. In this paper, <italic>x</italic> represents the state variable, namely the SOC, and <italic>u</italic> represents the control variable <italic>P<sub>bat</sub></italic>, where the control <italic>u</italic> is an admissible control input.<sup><xref ref-type="bibr" rid="bibr23-0954407012438304">23</xref></sup> On the other hand, if we have a pair of an optimal state <italic>x<sup>*</sup></italic> and an optimal control <italic>u</italic><sup>*</sup>, solved by PMP, we can prove that the pair of <italic>x<sup>*</sup></italic> and <italic>u</italic><sup>*</sup> is an optimal solution for the control problem by showing that the obtained solution is superior to any other solution. To evaluate the performance of the optimal pair <italic>x<sup>*</sup></italic> and <italic>u</italic><sup>*</sup>, we consider a pair of an alternative feasible state <inline-formula id="inline-formula5-0954407012438304">
<mml:math display="inline" id="math12-0954407012438304">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
</mml:mrow>
</mml:math></inline-formula> and an alternative admissible control input <inline-formula id="inline-formula6-0954407012438304">
<mml:math display="inline" id="math13-0954407012438304">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>u</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
</mml:mrow>
</mml:math></inline-formula>, which can be any trajectories that satisfy the state equation and the boundary condition in <xref ref-type="disp-formula" rid="disp-formula2-0954407012438304">equations (2)</xref> and <xref ref-type="disp-formula" rid="disp-formula3-0954407012438304">(3)</xref>, as shown in <xref ref-type="fig" rid="fig4-0954407012438304">Figure 4</xref>. In that the performance measures <italic>g</italic><sup>*</sup> and <inline-formula id="inline-formula7-0954407012438304">
<mml:math display="inline" id="math14-0954407012438304">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>g</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
</mml:mrow>
</mml:math></inline-formula> were evaluated for <italic>u</italic><sup>*</sup> and <inline-formula id="inline-formula8-0954407012438304">
<mml:math display="inline" id="math15-0954407012438304">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>u</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
</mml:mrow>
</mml:math></inline-formula> in <xref ref-type="disp-formula" rid="disp-formula1-0954407012438304">equation (1)</xref>, if <italic>g</italic><sup>*</sup> is optimal, it must be the case that</p>
<p>
<disp-formula id="disp-formula8-0954407012438304">
<label>(8)</label>
<mml:math display="block" id="math17-0954407012438304">
<mml:mrow>
<mml:msubsup>
<mml:mrow>
<mml:mo>∫</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>f</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:msubsup>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>g</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>−</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi>g</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mspace width="0.25em"/>
<mml:mtext>d</mml:mtext>
<mml:mi>t</mml:mi>
<mml:mo>≤</mml:mo>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula8-0954407012438304" xlink:href="10.1177_0954407012438304-eq8.tif"/>
</disp-formula>
</p>
<fig id="fig4-0954407012438304" position="float">
<label>Figure 4.</label>
<caption>
<p>An optimal trajectory <italic>x<sup>*</sup></italic> and an alternative trajectory <inline-formula id="inline-formula9-0954407012438304">
<mml:math display="inline" id="math16-0954407012438304">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
</mml:mrow>
</mml:math></inline-formula>.</p>
</caption>
<graphic xlink:href="10.1177_0954407012438304-fig4.tif"/>
</fig>
<p>In this section, we shall show that <xref ref-type="disp-formula" rid="disp-formula8-0954407012438304">equation (8)</xref> is possibly true in our control problems for HEVs. In the problems, the fuel consumption rate <italic>g</italic> is a function of <italic>u</italic> and time, and the state equation <italic>f</italic> is a function of <italic>x</italic> and <italic>u</italic> (see <xref ref-type="disp-formula" rid="disp-formula1-0954407012438304">equations (1)</xref> and <xref ref-type="disp-formula" rid="disp-formula2-0954407012438304">(2)</xref>). For the next step, we assumed, first, that the function <italic>g</italic> is a convex function of <italic>u</italic>, second, that the function <italic>f</italic> is a concave function of <italic>x</italic> and <italic>u</italic>, and, third, that the co-state λ is always negative. Under these assumptions, the control based on PMP is sufficient for global optimality; the reason why we use these assumptions will be discussed in the following section. For any optimal state <italic>x<sup>*</sup></italic>, the functions <italic>f</italic> and <italic>g</italic> can be obtained according to the admissible control <italic>u</italic>, as shown in <xref ref-type="fig" rid="fig5-0954407012438304">Figure 5</xref>.</p>
<fig id="fig5-0954407012438304" position="float">
<label>Figure 5.</label>
<caption>
<p>Example of a fuel consumption rate <italic>g</italic> and a state equation <italic>f. g</italic> is a function of only <italic>u</italic>, and <italic>f</italic> is a function of <italic>x</italic> and <italic>u</italic>.</p>
</caption>
<graphic xlink:href="10.1177_0954407012438304-fig5.tif"/>
</fig>
<p>Instead of using the functions <italic>g</italic> and <italic>f</italic>, as they are, we introduce <italic>g – H</italic><sup>*</sup> and –<italic>λ<sup>*</sup>f</italic>, where <italic>H</italic><sup>*</sup> is an optimal value of the Hamiltonian at <italic>x<sup>*</sup></italic> and <italic>u<sup>*</sup></italic> when <italic>λ<sup>*</sup></italic> is an optimal co-state at the time, as shown in <xref ref-type="fig" rid="fig6-0954407012438304">Figure 6</xref>. From the new curves, we could easily introduce inequality conditions among the curves. The two curves <italic>g – H</italic><sup>*</sup> and –<italic>λ<sup>*</sup>f</italic> are supposed to meet each other only at <italic>u<sup>*</sup></italic> and do not intersect, as shown in <xref ref-type="fig" rid="fig6-0954407012438304">Figure 6</xref>, because <italic>u<sup>*</sup></italic> is obtained by finding the minimum value of <italic>H</italic> where <italic>H</italic> is defined as <xref ref-type="disp-formula" rid="disp-formula4-0954407012438304">equation (4)</xref>, which satisfies</p>
<p>
<disp-formula id="disp-formula9-0954407012438304">
<label>(9)</label>
<mml:math display="block" id="math18-0954407012438304">
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mi>H</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>=</mml:mo>
<mml:mi>g</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>u</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>+</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>λ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mi>f</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>,</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>u</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula9-0954407012438304" xlink:href="10.1177_0954407012438304-eq9.tif"/>
</disp-formula>
</p>
<fig id="fig6-0954407012438304" position="float">
<label>Figure 6.</label>
<caption>
<p>Two curves <italic>g – h<sup>*</sup></italic> and –<italic>λ<sup>*</sup>f</italic> manipulated from <italic>g</italic> and <italic>f</italic>, while two parameters <italic>λ<sup>*</sup></italic> and <italic>h<sup>*</sup></italic> are constants at a given time. The virtual curve <italic>h</italic> is a tangent line that does not penetrate either of the two curves <italic>g – h<sup>*</sup></italic> and –<italic>λ<sup>*</sup>f</italic>.</p>
</caption>
<graphic xlink:href="10.1177_0954407012438304-fig6.tif"/>
</fig>
<p>For the next step, we introduce a virtual curve <italic>h</italic> that is a tangent line of –<italic>λ<sup>*</sup>f</italic> at <italic>u<sup>*</sup></italic>. It passes through the point at which the two curves <italic>g – H</italic><sup>*</sup> and –<italic>λ<sup>*</sup>f</italic> meet and never penetrates either <italic>g – H<sup>*</sup></italic> or <italic>–λ<sup>*</sup>f</italic> if <italic>g</italic> is convex and if –<italic>λ<sup>*</sup>f</italic> is concave. By utilizing the virtual curve <italic>h</italic>, we can drive the inequality condition in <xref ref-type="disp-formula" rid="disp-formula8-0954407012438304">equation (8)</xref> on the basis of the concavity characteristic in <xref ref-type="disp-formula" rid="disp-formula7-0954407012438304">equation (7)</xref>. If <italic>g</italic> is convex, we can have <italic>h</italic> satisfying</p>
<p>
<disp-formula id="disp-formula10-0954407012438304">
<label>(10)</label>
<mml:math display="block" id="math19-0954407012438304">
<mml:mrow>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>g</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>−</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>H</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>−</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi>g</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo>−</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>H</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>≤</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>h</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>−</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi>h</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula10-0954407012438304" xlink:href="10.1177_0954407012438304-eq10.tif"/>
</disp-formula>
</p>
<p>where <italic>h</italic><sup>*</sup> and <inline-formula id="inline-formula10-0954407012438304">
<mml:math display="inline" id="math20-0954407012438304">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>h</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
</mml:mrow>
</mml:math></inline-formula> are the values of <italic>h</italic> at <italic>u</italic><sup>*</sup> and <inline-formula id="inline-formula11-0954407012438304">
<mml:math display="inline" id="math21-0954407012438304">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>u</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
</mml:mrow>
</mml:math></inline-formula>. This means simply that</p>
<p>
<disp-formula id="disp-formula11-0954407012438304">
<label>(11)</label>
<mml:math display="block" id="math22-0954407012438304">
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mi>g</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>−</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi>g</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo>≤</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>h</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>−</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi>h</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula11-0954407012438304" xlink:href="10.1177_0954407012438304-eq11.tif"/>
</disp-formula>
</p>
<p>On the other hand, <italic>h</italic> is a tangent line of –<italic>λ<sup>*</sup>f</italic> at <italic>u<sup>*</sup></italic>, and so <italic>h</italic><sup>*</sup>–<inline-formula id="inline-formula12-0954407012438304">
<mml:math display="inline" id="math23-0954407012438304">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>h</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
</mml:mrow>
</mml:math></inline-formula> can be expressed as</p>
<p>
<disp-formula id="disp-formula12-0954407012438304">
<label>(12)</label>
<mml:math display="block" id="math24-0954407012438304">
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mi>h</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>−</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi>h</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo>=</mml:mo>
<mml:mo>−</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>λ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:msubsup>
<mml:mrow>
<mml:mi>f</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>u</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msubsup>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>u</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>−</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi>u</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula12-0954407012438304" xlink:href="10.1177_0954407012438304-eq12.tif"/>
</disp-formula>
</p>
<p>Further, we assume that the function <italic>f</italic> is concave and that the optimal co-state <italic>λ<sup>*</sup></italic> is negative and depends only on time; therefore, the curve –<italic>λ<sup>*</sup>f</italic> is still concave, which allows us to apply the condition in <xref ref-type="disp-formula" rid="disp-formula7-0954407012438304">equation (7)</xref> for –<italic>λ<sup>*</sup>f</italic> to give</p>
<p>
<disp-formula id="disp-formula13-0954407012438304">
<label>(13)</label>
<mml:math display="block" id="math25-0954407012438304">
<mml:mrow>
<mml:mo>−</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>λ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>f</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>−</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi>f</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>≥</mml:mo>
<mml:mo>−</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>λ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:msubsup>
<mml:mrow>
<mml:mi>f</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msubsup>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>−</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>+</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>h</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>−</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi>h</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula13-0954407012438304" xlink:href="10.1177_0954407012438304-eq13.tif"/>
</disp-formula>
</p>
<p>From <xref ref-type="disp-formula" rid="disp-formula11-0954407012438304">equation (11)</xref> and <xref ref-type="disp-formula" rid="disp-formula13-0954407012438304">equation (13)</xref>, we can obtain an inequality condition, such as</p>
<p>
<disp-formula id="disp-formula14-0954407012438304">
<label>(14)</label>
<mml:math display="block" id="math26-0954407012438304">
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mi>g</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>−</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi>g</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo>≤</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>h</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>−</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi>h</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo>≤</mml:mo>
<mml:mo>−</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>λ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>f</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>−</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi>f</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>+</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>λ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:msubsup>
<mml:mrow>
<mml:mi>f</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msubsup>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>−</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula14-0954407012438304" xlink:href="10.1177_0954407012438304-eq14.tif"/>
</disp-formula>
</p>
<p>On the other hand, the state equation and the co-state equation in <xref ref-type="disp-formula" rid="disp-formula2-0954407012438304">equations (2)</xref> and <xref ref-type="disp-formula" rid="disp-formula6-0954407012438304">(6)</xref> can be expressed as</p>
<p>
<disp-formula id="disp-formula15-0954407012438304">
<label>(15)</label>
<mml:math display="block" id="math27-0954407012438304">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
<mml:mo>=</mml:mo>
<mml:mi>f</mml:mi>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula15-0954407012438304" xlink:href="10.1177_0954407012438304-eq15.tif"/>
</disp-formula>
</p>
<p>and</p>
<p>
<disp-formula id="disp-formula16-0954407012438304">
<label>(16)</label>
<mml:math display="block" id="math28-0954407012438304">
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>λ</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>=</mml:mo>
<mml:mo>−</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>λ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:msubsup>
<mml:mrow>
<mml:mi>f</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msubsup>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula16-0954407012438304" xlink:href="10.1177_0954407012438304-eq16.tif"/>
</disp-formula>
</p>
<p>Multiplied by <italic>x<sup>*</sup></italic>−<inline-formula id="inline-formula13-0954407012438304">
<mml:math display="inline" id="math29-0954407012438304">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
</mml:mrow>
</mml:math></inline-formula>, <xref ref-type="disp-formula" rid="disp-formula16-0954407012438304">equation (16)</xref> can be expressed as</p>
<p>
<disp-formula id="disp-formula17-0954407012438304">
<label>(17)</label>
<mml:math display="block" id="math30-0954407012438304">
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>λ</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>−</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>+</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>λ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:msubsup>
<mml:mrow>
<mml:mi>f</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msubsup>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>−</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>=</mml:mo>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula17-0954407012438304" xlink:href="10.1177_0954407012438304-eq17.tif"/>
</disp-formula>
</p>
<p>The integration of <xref ref-type="disp-formula" rid="disp-formula17-0954407012438304">equation (17)</xref> must always yield zero, and so</p>
<p>
<disp-formula id="disp-formula18-0954407012438304">
<label>(18)</label>
<mml:math display="block" id="math31-0954407012438304">
<mml:mrow>
<mml:msubsup>
<mml:mrow>
<mml:mo>∫</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>f</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:msubsup>
<mml:msup>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>λ</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>−</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mspace width="0.25em"/>
<mml:mtext>d</mml:mtext>
<mml:mi>t</mml:mi>
<mml:mo>+</mml:mo>
<mml:msubsup>
<mml:mrow>
<mml:mo>∫</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>f</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:msubsup>
<mml:msup>
<mml:mrow>
<mml:mi>λ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:msubsup>
<mml:mrow>
<mml:mi>f</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msubsup>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>−</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mspace width="0.25em"/>
<mml:mtext>d</mml:mtext>
<mml:mi>t</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula18-0954407012438304" xlink:href="10.1177_0954407012438304-eq18.tif"/>
</disp-formula>
</p>
<p>By performing integration by part only for the first terms in <xref ref-type="disp-formula" rid="disp-formula18-0954407012438304">equation (18)</xref>, we can express the equation as</p>
<p>
<disp-formula id="disp-formula19-0954407012438304">
<label>(19)</label>
<mml:math display="block" id="math32-0954407012438304">
<mml:mrow>
<mml:msubsup>
<mml:mrow>
<mml:mo>[</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>λ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>−</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>]</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>f</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:msubsup>
<mml:mo>−</mml:mo>
<mml:msubsup>
<mml:mrow>
<mml:mo>∫</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>f</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:msubsup>
<mml:msup>
<mml:mrow>
<mml:mi>λ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>−</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mover>
<mml:mi>x</mml:mi>
<mml:mo>~</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mspace width="0.25em"/>
<mml:mtext>d</mml:mtext>
<mml:mi>t</mml:mi>
<mml:mo>+</mml:mo>
<mml:msubsup>
<mml:mrow>
<mml:mo>∫</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>f</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:msubsup>
<mml:msup>
<mml:mrow>
<mml:mi>λ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:msubsup>
<mml:mrow>
<mml:mi>f</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msubsup>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>−</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mspace width="0.25em"/>
<mml:mtext>d</mml:mtext>
<mml:mi>t</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula19-0954407012438304" xlink:href="10.1177_0954407012438304-eq19.tif"/></disp-formula>
</p>
<p>In our optimal-control problem, we suppose that the alternative state <inline-formula id="inline-formula14-0954407012438304">
<mml:math display="inline" id="math33-0954407012438304">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
</mml:mrow>
</mml:math></inline-formula> satisfies the boundary condition, and so the first term in <xref ref-type="disp-formula" rid="disp-formula19-0954407012438304">equation (19)</xref> should be zero because <italic>x<sup>*</sup></italic>−<inline-formula id="inline-formula15-0954407012438304">
<mml:math display="inline" id="math34-0954407012438304">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
</mml:mrow>
</mml:math></inline-formula> is zero at both the initial time <italic>t</italic> = 0 and the final time <italic>t</italic> = <italic>t<sub>f</sub></italic> (see <xref ref-type="fig" rid="fig4-0954407012438304">Figure 4</xref>). Further, we know that <inline-formula id="inline-formula16-0954407012438304">
<mml:math display="inline" id="math35-0954407012438304">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
</mml:mrow>
</mml:math></inline-formula> is a function, in <xref ref-type="disp-formula" rid="disp-formula15-0954407012438304">equation (15)</xref>, and so <xref ref-type="disp-formula" rid="disp-formula19-0954407012438304">equation (19)</xref> can be expressed as</p>
<p>
<disp-formula id="disp-formula20-0954407012438304">
<label>(20)</label>
<mml:math display="block" id="math36-0954407012438304">
<mml:mrow>
<mml:mo>−</mml:mo>
<mml:msubsup>
<mml:mrow>
<mml:mo>∫</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>f</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:msubsup>
<mml:msup>
<mml:mrow>
<mml:mi>λ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>f</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>−</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi>f</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mspace width="0.25em"/>
<mml:mtext>d</mml:mtext>
<mml:mi>t</mml:mi>
<mml:mo>+</mml:mo>
<mml:msubsup>
<mml:mrow>
<mml:mo>∫</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>f</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:msubsup>
<mml:msup>
<mml:mrow>
<mml:mi>λ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:msubsup>
<mml:mrow>
<mml:mi>f</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msubsup>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>−</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mspace width="0.25em"/>
<mml:mtext>d</mml:mtext>
<mml:mi>t</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>0</mml:mn>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula20-0954407012438304" xlink:href="10.1177_0954407012438304-eq20.tif"/>
</disp-formula>
</p>
<p>The integration of <xref ref-type="disp-formula" rid="disp-formula14-0954407012438304">equation (14)</xref> does not change the inequality condition; therefore</p>
<p>
<disp-formula id="disp-formula21-0954407012438304">
<label>(21)</label>
<mml:math display="block" id="math37-0954407012438304">
<mml:mrow>
<mml:msubsup>
<mml:mrow>
<mml:mo>∫</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>f</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:msubsup>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>g</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>−</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi>g</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mspace width="0.25em"/>
<mml:mtext>d</mml:mtext>
<mml:mi>t</mml:mi>
<mml:mo>≤</mml:mo>
<mml:mo>−</mml:mo>
<mml:msubsup>
<mml:mrow>
<mml:mo>∫</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>f</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:msubsup>
<mml:msup>
<mml:mrow>
<mml:mi>λ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>f</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>−</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi>f</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mspace width="0.25em"/>
<mml:mtext>d</mml:mtext>
<mml:mi>t</mml:mi>
<mml:mo>+</mml:mo>
<mml:msubsup>
<mml:mrow>
<mml:mo>∫</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>f</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:msubsup>
<mml:msup>
<mml:mrow>
<mml:mi>λ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:msubsup>
<mml:mrow>
<mml:mi>f</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msubsup>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>*</mml:mo>
</mml:mrow>
</mml:msup>
<mml:mo>−</mml:mo>
<mml:mover>
<mml:mrow>
<mml:mi>x</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mspace width="0.25em"/>
<mml:mtext>d</mml:mtext>
<mml:mi>t</mml:mi>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula21-0954407012438304" xlink:href="10.1177_0954407012438304-eq21.tif"/></disp-formula>
</p>
<p>Finally, we know that the right-hand side of <xref ref-type="disp-formula" rid="disp-formula21-0954407012438304">equation (21)</xref> is zero from <xref ref-type="disp-formula" rid="disp-formula20-0954407012438304">equation (20)</xref>; thus, the condition in <xref ref-type="disp-formula" rid="disp-formula8-0954407012438304">equation (8)</xref> is always satisfied, which shows that any alternative control <inline-formula id="inline-formula17-0954407012438304">
<mml:math display="inline" id="math38-0954407012438304">
<mml:mrow>
<mml:mover>
<mml:mrow>
<mml:mi>u</mml:mi>
</mml:mrow>
<mml:mo>~</mml:mo>
</mml:mover>
</mml:mrow>
</mml:math></inline-formula> cannot be superior to the optimal <italic>u<sup>*</sup></italic>. By the derivation, we can state that the necessary conditions produced by PMP are sufficient for the global optimal solution under our assumptions. In reality, the functions <italic>g</italic> and <italic>f</italic> are naturally characterized to satisfy the assumptions, and λ must be a negative value for our control problem, as discussed in the following section. In addition, a counterexample of the concavity of <italic>f</italic> will be introduced with an unusual battery, which will show that the battery characteristic is essential for the sufficient conditions.</p>
</sec>
<sec id="section7-0954407012438304">
<title>Convexity, concavity, and negativity</title>
<p>The convexity of <italic>g</italic>, the concavity of <italic>f</italic>, and the negativity of the co-state are necessary and sufficient conditions to make the control idea a global solution. Although the convexity and the concavity are not strong conditions for our control problems, we can consider that the characteristics of our control problem are very favorable for using the PMP-based control as an optimal solution. When it comes to the convexity of <italic>g</italic>, we are able to infer how the shape of the fuel consumption rate <italic>g</italic> is produced on the basis of <xref ref-type="fig" rid="fig7-0954407012438304">Figure 7</xref>. Although the real function <italic>g</italic> is numerically calculated on the basis of the Pareto frontier of all possible operating points,<sup><xref ref-type="bibr" rid="bibr10-0954407012438304">10</xref></sup> the overall shape of <italic>g</italic> could be simply understood by considering the following steps. First, if we do not consider the loss of the powertrain, the sum of the mechanical engine power <italic>P<sub>eng</sub></italic> and the electric machine power <italic>P<sub>mot</sub></italic> is conceptually the same as the output desired power <italic>P<sub>out</sub></italic>, as shown in <xref ref-type="fig" rid="fig7-0954407012438304">Figure 7(a)</xref>. Second, the line in <xref ref-type="fig" rid="fig7-0954407012438304">Figure 7(a)</xref> can be projected into another domain axis from <italic>P<sub>mot</sub></italic> to <italic>P<sub>bat</sub></italic>, as shown in <xref ref-type="fig" rid="fig7-0954407012438304">Figure 7(b)</xref>, and the converting efficiencies <italic>η</italic> or 1/<italic>η</italic> are multiplied by <italic>P<sub>mot</sub></italic> according to the direction of power flow. Further, the brake specific fuel consumption of engines generally has a larger value in the low- or high-engine-power region than in the middle range of power, and so the fuel consumption rate becomes more smoothly convex than the line in <xref ref-type="fig" rid="fig7-0954407012438304">Figure 7(b)</xref> if the <italic>y</italic> axis of the figure is converted from <italic>P<sub>eng</sub></italic> to <italic><sub>fc</sub></italic>.</p>
<fig id="fig7-0954407012438304" position="float">
<label>Figure 7.</label>
<caption>
<p>Conceptual correlation (a) between the motor power and the engine power and (b) between the battery power and the engine power.</p>
</caption>
<graphic xlink:href="10.1177_0954407012438304-fig7.tif"/>
</fig>
<p>
<xref ref-type="fig" rid="fig8-0954407012438304">Figure 8</xref> shows an example of the fuel consumption rate function, which is a family of the best operating points from the feasible operating area. The curve of the function clearly means that less fuel is consumed if more electric power is used, and the fuel consumption rate has a convex-like shape. Although the convexity of <italic>g</italic> seems natural, it could be revoked if a pure electric driving point is added to the Hamiltonian, or if there is an unexpected feasible operating area. The shape of <italic>g</italic>, however, generally affects the optimality of the solution rather than produces another solution that is far from optimal; a non-convex function for <italic>g</italic> produces a duality gap and degrades the performance of the control.<sup><xref ref-type="bibr" rid="bibr10-0954407012438304">10</xref></sup> On the other hand, the concavity of the function <italic>f</italic> is an important condition to make the solution unique, and so the control might produce an alternative solution if <italic>f</italic> were not concave. Therefore, we might have a very different energy management strategy if <italic>f</italic> is not concave. The state equation <italic>f</italic> is a function of both the SOC and <italic>P<sub>bat</sub></italic>, which can be expressed as</p>
<p>
<disp-formula id="disp-formula22-0954407012438304">
<label>(22)</label>
<mml:math display="block" id="math39-0954407012438304">
<mml:mrow>
<mml:mi>f</mml:mi>
<mml:mo>=</mml:mo>
<mml:mtext>S</mml:mtext>
<mml:mover>
<mml:mrow>
<mml:mtext>O</mml:mtext>
</mml:mrow>
<mml:mo>·</mml:mo>
</mml:mover>
<mml:mtext>C</mml:mtext>
<mml:mo>=</mml:mo>
<mml:mo>−</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>Q</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>bat</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>V</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>oc</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msqrt>
<mml:mrow>
<mml:msubsup>
<mml:mrow>
<mml:mi>V</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>oc</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msubsup>
<mml:mo>−</mml:mo>
<mml:mn>4</mml:mn>
<mml:msub>
<mml:mrow>
<mml:mi>R</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>bat</mml:mi>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mrow>
<mml:mi>P</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>bat</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:msqrt>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
<mml:msub>
<mml:mrow>
<mml:mi>R</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>bat</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula22-0954407012438304" xlink:href="10.1177_0954407012438304-eq22.tif"/>
</disp-formula>
</p>
<p>where <italic>V<sub>oc</sub></italic> and <italic>R<sub>bat</sub></italic> are the open-circuit voltage and the internal resistance of the battery respectively, which are generally functions of the SOC, and <italic>Q<sub>bat</sub></italic> is the capacity of the battery. If <italic>f</italic> is concave for both <italic>P<sub>bat</sub></italic> and the SOC, it should be considered to be a concave surface. First, from <xref ref-type="disp-formula" rid="disp-formula22-0954407012438304">equation (22)</xref>, the function <italic>f</italic> is a parabolic curve, as shown in <xref ref-type="fig" rid="fig9-0954407012438304">Figure 9</xref>, at any SOC; therefore, <italic>f</italic> is always concave for <italic>P<sub>bat</sub></italic> even though <italic>R<sub>bat</sub></italic> has a different value according to the direction of the power flow such as charging or discharging.</p>
<fig id="fig8-0954407012438304" position="float">
<label>Figure 8.</label>
<caption>
<p>An example of the fuel consumption rate function <italic>g</italic>. This line is obtained on the basis of data for a 2004 Toyota Prius 04 when the required output torque and the output speed are 50 nm and 100 rad/s respectively.</p>
</caption>
<graphic xlink:href="10.1177_0954407012438304-fig8.tif"/>
</fig>
<fig id="fig9-0954407012438304" position="float">
<label>Figure 9.</label>
<caption>
<p>The function <italic>f</italic> from the state equation. <italic>f</italic> is a function of only <italic>P<sub>bat</sub></italic> when the SOC is fixed, and it is always concave because the equation has a quadratic form.</p>
<p>SOC: state of charge; SC: time derivative of the state of charge.</p>
</caption>
<graphic xlink:href="10.1177_0954407012438304-fig9.tif"/>
</fig>
<p>It is, however, not easy to prove concavity for the SOC, and so we introduce an expository approach to show concavity for the SOC. In general, it is known that the open-circuit voltage increases as the SOC increases, and the internal resistance is generally a convex curve for the SOC, as shown in <xref ref-type="fig" rid="fig10-0954407012438304">Figure 10(a)</xref>.<sup><xref ref-type="bibr" rid="bibr24-0954407012438304">24</xref>,<xref ref-type="bibr" rid="bibr25-0954407012438304">25</xref></sup> The SȮC can be calculated from <xref ref-type="disp-formula" rid="disp-formula22-0954407012438304">equation (22)</xref>, as shown in <xref ref-type="fig" rid="fig10-0954407012438304">Figure 10(b)</xref>. In the figure, the loss from the internal resistance is smaller in the middle range of SOCs than at the extremes because of the convexity of the internal resistance. The concavity of <italic>f</italic> mainly depends on the shape of <italic>R<sub>bat</sub></italic> rather than <italic>V<sub>bat</sub></italic>, and, especially in the low range of SOCs, the resistance increases as the SOC decreases. The higher resistance causes relatively more internal loss than a lower resistance does, which makes <italic>f</italic> concave, as shown in <xref ref-type="fig" rid="fig10-0954407012438304">Figure 10(b)</xref>. The entire shape of the function <italic>f</italic> in the domain set {<italic>P<sub>bat</sub></italic>, SOC} is presented in <xref ref-type="fig" rid="fig11-0954407012438304">Figure 11</xref>, which is produced on the basis of the data for the battery of the 2004 Toyota Prius.</p>
<fig id="fig10-0954407012438304" position="float">
<label>Figure 10.</label>
<caption>
<p>(a) The voltage and resistance according to the SOC; (b) the shape of the state equation <italic>f</italic> when charging the battery with a fixed <italic>P<sub>bat</sub></italic>. If <italic>P<sub>bat</sub></italic> is fixed, <italic>f</italic> can be expressed as a function of the SOC. The concavity can be described based on the internal loss of the battery.</p>
<p>SOC: state of charge; SC: time derivative of the state of charge.</p>
</caption>
<graphic xlink:href="10.1177_0954407012438304-fig10.tif"/>
</fig>
<fig id="fig11-0954407012438304" position="float">
<label>Figure 11.</label>
<caption>
<p>An example of the state equation <italic>f</italic>. This example is obtained from the Prius 04 battery data.</p>
<p>SOC: state of charge; SC: time derivative of the state of charge.</p>
</caption>
<graphic xlink:href="10.1177_0954407012438304-fig11.tif"/>
</fig>
<p>The approach used in <xref ref-type="fig" rid="fig10-0954407012438304">Figure 10</xref> is not related to the direction of the power flow because it is considered when <italic>P<sub>bat</sub></italic> is fixed, and <italic>f</italic> is always concave for <italic>P<sub>bat</sub></italic> even though <italic>R<sub>bat</sub></italic> has a different value for the direction of the power flow; therefore, <italic>f</italic> is still concave even when two different resistance curves are used according to the state of charging or discharging. The concavity of <italic>f</italic> for the SOC becomes a weak condition when the battery resistance is not convex for the SOC, or the model includes very nonlinear submodels such as a temperature model or a transient-current model. It is, however, a well-known fact that the characteristic of the overall efficiency is concave for the SOC, and so the concavity could be considered as a reasonable assumption. We must complete one last step to prove the sufficient conditions for the control idea, which is that the co-state λ is negative. To show that the co-state should be negative, we need to consider the fuel consumption rate <italic>g</italic>. In general, it is physically impossible for either <italic>g</italic> or <italic>f</italic> to have a positive slope for the battery power <italic>P<sub>bat</sub></italic> (see <xref ref-type="fig" rid="fig8-0954407012438304">Figures 8</xref> and <xref ref-type="fig" rid="fig9-0954407012438304">9</xref>). These two unchangeable slopes of <italic>g</italic> and <italic>f</italic> force the co-state λ to have a negative value. If λ is positive, the necessary condition in <xref ref-type="disp-formula" rid="disp-formula5-0954407012438304">equation (5)</xref> always argues for picking up the maximum <italic>P<sub>bat</sub></italic> as an optimal control because the Hamiltonian in <xref ref-type="disp-formula" rid="disp-formula4-0954407012438304">equation (4)</xref> indicates that a higher <italic>P<sub>bat</sub></italic> is always better than a lower <italic>P<sub>bat</sub></italic>, which is not the solution that can satisfy the boundary condition. Further, the co-state equation in <xref ref-type="disp-formula" rid="disp-formula6-0954407012438304">equation (6)</xref> does not allow the co-state to change its sign, and so the co-state always has the same sign, which should be negative.</p>
<p>In accordance with an intuitive concept about <italic>f</italic>, the previous study<sup><xref ref-type="bibr" rid="bibr10-0954407012438304">10</xref></sup> proved that global optimality is guaranteed when the battery dynamics are not affected by the SOC, and so the optimal control could be determined by minimizing the Hamiltonian at the current SOC without any effort to explore the wide range of SOCs that could have been more efficient than the current SOC. In addition to the study, we show that we really do not have to explore the whole range of SOCs as long as the state equation <italic>f</italic> is concave for the SOC, which enables us to apply the control idea safely to PHEVs.<sup><xref ref-type="bibr" rid="bibr26-0954407012438304">26</xref></sup> We think that the results physically mean that the controller does not need to be concerned about the advantage that could be conferred in another state far from the current state when the battery has a concave efficiency function for the SOC; additional information about the control problem compensates for the weakness of the local optimization. In conclusion, the sufficient condition presented in this paper is well described by the real battery characteristics, providing a good fundamental basis for applying the control idea based on PMP to the problem of optimal control of HEV operation.</p>
</sec>
<sec id="section8-0954407012438304">
<title>Unusual case</title>
<p>As stated in the section on global optimality, the solution yielded by PMP could be considered a global solution under the assumptions of the convexity of <italic>g</italic>, the concavity of <italic>f</italic>, and the negativity of λ. Whereas the negativity of λ is a strong condition and the convexity of <italic>g</italic> is a quite natural condition, the concavity of <italic>f</italic> is a weak condition; the concavity condition is absolute for <italic>P<sub>bat</sub></italic>, but not for the SOC. If a battery has unusual characteristics, local optimal solutions could be obtained by PMP-based control. To determine the influence of an unusual battery type, we introduce a battery that has an abnormal internal resistance, as shown in <xref ref-type="fig" rid="fig12-0954407012438304">Figure 12</xref>. In <xref ref-type="fig" rid="fig12-0954407012438304">Figure 12</xref>, the internal resistance curve is manipulated on the basis of the real battery curve of the 2004 Toyota Prius, and so the curve near 0.48 and 0.72 creates domains that are lower than the real data, such that the SȮC is no longer concave. With the manipulated state equation <italic>f</italic>, we solved the control problem by both the DP and the PMP methods for a power-split hybrid vehicle, the 2004 Toyota Prius, on an Urban Dynamometer Driving Schedule. Detailed information about the vehicle is given in <xref ref-type="table" rid="table1-0954407012438304">Table 1</xref>, and the solution is obtained by a backward simulator OC_SIM developed by Seoul National University.<sup><xref ref-type="bibr" rid="bibr27-0954407012438304">27</xref></sup></p>
<fig id="fig12-0954407012438304" position="float">
<label>Figure 12.</label>
<caption>
<p>(a) Unusual internal resistance for charging, in which the curve is distorted from real data, and it has two low internal resistance ranges near 0.48 and 0.72. (b) An example of the SC for the unusual battery when the output power is 5 kW.</p>
<p>SOC: state of charge; SC: time derivative of the state of charge.</p>
</caption>
<graphic xlink:href="10.1177_0954407012438304-fig12.tif"/>
</fig>
<table-wrap id="table1-0954407012438304" position="float">
<label>Table 1.</label>
<caption>
<p>Vehicle parameters applied in the simulation.</p>
</caption>
<graphic alternate-form-of="table1-0954407012438304" xlink:href="10.1177_0954407012438304-table1.tif"/>
<table>
<colgroup>
<col align="left"/>
<col align="left"/>
</colgroup>
<tbody>
<tr>
<td>Vehicle total mass</td>
<td>1405 kg (1 occupant)</td>
</tr>
<tr>
<td>Engine</td>
<td>1497cc Gasoline (Prius04)</td>
</tr>
<tr>
<td>Motor 1</td>
<td>50 kW PMSM (Prius04)</td>
</tr>
<tr>
<td>Motor 2</td>
<td>30 kW PMSM (Prius04)</td>
</tr>
<tr>
<td>Battery</td>
<td>6.5Ah NiMH (Prius04)</td>
</tr>
<tr>
<td>Planetary gear ratio</td>
<td>2.6 (78/30)</td>
</tr>
<tr>
<td>Final gear ratio</td>
<td>4.113</td>
</tr>
<tr>
<td>Transmission gear efficiency</td>
<td>90%</td>
</tr>
<tr>
<td>Rolling resistance coefficient</td>
<td>0.007 + (0.000 12 ×  vehicle velocity)</td>
</tr>
<tr>
<td>Frontal area</td>
<td>2.25 m<sup>2</sup></td>
</tr>
<tr>
<td>Drag coefficient</td>
<td>0.29</td>
</tr>
<tr>
<td>Wheel radius</td>
<td>0.305 m</td>
</tr>
<tr>
<td>Air density</td>
<td>1.23 kg/m<sup>3</sup></td>
</tr>
<tr>
<td>SOC resolution</td>
<td>0.00001</td>
</tr>
<tr>
<td>Engine torque resolution</td>
<td>1 N m</td>
</tr>
<tr>
<td>Engine speed resolution</td>
<td>1 rad/s</td>
</tr>
</tbody>
</table>
<table-wrap-foot>
<fn id="table-fn1-0954407012438304">
<p>SOC: state of charge.</p>
</fn>
</table-wrap-foot>
</table-wrap>
<p>By searching multiple trajectories based on a wider range of co-states, we can obtain three trajectories that satisfy the necessary conditions of PMP, and we find that the unusual resistance causes very different energy management strategies, as shown in <xref ref-type="fig" rid="fig13-0954407012438304">Figure 13</xref>. In <xref ref-type="fig" rid="fig13-0954407012438304">Figure 13</xref>, trajectory 1, trajectory 2, and trajectory 3 are trajectories of SOC starting with three different initial co-states, which satisfy the necessary and boundary conditions of PMP; an additional simulation result solved by DP indicates that trajectory 1 is the global optimal solution to this problem. The three trajectories of the co-states for each solution are shown in <xref ref-type="fig" rid="fig14-0954407012438304">Figure 14</xref>. If we do not manipulate the internal resistance, PMP definitely allows only trajectory 2 as an optimal solution, but trajectory 1 is the optimal solution because the controller desires to operate the battery in an efficient range of SOCs, such as 0.72. The results in <xref ref-type="fig" rid="fig13-0954407012438304">Figures 13</xref> and <xref ref-type="fig" rid="fig14-0954407012438304">14</xref> show that we might achieve a completely different control solution from PMP if the battery has a very unusual characteristic. On the other hand, it is nearly impossible to predict the best control policy prior to the simulation; trajectory 2 or trajectory 3 could be the optimal solution according to the level of the manipulation. It has been considered that we could characterize the energy management strategy on the basis of driving cycles, but the strategy could be dramatically changed by the battery characteristic on a same-cycle profile.</p>
<fig id="fig13-0954407012438304" position="float">
<label>Figure 13.</label>
<caption>
<p>Three different SOC trajectories solved by PMP control. The energy management strategies are different, and trajectory 1 is coincident with the results obtained by DP.</p>
<p>SOC: state of charge; dp: dynamic programming; <italic>Traj. 1</italic>: trajectory 1; <italic>Traj. 2</italic>: trajectory 2; <italic>Traj. 3</italic>: trajectory 3.</p>
</caption>
<graphic xlink:href="10.1177_0954407012438304-fig13.tif"/>
</fig>
<fig id="fig14-0954407012438304" position="float">
<label>Figure 14.</label>
<caption>
<p>Three trajectories of co-states for each PMP solution. Trajectory 2 is the normal solution when the unusual resistance does not exist.</p>
<p>
<italic>Traj. 1</italic>: trajectory 1; <italic>Traj. 2</italic>: trajectory 2; <italic>Traj. 3</italic>: trajectory 3.</p>
</caption>
<graphic xlink:href="10.1177_0954407012438304-fig14.tif"/>
</fig>
<p>Although the energy management strategies of the three trajectories are very different, <xref ref-type="fig" rid="fig15-0954407012438304">Figure 15</xref> and <xref ref-type="table" rid="table2-0954407012438304">Table 2</xref> show that the fuel consumption results for the three control trajectories are not very different, which means that a local optimal solution is still comparable with the global optimal solution in this case. <xref ref-type="table" rid="table2-0954407012438304">Table 2</xref> shows that trajectory 1 has slightly higher fuel economy than the other two control trajectories, and the value is very close to the results of DP.</p>
<fig id="fig15-0954407012438304" position="float">
<label>Figure 15.</label>
<caption>
<p>Integrated fuel consumption trajectories for different co-states. The final fuel consumptions of these three trajectories are almost the same.</p>
<p>
<italic>Traj. 1</italic>: trajectory 1; <italic>Traj. 2</italic>: trajectory 2; <italic>Traj. 3</italic>: trajectory 3.</p>
</caption>
<graphic xlink:href="10.1177_0954407012438304-fig15.tif"/>
</fig>
<table-wrap id="table2-0954407012438304" position="float">
<label>Table 2.</label>
<caption>
<p>Fuel economy of each trajectory.</p>
</caption>
<graphic alternate-form-of="table2-0954407012438304" xlink:href="10.1177_0954407012438304-table2.tif"/>
<table>
<colgroup>
<col align="left"/>
<col align="char" char="."/>
<col align="char" char="."/>
<col align="char" char="."/>
<col align="char" char="."/>
</colgroup>
<thead>
<tr>
<th/>
<th align="left" colspan="4">Value for the following<hr/></th>
</tr>
<tr>
<th/>
<th align="left">DP results</th>
<th align="left">Trajectory 1</th>
<th align="left">Trajectory 2</th>
<th align="left">Trajectory 3</th>
</tr>
</thead>
<tbody>
<tr>
<td>Initial co-state</td>
<td>—</td>
<td>−351.08</td>
<td>−329.63</td>
<td>−302.31</td>
</tr>
<tr>
<td>Fuel economy (km/l)</td>
<td>32.4845</td>
<td>32.4794</td>
<td>32.0636</td>
<td>32.269</td>
</tr>
</tbody>
</table>
<table-wrap-foot>
<fn id="table-fn2-0954407012438304">
<p>DP: dynamic programming.</p>
</fn>
</table-wrap-foot>
</table-wrap>
<p>As stated earlier, if the battery has a normal internal resistance, trajectory 2 should be a unique and global optimal solution, and the co-state of trajectory 2 would vary within 1% for the whole driving cycle, which is the conclusion reached in our earlier study.<sup><xref ref-type="bibr" rid="bibr10-0954407012438304">10</xref></sup> Although trajectory 1 shows the best performance in our case, it is, unfortunately, not a desirable solution in the context of PMP because it is very difficult to predict the initial co-state on the basis of the profile information, whereas the co-state for trajectory 2 could be approximated on the basis of the driving patterns.<sup><xref ref-type="bibr" rid="bibr11-0954407012438304">11</xref></sup> In conclusion, PMP-based control could produce alternative solutions, or it is very hard to manage the optimal co-state if the battery efficiency is not a concave function of the SOC.</p>
</sec>
</sec>
<sec id="section9-0954407012438304" sec-type="conclusions">
<title>Conclusion</title>
<p>PMP produces only the conditions necessary for an optimal solution. However, it can be sufficient conditions for a global optimal solution when the problem gives us additional information about the system’s behaviors. In this paper, we show that the case of the optimal control for HEVs has fulfilled this expectation. When the fuel consumption rate <italic><sub>fc</sub></italic> is a convex function of <italic>P<sub>bat</sub></italic>, and the time derivative SȮC of the SOC is a concave function of <italic>P<sub>bat</sub></italic> and the SOC, the control idea based on PMP always generates a global optimal solution. We showed that the convexity and the concavity are quite natural characteristics of the control problem for HEVs. On the basis of this conclusion, we can expand the application of the control concept from HEVs to PHEVs, whereas the previous study<sup><xref ref-type="bibr" rid="bibr10-0954407012438304">10</xref></sup> limited the application of this concept to HEVs that use small ranges of SOCs because the assumption in the study did not guarantee optimality over wide ranges of SOCs. Additionally, we simulated the vehicle with a battery that does not have a concave function for the SȮC, and the results show that PMP-based control could produce alternative solutions with the unusual battery. In those alternatives, the energy management strategies could be very different even for the same driving cycle. Although PMP control could be a global optimal solution, we cannot determine the optimal co-state without information about future conditions. Nevertheless, the beauty of PMP is that unpredictable and complicated information applicable to future situations could be implied by the co-state, which is the only parameter that we need to consider for optimality. Because the control concept based on PMP already provides an optimized form of control through the Hamiltonian, it is very efficient to archive the optimality (or, at least, it is not easy to fall into inefficient control). Although the problem of connecting future information to the co-state still remains unsolved, the PMP control concept should be considered to be a promising solution for problems that need to be addressed in both simulations and the real world.</p>
</sec>
</body>
<back>
<fn-group>
<fn fn-type="financial-disclosure">
<label>Funding</label>
<p>This research received no specific grant from any funding agency in the public, commercial, or not-for-profit sectors.</p>
</fn>
</fn-group>
<ref-list>
<title>References</title>
<ref id="bibr1-0954407012438304">
<label>1.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Paganelli</surname><given-names>G</given-names></name>
<name><surname>Ercole</surname><given-names>G</given-names></name>
<name><surname>Brahma</surname><given-names>A</given-names></name><etal/>
</person-group>. <article-title>General supervisory control policy for the energy optimization of charge-sustaining hybrid electric vehicles</article-title>. <source>JSAE Rev</source> <year>2001</year>; <volume>22</volume>(<issue>4</issue>): <fpage>511</fpage>–<lpage>518</lpage>.</citation>
</ref>
<ref id="bibr2-0954407012438304">
<label>2.</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Paganelli</surname><given-names>G</given-names></name>
<name><surname>Delprat</surname><given-names>S</given-names></name>
<name><surname>Guerra</surname><given-names>TM</given-names></name>
<etal/>
</person-group>. <article-title>Equivalent consumption minimization strategy for parallel hybrid powertrains</article-title>. In: <conf-name>IEEE semiannual vehicular technology conference</conf-name>, <conf-loc>Birmingham, AL, USA</conf-loc>, <conf-date>6–9 May 2002</conf-date>, pp.<fpage>2076</fpage>–<lpage>2081</lpage>. <publisher-loc>New York</publisher-loc>: <publisher-name>IEEE</publisher-name>.</citation>
</ref>
<ref id="bibr3-0954407012438304">
<label>3.</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Pisu</surname><given-names>P</given-names></name>
<name><surname>Rizzoni</surname><given-names>G</given-names></name>
</person-group>. <article-title>A supervisory control strategy for series hybrid electric vehicles with two energy storage systems</article-title>. In: <conf-name>IEEE vehicle power and propulsion conference</conf-name>, <conf-loc>Chicago, IL, USA</conf-loc>, <conf-date>7–9 September 2005</conf-date>, pp.<fpage>65</fpage>–<lpage>72</lpage>. <publisher-loc>New York</publisher-loc>: <publisher-name>IEEE</publisher-name>.</citation>
</ref>
<ref id="bibr4-0954407012438304">
<label>4.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Pisu</surname><given-names>P</given-names></name>
<name><surname>Rizzoni</surname><given-names>G</given-names></name>
</person-group>. <article-title>A Comparative study of supervisory control strategies for hybrid electric vehicles</article-title>. <source>IEEE Trans Control Systems Technol</source> <year>2007</year>; <volume>15</volume>(<issue>3</issue>): <fpage>506</fpage>–<lpage>518</lpage>.</citation>
</ref>
<ref id="bibr5-0954407012438304">
<label>5.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Sciarretta</surname><given-names>A</given-names></name>
<name><surname>Guzzella</surname><given-names>L</given-names></name>
</person-group>. <article-title>Control of hybrid electric vehicles</article-title>. <source>IEEE Control Systems Mag</source> <year>2007</year>; <volume>27</volume>(<issue>2</issue>): <fpage>60</fpage>–<lpage>70</lpage>.</citation>
</ref>
<ref id="bibr6-0954407012438304">
<label>6.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Salmasi</surname><given-names>FR</given-names></name>
</person-group>. <article-title>Control strategies for hybrid electric vehicle: evolution, classification, comparison</article-title>. <source>IEEE Trans Veh Technol</source> <year>2007</year>; <volume>56</volume>(<issue>5</issue>): <fpage>2393</fpage>–<lpage>2404</lpage>.</citation>
</ref>
<ref id="bibr7-0954407012438304">
<label>7.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Serrao</surname><given-names>L</given-names></name>
<name><surname>Onori</surname><given-names>S</given-names></name>
<name><surname>Rizzoni</surname><given-names>G</given-names></name>
</person-group>. <article-title>A comparative analysis of energy management strategies for hybrid electric vehicles</article-title>. <source>Trans ASME, J Dynamic Systems, Measmt, Control</source> <year>2011</year>; <volume>133</volume>(<issue>3</issue>): <fpage>031012</fpage>.</citation>
</ref>
<ref id="bibr8-0954407012438304">
<label>8.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Delprat</surname><given-names>S</given-names></name>
<name><surname>Lauber</surname><given-names>J</given-names></name>
<name><surname>Marie</surname><given-names>T</given-names></name>
<name><surname>Rimaux</surname><given-names>J</given-names></name>
</person-group>. <article-title>Control of a parallel hybrid powertrain: optimal control</article-title>. <source>IEEE Trans Veh Technol 004</source>; <volume>53</volume>(<issue>3</issue>): <fpage>872</fpage>–<lpage>881</lpage>.</citation>
</ref>
<ref id="bibr9-0954407012438304">
<label>9.</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Serrao</surname><given-names>L</given-names></name>
<name><surname>Onori</surname><given-names>S</given-names></name>
<name><surname>Rizzoni</surname><given-names>G</given-names></name>
</person-group>. <article-title>ECMS as a realization of Pontryagin’s minimum principle for HEV control</article-title>. In: <conf-name>2009 American control conference</conf-name>, <conf-loc>St Louis, MO, USA</conf-loc>, <conf-date>10–12 June 2009</conf-date>, pp.<fpage>3964</fpage>–<lpage>3969</lpage>. <publisher-loc>New York</publisher-loc>: <publisher-name>IEEE</publisher-name>.</citation>
</ref>
<ref id="bibr10-0954407012438304">
<label>10.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Kim</surname><given-names>N</given-names></name>
<name><surname>Cha</surname><given-names>S</given-names></name>
<name><surname>Peng</surname><given-names>H</given-names></name>
</person-group>. <article-title>Optimal control of hybrid electric vehicles based on Pontryagin’s minimum principle</article-title>. <source>IEEE Trans Control Systems Technol</source> <year>2011</year>; <volume>19</volume>(<issue>5</issue>): <fpage>1279</fpage>–<lpage>1287</lpage>.</citation>
</ref>
<ref id="bibr11-0954407012438304">
<label>11.</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Ahn</surname><given-names>K</given-names></name>
<name><surname>Cho</surname><given-names>S</given-names></name>
<name><surname>Park</surname><given-names>YI</given-names></name>
<name><surname>Lee</surname><given-names>JM</given-names></name>
</person-group>. <article-title>Optimal sizing of HEV power sources using optimal control simulations</article-title>. In: <conf-name>21st international battery, hybrid and fuel cell electric vehicle symposium and exhibition</conf-name>, <conf-loc>Monte Carlo, Monaco</conf-loc>, <conf-date>2–6 April 2005</conf-date>, pp.<fpage>1</fpage>–<lpage>8</lpage>.</citation>
</ref>
<ref id="bibr12-0954407012438304">
<label>12.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Kim</surname><given-names>N</given-names></name>
<name><surname>Cha</surname><given-names>S</given-names></name>
<name><surname>Peng</surname><given-names>H</given-names></name>
</person-group>. <article-title>Optimal equivalent fuel consumption for hybrid electric vehicles</article-title>. <source>IEEE Trans Control Systems Technol</source> <year>2012</year> (<comment>in press</comment>). DOI: 10.1109/TCST.2011.2123099<pub-id pub-id-type="doi">10.1109/TCST.2011.2123099</pub-id>.</citation>
</ref>
<ref id="bibr13-0954407012438304">
<label>13.</label>
<citation citation-type="book">
<person-group person-group-type="author">
<name><surname>Kirk</surname><given-names>DE</given-names></name>
</person-group>. <source>Optimal control theory: an introduction</source>. <publisher-loc>Engelwood Cliffs, NJ</publisher-loc>: <publisher-name>Prentice-Hall</publisher-name>, <year>1970</year>, p.<fpage>233</fpage>.</citation>
</ref>
<ref id="bibr14-0954407012438304">
<label>14.</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Lin</surname><given-names>CC</given-names></name>
<name><surname>Peng</surname><given-names>H</given-names></name>
<name><surname>Grizzle</surname><given-names>JW</given-names></name>
</person-group>. <article-title>A stochastic control strategy for hybrid electric vehicles</article-title>. In: <conf-name>2004 American control conference</conf-name>, <conf-loc>Boston, MA, USA</conf-loc>, <year>2004</year>, pp.<fpage>4710</fpage>–<lpage>4715</lpage>. <publisher-loc>New York</publisher-loc>: <publisher-name>IEEE</publisher-name>.</citation>
</ref>
<ref id="bibr15-0954407012438304">
<label>15.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Lin</surname><given-names>CC</given-names></name>
<name><surname>Peng</surname><given-names>H</given-names></name>
<name><surname>Grizzle</surname><given-names>JW</given-names></name>
<name><surname>Kang</surname><given-names>J</given-names></name>
</person-group>. <article-title>Power management strategy for a parallel hybrid electric truck</article-title>. <source>IEEE Trans Control Systems Technol</source> <year>2003</year>; <volume>11</volume>(<issue>6</issue>): <fpage>839</fpage>–<lpage>849</lpage>.</citation>
</ref>
<ref id="bibr16-0954407012438304">
<label>16.</label>
<citation citation-type="book">
<person-group person-group-type="author">
<name><surname>Guzzella</surname><given-names>L</given-names></name>
<name><surname>Sciarretta</surname><given-names>A</given-names></name>
</person-group>. <source>Vehicle propulsion systems. Introduction to modeling and optimization</source>. <publisher-loc>Berlin</publisher-loc>: <publisher-name>Springer</publisher-name>, <year>2005</year>, pp.<fpage>201</fpage>–<lpage>204</lpage>.</citation>
</ref>
<ref id="bibr17-0954407012438304">
<label>17.</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Musardo</surname><given-names>C</given-names></name>
<name><surname>Rizzoni</surname><given-names>G</given-names></name>
<name><surname>Staccia</surname><given-names>B</given-names></name>
</person-group>. <article-title>A-ECMS: an adaptive algorithm for hybrid electric vehicle energy management</article-title>. In: <conf-name>44th IEEE conference on decision control and 2005 European control conference</conf-name>, <conf-loc>Seville, Spain</conf-loc>, <conf-date>12–15 December 2005</conf-date>, pp.<fpage>1816</fpage>–<lpage>1823</lpage>. <publisher-loc>New York</publisher-loc>: <publisher-name>IEEE</publisher-name>.</citation>
</ref>
<ref id="bibr18-0954407012438304">
<label>18.</label>
<citation citation-type="other">
<person-group person-group-type="author">
<name><surname>Kim</surname><given-names>N</given-names></name>
<name><surname>Rousseau</surname><given-names>A</given-names></name>
</person-group>. <article-title>Comparison between rule-based and instantaneous optimization for a single-mode, power-split HEV</article-title>. <comment>SAE paper 2011-01-0873</comment>, <year>2011</year>.</citation>
</ref>
<ref id="bibr19-0954407012438304">
<label>19.</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Chasse</surname><given-names>A</given-names></name>
<name><surname>Corde</surname><given-names>G</given-names></name>
<name><surname>Mastro</surname><given-names>AD</given-names></name>
<name><surname>Perez</surname><given-names>F</given-names></name>
</person-group>. <article-title>Online optimal control of a parallel hybrid with after-treatment constraint integration</article-title>. In: <conf-name>2010 IEEE vehicle power and propulsion conference</conf-name>, <conf-loc>Lille, France</conf-loc>, <conf-date>1–3 September 2010</conf-date>, pp.<fpage>1</fpage>–<lpage>6</lpage>. <publisher-loc>New York</publisher-loc>: <publisher-name>IEEE</publisher-name>.</citation>
</ref>
<ref id="bibr20-0954407012438304">
<label>20.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Kessels</surname><given-names>J</given-names></name>
<name><surname>Koot</surname><given-names>M</given-names></name>
<name><surname>van den Bosch</surname><given-names>P</given-names></name>
<name><surname>Kok</surname><given-names>D</given-names></name>
</person-group>. <article-title>Online energy management for hybrid electric vehicles</article-title>. <source>IEEE Trans Veh Technol</source> <year>2008</year>; <volume>57</volume>(<issue>6</issue>): <fpage>3428</fpage>–<lpage>3440</lpage>.</citation>
</ref>
<ref id="bibr21-0954407012438304">
<label>21.</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Onori</surname><given-names>S</given-names></name>
<name><surname>Serrao</surname><given-names>L</given-names></name>
<name><surname>Rizzoni</surname><given-names>G</given-names></name>
</person-group>. <article-title>Adaptive equivalent consumption minimization strategy for hybrid electric vehicles</article-title>. In: <conf-name>ASME 3rd annual dynamic systems and control conference</conf-name>, <conf-loc>Cambridge, MA, USA</conf-loc>, <conf-date>13–15 September 2010</conf-date>, <comment>paper TuAT5.2</comment>. <publisher-loc>New York</publisher-loc>: <publisher-name>ASME</publisher-name>.</citation>
</ref>
<ref id="bibr22-0954407012438304">
<label>22.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Mangasarian</surname><given-names>OL</given-names></name>
</person-group>. <article-title>Sufficient conditions for the optimal control of nonlinear systems</article-title>. <source>J SIAM Control</source> <year>1966</year>; <volume>4</volume>(<issue>1</issue>): <fpage>139</fpage>–<lpage>152</lpage>.</citation>
</ref>
<ref id="bibr23-0954407012438304">
<label>23.</label>
<citation citation-type="book">
<person-group person-group-type="author">
<name><surname>Kirk</surname><given-names>DE</given-names></name>
</person-group>. <source>Optimal control theory: an introduction</source>. <publisher-loc>Engelwood Cliffs, NJ</publisher-loc>: <publisher-name>Prentice-Hall</publisher-name>, <year>1970</year>, p.<fpage>229</fpage>.</citation>
</ref>
<ref id="bibr24-0954407012438304">
<label>24.</label>
<citation citation-type="book">
<person-group person-group-type="author">
<name><surname>Emadi</surname><given-names>A</given-names></name>
</person-group>. <source>Handbook of automotive power electronics and motor drives</source>. <publisher-loc>London</publisher-loc>: <publisher-name>Taylor &amp; Francis</publisher-name>, <year>2005</year>, pp.<fpage>602</fpage>–<lpage>604</lpage>.</citation>
</ref>
<ref id="bibr25-0954407012438304">
<label>25.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Johnson</surname><given-names>VH</given-names></name>
</person-group>. <article-title>Battery performance models in ADVISOR</article-title>. <source>J Power Sources</source> <year>2002</year>; <volume>110</volume>(<issue>2</issue>): <fpage>321</fpage>–<lpage>329</lpage>.</citation>
</ref>
<ref id="bibr26-0954407012438304">
<label>26.</label>
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Kim</surname><given-names>N</given-names></name>
<name><surname>Rousseau</surname><given-names>A</given-names></name>
<name><surname>Lee</surname><given-names>D</given-names></name>
</person-group>. <article-title>A jump condition of PMP-based control for HEVs</article-title>. <source>J Power Sources</source> <year>2011</year>; <volume>196</volume>(<issue>23</issue>): <fpage>10 380</fpage>–<lpage>10 386</lpage>.</citation>
</ref>
<ref id="bibr27-0954407012438304">
<label>27.</label>
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Kim</surname><given-names>N</given-names></name>
<name><surname>Lee</surname><given-names>D</given-names></name>
<name><surname>Cha</surname><given-names>S</given-names></name>
<name><surname>Peng</surname><given-names>H</given-names></name>
</person-group>. <article-title>Optimal control of a plug-in hybrid electric vehicle based on driving patterns</article-title>. In: <conf-name>24th international battery, hybrid and fuel cell electric vehicle symposium</conf-name>, <conf-loc>Stavanger, Norway</conf-loc>, <conf-date>13–16 May 2009</conf-date>, pp.<fpage>1</fpage>–<lpage>9</lpage>.</citation>
</ref>
</ref-list>
</back>
</article>