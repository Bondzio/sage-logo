<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v2.3 20070202//EN" "journalpublishing.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">TIM</journal-id>
<journal-id journal-id-type="hwp">sptim</journal-id>
<journal-title>Transactions of the Institute of Measurement and Control</journal-title>
<issn pub-type="ppub">0142-3312</issn>
<issn pub-type="epub">1477-0369</issn>
<publisher>
<publisher-name>SAGE Publications</publisher-name>
<publisher-loc>Sage UK: London, England</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1177/0142331212439598</article-id>
<article-id pub-id-type="publisher-id">10.1177_0142331212439598</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Articles</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Improving IEC flickermeter for implementation by an ARM microcontroller-based digital system</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<name><surname>Moallem</surname><given-names>Payman</given-names></name>
<xref ref-type="aff" rid="aff1-0142331212439598">1</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Zargari</surname><given-names>Abalfazl</given-names></name>
<xref ref-type="aff" rid="aff2-0142331212439598">2</xref>
</contrib>
<contrib contrib-type="author">
<name><surname>Kiyoumarsi</surname><given-names>Arash</given-names></name>
<xref ref-type="aff" rid="aff1-0142331212439598">1</xref>
</contrib>
</contrib-group>
<aff id="aff1-0142331212439598"><label>1</label>Department of Electrical Engineering, University of Isfahan, Isfahan, Iran</aff>
<aff id="aff2-0142331212439598"><label>2</label>Department of Electrical Engineering, Majlesi Branch, Islamic Azad University, Isfahan, Iran</aff>
<author-notes>
<corresp id="corresp1-0142331212439598">Payman Moallem, Department of Electrical Engineering, University of Isfahan, Hezarjerib Street, Isfahan, 81746, Iran. Email: <email>p_moallem@eng.ui.ac.ir</email>.</corresp>
</author-notes>
<pub-date pub-type="epub-ppub">
<month>5</month>
<year>2013</year>
</pub-date>
<volume>35</volume>
<issue>3</issue>
<fpage>342</fpage>
<lpage>352</lpage>
<permissions>
<copyright-statement>© The Author(s) 2012</copyright-statement>
<copyright-year>2012</copyright-year>
<copyright-holder content-type="sage">SAGE Publications</copyright-holder>
</permissions>
<abstract>
<p>The IEC 61000-4-15 flickermeter has been widely accepted as an international standard for flicker severity measurement. In this paper, the implementation of an improved IEC flickermeter by an ARM microcontroller-based digital system with low cost and simple proposed prototype hardware is presented. The improvements include replacing a band-pass filter with a more appropriate filter and considering the model of various lamps. The operation of the improved flickermeter is evaluated in a simulated power system in Simulink of MATLAB software with its flicker source an arc furnace. Finally, a manipulated hardware for implementation of the improved flickermeter is proposed based on ARM microcontroller, and its performance is evaluated with some real-time experimental measurements.</p>
</abstract>
<kwd-group>
<kwd>Arc furnace</kwd>
<kwd>ARM microcontroller</kwd>
<kwd>IEC flickermeter</kwd>
<kwd>power quality</kwd>
<kwd>voltage flicker</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="section1-0142331212439598" sec-type="intro">
<title>Introduction</title>
<p>The voltage fluctuation that makes a light flicker is termed as voltage flicker (<xref ref-type="bibr" rid="bibr6-0142331212439598">Girgis et al., 1995</xref>; <xref ref-type="bibr" rid="bibr18-0142331212439598">Xu, 2005</xref>). Light flicker is defined as the impression of fluctuating brightness or colour. Whether the human eye detects flicker at this frequency or not depends on several situations, including light fixture, intensity, time variation, age, eye condition, emotional state and adaptation to background light (<xref ref-type="bibr" rid="bibr3-0142331212439598">Emanuel and Peretto, 2004</xref>).</p>
<p>The methods of measurement of the calculation of the severity of flicker allow utilities to estimate impacts on end-users and power systems. They would also provide information in selecting an appropriate flicker mitigation technique. In the last decade, many researchers have been involved in studies related to flicker measurement (<xref ref-type="bibr" rid="bibr1-0142331212439598">Arsenau et al., 2002</xref>; <xref ref-type="bibr" rid="bibr8-0142331212439598">Huang and Lu, 2004</xref>; <xref ref-type="bibr" rid="bibr10-0142331212439598">Keppler et al., 2000</xref>; <xref ref-type="bibr" rid="bibr15-0142331212439598">Peretto et al., 2006</xref>, <xref ref-type="bibr" rid="bibr13-0142331212439598">2007a</xref>, <xref ref-type="bibr" rid="bibr14-0142331212439598">2007b</xref>; <xref ref-type="bibr" rid="bibr17-0142331212439598">Wang and Devaney, 2004</xref>). As far as flicker measurement is concerned, attention has been focused on digital implementation (<xref ref-type="bibr" rid="bibr14-0142331212439598">Peretto et al., 2007b</xref>) of the standard flickermeter (<xref ref-type="bibr" rid="bibr4-0142331212439598">EN 61000-4-15, 1997</xref>), calibration systems (<xref ref-type="bibr" rid="bibr18-0142331212439598">Xu, 2005</xref>) or development of improved flickermeters (<xref ref-type="bibr" rid="bibr8-0142331212439598">Huang and Lu, 2004</xref>; <xref ref-type="bibr" rid="bibr10-0142331212439598">Keppler et al., 2000</xref>; <xref ref-type="bibr" rid="bibr17-0142331212439598">Wang and Devaney, 2004</xref>). The IEC 61000-4-15 flickermeter has been widely accepted as an international standard for flicker severity measurement (<xref ref-type="bibr" rid="bibr9-0142331212439598">IEC 61000-4-15, 2003</xref>).</p>
<p>In this paper, an improved flickermeter based on the IEC standard flickermeter is proposed and its improvements are evaluated. The improved flickermeter is also implemented by an ARM microcontroller-based digital system with low cost and the simple prototype hardware proposed. First, a brief description of the IEC flickermeter is presented. Then, the implementation of the IEC flickermeter in a discrete-time domain and some improvements are discussed. The improvements are replacing the band-pass filter with a more appropriate filter and considering the model of various lamps. Its operation and the flicker effect on various lamps is evaluated in a simulated system that has an arc furnace as its flicker source. Finally, the proposed flickermeter is implemented by an ARM microcontroller-based digital system and its operation is evaluated with real-time measurements. The prototype hardware of the improved flickermeter is comprehensively described. Lastly, the whole structure of the paper is reviewed as a conclusion.</p>
</sec>
<sec id="section2-0142331212439598">
<title>IEC flickermeter</title>
<p>According to standard IEC61000-4-15, voltage flickers should be measured by an IEC flickermeter (<xref ref-type="bibr" rid="bibr9-0142331212439598">IEC 61000-4-15, 2003</xref>). This is originally a signal processing unit. Based on the lamp–eye–brain response, the IEC flickermeter consists of three parts: a demodulator, a weighting filter and a statistical analysis unit. This instrument receives crude voltage signals as inputs and puts flicker intensity indices, <italic>P</italic><sub>st</sub> (short-term flicker level) and <italic>P</italic><sub>lt</sub> (long-term flicker level), in its output. In this section, the algorithm and content of IEC flickermeter is described. <xref ref-type="fig" rid="fig1-0142331212439598">Figure 1</xref> shows the IEC flickermeter block diagram.</p>
<fig id="fig1-0142331212439598" position="float">
<label>Figure 1</label>
<caption>
<p>Block diagram of IEC flickermeter.</p>
</caption>
<graphic xlink:href="10.1177_0142331212439598-fig1.tif"/>
</fig>
<p>Different parts of this processor can be summarized as follows (<xref ref-type="bibr" rid="bibr9-0142331212439598">IEC 61000-4-15, 2003</xref>):</p>
<list id="list1-0142331212439598" list-type="bullet">
<list-item><p><italic>Block 1</italic>: This block consists of a voltage adapting circuit that scales the mean r.m.s value of the input main frequency voltage down to an internal level.</p></list-item>
<list-item><p><italic>Block 2</italic>: This block contains a squaring demodulator. It simulates the lamp behaviour in facing its input voltage.</p></list-item>
<list-item><p><italic>Blocks 3 and 4</italic>: These blocks contain weighting filters. Block 3 simulates an eye model. The first filter eliminates the DC and second harmonic ripple components of the demodulator output until just a flicker component remains. This filter has 0.05-Hz cut-off frequency at low frequencies and a 35-Hz cut-off at high frequencies for a 50-Hz based system.</p></list-item>
</list>
<p>The second filter is a weighting filter block that simulates the frequency response to the sinusoidal voltage fluctuations of a coiled filament gas-filled lamp (60 W/230 V/50 Hz) combined with the human visual system. The transfer function for this filter is as follows:</p>
<p>
<disp-formula id="disp-formula1-0142331212439598">
<label>(1)</label>
<mml:math display="block" id="math1-0142331212439598">
<mml:mrow>
<mml:mi>F</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>s</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mi>k</mml:mi>
<mml:mspace width="0.25em"/>
<mml:mi>ω</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mspace width="0.25em"/>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.25em"/>
<mml:mi>s</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mi>s</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msup>
<mml:mo>+</mml:mo>
<mml:mn>2</mml:mn>
<mml:mspace width="0.25em"/>
<mml:mi>λ</mml:mi>
<mml:mspace width="0.25em"/>
<mml:mi>s</mml:mi>
<mml:mo>+</mml:mo>
<mml:mi>ω</mml:mi>
<mml:msubsup>
<mml:mrow>
<mml:mspace width="0.25em"/>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msubsup>
</mml:mrow>
</mml:mfrac>
<mml:mo>×</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>+</mml:mo>
<mml:mi>s</mml:mi>
<mml:mo stretchy="false">/</mml:mo>
<mml:mi>ω</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mspace width="0.25em"/>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:mo stretchy="false">(</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>+</mml:mo>
<mml:mi>s</mml:mi>
<mml:mo stretchy="false">/</mml:mo>
<mml:mi>ω</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mspace width="0.25em"/>
</mml:mrow>
<mml:mrow>
<mml:mn>3</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:mspace width="0.25em"/>
<mml:mo stretchy="false">(</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>+</mml:mo>
<mml:mi>s</mml:mi>
<mml:mo stretchy="false">/</mml:mo>
<mml:mi>ω</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mspace width="0.25em"/>
</mml:mrow>
<mml:mrow>
<mml:mn>4</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula1-0142331212439598" xlink:href="10.1177_0142331212439598-eq1.tif"/>
</disp-formula>
</p>
<p>for which the indicative values for the parameters are listed below:</p>
<p>
<disp-formula id="disp-formula2-0142331212439598">
<mml:math display="block" id="math2-0142331212439598">
<mml:mrow>
<mml:mtable align="left">
<mml:mtr>
<mml:mtd columnalign="left">
<mml:mrow>
<mml:mtext>k</mml:mtext>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>748</mml:mn>
</mml:mrow>
</mml:mtd>
<mml:mtd columnalign="left">
<mml:mrow><mml:mi>λ</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>25</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>508</mml:mn>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="left" columnspan="1">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>ω</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mn>57</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>522</mml:mn>
<mml:mspace width="0.25em"/>
<mml:mtext>rad</mml:mtext>
<mml:mo stretchy="false">/</mml:mo>
<mml:mtext>s</mml:mtext>
</mml:mrow>
</mml:mtd>
<mml:mtd columnalign="left">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>ω</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mn>14</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>319</mml:mn>
<mml:mspace width="0.25em"/>
<mml:mspace width="0.25em"/>
<mml:mtext>rad</mml:mtext>
<mml:mo stretchy="false">/</mml:mo>
<mml:mtext>s</mml:mtext>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="left" columnspan="1">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>ω</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>3</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mn>7</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>7</mml:mn>
<mml:mspace width="0.25em"/>
<mml:mtext>rad</mml:mtext>
<mml:mo stretchy="false">/</mml:mo>
<mml:mtext>s</mml:mtext>
</mml:mrow>
</mml:mtd>
<mml:mtd columnalign="left">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>ω</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>4</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mn>137</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>6</mml:mn>
<mml:mspace width="0.25em"/>
<mml:mtext>rad</mml:mtext>
<mml:mo stretchy="false">/</mml:mo>
<mml:mtext>s</mml:mtext>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula2-0142331212439598" xlink:href="10.1177_0142331212439598-eq2.tif"/>
</disp-formula>
</p>
<p>It should be noted that another type of filament lamp (60 W/120 V/60 Hz) is also referenced in standard IEC61000-4-15. The characteristics of this lamp are totally different, and substantial modifications would be necessary if this was taken into account.</p>
<list id="list2-0142331212439598" list-type="bullet">
<list-item><p><italic>Blocks 5 and 6</italic>: These blocks simulate the brain’s behaviour against the lamp’s flicker. They consist of a squaring and a low-pass filter with transfer function <italic>H</italic><sub>b</sub>:</p></list-item>
</list>
<p>
<disp-formula id="disp-formula3-0142331212439598">
<label>(2)</label>
<mml:math display="block" id="math3-0142331212439598">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>H</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>b</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>s</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>K</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>b</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>+</mml:mo>
<mml:mi>s</mml:mi>
<mml:mspace width="0.25em"/>
<mml:msub>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>b</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula3-0142331212439598" xlink:href="10.1177_0142331212439598-eq3.tif"/>
</disp-formula>
</p>
<p>where <italic>K</italic><sub>b</sub>=1 and <italic>T</italic><sub>b</sub>=300 ms. Squaring simulates the brain’s non-linear behaviour and the low-pass filter simulates the memory’s effect. This block’s output presents an instantaneous flicker level (IFL). If the output is higher than 1, the lamp’s flicker will be observable and if it is less than 1, the flicker will be unobservable, but it does not mean whether flicker has been annoyance. For a proper evaluation, statistical processing in a specific period is needed in the next block.</p>
<list id="list3-0142331212439598" list-type="bullet">
<list-item><p><italic>Block 7</italic>: In this block, statistical analysis will be carried out on the samples of the previous block to determine the annoyance level.</p></list-item>
</list>
<p>All samples are classified based on their size at the distance between the smallest and largest ones. Each sample, which is more than a specific class level, will be set in that class. So there are <italic>n</italic><sub>l</sub> samples in each class. The cumulative probability function (CPF) of each class will be calculated as in <xref ref-type="disp-formula" rid="disp-formula4-0142331212439598">Equation (3)</xref>:</p>
<p>
<disp-formula id="disp-formula4-0142331212439598">
<label>(3)</label>
<mml:math display="block" id="math4-0142331212439598">
<mml:mrow>
<mml:mi>pl</mml:mi>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mi>nl</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>N</mml:mi>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula4-0142331212439598" xlink:href="10.1177_0142331212439598-eq4.tif"/>
</disp-formula>
</p>
<p>where <italic>N</italic> is the number of whole samples. The CPF graph, which shows the statistical distribution of 64 classes, has a configuration such as in <xref ref-type="fig" rid="fig2-0142331212439598">Figure 2</xref>.</p>
<fig id="fig2-0142331212439598" position="float">
<label>Figure 2</label>
<caption>
<p>An example of the cumulative probability function (CPF) with 64 level classes.</p>
</caption>
<graphic xlink:href="10.1177_0142331212439598-fig2.tif"/>
</fig>
<p>In order to increase the accuracy, linear or non-linear interpolation methods for finding other points of this graph can be used. After achieving a CPF graph, the intensity indices of the flicker, <italic>P</italic><sub>st</sub> and <italic>P</italic><sub>lt</sub>, will be computed.</p>
<p>The <italic>P</italic><sub>st</sub> index is defined as a flicker’s intensity index in a short time of about 10 min and is calculated by <xref ref-type="disp-formula" rid="disp-formula5-0142331212439598">Equation (4)</xref>:</p>
<p>
<disp-formula id="disp-formula5-0142331212439598">
<label>(4)</label>
<mml:math display="block" id="math5-0142331212439598">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>p</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>st</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:msqrt>
<mml:mrow>
<mml:munderover>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>n</mml:mi>
</mml:mrow>
</mml:munderover>
<mml:msub>
<mml:mrow>
<mml:mi>K</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>i</mml:mi>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mrow>
<mml:mi>P</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>i</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:msqrt>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula5-0142331212439598" xlink:href="10.1177_0142331212439598-eq5.tif"/>
</disp-formula>
</p>
<p>where <italic>P</italic><sub>i</sub> is the flicker level exceeded during a particular percentage of the 10-min observation period, and <italic>K</italic><sub>i</sub> is the corresponding weighting coefficient. The exceeding flicker level can be found from the CPF as <xref ref-type="disp-formula" rid="disp-formula6-0142331212439598">equation 5</xref>:</p>
<p>
<disp-formula id="disp-formula6-0142331212439598">
<label>(5)</label>
<mml:math display="block" id="math6-0142331212439598">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>p</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>i</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mi>CPF</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mspace width="0.25em"/>
<mml:msub>
<mml:mrow>
<mml:mi>η</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>i</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.25em"/>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula6-0142331212439598" xlink:href="10.1177_0142331212439598-eq6.tif"/>
</disp-formula>
</p>
<p>In which <italic>η</italic><sub>i</sub> is a particular percentage of the observation period.</p>
<p>The <italic>P</italic><sub>lt</sub> index presents the flicker intensity over a long period, about 2 hours, which can be computed by <italic>P</italic><sub>st</sub> amounts as follows:</p>
<p>
<disp-formula id="disp-formula7-0142331212439598">
<label>(6)</label>
<mml:math display="block" id="math7-0142331212439598">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>P</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>lt</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mspace width="0.25em"/>
<mml:mo>=</mml:mo>
<mml:mspace width="0.25em"/>
<mml:mroot>
<mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:mspace width="0.25em"/>
<mml:munderover>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>N</mml:mi>
</mml:mrow>
</mml:munderover>
<mml:msubsup>
<mml:mrow>
<mml:mi>P</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>sti</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>3</mml:mn>
</mml:mrow>
</mml:msubsup>
</mml:mrow>
<mml:mrow>
<mml:mi>N</mml:mi>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
<mml:mrow>
<mml:mn>3</mml:mn>
</mml:mrow>
</mml:mroot>
<mml:mspace width="0.25em"/>
<mml:mo>,</mml:mo>
<mml:mspace width="0.25em"/>
<mml:mi>N</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>12</mml:mn>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula7-0142331212439598" xlink:href="10.1177_0142331212439598-eq7.tif"/>
</disp-formula>
</p>
<p>Finally, according to the obtained index, the annoyance level is determined.</p>
</sec>
<sec id="section3-0142331212439598">
<title>Improvements and considerations on the IEC flickermeter</title>
<p>In this section, some improvements to the standard IEC flickermeter are proposed. These improvements are: replacing band-pass filter in block 3 by a more appropriate filter, and considering the model of the various lamps in block 4. Moreover, in order to implement the improved flickermeter in the discrete-time domain and in the proposed digital system, some considerations are discussed here. It should be noted that the sampling frequency is considered 700 Hz.</p>
<sec id="section4-0142331212439598">
<title>Implementation of demodulator (second block)</title>
<p>The squaring demodulator is implemented by the equation <italic>y</italic>[<italic>n</italic>] = <italic>x</italic>[<italic>n</italic>]<sup>2</sup> in the digital domain, where <italic>x</italic>[<italic>n</italic>] is the input signal.</p>
</sec>
<sec id="section5-0142331212439598">
<title>Implementation of band-pass filter (third block)</title>
<p>The considered band-pass filter in flickermeter IEC is of the Butterworth kind, of order 6, which can be replaced with another appropriate filter. As shown in <xref ref-type="fig" rid="fig3-0142331212439598">Figure 3</xref>, it is clear that by increasing the order of the Butterworth filter or by using elliptic or Chebychev filters, the negative slope at the cut-off frequency 35 Hz increases compared with the sixth-order Butterworth filter. For these alternative filters, the magnitude of any frequency component higher than the cut-off frequency that passes through the filter will decrease (<xref ref-type="bibr" rid="bibr7-0142331212439598">Halpin and Singhvi, 2007</xref>).</p>
<fig id="fig3-0142331212439598" position="float">
<label>Figure 3</label>
<caption>
<p>Frequency response of Butterworth, elliptic and Chebychev filters, which are computed by MATLAB software.</p>
</caption>
<graphic xlink:href="10.1177_0142331212439598-fig3.tif"/>
</fig>
<p>In designing the improved flickermeter, the Chebyshev type band-pass filter is substituted by the band-pass Butterworth filter, because the attenuation of the Chebyshev type II band-pass filter is less than the Butterworth band-pass filter in the pass band (0–35 Hz). Therefore, the high-frequency flicker (close to 35 Hz) is measured more accurate using the Chebyshev type II band-pass filter.</p>
<p>This filter is designed according to the common digital filter design methods in MATLAB software with parameters such as <italic>F</italic><sub>s</sub>=700 Hz, <italic>F</italic><sub>stop1</sub>=0.001 Hz, <italic>F</italic><sub>pass1</sub>=0.05 Hz, <italic>F</italic><sub>pass2</sub>=35 Hz, <italic>F</italic><sub>stop2</sub>=37 Hz, <italic>A</italic><sub>stop1</sub>=20, <italic>A</italic><sub>stop2</sub>=20, <italic>A</italic><sub>pass</sub>=1. The designed filter is shown in <xref ref-type="fig" rid="fig4-0142331212439598">Figure 4</xref>.</p>
<fig id="fig4-0142331212439598" position="float">
<label>Figure 4</label>
<caption>
<p>The magnitude response the Chebyshev, band-pass, 18<sup>th</sup>-order filter.</p>
</caption>
<graphic xlink:href="10.1177_0142331212439598-fig4.tif"/>
</fig>
<p>The order of the designed filter is 22 and direct form realization is used in order to implement it. Additionally, the filter infinite impulse response (IIR) is used instead of finite impulse response (FIR), because of less computational cost and a shorter time of filter operation.</p>
</sec>
<sec id="section6-0142331212439598">
<title>Implementation of weighting filter (fourth block)</title>
<p>The transfer function of the fourth block is especially proposed for filament lamps (60 W/230 V/50 Hz) and (60 W/120 V/60 Hz), and therefore, only the effect of these two various lamps is considered for measuring flicker. So this measuring instrument cannot reflect the other effects of the lamps in confronting with flicker phenomenon and thus cannot be an appropriate source for evaluating and measuring flicker.</p>
<p>A good weighting filter, in which the effect of whole lamp has been considered, should be replaced by the weighting filter of fourth block. As mentioned before, the weighting graph of this block is based on lamp–eye–brain response to lamp voltage and it is obtained using a group of volunteers for studying the effect of the flicker’s intensity. Therefore, it seems to improve the weighting filter that one of the methods is to provide the same conditions as the weighting graph’s conditions of this block for other kinds of lamps and to compute the weighting graph of each lamp (<xref ref-type="bibr" rid="bibr5-0142331212439598">Frater and Watson, 2007</xref>; <xref ref-type="bibr" rid="bibr11-0142331212439598">Maana et al., 2007</xref>). In <xref ref-type="bibr" rid="bibr14-0142331212439598">Peretto et al. (2007b)</xref>, a dynamic analytical model of the lamp-eye–brain system is proposed and using a hardware set-up, the transfer function of lamp-eye–brain is obtained. In <xref ref-type="bibr" rid="bibr3-0142331212439598">Emanuel and Peretto (2004)</xref>, a simple lamp–eye–brain simulator for light flicker studies is proposed where the eye and brain structures are implemented by some approximate functions. Unfortunately, this method can surely be influenced by experiments and its volunteers, and can be time-consuming and inaccurate. Another way, which is more appropriate, is to decompose the lamp–eye–brain model into two parts: 1) the lamp response to voltage flicker, and 2) the eye–brain response to light flicker, as shown in <xref ref-type="fig" rid="fig5-0142331212439598">Figure 5</xref>.</p>
<fig id="fig5-0142331212439598" position="float">
<label>Figure 5</label>
<caption>
<p>Separating the IEC weighting curve.</p>
</caption>
<graphic xlink:href="10.1177_0142331212439598-fig5.tif"/>
</fig>
<p>Thus, eye–brain response to light flicker can be considered a reference model and lamp response to voltage flicker should be computed. In this way, dependency on volunteers and the environmental situation for investigating the effects of eye–brain model is eliminated. Therefore, the transfer function of various lamps can be obtained with laboratory work. Some work is done to obtain the gain factor of various lamps (<xref ref-type="bibr" rid="bibr2-0142331212439598">Drapela et al., 2005</xref>; <xref ref-type="bibr" rid="bibr12-0142331212439598">Moallem et al., 2012</xref>). In <xref ref-type="bibr" rid="bibr12-0142331212439598">Moallem et al. (2012)</xref>, a practical framework for obtaining the transfer function of various lamps is proposed. For example, the transfer function of the fluorescent lamp of 23 W is estimated as:</p>
<p>
<disp-formula id="disp-formula8-0142331212439598">
<label>(7)</label>
<mml:math display="block" id="math8-0142331212439598">
<mml:mrow>
<mml:mi>T</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>s</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>223</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>83</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>s</mml:mi>
<mml:mo>+</mml:mo>
<mml:mn>998</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>36</mml:mn>
<mml:mo stretchy="false">)</mml:mo>
<mml:mspace width="0.25em"/>
</mml:mrow>
</mml:mfrac>
<mml:mo>+</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>23</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>2</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>s</mml:mi>
<mml:mo>+</mml:mo>
<mml:mn>45</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>35</mml:mn>
<mml:mo stretchy="false">)</mml:mo>
<mml:mspace width="0.25em"/>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula8-0142331212439598" xlink:href="10.1177_0142331212439598-eq8.tif"/>
</disp-formula>
</p>
<p>It should be noted that all the transfer functions in the IEC flickermeter model are in the continuous-time domain; for their implementation, they should be mapped to the discrete-time domain. If a transfer function in continuous-time domain is as below:</p>
<p>
<disp-formula id="disp-formula9-0142331212439598">
<label>(8)</label>
<mml:math display="block" id="math9-0142331212439598">
<mml:mrow>
<mml:mi>H</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>s</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:munderover>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>k</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>N</mml:mi>
</mml:mrow>
</mml:munderover>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>A</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:mi>s</mml:mi>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>s</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula9-0142331212439598" xlink:href="10.1177_0142331212439598-eq9.tif"/>
</disp-formula>
</p>
<p>then its transfer function in discrete-time domain would appeared to be:</p>
<p>
<disp-formula id="disp-formula10-0142331212439598">
<label>(9)</label>
<mml:math display="block" id="math10-0142331212439598">
<mml:mrow>
<mml:mi>H</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>z</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:munderover>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>k</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>N</mml:mi>
</mml:mrow>
</mml:munderover>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>d</mml:mi>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mrow>
<mml:mi>A</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>e</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>s</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>d</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:msup>
<mml:msup>
<mml:mrow>
<mml:mi>z</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula10-0142331212439598" xlink:href="10.1177_0142331212439598-eq10.tif"/>
</disp-formula>
</p>
<p>where <italic>T</italic><sub>d</sub> is the sampling time. Therefore, for example, for the eye–brain transfer function introduced in <xref ref-type="fig" rid="fig5-0142331212439598">Figure 5</xref>, its discrete-time conversion is as follows:</p>
<p>
<disp-formula id="disp-formula11-0142331212439598">
<label>(10)</label>
<mml:math display="block" id="math11-0142331212439598">
<mml:mrow>
<mml:mi>F</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>z</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>2514</mml:mn>
<mml:mo>−</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>2489</mml:mn>
<mml:msup>
<mml:mrow>
<mml:mi>z</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
</mml:mrow>
<mml:mrow>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>8803</mml:mn>
<mml:msup>
<mml:mrow>
<mml:mi>z</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>−</mml:mo>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msup>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>8609</mml:mn>
<mml:msup>
<mml:mrow>
<mml:mi>z</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula11-0142331212439598" xlink:href="10.1177_0142331212439598-eq11.tif"/>
</disp-formula>
</p>
<p>and is implemented based on the following recursive equation:</p>
<p>
<disp-formula id="disp-formula12-0142331212439598">
<label>(11)</label>
<mml:math display="block" id="math12-0142331212439598">
<mml:mrow>
<mml:mi>y</mml:mi>
<mml:mo stretchy="false">[</mml:mo>
<mml:mi>n</mml:mi>
<mml:mo stretchy="false">]</mml:mo>
<mml:mo>=</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>2514</mml:mn>
<mml:mi>x</mml:mi>
<mml:mo stretchy="false">[</mml:mo>
<mml:mi>n</mml:mi>
<mml:mo stretchy="false">]</mml:mo>
<mml:mo>−</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>2489</mml:mn>
<mml:mi>x</mml:mi>
<mml:mo stretchy="false">[</mml:mo>
<mml:mi>n</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo stretchy="false">]</mml:mo>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>8609</mml:mn>
<mml:mi>y</mml:mi>
<mml:mo stretchy="false">[</mml:mo>
<mml:mi>n</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo stretchy="false">]</mml:mo>
<mml:mo>−</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>8803</mml:mn>
<mml:mi>y</mml:mi>
<mml:mo stretchy="false">[</mml:mo>
<mml:mi>n</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>2</mml:mn>
<mml:mo stretchy="false">]</mml:mo>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula12-0142331212439598" xlink:href="10.1177_0142331212439598-eq12.tif"/>
</disp-formula>
</p>
</sec>
<sec id="section7-0142331212439598">
<title>Implementation of squaring (fifth block)</title>
<p>The squaring is implemented by the equation <italic>y</italic>[<italic>n</italic>] = <italic>x</italic>[<italic>n</italic>]<sup>2</sup> in the digital domain, where <italic>x</italic>[<italic>n</italic>] is the third block’s output.</p>
</sec>
<sec id="section8-0142331212439598">
<title>Implementation of the low-pass filter (sixth block)</title>
<p>According to standard IEC61000-4-15, the function below, which is a low-pass filter with time constant 0.3 s, should be implemented:</p>
<p>
<disp-formula id="disp-formula13-0142331212439598">
<label>(12)</label>
<mml:math display="block" id="math13-0142331212439598">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>H</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>b</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>s</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>+</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>3</mml:mn>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula13-0142331212439598" xlink:href="10.1177_0142331212439598-eq13.tif"/>
</disp-formula>
</p>
<p>which is implemented based on the recursive equation below in the discrete-time domain:</p>
<p>
<disp-formula id="disp-formula14-0142331212439598">
<label>(13)</label>
<mml:math display="block" id="math14-0142331212439598">
<mml:mrow>
<mml:mi>y</mml:mi>
<mml:mo stretchy="false">[</mml:mo>
<mml:mi>n</mml:mi>
<mml:mo stretchy="false">]</mml:mo>
<mml:mo>=</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>0025</mml:mn>
<mml:mi>x</mml:mi>
<mml:mo stretchy="false">[</mml:mo>
<mml:mi>n</mml:mi>
<mml:mo stretchy="false">]</mml:mo>
<mml:mo>+</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>9998</mml:mn>
<mml:mi>y</mml:mi>
<mml:mo stretchy="false">[</mml:mo>
<mml:mi>n</mml:mi>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo stretchy="false">]</mml:mo>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula14-0142331212439598" xlink:href="10.1177_0142331212439598-eq14.tif"/>
</disp-formula>
</p>
</sec>
<sec id="section9-0142331212439598">
<title>Implementation of statistical analysis (seventh block)</title>
<p>All the output data of the previous block should be classified; 64 classes are selected for this purpose. First, the smallest and the largest data are identified. Second, the range between the data is divided into 64 classes. The other data are classified based on their value. Then, the CPF is constructed and the <italic>P<sub>st</sub></italic> index is calculated, according to standard IEC61000-4-15. It should be mentioned that the linear interpolation is used to find the obscure points of the CPF.</p>
</sec>
</sec>
<sec id="section10-0142331212439598">
<title>Simulation</title>
<p>In this section, an industrial plant, which includes an arc furnace, is simulated. In simulation results, the flicker effect of various lamps is evaluated by the improved flickermeter. A simplified one-line diagram of the studied system is shown in <xref ref-type="fig" rid="fig6-0142331212439598">Figure 6</xref>.</p>
<fig id="fig6-0142331212439598" position="float">
<label>Figure 6</label>
<caption>
<p>The diagram of switch function.</p>
</caption>
<graphic xlink:href="10.1177_0142331212439598-fig6.tif"/>
</fig>
<p>At the high-voltage bus, or point of common coupling (PCC), the utility serves other customers who complain about light fluctuation. The electric arc resistance is defined as:</p>
<p>
<disp-formula id="disp-formula15-0142331212439598">
<label>(14)</label>
<mml:math display="block" id="math15-0142331212439598">
<mml:mrow>
<mml:mi>R</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mi>R</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>+</mml:mo>
<mml:mi>sin</mml:mi>
<mml:mi>ω</mml:mi>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula15-0142331212439598" xlink:href="10.1177_0142331212439598-eq15.tif"/>
</disp-formula>
</p>
<p>where ω=2π<italic>f</italic> and <italic>f</italic> is the flicker frequency. The arc resistance <italic>R</italic> can be expressed in the form of a current controlled non-linear resistance. An approximated model of the <italic>V–I</italic> characteristic of <italic>R</italic> is shown in <xref ref-type="fig" rid="fig7-0142331212439598">Figure 7</xref> (<xref ref-type="bibr" rid="bibr19-0142331212439598">Zheng and Makram, 2000</xref>), where <italic>V</italic> is the arc voltage, <italic>I</italic> is the arc current, <italic>v</italic><sub>ig</sub> and <italic>v</italic><sub>st</sub> are the ignition voltage and static voltage of the arc, respectively.</p>
<fig id="fig7-0142331212439598" position="float">
<label>Figure 7</label>
<caption>
<p>Approximated model of the <italic>V–I</italic> characteristic curve of the arc furnace load.</p>
</caption>
<graphic xlink:href="10.1177_0142331212439598-fig7.tif"/>
</fig>
<p>The <italic>V–I</italic> characteristic curve is defined in terms of the <xref ref-type="disp-formula" rid="disp-formula16-0142331212439598">Equation (15)</xref> as:</p>
<p>
<disp-formula id="disp-formula16-0142331212439598">
<label>(15)</label>
<mml:math display="block" id="math16-0142331212439598">
<mml:mrow>
<mml:mi>R</mml:mi>
<mml:mo>=</mml:mo>
<mml:mrow>
<mml:mo>{</mml:mo>
<mml:mtable align="left">
<mml:mtr>
<mml:mtd columnalign="left">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>R</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mtd>
<mml:mtd columnalign="left">
<mml:mrow>
<mml:mn>0</mml:mn>
<mml:mo>≤</mml:mo>
<mml:mrow>
<mml:mo>|</mml:mo>
<mml:mi>i</mml:mi>
<mml:mo>|</mml:mo>
</mml:mrow>
<mml:mo>&lt;</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>i</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="left" columnspan="1">
<mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>v</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>st</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>v</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>ig</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>v</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>st</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mi>e</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:mo>−</mml:mo>
<mml:mo stretchy="false">(</mml:mo>
<mml:mrow>
<mml:mo>|</mml:mo>
<mml:mi>i</mml:mi>
<mml:mo>|</mml:mo>
</mml:mrow>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>i</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mi>τ</mml:mi>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:msup>
</mml:mrow>
<mml:mrow>
<mml:mrow>
<mml:mo>|</mml:mo>
<mml:mi>i</mml:mi>
<mml:mo>|</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:mtd>
<mml:mtd columnalign="left">
<mml:mrow>
<mml:mrow>
<mml:mo>|</mml:mo>
<mml:mi>i</mml:mi>
<mml:mo>|</mml:mo>
</mml:mrow>
<mml:mo>&gt;</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>i</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:mrow>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula16-0142331212439598" xlink:href="10.1177_0142331212439598-eq16.tif"/>
</disp-formula>
</p>
<p>where <italic>R</italic><sub>1</sub> is slope the slope of the linear segment and <italic>τ</italic> is time constant of the non-linear segment. The system parameters are summarized in <xref ref-type="table" rid="table1-0142331212439598">Table 1</xref>.</p>
<table-wrap id="table1-0142331212439598" position="float">
<label>Table 1</label>
<caption>
<p>System parameters of the power system.</p>
</caption>
<graphic alternate-form-of="table1-0142331212439598" xlink:href="10.1177_0142331212439598-table1.tif"/>
<table>
<colgroup>
<col align="left"/>
<col align="left"/>
</colgroup>
<thead>
<tr>
<th align="left">Parameter description</th>
<th align="left">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Source impedance</td>
<td>0.01+<italic>j</italic>0.01</td>
</tr>
<tr>
<td>Transformer impedances</td>
<td>0.06+<italic>j</italic>0.1</td>
</tr>
<tr>
<td>Plant load impedances</td>
<td>5.7+<italic>j</italic>1.7</td>
</tr>
<tr>
<td><italic>R</italic><sub>1</sub></td>
<td>62</td>
</tr>
<tr>
<td><italic>i</italic><sub>1</sub></td>
<td>0.016</td>
</tr>
<tr>
<td><italic>v</italic><sub>ig</sub></td>
<td>1</td>
</tr>
<tr>
<td><italic>v</italic><sub>st</sub></td>
<td>0.8</td>
</tr>
<tr>
<td>τ</td>
<td>0.024</td>
</tr>
</tbody>
</table>
</table-wrap>
<p>For simulation, <italic>f</italic> equalled 54 Hz in the arc furnace system. Here, the transfer function of the 23-W fluorescent lamp is replaced by a filament lamp (60 W/230 V/50 Hz) in the IEC standard. Then, the flicker effect of these lamps is compared. The simulated model of industrial plant, which is implemented in Simulink of MATLAB software, is shown in <xref ref-type="fig" rid="fig8-0142331212439598">Figure 8</xref>, and the simulated model of the arc furnace is implemented in Simulink as in <xref ref-type="fig" rid="fig9-0142331212439598">Figure 9</xref>. Here, it is attempted that the model of the arc furnace is implemented based on <xref ref-type="disp-formula" rid="disp-formula15-0142331212439598">Equations (14)</xref> and <xref ref-type="disp-formula" rid="disp-formula15-0142331212439598">(15)</xref> and the <italic>V–I</italic> characteristic curve of <xref ref-type="fig" rid="fig7-0142331212439598">Figure 7</xref>.</p>
<fig id="fig8-0142331212439598" position="float">
<label>Figure 8</label>
<caption>
<p>The simulated model of industrial plant in Simulink of MATLAB software.</p>
</caption>
<graphic xlink:href="10.1177_0142331212439598-fig8.tif"/>
</fig>
<fig id="fig9-0142331212439598" position="float">
<label>Figure 9</label>
<caption>
<p>The simulated model of arc furnace in Simulink of MATLAB software.</p>
</caption>
<graphic xlink:href="10.1177_0142331212439598-fig9.tif"/>
</fig>
<p>Running the simulation system, the voltage and current curves at the PCC are recorded and shown in <xref ref-type="fig" rid="fig10-0142331212439598">Figure 10</xref>.</p>
<fig id="fig10-0142331212439598" position="float">
<label>Figure 10</label>
<caption>
<p>(a) Voltage of the point of common coupling (PCC); (b) current of the PCC.</p>
</caption>
<graphic xlink:href="10.1177_0142331212439598-fig10.tif"/>
</fig>
<p>As seen on these curves, both voltage and current are distorted. The frequency spectrum of the voltage signal is shown in <xref ref-type="fig" rid="fig11-0142331212439598">Figure 11</xref>.</p>
<fig id="fig11-0142331212439598" position="float">
<label>Figure 11</label>
<caption>
<p>Frequency spectrum of voltage signal.</p>
</caption>
<graphic xlink:href="10.1177_0142331212439598-fig11.tif"/>
</fig>
<p>The interharmonics 42, 58 and 66 Hz are merged; these interharmonics make the 8-, 8- and 16-Hz flicker components with amplitudes of 0.00011, 0.0023 and 0.00013 V, respectively. These flicker components can be annoying for customers of power systems considering the <italic>P</italic><sub>st</sub> index and type of applied lamp. The <italic>P</italic><sub>st</sub> index for the lamps are presented in <xref ref-type="table" rid="table2-0142331212439598">Table 2</xref>.</p>
<table-wrap id="table2-0142331212439598" position="float">
<label>Table 2</label>
<caption>
<p><italic>P</italic><sub>st</sub> index for two lamps.</p>
</caption>
<graphic alternate-form-of="table2-0142331212439598" xlink:href="10.1177_0142331212439598-table2.tif"/>
<table>
<colgroup>
<col align="left"/>
<col align="char" char="."/>
</colgroup>
<thead>
<tr>
<th align="left">Filament lamp (60 W/230 V/50 Hz)</th>
<th align="left">Fluorescent lamp 23 W</th>
</tr>
</thead>
<tbody>
<tr>
<td>1.23</td>
<td>0.89</td>
</tr>
</tbody>
</table>
</table-wrap>
<p>As seen, the <italic>P</italic><sub>st</sub> value is different for different lamps. For the filament lamp (60 W/230 V/50 Hz), the flicker effect is annoying because the <italic>P<sub>st</sub></italic> value is more than 1, but for the 23-W fluorescent lamp it is not annoying because the <italic>P<sub>st</sub></italic> value is less than 1.</p>
</sec>
<sec id="section11-0142331212439598">
<title>Practical implementation in an experimental set-up</title>
<p>This section presents details of the implemented hardware and software of the proposed improved flickermeter. The main parts of the hardware are the main board including an LPC2368 ARM microcontroller for computing the flicker index, the input voltage adapter and the necessary external memory for recording the sampled voltages. The implemented hardware is shown in <xref ref-type="fig" rid="fig12-0142331212439598">Figure 12</xref> and the block diagram of proposed hardware is shown in <xref ref-type="fig" rid="fig13-0142331212439598">Figure 13</xref></p>
<fig id="fig12-0142331212439598" position="float">
<label>Figure 12</label>
<caption>
<p>The implemented hardware for the improved flickermeter.</p>
</caption>
<graphic xlink:href="10.1177_0142331212439598-fig12.tif"/>
</fig>
<fig id="fig13-0142331212439598" position="float">
<label>Figure 13</label>
<caption>
<p>The block diagram of the proposed hardware for the improved flickermeter.</p>
</caption>
<graphic xlink:href="10.1177_0142331212439598-fig13.tif"/>
</fig>
<sec id="section12-0142331212439598">
<title>Main board</title>
<p>Here, this flickermeter is implemented by a trial digital system based on an ARM microcontroller (<xref ref-type="bibr" rid="bibr16-0142331212439598">Sloss et al., 2004</xref>), LPC2368. This microcontroller is a high-speed and powerful processor with peripheral units that make it appropriate for implementing the improved flickermeter. The clock frequency of the CPU is set to 72 MHz. The designed hardware system includes the ARM microcontroller, programming interface, input analogue interface, voltage adapter circuit (whose output is connected to a 10-bit A/D converter of the ARM), the main harmonic detector circuit and the memory card.</p>
</sec>
<sec id="section13-0142331212439598">
<title>Input voltage adapter</title>
<p>This circuit uses an MC1494 chip. This chip is an internal multiplier with a settable coefficient. One of the inputs is accompanied by flicker. The other input of the multiplier, which is a controlled voltage, is supplied by the OC output pin of an ATmega8 microcontroller. The coefficient of the multiplier is an assumed one. The ATmega8 microcontroller is permanently sampling the multiplier output and sets the controlling signal in the multiplier input as desirable as possible. In fact, it maintains the multiplier output always in the interval, ±1 V. Then, the multiplier output is maintained in the range 1∼3 V by the Op-Amp, LM324, for microcontroller LPC2368 usage.</p>
</sec>
<sec id="section14-0142331212439598">
<title>External memory</title>
<p>Based on the IEC standard, the sampling operation should be performed in 10 min and the sampling frequency is considered to be 700 Hz. Therefore, 420 000 data should be sampled and saved. If the data to be recorded are defined as floating (4-byte), a 1680-kB memory should be accessible for the program and the microcontroller LPC2368 needs an external memory. It is proposed that a 512-Mb multimedia memory card (MMC) is used here as the external memory, which is low cost. After recording, the MMC can be used to transfer the data to a computer for additional processing.</p>
</sec>
<sec id="section15-0142331212439598">
<title>Flowchart of ARM microcontroller program</title>
<p><xref ref-type="fig" rid="fig14-0142331212439598">Figure 14</xref> shows the microcontroller program flowchart, which is implemented using programming language C and is compiled by Keil.</p>
<fig id="fig14-0142331212439598" position="float">
<label>Figure 14</label>
<caption>
<p>Microcontroller LPC2368 program flowchart to implement the constructed IEC flickermeter practically.</p>
</caption>
<graphic xlink:href="10.1177_0142331212439598-fig14.tif"/>
</fig>
</sec>
<sec id="section16-0142331212439598">
<title>Algorithm run time</title>
<p>The suggested IEC flickermeter run time after sampling is about 27 s. <xref ref-type="table" rid="table3-0142331212439598">Table 3</xref> shows the run times of the flowchart main block. The other block’s run times are negligible.</p>
<table-wrap id="table3-0142331212439598" position="float">
<label>Table 3</label>
<caption>
<p>Run times of different parts of ARM microcontroller program flowchart.</p>
</caption>
<graphic alternate-form-of="table3-0142331212439598" xlink:href="10.1177_0142331212439598-table3.tif"/>
<table>
<colgroup>
<col align="left"/>
<col align="char" char="."/>
<col align="char" char="."/>
<col align="char" char="."/>
<col align="char" char="."/>
<col align="char" char="."/>
<col align="char" char="."/>
</colgroup>
<tbody>
<tr>
<td>Block in <xref ref-type="fig" rid="fig12-0142331212439598">Figure 14</xref></td>
<td>1, 2, 3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
</tr>
<tr>
<td>Execution time (s)</td>
<td>600</td>
<td>9.54</td>
<td>3.85</td>
<td>0.32</td>
<td>2.3</td>
<td>10.7</td>
</tr>
</tbody>
</table>
</table-wrap>
</sec>
<sec id="section17-0142331212439598">
<title>Experimental tests</title>
<p>In this subsection, the results of some practical experiments on the manipulated flickermeter are presented. In order to evaluate the performance of the system in different conditions, it is necessary to have a flickermaker that is made by a digital system based on an Atmega8 AVR microcontroller. The implemented flickermaker is shown in <xref ref-type="fig" rid="fig15-0142331212439598">Figure 15</xref>, including the AVR microcontroller, the resistive–capacitive (RC)-type low-pass filter, which is connected to the pulse-width modulator (PWM) of AVR microcontroller; and the 5-V voltage regulator.</p>
<fig id="fig15-0142331212439598" position="float">
<label>Figure 15</label>
<caption>
<p>The experimental flickermaker based on an AVR microcontroller.</p>
</caption>
<graphic xlink:href="10.1177_0142331212439598-fig15.tif"/>
</fig>
<p>The PWM facility of the microcontroller can be used to make analogue voltage with the desired frequency and amplitude. When the main frequency of the voltage is constant, an appropriate low-pass RC filter can be coupled to the PWM output to attenuate unwanted harmonics and make a nearly pure sinusoid signal. The AVR microcontroller has a 10-bit PWM with a controllable frequency. In the implemented system, the frequency of the PWM is set to 15 kHz and the duty cycle of the PWM is tuned based on the relationship <italic>av</italic>(<italic>t</italic>)+<italic>b</italic>, where <italic>a</italic> and <italic>b</italic> are selected such that the duty cycle is between 0 to 2<sup>10</sup>−1. The cut-off frequency of the low-pass RC filter is set to 1.5 kHz.</p>
<p>Supposing that <italic>v</italic>(<italic>t</italic>) has the main frequency of 50 Hz and interharmonic frequencies of 54, 40 and 70 Hz with amplitudes of 0.1, 0.08 and 0.05V, respectively,</p>
<p>
<disp-formula id="disp-formula17-0142331212439598">
<label>(16)</label>
<mml:math display="block" id="math17-0142331212439598">
<mml:mrow>
<mml:mi>v</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>=</mml:mo>
<mml:mi>cos</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mn>2</mml:mn>
<mml:mi>π</mml:mi>
<mml:mn>50</mml:mn>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>+</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>1</mml:mn>
<mml:mi>cos</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mn>2</mml:mn>
<mml:mi>π</mml:mi>
<mml:mn>54</mml:mn>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>+</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>08</mml:mn>
<mml:mi>cos</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mn>2</mml:mn>
<mml:mi>π</mml:mi>
<mml:mn>40</mml:mn>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo>+</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo>.</mml:mo>
<mml:mn>05</mml:mn>
<mml:mi>cos</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mn>2</mml:mn>
<mml:mi>π</mml:mi>
<mml:mn>70</mml:mn>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:mrow>
</mml:math>
<graphic alternate-form-of="disp-formula17-0142331212439598" xlink:href="10.1177_0142331212439598-eq17.tif"/>
</disp-formula>
</p>
<p>therefore, this make 4-, 10- and 20-Hz flicker components that correspond to a <italic>P</italic><sub>st</sub> of about 85, for a filament lamp (60 W/230 V/50 Hz) in an IEC standard flickermeter.</p>
<p><xref ref-type="fig" rid="fig16-0142331212439598">Figure 16</xref> shows the typical output of the flicker maker based on the <xref ref-type="disp-formula" rid="disp-formula17-0142331212439598">equation (16)</xref> measured by a traditional 20-MHz oscilloscope in comparison with the simulated output. In the next experiments, this output is used for evaluating the implemented hardware and software of the proposed improved flickermeter.</p>
<fig id="fig16-0142331212439598" position="float">
<label>Figure 16</label>
<caption>
<p>Typical output of the flicker maker measured by a traditional 20-MHz oscilloscope (a) in comparison with the simulated output (b).</p>
</caption>
<graphic xlink:href="10.1177_0142331212439598-fig16.tif"/>
</fig>
<p><xref ref-type="fig" rid="fig17-0142331212439598">Figures 17</xref><xref ref-type="fig" rid="fig18-0142331212439598"/><xref ref-type="fig" rid="fig19-0142331212439598"/><xref ref-type="fig" rid="fig20-0142331212439598"/>–<xref ref-type="fig" rid="fig21-0142331212439598">21</xref> show the comparison of output signals of some practical experiments and simulations for the filament lamp (60 W/230 V/50 Hz). The output signals by the DAC out of ARM microcontroller are obtained and measured by a 20-MHz traditional oscilloscope.</p>
<fig id="fig17-0142331212439598" position="float">
<label>Figure 17</label>
<caption>
<p>Output of the squaring demodulator measured by the oscilloscope (a) in comparison with the simulated output (b).</p>
</caption>
<graphic xlink:href="10.1177_0142331212439598-fig17.tif"/>
</fig>
<fig id="fig18-0142331212439598" position="float">
<label>Figure 18</label>
<caption>
<p>Output of the band-pass filter measured by the oscilloscope (a) in comparison with the simulated output (b) and the frequency spectrum of signal (c).</p>
</caption>
<graphic xlink:href="10.1177_0142331212439598-fig18.tif"/>
</fig>
<fig id="fig19-0142331212439598" position="float">
<label>Figure 19</label>
<caption>
<p>Output of the gain factor for the filament lamp (60 W/230 V/50 Hz) measured by the oscilloscope (a) in comparison with the simulated output (b).</p>
</caption>
<graphic xlink:href="10.1177_0142331212439598-fig19.tif"/>
</fig>
<fig id="fig20-0142331212439598" position="float">
<label>Figure 20</label>
<caption>
<p>Output of the eye–brain transfer fmeasured by the oscilloscope (a) in comparison with the simulated output (b).</p>
</caption>
<graphic xlink:href="10.1177_0142331212439598-fig20.tif"/>
</fig>
<fig id="fig21-0142331212439598" position="float">
<label>Figure 21</label>
<caption>
<p>Output of the squaring of the brain model measured by the oscilloscope (a) in comparison with the simulated output (b).</p>
</caption>
<graphic xlink:href="10.1177_0142331212439598-fig21.tif"/>
</fig>
<p><xref ref-type="fig" rid="fig17-0142331212439598">Figure 17</xref> shows the output of the squaring demodulator (block 2) measured by the oscilloscope in comparison with the simulated output. <xref ref-type="fig" rid="fig18-0142331212439598">Figure 18</xref> shows the output of the band-pass filter measured by the oscilloscope in comparison with the simulated output. <xref ref-type="fig" rid="fig19-0142331212439598">Figure 19</xref> shows the output of the gain factor for the filament lamp (60 W/230 V/50 Hz) measured by the oscilloscope in comparison with the simulated output. <xref ref-type="fig" rid="fig20-0142331212439598">Figure 20</xref> shows the output of the eye–brain transfer function measured by the oscilloscope in comparison with the simulated output. <xref ref-type="fig" rid="fig21-0142331212439598">Figure 21</xref> shows the output of the squaring of the brain model measured by the oscilloscope in comparison with the simulated output.</p>
<p>As is shown in these figures, after passing signal <italic>v</italic>(<italic>t</italic>) from the squaring demodulator and band-pass filter, its flicker component 4, 10 and 20 Hz are extracted. Then, the flicker component is passed through a weighting filter and is multiplied by a related coefficient. The output signal is squared by block 5. Then, by passing from block 6, its DC component is extracted, which is referred to as the IFL signal (<xref ref-type="fig" rid="fig22-0142331212439598">Figure 22</xref>). Then, in block 7, the CPF graph (<xref ref-type="fig" rid="fig23-0142331212439598">Figure 23</xref>) and <italic>P</italic><sub>st</sub> value are computed.</p>
<fig id="fig22-0142331212439598" position="float">
<label>Figure 22</label>
<caption>
<p>Output of the low-pass filter of the brain model (instantaneous flicker level; IFL).</p>
</caption>
<graphic xlink:href="10.1177_0142331212439598-fig22.tif"/>
</fig>
<fig id="fig23-0142331212439598" position="float">
<label>Figure 23</label>
<caption>
<p>The cumulative probability function (CPF) graph of instantaneous flicker level (IFL) signal.</p>
</caption>
<graphic xlink:href="10.1177_0142331212439598-fig23.tif"/>
</fig>
</sec>
</sec>
<sec id="section18-0142331212439598" sec-type="conclusions">
<title>Conclusion</title>
<p>Some improvements, include replacing the band-pass filter by a more appropriate filter and considering the model of various lamps, were suggested for the IEC flickermeter. Then, the improved flickermeter was implemented in the discrete-time domain and its performance was simulated in an industrial plant, which includes an arc furnace. Finally, the experimental implementation of this flickermeter based on an ARM LPC2368 microcontroller was tested and evaluated in the experimental set-up. Some of considered features of this hardware are using an ARM microcontroller as a processor, and using a memory card as an external memory. It is used to implement the blocks of the flickermeter in the discrete-time domain without additional hardware and with an adequate short run time. Also, using a memory card as an external memory simply provides the requested memory for the implemented hardware. Again, their recorded data can be simply transferred to a computer for additional processing. It should be noted that this hardware is a prototype and the cost of its implementation is less than $40. To implement the proposed flickermeter as an industrial measurement device, some considerations and additional hardware should be added.</p>
</sec>
</body>
<back>
<fn-group>
<fn fn-type="financial-disclosure">
<label>Funding</label>
<p>This research received no specific grant from any funding agency in the public, commercial, or not-for-profit sectors.</p>
</fn>
</fn-group>
<ref-list>
<title>References</title>
<ref id="bibr1-0142331212439598">
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Arsenau</surname><given-names>R</given-names></name>
<name><surname>Sutherland</surname><given-names>ME</given-names></name>
<name><surname>Zelle</surname><given-names>JJ</given-names></name>
</person-group> (<year>2002</year>) <article-title>A test system for calibrating flickermeters</article-title>. <source>IEEE Transactions on Instrumentation and Measurement</source> <volume>51</volume>(<issue>4</issue>): <fpage>598</fpage>–<lpage>600</lpage>.</citation>
</ref>
<ref id="bibr2-0142331212439598">
<citation citation-type="book">
<person-group person-group-type="author">
<name><surname>Drapela</surname><given-names>J</given-names></name>
<name><surname>Kratky</surname><given-names>M</given-names></name>
<name><surname>Weidinger</surname><given-names>L</given-names></name>
<name><surname>Zavodny</surname><given-names>M</given-names></name>
</person-group> (<year>2005</year>) <article-title>Light flicker of fluorescent lamps with different types of ballasts caused by interharmonics</article-title>. <source>Proceedings of the IEEE St. Petersburg Power Technology Proceedings</source>, <publisher-loc>St. Petersburg</publisher-loc>, pp. <fpage>1</fpage>–<lpage>7</lpage>.</citation>
</ref>
<ref id="bibr3-0142331212439598">
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Emanuel</surname><given-names>AE</given-names></name>
<name><surname>Peretto</surname><given-names>L</given-names></name>
</person-group> (<year>2004</year>) <article-title>A simple lamp–eye–brain model for flicker observations</article-title>. <source>IEEE Transactions on Power Delivery</source> <volume>19</volume>(<issue>3</issue>): <fpage>1308</fpage>–<lpage>1313</lpage>.</citation>
</ref>
<ref id="bibr4-0142331212439598">
<citation citation-type="book">
<collab>EN 61000-4-15</collab> (<year>1997</year>) <article-title>Flickermeter – Functional and Design Specification. Testing and Measurement Techniques</article-title>. <publisher-loc>Geneva</publisher-loc>.</citation>
</ref>
<ref id="bibr5-0142331212439598">
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Frater</surname><given-names>L</given-names></name>
<name><surname>Watson</surname><given-names>N</given-names></name>
</person-group> (<year>2007</year>) <article-title>Light flicker sensitivity of high efficiency compact fluorescent lamps</article-title>. <conf-name>Proceedings of Australasian Universities Power Engineering Conference</conf-name>, <publisher-loc>Perth</publisher-loc>, pp. <fpage>1</fpage>–<lpage>6</lpage>.</citation>
</ref>
<ref id="bibr6-0142331212439598">
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Girgis</surname><given-names>A</given-names></name>
<name><surname>Stephens</surname><given-names>JW</given-names></name>
<name><surname>Makram</surname><given-names>EB</given-names></name>
</person-group> (<year>1995</year>) <article-title>Measurement and prediction of voltage flicker magnitude and frequency</article-title>. <source>IEEE Transactions on Power Delivery</source> <volume>10</volume>(<issue>3</issue>): <fpage>1600</fpage>–<lpage>1604</lpage>.</citation>
</ref>
<ref id="bibr7-0142331212439598">
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Halpin</surname><given-names>SM</given-names></name>
<name><surname>Singhvi</surname><given-names>V</given-names></name>
</person-group> (<year>2007</year>) <article-title>Limits for interharmonics in the 1–100-Hz range based on lamp flicker considerations</article-title>. <source>IEEE Transactions on Power Delivery</source> <volume>22</volume>(<issue>1</issue>): <fpage>270</fpage>–<lpage>276</lpage>.</citation>
</ref>
<ref id="bibr8-0142331212439598">
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Huang</surname><given-names>SJ</given-names></name>
<name><surname>Lu</surname><given-names>CW</given-names></name>
</person-group> (<year>2004</year>) <article-title>Enhancement of digital equivalent voltage flicker measurement via continuous wavelet transform</article-title>. <source>IEEE Transactions on Power Delivery</source> <volume>19</volume>(<issue>2</issue>): <fpage>663</fpage>–<lpage>670</lpage>.</citation>
</ref>
<ref id="bibr9-0142331212439598">
<citation citation-type="book">
<collab>IEC 61000-4-15</collab> (<year>2003</year>) <article-title>Electromagnetic Compatibility (EMC) – Part 4, Testing and measurement techniques – Section 15. Flickermeter – Functional and Design Specifications</article-title>. <publisher-name>International Electrotechnical Commission (IEC) Standard</publisher-name>.</citation>
</ref>
<ref id="bibr10-0142331212439598">
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Keppler</surname><given-names>T</given-names></name>
<name><surname>Watson</surname><given-names>N</given-names></name>
<name><surname>Arrillaga</surname><given-names>J</given-names></name>
</person-group> (<year>2000</year>) <article-title>Computation of the short-term flicker severity index</article-title>. <source>IEEE Transactions on Power Delivery</source> <volume>15</volume>(<issue>4</issue>): <fpage>1110</fpage>–<lpage>1115</lpage>.</citation>
</ref>
<ref id="bibr11-0142331212439598">
<citation citation-type="confproc">
<person-group person-group-type="author">
<name><surname>Maana</surname><given-names>M</given-names></name>
<name><surname>Ortiz</surname><given-names>A</given-names></name>
<name><surname>Azcondo</surname><given-names>FJ</given-names></name>
<name><surname>Diaz</surname><given-names>FJ</given-names></name>
<name><surname>Gonzalez</surname><given-names>F</given-names></name>
<name><surname>Renedo</surname><given-names>C</given-names></name>
</person-group> (<year>2007</year>) <article-title>Flicker impact on 150 W HPS lamps of different ages</article-title>. <conf-name>Proceedings of the 9th International Conference on Digital Object Identifier</conf-name>, <conf-loc>Santander</conf-loc>.</citation>
</ref>
<ref id="bibr12-0142331212439598">
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Moallem</surname><given-names>P</given-names></name>
<name><surname>Zargari</surname><given-names>A</given-names></name>
<name><surname>Kiyoumarsi</surname><given-names>A</given-names></name>
</person-group> (<year>2012</year>) <article-title>A practical framework for applying effects of various lamps on IEC flickermeter and evaluating results in a welding system</article-title>. <source>Journal of the Chinese Institute of Engineers</source>. Epub ahead of print <day>21</day> <month>Mar</month> <year>2012</year>. DOI:<pub-id pub-id-type="doi">10.1080/02533839.2012.655904</pub-id>.</citation>
</ref>
<ref id="bibr13-0142331212439598">
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Peretto</surname><given-names>L</given-names></name>
<name><surname>Pivello</surname><given-names>E</given-names></name>
<name><surname>Tinarelli</surname><given-names>R</given-names></name>
<name><surname>Emanuel</surname><given-names>AE</given-names></name>
</person-group> (<year>2007a</year>) <article-title>Theoretical analysis of the physiologic mechanism of luminous variation in eye–brain system</article-title>. <source>IEEE Transactions on Instrumentation and Measurement</source> <volume>56</volume>(<issue>1</issue>): <fpage>164</fpage>–<lpage>170</lpage>.</citation>
</ref>
<ref id="bibr14-0142331212439598">
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Peretto</surname><given-names>L</given-names></name>
<name><surname>Rovati</surname><given-names>L</given-names></name>
<name><surname>Salvatori</surname><given-names>G</given-names></name>
</person-group> (<year>2007b</year>) <article-title>A measurement system for the analysis of the response of the human eye to the light flicker</article-title>. <source>IEEE Transactions on Instrumentation and Measurement</source> <volume>56</volume>(<issue>4</issue>): <fpage>1384</fpage>–<lpage>1390</lpage>.</citation>
</ref>
<ref id="bibr15-0142331212439598">
<citation citation-type="book">
<person-group person-group-type="author">
<name><surname>Peretto</surname><given-names>L</given-names></name>
<name><surname>Rovati</surname><given-names>L</given-names></name>
<name><surname>Salvatori</surname><given-names>G</given-names></name>
<name><surname>Tinarelli</surname><given-names>R</given-names></name>
<name><surname>Emanuel</surname><given-names>AE</given-names></name>
</person-group> (<year>2006</year>) <article-title>Investigation on the response of the human eye to light flicker produced by different lamps</article-title>. <source>Proceedings of the 23rd IEEE IMTC</source>, <publisher-loc>Sorrento</publisher-loc>, pp. <fpage>37</fpage>–<lpage>42</lpage>.</citation>
</ref>
<ref id="bibr16-0142331212439598">
<citation citation-type="book">
<person-group person-group-type="author">
<name><surname>Sloss</surname><given-names>A</given-names></name>
<name><surname>Symes</surname><given-names>D</given-names></name>
<name><surname>Wright</surname><given-names>C</given-names></name>
</person-group> (<year>2004</year>) <source>ARM System Developer’s Guide: Designing and Optimizing System Software</source>. <publisher-loc>San Francisco, CA</publisher-loc>: <publisher-name>Morgan Kaufmann</publisher-name>.</citation>
</ref>
<ref id="bibr17-0142331212439598">
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Wang</surname><given-names>C</given-names></name>
<name><surname>Devaney</surname><given-names>MJ</given-names></name>
</person-group> (<year>2004</year>) <article-title>Incandescent lamp flicker mitigation and measurement</article-title>. <source>IEEE Transactions on Instrumentation and Measurement</source> <volume>53</volume>(<issue>4</issue>): <fpage>1028</fpage>–<lpage>1034</lpage>.</citation>
</ref>
<ref id="bibr18-0142331212439598">
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Xu</surname><given-names>W</given-names></name>
</person-group> (<year>2005</year>) <article-title>Defeciency of the IEC flickermeter for measuring interharmonic-caused voltage flickers</article-title>. <source>Proceedings of the IEEE Power Engineering Society General Meeting</source> <volume>3</volume>: <fpage>2326</fpage>–<lpage>2329</lpage>.</citation>
</ref>
<ref id="bibr19-0142331212439598">
<citation citation-type="journal">
<person-group person-group-type="author">
<name><surname>Zheng</surname><given-names>T</given-names></name>
<name><surname>Makram</surname><given-names>EB</given-names></name>
</person-group> (<year>2000</year>) <article-title>An adaptive arc furnace model</article-title>. <source>IEEE Transactions on Power Delivery</source> <volume>15</volume>(<issue>3</issue>): <fpage>931</fpage>–<lpage>939</lpage>.</citation>
</ref>
</ref-list>
</back>
</article>