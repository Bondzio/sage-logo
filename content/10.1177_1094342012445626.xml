<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v2.3 20070202//EN" "journalpublishing.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">HPC</journal-id>
<journal-id journal-id-type="hwp">sphpc</journal-id>
<journal-title>The International Journal of High Performance Computing Applications</journal-title>
<issn pub-type="ppub">1094-3420</issn>
<issn pub-type="epub">1741-2846</issn>
<publisher>
<publisher-name>SAGE Publications</publisher-name>
<publisher-loc>Sage UK: London, England</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1177/1094342012445626</article-id>
<article-id pub-id-type="publisher-id">10.1177_1094342012445626</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Articles</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Adaptive Real-Time Imaging Synthesis Telescopes</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Wright</surname>
<given-names>Melvyn</given-names>
</name>
<xref ref-type="aff" rid="aff1-1094342012445626"/>
<xref ref-type="corresp" rid="corresp1-1094342012445626"/>
</contrib>
<bio>
<title>Author biography</title>
<p>
<italic>Dr Melvyn Wright</italic> has BA and MA degrees in Mathematics and Natural Sciences, and a PhD in Radio Astronomy from the University of Cambridge (1963–1970). He was a Research Associate at the National Radio Astronomy Observatory (1970–1972), and has been a Research Astronomer at the University of California, Berkeley, since 1972. He is co-developer of the MIRIAD software package, used for imaging, and analysis of data from aperture synthesis telescopes, and co-founding PI of CASPER, the Center for Astronomy Signal Processing and Electronics Research Collaboration. His current work integrates off-line and on-line DSP to process the enormous data rates from synthesis telescopes into meaningful results with real-time feedback for scientists and engineers. His current science projects include millimeter-wavelength imaging of massive young protostars, and VLBI observations of the black holes in the Galactic center and the nucleus of M87 using telescopes in Arizona, California, and Hawaii at 1.3 mm wavelength. Both projects require interesting technical developments. The VLBI observations use phased array beam formers based on a CASPER design. He has organized and taught summer schools at the Hat Creek and CARMA observatories each year since 1989. Many of these students are now the interferometry experts at major universities and observatories.</p>
</bio>
</contrib-group>
<aff id="aff1-1094342012445626">Radio Astronomy Laboratory, University of California, Berkeley, CA, USA</aff>
<author-notes>
<corresp id="corresp1-1094342012445626">Melvyn Wright, Radio Astronomy Laboratory, University of California, Berkeley, CA 94720, USA Email: <email>melvyn.wright@gmail.com</email>
</corresp>
</author-notes>
<pub-date pub-type="epub-ppub">
<month>11</month>
<year>2012</year>
</pub-date>
<volume>26</volume>
<issue>4</issue>
<fpage>358</fpage>
<lpage>366</lpage>
<permissions>
<copyright-statement>© The Author(s) 2012</copyright-statement>
<copyright-year>2012</copyright-year>
<copyright-holder content-type="sage">SAGE Publications</copyright-holder>
</permissions>
<abstract>
<p>The digital revolution is transforming astronomy from a data-starved to a data-submerged science. Instruments such as the Atacama Large Millimeter Array (ALMA), the Large Synoptic Survey Telescope (LSST), and the Square Kilometre Array (SKA) will measure their accumulated data in petabytes. The capacity to produce enormous volumes of data must be matched with the computing power to process that data and produce meaningful results. In addition to handling huge data rates, we need adaptive calibration and beamforming to handle atmospheric fluctuations and radio frequency interference, and to provide a user environment which makes the full power of large telescope arrays accessible to both expert and non-expert users. Delayed calibration and analysis limit the science which can be done. To make the best use of both telescope and human resources we must reduce the burden of data reduction. We propose to build a heterogeneous computing platform for real-time processing of radio telescope array data. Our instrumentation comprises a flexible correlator, beam former, and imager that is based on state-of-the-art digital signal processing closely coupled with a computing cluster. This instrumentation will be highly accessible to scientists, engineers, and students for research and development of real-time processing algorithms, and will tap into the pool of talented and innovative students and visiting scientists from engineering, computing, and astronomy backgrounds. The instrument can be deployed on several telescopes to get feedback from dealing with real sky data on working telescopes. Adaptive real-time imaging will transform radio astronomy by providing real-time feedback to observers. Calibration of the data is made in close to real time using a model of the sky brightness distribution. The derived calibration parameters are fed back into the imagers and beam formers. The regions imaged are used to update and improve the a priori model, which becomes the final calibrated image by the time the observations are complete.</p>
</abstract>
<kwd-group>
<kwd>high performance heterogeneous computing</kwd>
<kwd>real-time data processing</kwd>
<kwd>adaptive calibration and image formation</kwd>
<kwd>synthesis telescopes</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="section1-1094342012445626">
<title>1. Introduction</title>
<p>The scientific goals of the next generation of radio telescopes will be enabled by transforming our approach to signal processing by exploiting the digital revolution. Real-time signal processing for telescope arrays must address data rates that will exceed <inline-formula id="inline-formula1-1094342012445626">
<mml:math id="mml-inline1-1094342012445626">
<mml:mo stretchy="false">~</mml:mo>
</mml:math>
</inline-formula>1 TB s<inline-formula id="inline-formula2-1094342012445626">
<mml:math id="mml-inline2-1094342012445626">
<mml:msup>
<mml:mi>
</mml:mi>
<mml:mrow>
<mml:mo stretchy="false">−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
</mml:math>
</inline-formula> and require petaop/s signal processing. The huge volumes of data must be matched with the computing power to process that data and produce meaningful results. Innovative approaches in signal processing, computing hardware, algorithms, and data handling are necessary. In addition to handling the data rates, adaptive calibration and beamforming are essential to handle atmospheric perturbations (adaptive optics) and radio frequency interference (RFI), and to provide a user environment which makes the full power of large telescope arrays accessible to both expert and non-expert users.</p>
<p>The current data processing paradigm uses on-line custom digital signal processing (DSP) with off-line data reduction and analysis in general-purpose computers. Off-line processing can handle only a few percent of the data generated by the on-line DSP. The large time between data acquisition and analysis results in lost science opportunities.</p>
<p>In this paper we propose to address these problems by integrating on-line and off-line data processing in a heterogeneous system using application-specific integrated circuits (ASICs), field programmable gate arrays (FPGAs), graphics processing units (GPUs) and computer clusters to provide a flexible programming environment with real-time feedback. Adaptive real-time imaging enables us to image large regions with high frequency and time resolution. Variable sources, instrumental problems, and RFI are handled in real time. We propose to build a development computing platform with a flexible correlator, beam former, and imager for radio telescope and receiver arrays that is based on state-of-the-art, DSP closely coupled with a computing cluster. This instrumentation will be accessible to scientists, engineers, and students for research and development of real-time processing algorithms, and taps into the pool of talented and innovative students and visiting scientists from engineering, computing, and astronomy backgrounds. Adaptive real-time imaging is a major step in transforming synthesis imaging from an off-line to a real-time process: a digital camera for radio telescopes. This transformation enables new science, and is necessary to prevent astronomers from being overwhelmed by data and off-line data reduction. In addition to signal processing and scientific advances, new approaches are needed to enable power-efficient instrumentation that is affordable on a massive scale. Adaptive real-time imaging will revolutionize the science capabilities of existing and developing telescopes such as the Atacama Large Millimeter Array (ALMA) and the Murchison Wide-Field Array (MWA), and have a broad impact on the way that radio telescope arrays can be used. Adaptive real-time imaging will transform synthesis telescopes by providing real-time feedback to observers. Obtaining calibrated data and images quickly will enable astronomers to optimize the observations and calibrations needed to realize their science.</p>
<p>Section 2 reviews the current state of the art and the problems faced by existing and next generation aperture synthesis telescopes. Section 3 presents a model for developing adaptive real-time imaging. In Sections 4, 5, and 6 we trace the data processing from the telescopes through cross correlation, calibration, and imaging. Section 7 presents some current developments and conclusion.</p>
</sec>
<sec id="section2-1094342012445626">
<title>2. Aperture synthesis imaging</title>
<p>Arrays of radio telescopes enable us to map the sky brightness using aperture synthesis techniques (<xref ref-type="bibr" rid="bibr27-1094342012445626">Thompson et al., 2001</xref>). If the dimensions of the radio source and the telescope array are small compared with the distance to the source, then the coherence of the wavefront is proportional to the Fourier transform of the intensity distribution of the source (Van Cittert–Zernike theorem; <xref ref-type="bibr" rid="bibr2-1094342012445626">Born and Wolf, 1959</xref>). The coherence, also known as the visibility function, is obtained from measurements of the cross correlation of signals between pairs of antennas in the telescope array. A telescope array with <inline-formula id="inline-formula3-1094342012445626">
<mml:math id="mml-inline3-1094342012445626">
<mml:mi>N</mml:mi>
</mml:math>
</inline-formula> antennas provides <inline-formula id="inline-formula4-1094342012445626">
<mml:math id="mml-inline4-1094342012445626">
<mml:mi>N</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>N</mml:mi>
<mml:mo stretchy="false">−</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo stretchy="false">)</mml:mo>
<mml:mrow>
<mml:mo>/</mml:mo>
</mml:mrow>
<mml:mn>2</mml:mn>
</mml:math>
</inline-formula> cross correlations and <inline-formula id="inline-formula5-1094342012445626">
<mml:math id="mml-inline5-1094342012445626">
<mml:mi>N</mml:mi>
</mml:math>
</inline-formula> autocorrelations for each polarization product. The Earth’s rotation of the projected geometry of the telescope array in the direction of a celestial source provides additional samples of the source visibility function in the aperture plane (<xref ref-type="bibr" rid="bibr24-1094342012445626">Ryle and Neville, 1962</xref>; <xref ref-type="bibr" rid="bibr27-1094342012445626">Thompson et al., 2001</xref>).</p>
<p>Digital cross correlators compute cross-power frequency spectra for all pairs of antennas in the telescope array. Since the signals from celestial radio sources are typically much weaker than the uncorrelated noise power from sky and radio receivers, the measured cross correlations are time averaged to enhance the signal-to-noise ratio.</p>
<p>The Expanded VLA (EVLA) with 27 antennas (<xref ref-type="bibr" rid="bibr23-1094342012445626">Perley et al., 2011</xref>) and ALMA with 64 antennas (<xref ref-type="bibr" rid="bibr29-1094342012445626">Wootten and Thompson, 2009</xref>) represent the current state-of-the-art aperture synthesis telescopes at centimeter and millimeter/submillimeter wavelengths, respectively.</p>
<p>The digital correlators are peta-op, special-purpose computers. The EVLA correlator (<xref ref-type="bibr" rid="bibr4-1094342012445626">Carlson and Dewdney, 2000</xref>) cross correlates all pairs of antennas with up to 16 GHz of bandwidth with a minimum of 16,384 spectral channels in 64 full polarization, independent spectral windows. The ALMA correlator (<xref ref-type="bibr" rid="bibr10-1094342012445626">Escoffier et al., 2007</xref>) processes 16 GHz of bandwidth for the 2016 pairs of antennas and 4 polarization products. The basic operation is a complex-multiply and add operation. The complex-multiply is typically 4 <inline-formula id="inline-formula6-1094342012445626">
<mml:math id="mml-inline6-1094342012445626">
<mml:mo stretchy="false">×</mml:mo>
</mml:math>
</inline-formula> 4-bit with accumulation into 32-bits at rates <inline-formula id="inline-formula7-1094342012445626">
<mml:math id="mml-inline7-1094342012445626">
<mml:mo stretchy="false">~</mml:mo>
<mml:msup>
<mml:mn>10</mml:mn>
<mml:mrow>
<mml:mn>17</mml:mn>
</mml:mrow>
</mml:msup>
</mml:math>
</inline-formula> s<inline-formula id="inline-formula8-1094342012445626">
<mml:math id="mml-inline8-1094342012445626">
<mml:msup>
<mml:mi>
</mml:mi>
<mml:mrow>
<mml:mo stretchy="false">−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
</mml:math>
</inline-formula>. Large digital correlators built using custom ASICS take 5–10 years to develop, e.g. ALMA (<xref ref-type="bibr" rid="bibr10-1094342012445626">Escoffier et al., 2007</xref>) and EVLA (<xref ref-type="bibr" rid="bibr23-1094342012445626">Perley et al., 2011</xref>).</p>
<p>Time-averaged correlation data are written to a data archive for off-line data processing. The data rate from the EVLA correlator can be up to 350 GB s<inline-formula id="inline-formula9-1094342012445626">
<mml:math id="mml-inline9-1094342012445626">
<mml:msup>
<mml:mi>
</mml:mi>
<mml:mrow>
<mml:mo stretchy="false">−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
</mml:math>
</inline-formula>. Only a few percent of this data rate can be handled by the off-line data processing. The current plan for ALMA is an average data rate <inline-formula id="inline-formula10-1094342012445626">
<mml:math id="mml-inline10-1094342012445626">
<mml:mo stretchy="false">~</mml:mo>
<mml:mn>6</mml:mn>
</mml:math>
</inline-formula> MB s<inline-formula id="inline-formula11-1094342012445626">
<mml:math id="mml-inline11-1094342012445626">
<mml:msup>
<mml:mi>
</mml:mi>
<mml:mrow>
<mml:mo stretchy="false">−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
</mml:math>
</inline-formula> and a peak rate 60 MB s<inline-formula id="inline-formula12-1094342012445626">
<mml:math id="mml-inline12-1094342012445626">
<mml:msup>
<mml:mi>
</mml:mi>
<mml:mrow>
<mml:mo stretchy="false">−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
</mml:math>
</inline-formula> (<xref ref-type="bibr" rid="bibr13-1094342012445626">Lucas et al., 2004</xref>). Even so, users will be faced with the prospect of dealing with several terabytes of data for EVLA (<xref ref-type="bibr" rid="bibr20-1094342012445626">Perley, 2004</xref>) and ALMA observations (<xref ref-type="bibr" rid="bibr13-1094342012445626">Lucas et al., 2004</xref>).</p>
<p>Calibration and imaging are made in general-purpose floating point processors using the averaged cross correlations from the data archive. The complex-valued cross correlations are samples of the Fourier transform of the sky brightness distribution. These are calibrated with respect to measurements of known sources. When sufficient cross correlations have been measured, images of the sky brightness distribution can be made from the Fourier transform of the calibrated cross correlations. The images, <inline-formula id="inline-formula13-1094342012445626">
<mml:math id="mml-inline13-1094342012445626">
<mml:mi>I</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mrow>
<mml:mi mathvariant="bold">s</mml:mi>
</mml:mrow>
<mml:mo stretchy="false">,</mml:mo>
<mml:mi>f</mml:mi>
<mml:mo stretchy="false">,</mml:mo>
<mml:mi>p</mml:mi>
<mml:mo stretchy="false">,</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:math>
</inline-formula>, are, in general, functions of position, <bold>s</bold>, frequency, <inline-formula id="inline-formula14-1094342012445626">
<mml:math id="mml-inline14-1094342012445626">
<mml:mi>f</mml:mi>
</mml:math>
</inline-formula>, polarization, <inline-formula id="inline-formula15-1094342012445626">
<mml:math id="mml-inline15-1094342012445626">
<mml:mi>p</mml:mi>
</mml:math>
</inline-formula> (Stokes <inline-formula id="inline-formula16-1094342012445626">
<mml:math id="mml-inline16-1094342012445626">
<mml:mi>I</mml:mi>
</mml:math>
</inline-formula>, <inline-formula id="inline-formula17-1094342012445626">
<mml:math id="mml-inline17-1094342012445626">
<mml:mi>Q</mml:mi>
</mml:math>
</inline-formula>, <inline-formula id="inline-formula18-1094342012445626">
<mml:math id="mml-inline18-1094342012445626">
<mml:mi>U</mml:mi>
</mml:math>
</inline-formula>, <inline-formula id="inline-formula19-1094342012445626">
<mml:math id="mml-inline19-1094342012445626">
<mml:mi>V</mml:mi>
</mml:math>
</inline-formula>), and time, <inline-formula id="inline-formula20-1094342012445626">
<mml:math id="mml-inline20-1094342012445626">
<mml:mi>t</mml:mi>
</mml:math>
</inline-formula>.</p>
<p>Sophisticated image processing algorithms have been developed to self-calibrate the measured cross-correlation function using images of the sky brightness, and to remove sidelobes of the synthesized beam and confusing sources (e.g., <xref ref-type="bibr" rid="bibr8-1094342012445626">Cornwell and Perley, 1992</xref>; <xref ref-type="bibr" rid="bibr27-1094342012445626">Thompson et al., 2001</xref>). These algorithms have been very successful, but are time consuming and require a level of expertise which many astronomers do not wish to acquire in order to do their science. The delayed calibration and analysis of the data limit the science which can be done. Variable sources, targets of opportunity, instrumental and atmospheric problems, and RFI at low frequency are more easily handled as the data are being acquired.</p>
<p>Aperture synthesis arrays at meter wavelengths present formidable problems. The wide field of view of the telescopes are full of radio sources which confuse the regions of interest. The antennas have direction-dependent response over the field of view, and the ionosphere can cause direction-dependent phase shifts on short time scales. LOFAR is a low-frequency array telescope with antennas at 77 stations spread over 100 km and observing in the frequency range 30–90 and 120–250 MHz. Data from the antennas at each station are combined into phased array beams to reduce the data rate to a single data stream for each station. Correlation of the station beams is made in a 34 TFLOP, IBM BlueGene/L. LOFAR calibration and imaging are made in pipelined data processing performing RFI flagging, with calibration using a model sky brightness model (<xref ref-type="bibr" rid="bibr16-1094342012445626">Nijboer et al., 2006</xref>). The MWA was designed as a 512-antenna array being built in Western Australia to observe in the frequency range 80–300 MHz. The correlation data would comprise 130,000 cross correlations with 768 frequency channels and 4 polarization products (<xref ref-type="bibr" rid="bibr17-1094342012445626">Ord et al., 2009</xref>). The data rate <inline-formula id="inline-formula21-1094342012445626">
<mml:math id="mml-inline21-1094342012445626">
<mml:mo stretchy="false">~</mml:mo>
</mml:math>
</inline-formula>19 GB s<inline-formula id="inline-formula22-1094342012445626">
<mml:math id="mml-inline22-1094342012445626">
<mml:msup>
<mml:mi>
</mml:mi>
<mml:mrow>
<mml:mo stretchy="false">−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
</mml:math>
</inline-formula> is impractical to store; data will be calibrated and imaged in a real-time pipeline with images of the sky produced at 8 s intervals. The real-time calibration pipeline processing is discussed in detail by <xref ref-type="bibr" rid="bibr14-1094342012445626">Mitchell et al. (2008</xref>). The MWA was recently de-scoped to a 128-antenna array, which reduces the data rate by a factor 16.</p>
<p>The Square Kilometre Array (SKA) will be able to form simultaneous images in multiple regions within the field of view. The SKA science requirements (<xref ref-type="bibr" rid="bibr26-1094342012445626">Schilizzi et al., 2007</xref>) require imaging multiple regions with an image fidelity <inline-formula id="inline-formula23-1094342012445626">
<mml:math id="mml-inline23-1094342012445626">
<mml:mo stretchy="false">~</mml:mo>
<mml:msup>
<mml:mn>10</mml:mn>
<mml:mn>4</mml:mn>
</mml:msup>
</mml:math>
</inline-formula> between 0.5 and 25 GHz. The bandwidth <inline-formula id="inline-formula24-1094342012445626">
<mml:math id="mml-inline24-1094342012445626">
<mml:mo stretchy="false">~</mml:mo>
</mml:math>
</inline-formula>25% at observing frequencies below 16 GHz, and 4 GHz above 16 GHz. Each band will have <inline-formula id="inline-formula25-1094342012445626">
<mml:math id="mml-inline25-1094342012445626">
<mml:mo stretchy="false">~</mml:mo>
<mml:msup>
<mml:mn>10</mml:mn>
<mml:mn>5</mml:mn>
</mml:msup>
</mml:math>
</inline-formula> spectral channels with a minimum accumulation interval 0.5 s. The images should have at least <inline-formula id="inline-formula26-1094342012445626">
<mml:math id="mml-inline26-1094342012445626">
<mml:msup>
<mml:mn>10</mml:mn>
<mml:mn>5</mml:mn>
</mml:msup>
</mml:math>
</inline-formula> beam areas at the maximum angular resolution. Three Key Science projects require all-sky surveys. Survey science requires images with superb image quality, which imposes stringent requirements on the calibration and sidelobe levels at every stage of beam formation. A major theme driving the SKA design is the high cost of data processing (<xref ref-type="bibr" rid="bibr21-1094342012445626">Perley et al., 2003</xref>; <xref ref-type="bibr" rid="bibr6-1094342012445626">Cornwell, 2004</xref>; <xref ref-type="bibr" rid="bibr12-1094342012445626">Lonsdale et al., 2004</xref>; <xref ref-type="bibr" rid="bibr7-1094342012445626">Cornwell, 2005</xref>; <xref ref-type="bibr" rid="bibr31-1094342012445626">Wright et al., 2006</xref>).</p>
</sec>
<sec id="section3-1094342012445626">
<title>3. Data processing model</title>
<p>In this paper we propose to develop calibration and imaging in close to real time in order to reduce the burden of expert data reduction on the end user, and to make best use of both telescope and human resources. Large arrays and new science require seamlessly integrating calibration and imaging into the data acquisition process. Calibration, imaging, and deconvolving the response of sources outside the fields of interest are intimately related, and are best handled in close to real time, rather than using off-line data processing. Calibration in close to real time uses a model of the sky brightness distribution. The derived calibration parameters are fed back into the imagers and beam formers. The regions imaged update and improve the a priori model, which becomes the final calibrated image by the time the observations are complete (<xref ref-type="fig" rid="fig1-1094342012445626">Figure 1</xref>).</p>
<fig id="fig1-1094342012445626" position="float">
<label>Figure 1.</label>
<caption>
<p>Data flow from telescopes to images. Signals from each antenna are converted to baseband (X) and digitized. The sampled bandwidth is divided into frequency channels using a polyphase filter bank (F). The data are routed through Ethernet switches into cross correlators (X) for each pair of antennas and frequency channel to measure the correlation properties of the incident radiation, and into beam formers to form phased array beams at multiple points in the sky (IFP). The data are calibrated in the Solver by comparing the measured cross correlations, <inline-formula id="inline-formula27-1094342012445626">
<mml:math id="mml-inline27-1094342012445626">
<mml:mi>V</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>f</mml:mi>
<mml:mo stretchy="false">,</mml:mo>
<mml:mi>p</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:math>
</inline-formula>, with a sky brightness model, <inline-formula id="inline-formula28-1094342012445626">
<mml:math id="mml-inline28-1094342012445626">
<mml:mi>M</mml:mi>
<mml:mi>o</mml:mi>
<mml:mi>d</mml:mi>
<mml:mi>e</mml:mi>
<mml:mi>l</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>s</mml:mi>
<mml:mo stretchy="false">,</mml:mo>
<mml:mi>f</mml:mi>
<mml:mo stretchy="false">,</mml:mo>
<mml:mi>p</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:math>
</inline-formula>, to derive instrumental gains, <inline-formula id="inline-formula29-1094342012445626">
<mml:math id="mml-inline29-1094342012445626">
<mml:mi>G</mml:mi>
<mml:mi>a</mml:mi>
<mml:mi>i</mml:mi>
<mml:mi>n</mml:mi>
<mml:mi>s</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>s</mml:mi>
<mml:mo stretchy="false">,</mml:mo>
<mml:mi>f</mml:mi>
<mml:mo stretchy="false">,</mml:mo>
<mml:mi>p</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:math>
</inline-formula>, primary beams, <inline-formula id="inline-formula30-1094342012445626">
<mml:math id="mml-inline30-1094342012445626">
<mml:mi>P</mml:mi>
<mml:mi>B</mml:mi>
<mml:mi>e</mml:mi>
<mml:mi>a</mml:mi>
<mml:mi>m</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>s</mml:mi>
<mml:mo stretchy="false">,</mml:mo>
<mml:mi>f</mml:mi>
<mml:mo stretchy="false">,</mml:mo>
<mml:mi>p</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:math>
</inline-formula>, <inline-formula id="inline-formula31-1094342012445626">
<mml:math id="mml-inline31-1094342012445626">
<mml:mi>B</mml:mi>
<mml:mi>a</mml:mi>
<mml:mi>n</mml:mi>
<mml:mi>d</mml:mi>
<mml:mi>p</mml:mi>
<mml:mi>a</mml:mi>
<mml:mi>s</mml:mi>
<mml:mi>s</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>f</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:math>
</inline-formula>, and polarization, <inline-formula id="inline-formula32-1094342012445626">
<mml:math id="mml-inline32-1094342012445626">
<mml:mi>P</mml:mi>
<mml:mi>o</mml:mi>
<mml:mi>l</mml:mi>
<mml:mi>C</mml:mi>
<mml:mi>a</mml:mi>
<mml:mi>l</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>f</mml:mi>
<mml:mo stretchy="false">,</mml:mo>
<mml:mi>p</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:math>
</inline-formula>, calibrations as a functions of position, <inline-formula id="inline-formula33-1094342012445626">
<mml:math id="mml-inline33-1094342012445626">
<mml:mi>s</mml:mi>
</mml:math>
</inline-formula>, frequency, <inline-formula id="inline-formula34-1094342012445626">
<mml:math id="mml-inline34-1094342012445626">
<mml:mi>f</mml:mi>
</mml:math>
</inline-formula>, and polarization, <inline-formula id="inline-formula35-1094342012445626">
<mml:math id="mml-inline35-1094342012445626">
<mml:mi>p</mml:mi>
</mml:math>
</inline-formula>. Improvements to the sky model are made in the Imager from the difference between the calibrated, measured cross correlations and those derived from the sky model.</p>
</caption>
<graphic alternate-form-of="fig1-1094342012445626" xlink:href="10.1177_1094342012445626-fig1.tif"/>
</fig>
<p>High-performance DSP enables us to handle high data rates in parallel, and to make images in close to real time. Images can be made simultaneously for multiple regions within the field of view by integrating the output from the correlators on multiple targets of interest, calibration sources, and sources whose sidelobes confuse the regions of interest.</p>
<p>The system design uses modular DSP boards with a 10 GbE interconnect architecture which allows reconfiguration of the computing resources for multiple applications. The programming model uses a system generation library with hardware abstractions which allow the application programmer to focus on the application rather than the details of the hardware. The system design and programming model together allow the application software to survive by using a technology-independent design flow. A major problem in the design of large antenna array processors has been the routing of high-bandwidth data. Each cross-correlation processor and beam former must receive data from every antenna, and the number of interconnections can become unmanageable. The Collaboration for Astronomical Signal Processing and Engineering Research (CASPER; http://casper.berkeley.edu) group has developed a packetized signal flow architecture capable of performing this antenna/frequency data transposition using commercial 10 Gbit Ethernet (10 GbE) switches (<xref ref-type="bibr" rid="bibr18-1094342012445626">Parsons et al., 2008</xref>). The FPGA devices are programmed using open-source signal processing libraries developed and supported at multiple observatories that allow flexible, scalable, and device-independent solutions (<xref ref-type="bibr" rid="bibr3-1094342012445626">Brodersen et al., 2004</xref>; <xref ref-type="bibr" rid="bibr18-1094342012445626">Parsons et al., 2008</xref>). This ongoing work reduces the time and cost of implementing interferometer processors while supporting upgrades to new generations of processing technology.</p>
<p>A hybrid solution using beam formation and correlators provides a flexible development path for imaging large fields of view. Phased array beams can be formed anywhere in the sky by adding the signals from the antennas. The sidelobe structure of each beam depends on the array geometry, the source direction, and the amplitude and phase weighting of the signals from each antenna. Beam formation is appropriate for analyzing signals from discrete radio sources such as pulsars, SETI targets, and RFI sources. Beam formation allows us to channel the collecting area of large arrays of telescopes into expensive back-end analysis engines. Direct imaging using beam formation is appropriate for compact sources, but is currently too expensive for imaging large fields. Correlators provide a versatile mechanism for imaging multiple regions within a field of view.</p>
</sec>
<sec id="section4-1094342012445626">
<title>4. Data flow</title>
<p>In this section we trace the data flow through an imaging system using correlators and beam formers. <xref ref-type="fig" rid="fig1-1094342012445626">Figure 1</xref> shows the overall system. The total bandwidth of signals from <inline-formula id="inline-formula36-1094342012445626">
<mml:math id="mml-inline36-1094342012445626">
<mml:mi>N</mml:mi>
</mml:math>
</inline-formula> antennas is <inline-formula id="inline-formula37-1094342012445626">
<mml:math id="mml-inline37-1094342012445626">
<mml:mi>N</mml:mi>
<mml:mo stretchy="false">×</mml:mo>
<mml:mi>B</mml:mi>
<mml:mo stretchy="false">×</mml:mo>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mrow>
<mml:mi>p</mml:mi>
<mml:mi>o</mml:mi>
<mml:mi>l</mml:mi>
</mml:mrow>
</mml:msub>
</mml:math>
</inline-formula>, where <inline-formula id="inline-formula38-1094342012445626">
<mml:math id="mml-inline38-1094342012445626">
<mml:mi>B</mml:mi>
</mml:math>
</inline-formula> is the analog bandwidth and <inline-formula id="inline-formula39-1094342012445626">
<mml:math id="mml-inline39-1094342012445626">
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mrow>
<mml:mi>p</mml:mi>
<mml:mi>o</mml:mi>
<mml:mi>l</mml:mi>
</mml:mrow>
</mml:msub>
</mml:math>
</inline-formula> the number of polarizations from each antenna. The data for each antenna are digitized with 2–12 bit precision. The total data bandwidth is <inline-formula id="inline-formula40-1094342012445626">
<mml:math id="mml-inline40-1094342012445626">
<mml:mi>N</mml:mi>
<mml:mo stretchy="false">×</mml:mo>
<mml:mn>2</mml:mn>
<mml:mi>B</mml:mi>
<mml:mo stretchy="false">×</mml:mo>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mrow>
<mml:mi>p</mml:mi>
<mml:mi>o</mml:mi>
<mml:mi>l</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">×</mml:mo>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mrow>
<mml:mi>b</mml:mi>
<mml:mi>i</mml:mi>
<mml:mi>t</mml:mi>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
</mml:math>
</inline-formula>, e.g., for <inline-formula id="inline-formula41-1094342012445626">
<mml:math id="mml-inline41-1094342012445626">
<mml:mi>N</mml:mi>
</mml:math>
</inline-formula> = 1000, <inline-formula id="inline-formula42-1094342012445626">
<mml:math id="mml-inline42-1094342012445626">
<mml:mi>B</mml:mi>
</mml:math>
</inline-formula> = 1 GHz, <inline-formula id="inline-formula43-1094342012445626">
<mml:math id="mml-inline43-1094342012445626">
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mrow>
<mml:mi>p</mml:mi>
<mml:mi>o</mml:mi>
<mml:mi>l</mml:mi>
</mml:mrow>
</mml:msub>
</mml:math>
</inline-formula> = 2, and <inline-formula id="inline-formula44-1094342012445626">
<mml:math id="mml-inline44-1094342012445626">
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mrow>
<mml:mi>b</mml:mi>
<mml:mi>i</mml:mi>
<mml:mi>t</mml:mi>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
</mml:math>
</inline-formula> = 8, the total data bandwidth is <inline-formula id="inline-formula45-1094342012445626">
<mml:math id="mml-inline45-1094342012445626">
<mml:mn>4</mml:mn>
<mml:mo stretchy="false">×</mml:mo>
<mml:msup>
<mml:mn>10</mml:mn>
<mml:mrow>
<mml:mn>12</mml:mn>
</mml:mrow>
</mml:msup>
</mml:math>
</inline-formula> bytes s<inline-formula id="inline-formula46-1094342012445626">
<mml:math id="mml-inline46-1094342012445626">
<mml:msup>
<mml:mi>
</mml:mi>
<mml:mrow>
<mml:mo stretchy="false">−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
</mml:math>
</inline-formula>.</p>
<p>The bandwidth must be channelized to provide spectral resolution, to facilitate interference rejection, and to reduce bandwidth smearing by using multi-frequency synthesis (MFS). The science and RFI requirements for a large number of frequency channels favor an ‘FX’ architecture (<xref ref-type="fig" rid="fig1-1094342012445626">Figure 1</xref>). Voltage signals from each antenna and polarization are divided into many frequency channels (‘F’ stage). Excellent separation of frequency channels can be obtained with polyphase filters. Fixed point processors are well matched to the ‘F’ stage, with <inline-formula id="inline-formula47-1094342012445626">
<mml:math id="mml-inline47-1094342012445626">
<mml:mo stretchy="false">~</mml:mo>
</mml:math>
</inline-formula>
<inline-formula id="inline-formula48-1094342012445626">
<mml:math id="mml-inline48-1094342012445626">
<mml:mrow>
<mml:mi mathvariant="normal">l</mml:mi>
<mml:mi mathvariant="normal">o</mml:mi>
<mml:mi mathvariant="normal">g</mml:mi>
</mml:mrow>
</mml:math>
</inline-formula>
<inline-formula id="inline-formula49-1094342012445626">
<mml:math id="mml-inline49-1094342012445626">
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mrow>
<mml:mi>c</mml:mi>
<mml:mi>h</mml:mi>
<mml:mi>a</mml:mi>
<mml:mi>n</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
</mml:math>
</inline-formula> complex-multiply–add operations and a high data bandwidth. After the frequency transform, the data can be processed in parallel, reducing the data rate in each frequency channel by a factor <inline-formula id="inline-formula50-1094342012445626">
<mml:math id="mml-inline50-1094342012445626">
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mrow>
<mml:mi>c</mml:mi>
<mml:mi>h</mml:mi>
<mml:mi>a</mml:mi>
<mml:mi>n</mml:mi>
</mml:mrow>
</mml:msub>
</mml:math>
</inline-formula>.</p>
<p>These data are routed into cross correlators for each pair of antennas and frequency channel to measure the correlation properties of the incident radiation (‘X’ stage), and into beam formers to form phased array beams at multiple points in the sky. Commercial 10-GbE switches provide flexible routing which allows the DSP to be upgraded, repaired, and reprogrammed with minimum interruption to telescope operations.</p>
<p>Cross correlation is a complex-multiply and accumulate operation for all pairs of antennas and polarizations. For a dual polarization array with <inline-formula id="inline-formula51-1094342012445626">
<mml:math id="mml-inline51-1094342012445626">
<mml:mi>N</mml:mi>
</mml:math>
</inline-formula> antennas and bandwidth, <inline-formula id="inline-formula52-1094342012445626">
<mml:math id="mml-inline52-1094342012445626">
<mml:mi>B</mml:mi>
</mml:math>
</inline-formula>, the correlator must provide <inline-formula id="inline-formula53-1094342012445626">
<mml:math id="mml-inline53-1094342012445626">
<mml:mn>2</mml:mn>
<mml:mi>N</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mn>2</mml:mn>
<mml:mi>N</mml:mi>
<mml:mo stretchy="false">+</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo stretchy="false">)</mml:mo>
<mml:mrow>
<mml:mo>/</mml:mo>
</mml:mrow>
<mml:mn>2</mml:mn>
<mml:mo stretchy="false">×</mml:mo>
<mml:mi>B</mml:mi>
</mml:math>
</inline-formula> complex-multiply and accumulate operations per second, independent of the number of frequency channels. The complex-multiply is typically 4 <inline-formula id="inline-formula54-1094342012445626">
<mml:math id="mml-inline54-1094342012445626">
<mml:mo stretchy="false">×</mml:mo>
</mml:math>
</inline-formula> 4 bit with accumulation into 32 bits. Using fewer bits in the cross correlation results in a small loss in resulting signal to noise, but allows the use of lookup tables for the cross correlations. Floating point processors can also be used. Performance, cost, and power comparisons of ASIC, FPGA, GPU, and CPU processors have been made by a number of authors (<xref ref-type="bibr" rid="bibr17-1094342012445626">Ord et al., 2009</xref>; <xref ref-type="bibr" rid="bibr15-1094342012445626">Nieuwpoort and Romein, 2009</xref>; <xref ref-type="bibr" rid="bibr5-1094342012445626">Clark et al., 2012</xref>). An order of magnitude estimate for the cost of a custom ASIC correlator, which has been considered by the CASPER group, is US$2M + US$10 per chip, versus US$2000 for a high-performance GPU or FPGA, which suggest that an ASIC correlator would be a better solution for systems with more than <inline-formula id="inline-formula55-1094342012445626">
<mml:math id="mml-inline55-1094342012445626">
<mml:mo stretchy="false">~</mml:mo>
<mml:mn>1000</mml:mn>
</mml:math>
</inline-formula> chips. The development times are GPU (<inline-formula id="inline-formula56-1094342012445626">
<mml:math id="mml-inline56-1094342012445626">
<mml:mo stretchy="false">~</mml:mo>
<mml:mn>1</mml:mn>
</mml:math>
</inline-formula> year), FPGA (<inline-formula id="inline-formula57-1094342012445626">
<mml:math id="mml-inline57-1094342012445626">
<mml:mo stretchy="false">~</mml:mo>
<mml:mn>2</mml:mn>
</mml:math>
</inline-formula> year), ASIC (<inline-formula id="inline-formula58-1094342012445626">
<mml:math id="mml-inline58-1094342012445626">
<mml:mo stretchy="false">~</mml:mo>
<mml:mn>5</mml:mn>
</mml:math>
</inline-formula> year). ASICs or FPGAs offer more bandwidth, GPUs offer more FLOPS per US$. Development time favors GPUs. ASICs will be required for arrays with large numbers of correlations in order to meet the power/heat requirements. A heterogeneous system would allow choosing the appropriate solutions at each stage of the data flow. Clark et al. (2011, Section 2.3) gave a useful discussion.</p>
<p>After correlation there are <inline-formula id="inline-formula59-1094342012445626">
<mml:math id="mml-inline59-1094342012445626">
<mml:mi>N</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>N</mml:mi>
<mml:mo stretchy="false">+</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo stretchy="false">)</mml:mo>
<mml:mrow>
<mml:mo>/</mml:mo>
</mml:mrow>
<mml:mn>2</mml:mn>
</mml:math>
</inline-formula> autocorrelations and cross correlations for each polarization product. The data are then time averaged. The data rate is reduced from the input bandwidth, <inline-formula id="inline-formula60-1094342012445626">
<mml:math id="mml-inline60-1094342012445626">
<mml:mi>B</mml:mi>
</mml:math>
</inline-formula>, to the rate of change of the cross correlations: the fringe rate. In order to correlate the signals from a sidereal source anywhere in the sky, the data bandwidth from the correlator is<disp-formula id="disp-formula1-1094342012445626">
<mml:math id="mml-disp1-1094342012445626">
<mml:mi>N</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>N</mml:mi>
<mml:mo stretchy="false">+</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo stretchy="false">)</mml:mo>
<mml:mrow>
<mml:mo>/</mml:mo>
</mml:mrow>
<mml:mn>2</mml:mn>
<mml:mo stretchy="false">×</mml:mo>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mrow>
<mml:mi>p</mml:mi>
<mml:mi>o</mml:mi>
<mml:mi>l</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">×</mml:mo>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mrow>
<mml:mi>c</mml:mi>
<mml:mi>h</mml:mi>
<mml:mi>a</mml:mi>
<mml:mi>n</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">×</mml:mo>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mrow>
<mml:mi>b</mml:mi>
<mml:mi>i</mml:mi>
<mml:mi>t</mml:mi>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">×</mml:mo>
<mml:mn>2</mml:mn>
<mml:mtext> </mml:mtext>
<mml:mi>s</mml:mi>
<mml:mi>d</mml:mi>
<mml:mi>o</mml:mi>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">×</mml:mo>
<mml:msub>
<mml:mi>D</mml:mi>
<mml:mrow>
<mml:mi>m</mml:mi>
<mml:mi>a</mml:mi>
<mml:mi>x</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>/</mml:mo>
</mml:mrow>
<mml:mi mathvariant="italic">λ</mml:mi>
<mml:mo stretchy="false">,</mml:mo>
</mml:math>
<graphic alternate-form-of="disp-formula1-1094342012445626" xlink:href="10.1177_1094342012445626-eq1.tif"/>
</disp-formula>where <inline-formula id="inline-formula61-1094342012445626">
<mml:math id="mml-inline61-1094342012445626">
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mrow>
<mml:mi>p</mml:mi>
<mml:mi>o</mml:mi>
<mml:mi>l</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">=</mml:mo>
<mml:mn>4</mml:mn>
</mml:math>
</inline-formula> polarization products, and <inline-formula id="inline-formula62-1094342012445626">
<mml:math id="mml-inline62-1094342012445626">
<mml:mi>s</mml:mi>
<mml:mi>d</mml:mi>
<mml:mi>o</mml:mi>
<mml:mi>t</mml:mi>
</mml:math>
</inline-formula> is the Earth’s rotation rate, <inline-formula id="inline-formula63-1094342012445626">
<mml:math id="mml-inline63-1094342012445626">
<mml:mn>7.27</mml:mn>
<mml:mo stretchy="false">×</mml:mo>
<mml:msup>
<mml:mn>10</mml:mn>
<mml:mrow>
<mml:mo stretchy="false">−</mml:mo>
<mml:mn>5</mml:mn>
</mml:mrow>
</mml:msup>
</mml:math>
</inline-formula> rad s<inline-formula id="inline-formula64-1094342012445626">
<mml:math id="mml-inline64-1094342012445626">
<mml:msup>
<mml:mi>
</mml:mi>
<mml:mrow>
<mml:mo stretchy="false">−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
</mml:math>
</inline-formula>. e.g., for <inline-formula id="inline-formula65-1094342012445626">
<mml:math id="mml-inline65-1094342012445626">
<mml:mi>N</mml:mi>
<mml:mo stretchy="false">=</mml:mo>
<mml:mn>1000</mml:mn>
</mml:math>
</inline-formula>, <inline-formula id="inline-formula66-1094342012445626">
<mml:math id="mml-inline66-1094342012445626">
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mrow>
<mml:mi>c</mml:mi>
<mml:mi>h</mml:mi>
<mml:mi>a</mml:mi>
<mml:mi>n</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">=</mml:mo>
<mml:msup>
<mml:mn>10</mml:mn>
<mml:mn>5</mml:mn>
</mml:msup>
</mml:math>
</inline-formula>, <inline-formula id="inline-formula67-1094342012445626">
<mml:math id="mml-inline67-1094342012445626">
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mrow>
<mml:mi>p</mml:mi>
<mml:mi>o</mml:mi>
<mml:mi>l</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">=</mml:mo>
<mml:mn>4</mml:mn>
</mml:math>
</inline-formula>, <inline-formula id="inline-formula68-1094342012445626">
<mml:math id="mml-inline68-1094342012445626">
<mml:msub>
<mml:mi>D</mml:mi>
<mml:mrow>
<mml:mi>m</mml:mi>
<mml:mi>a</mml:mi>
<mml:mi>x</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">=</mml:mo>
<mml:mn>1000</mml:mn>
<mml:mrow>
<mml:mrow>
<mml:mi mathvariant="normal">k</mml:mi>
<mml:mi mathvariant="normal">m</mml:mi>
</mml:mrow>
</mml:mrow>
<mml:mo stretchy="false">,</mml:mo>
</mml:math>
</inline-formula> <inline-formula id="inline-formula69-1094342012445626">
<mml:math id="mml-inline69-1094342012445626">
<mml:mi mathvariant="italic">λ</mml:mi>
<mml:mo stretchy="false">=</mml:mo>
<mml:mn>1</mml:mn>
<mml:mrow>
<mml:mrow>
<mml:mi mathvariant="normal">c</mml:mi>
<mml:mi mathvariant="normal">m</mml:mi>
</mml:mrow>
</mml:mrow>
</mml:math>
</inline-formula>, and <inline-formula id="inline-formula70-1094342012445626">
<mml:math id="mml-inline70-1094342012445626">
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mrow>
<mml:mi>b</mml:mi>
<mml:mi>i</mml:mi>
<mml:mi>t</mml:mi>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">=</mml:mo>
<mml:mn>2</mml:mn>
<mml:mo stretchy="false">×</mml:mo>
<mml:mn>16</mml:mn>
</mml:math>
</inline-formula> (complex data), the total data bandwidth would be <inline-formula id="inline-formula71-1094342012445626">
<mml:math id="mml-inline71-1094342012445626">
<mml:mo stretchy="false">~</mml:mo>
<mml:msup>
<mml:mn>10</mml:mn>
<mml:mrow>
<mml:mn>16</mml:mn>
</mml:mrow>
</mml:msup>
</mml:math>
</inline-formula> bytes s<inline-formula id="inline-formula72-1094342012445626">
<mml:math id="mml-inline72-1094342012445626">
<mml:msup>
<mml:mi>
</mml:mi>
<mml:mrow>
<mml:mo stretchy="false">−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
</mml:math>
</inline-formula>.</p>
<p>Sampling the correlator at the fringe rate allows us to make images over a wide field of view, including targets of interest, calibration sources, and sources whose sidelobes confuse the regions of interest. We can form simultaneous images in multiple regions within the field of view by integrating the output from the correlators at multiple phase centers. The data stream from each correlator is multiplied by phase factors, <inline-formula id="inline-formula73-1094342012445626">
<mml:math id="mml-inline73-1094342012445626">
<mml:mo form="prefix" movablelimits="false">exp</mml:mo>
<mml:mtext> </mml:mtext>
<mml:mo stretchy="false">(</mml:mo>
<mml:mn>2</mml:mn>
<mml:mi mathvariant="italic">π</mml:mi>
<mml:mi>i</mml:mi>
<mml:mrow>
<mml:mo>/</mml:mo>
</mml:mrow>
<mml:mi mathvariant="italic">λ</mml:mi>
<mml:mtext> </mml:mtext>
<mml:mi>r</mml:mi>
<mml:mo>.</mml:mo>
<mml:msub>
<mml:mi>s</mml:mi>
<mml:mi>o</mml:mi>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
</mml:math>
</inline-formula>, where <inline-formula id="inline-formula74-1094342012445626">
<mml:math id="mml-inline74-1094342012445626">
<mml:mi>r</mml:mi>
<mml:mo stretchy="false">=</mml:mo>
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>r</mml:mi>
<mml:mi>j</mml:mi>
</mml:msub>
<mml:mo stretchy="false">−</mml:mo>
<mml:msub>
<mml:mi>r</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
</mml:math>
</inline-formula> is the baseline vector for antenna pair <inline-formula id="inline-formula75-1094342012445626">
<mml:math id="mml-inline75-1094342012445626">
<mml:mo stretchy="false">(</mml:mo>
<mml:msub>
<mml:mi>r</mml:mi>
<mml:mi>j</mml:mi>
</mml:msub>
<mml:mo stretchy="false">,</mml:mo>
<mml:msub>
<mml:mi>r</mml:mi>
<mml:mi>k</mml:mi>
</mml:msub>
<mml:mo stretchy="false">)</mml:mo>
</mml:math>
</inline-formula>, and <inline-formula id="inline-formula76-1094342012445626">
<mml:math id="mml-inline76-1094342012445626">
<mml:msub>
<mml:mi>s</mml:mi>
<mml:mi>o</mml:mi>
</mml:msub>
</mml:math>
</inline-formula> is the phase center in each region of interest. The data bandwidth for imaging the primary beam width is<disp-formula id="disp-formula2-1094342012445626">
<mml:math id="mml-disp2-1094342012445626">
<mml:mi>N</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>N</mml:mi>
<mml:mo stretchy="false">−</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo stretchy="false">)</mml:mo>
<mml:mrow>
<mml:mo>/</mml:mo>
</mml:mrow>
<mml:mn>2</mml:mn>
<mml:mo stretchy="false">×</mml:mo>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mrow>
<mml:mi>p</mml:mi>
<mml:mi>o</mml:mi>
<mml:mi>l</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">×</mml:mo>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mrow>
<mml:mi>c</mml:mi>
<mml:mi>h</mml:mi>
<mml:mi>a</mml:mi>
<mml:mi>n</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">×</mml:mo>
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mrow>
<mml:mi>b</mml:mi>
<mml:mi>i</mml:mi>
<mml:mi>t</mml:mi>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">×</mml:mo>
<mml:mn>2</mml:mn>
<mml:mtext> </mml:mtext>
<mml:mi>s</mml:mi>
<mml:mi>d</mml:mi>
<mml:mi>o</mml:mi>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">×</mml:mo>
<mml:msub>
<mml:mi>D</mml:mi>
<mml:mrow>
<mml:mi>m</mml:mi>
<mml:mi>a</mml:mi>
<mml:mi>x</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>/</mml:mo>
</mml:mrow>
<mml:msub>
<mml:mi>D</mml:mi>
<mml:mrow>
<mml:mi>a</mml:mi>
<mml:mi>n</mml:mi>
<mml:mi>t</mml:mi>
</mml:mrow>
</mml:msub>
</mml:math>
<graphic alternate-form-of="disp-formula2-1094342012445626" xlink:href="10.1177_1094342012445626-eq2.tif"/>
</disp-formula>e.g., for <inline-formula id="inline-formula77-1094342012445626">
<mml:math id="mml-inline77-1094342012445626">
<mml:mi>N</mml:mi>
<mml:mo stretchy="false">=</mml:mo>
<mml:mn>1000</mml:mn>
</mml:math>
</inline-formula>, <inline-formula id="inline-formula78-1094342012445626">
<mml:math id="mml-inline78-1094342012445626">
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mrow>
<mml:mi>c</mml:mi>
<mml:mi>h</mml:mi>
<mml:mi>a</mml:mi>
<mml:mi>n</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">=</mml:mo>
<mml:msup>
<mml:mn>10</mml:mn>
<mml:mn>5</mml:mn>
</mml:msup>
</mml:math>
</inline-formula>, <inline-formula id="inline-formula79-1094342012445626">
<mml:math id="mml-inline79-1094342012445626">
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mrow>
<mml:mi>p</mml:mi>
<mml:mi>o</mml:mi>
<mml:mi>l</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">=</mml:mo>
<mml:mn>4</mml:mn>
</mml:math>
</inline-formula>, <inline-formula id="inline-formula80-1094342012445626">
<mml:math id="mml-inline80-1094342012445626">
<mml:msub>
<mml:mi>D</mml:mi>
<mml:mrow>
<mml:mi>a</mml:mi>
<mml:mi>n</mml:mi>
<mml:mi>t</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">=</mml:mo>
<mml:mn>12</mml:mn>
<mml:mi>m</mml:mi>
</mml:math>
</inline-formula>, and <inline-formula id="inline-formula81-1094342012445626">
<mml:math id="mml-inline81-1094342012445626">
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mrow>
<mml:mi>b</mml:mi>
<mml:mi>i</mml:mi>
<mml:mi>t</mml:mi>
<mml:mi>s</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo stretchy="false">=</mml:mo>
<mml:mn>2</mml:mn>
<mml:mo stretchy="false">×</mml:mo>
<mml:mn>16</mml:mn>
</mml:math>
</inline-formula> (complex data), the total data bandwidth is <inline-formula id="inline-formula82-1094342012445626">
<mml:math id="mml-inline82-1094342012445626">
<mml:mn>2</mml:mn>
<mml:mo stretchy="false">×</mml:mo>
<mml:msup>
<mml:mn>10</mml:mn>
<mml:mrow>
<mml:mn>10</mml:mn>
</mml:mrow>
</mml:msup>
</mml:math>
</inline-formula> bytes s<inline-formula id="inline-formula83-1094342012445626">
<mml:math id="mml-inline83-1094342012445626">
<mml:msup>
<mml:mi>
</mml:mi>
<mml:mrow>
<mml:mo stretchy="false">−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
</mml:math>
</inline-formula> for 1 km baselines, and <inline-formula id="inline-formula84-1094342012445626">
<mml:math id="mml-inline84-1094342012445626">
<mml:mn>2</mml:mn>
<mml:mo stretchy="false">×</mml:mo>
<mml:msup>
<mml:mn>10</mml:mn>
<mml:mrow>
<mml:mn>13</mml:mn>
</mml:mrow>
</mml:msup>
</mml:math>
</inline-formula> bytes s<inline-formula id="inline-formula85-1094342012445626">
<mml:math id="mml-inline85-1094342012445626">
<mml:msup>
<mml:mi>
</mml:mi>
<mml:mrow>
<mml:mo stretchy="false">−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
</mml:math>
</inline-formula> for 1000 km baselines.</p>
</sec>
<sec id="section5-1094342012445626">
<title>5. Calibration</title>
<p>An a priori model of the sky brightness distribution is used for calibration and imaging. In the standard observing paradigm, strong compact sources are used as primary calibrators, and self-calibration is used to improve the calibration during the off-line imaging process. The calibrations are the product of antenna station beam patterns, gains, bandpass, and polarization corrections which are derived from a least-squares fit of the data to a model visibility which is computed for the calibration source or the sky brightness model. For compact sources, a simple direct Fourier transform can be used. For more complex sky brightness models, a gridded fast Fourier transform (FFT) can be used to derive the model visibility used in a least-squares fit to the measured cross correlations. The calibrations may vary with time and position in the sky. For phased array station beams, atmospheric fluctuations make the primary beam response time variable. Our approach to these problems is to separately calibrate the data for each phase center. We can identify regions which have bright emission from a priori images of the sky brightness, and image only regions which are of interest or contain sources whose sidelobes corrupt the regions of interest. Confusing sources may be in the sidelobes of the primary beam, or in different isoplanatic regions. The sky model is used in a self-calibration algorithm to determine the antenna calibration as a function of time for each phase center which contains suitable sources. The calibrations at each phase center are correlated, and can be improved by developing a global model across the array as a function of time and frequency (<xref ref-type="bibr" rid="bibr16-1094342012445626">Nijboer et al., 2006</xref>). If the source contains spectral lines, multiple frequency channels are used simultaneously to determine the calibration. Observations in multiple frequency bands can be used to separate the gains into tropospheric and ionospheric delays. The data streams can be buffered so that the gains can be averaged and interpolated before being applied to the data stream. Confusing sources are removed by subtracting the source model from the calibrated data stream. The subtraction can be made for each region of interest and frequency channel in distributed processors associated with each correlation engine, but including the response from the whole sky model, especially of course the strong sources (<xref ref-type="bibr" rid="bibr30-1094342012445626">Wright, 2005</xref>; <xref ref-type="bibr" rid="bibr14-1094342012445626">Mitchell et al., 2008</xref>).</p>
<p>The basic calibration computation is a complex-multiply of the measured cross correlations (<italic>uv</italic> data) for each data sample and frequency channel. The calibrations can be stored in data structures and applied when the <inline-formula id="inline-formula86-1094342012445626">
<mml:math id="mml-inline86-1094342012445626">
<mml:mi>u</mml:mi>
<mml:mi>v</mml:mi>
</mml:math>
</inline-formula> data are plotted, analyzed, or imaged. In <xref ref-type="fig" rid="fig2-1094342012445626">Figure 2</xref>, we plot the computation time for calibrating multi-channel <inline-formula id="inline-formula87-1094342012445626">
<mml:math id="mml-inline87-1094342012445626">
<mml:mi>u</mml:mi>
<mml:mi>v</mml:mi>
</mml:math>
</inline-formula> data versus the number of <inline-formula id="inline-formula88-1094342012445626">
<mml:math id="mml-inline88-1094342012445626">
<mml:mi>u</mml:mi>
<mml:mi>v</mml:mi>
</mml:math>
</inline-formula> data samples in an off-line simulation for ALMA data with 60 antennas in a 4 km configuration. <xref ref-type="fig" rid="fig2-1094342012445626">Figure 2</xref> shows that the off-line calibration time is proportional to the number of <inline-formula id="inline-formula89-1094342012445626">
<mml:math id="mml-inline89-1094342012445626">
<mml:mi>u</mml:mi>
<mml:mi>v</mml:mi>
</mml:math>
</inline-formula> data samples. We used the MIRIAD data reduction package (<xref ref-type="bibr" rid="bibr25-1094342012445626">Sault et al., 1995</xref>), which uses a streaming data format. The complex-valued <inline-formula id="inline-formula90-1094342012445626">
<mml:math id="mml-inline90-1094342012445626">
<mml:mi>u</mml:mi>
<mml:mi>v</mml:mi>
</mml:math>
</inline-formula> data were represented by 4 bytes per frequency channel with a scaling factor for each multi-channel data sample. The 4-byte representation of the <inline-formula id="inline-formula91-1094342012445626">
<mml:math id="mml-inline91-1094342012445626">
<mml:msub>
<mml:mi>N</mml:mi>
<mml:mrow>
<mml:mi>c</mml:mi>
<mml:mi>h</mml:mi>
<mml:mi>a</mml:mi>
<mml:mi>n</mml:mi>
</mml:mrow>
</mml:msub>
</mml:math>
</inline-formula> allows a 1:32,000 spectral dynamic range for each multi-channel data sample. Including the time-variable metadata which describe the data, the telescope, and the observations, the total length was 460 bytes for a 100-channel data sample. The calibration rate was 6 MB s<inline-formula id="inline-formula92-1094342012445626">
<mml:math id="mml-inline92-1094342012445626">
<mml:msup>
<mml:mi>
</mml:mi>
<mml:mrow>
<mml:mo stretchy="false">−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
</mml:math>
</inline-formula>, showing that the average data rate currently allowed for ALMA could be calibrated in a single pipelined process on a standard rack server, and that much higher data rates could be supported in multiple threads on a modest sized cluster. Further gains in computing efficiency are clearly possible. Off-line data reduction typically uses static ‘measurement sets’ with the <inline-formula id="inline-formula93-1094342012445626">
<mml:math id="mml-inline93-1094342012445626">
<mml:mi>u</mml:mi>
<mml:mi>v</mml:mi>
</mml:math>
</inline-formula> data represented as 8- or 16-byte complex values. An astronomer using off-line data processing typically keeps several copies of calibrated and uncalibrated <inline-formula id="inline-formula94-1094342012445626">
<mml:math id="mml-inline94-1094342012445626">
<mml:mi>u</mml:mi>
<mml:mi>v</mml:mi>
</mml:math>
</inline-formula> data, with each step requiring reading and writing the <inline-formula id="inline-formula95-1094342012445626">
<mml:math id="mml-inline95-1094342012445626">
<mml:mi>u</mml:mi>
<mml:mi>v</mml:mi>
</mml:math>
</inline-formula> data.</p>
<fig id="fig2-1094342012445626" position="float">
<label>Figure 2.</label>
<caption>
<p>Timing for <inline-formula id="inline-formula96-1094342012445626">
<mml:math id="mml-inline96-1094342012445626">
<mml:mn>1280</mml:mn>
<mml:mo stretchy="false">×</mml:mo>
<mml:mn>1280</mml:mn>
<mml:mo stretchy="false">×</mml:mo>
<mml:mn>100</mml:mn>
</mml:math>
</inline-formula>-channel imaging using simulated MIRIAD data for ALMA with 60 antennas in a 4 km configuration. The dashed line shows the time for applying the antenna-based gains and bandpass calibrations to the <inline-formula id="inline-formula97-1094342012445626">
<mml:math id="mml-inline97-1094342012445626">
<mml:mi>u</mml:mi>
<mml:mi>v</mml:mi>
</mml:math>
</inline-formula> data, or for subtracting the sky brightness model from the <inline-formula id="inline-formula98-1094342012445626">
<mml:math id="mml-inline98-1094342012445626">
<mml:mi>u</mml:mi>
<mml:mi>v</mml:mi>
</mml:math>
</inline-formula> data. The imaging step (dash-dotted line) applies the weights to the <inline-formula id="inline-formula99-1094342012445626">
<mml:math id="mml-inline99-1094342012445626">
<mml:mi>u</mml:mi>
<mml:mi>v</mml:mi>
</mml:math>
</inline-formula> data, convolves the calibrated <inline-formula id="inline-formula100-1094342012445626">
<mml:math id="mml-inline100-1094342012445626">
<mml:mi>u</mml:mi>
<mml:mi>v</mml:mi>
</mml:math>
</inline-formula> data onto a gridded <inline-formula id="inline-formula101-1094342012445626">
<mml:math id="mml-inline101-1094342012445626">
<mml:mi>u</mml:mi>
<mml:mi>v</mml:mi>
</mml:math>
</inline-formula> plane, and uses a fast Fourier transform to make the synthesized multi-channel image and synthesized beam. Off-line calibration and imaging are typically made in several steps. In a real-time pipeline, these steps can be made in sequence on the data stream. The bottom two lines show the time for deconvolving the synthesized beam response from the 100-channel image using the CLEAN algorithm (dots), and convolving by a Gaussian beam (3-dot-dashes).</p>
</caption>
<graphic alternate-form-of="fig2-1094342012445626" xlink:href="10.1177_1094342012445626-fig2.tif"/>
</fig>
<p>In a real-time imaging pipeline, the calibrations are derived from and applied to the data streams from the correlators (see <xref ref-type="fig" rid="fig1-1094342012445626">Figure 1</xref>). RFI must be also subtracted from the data stream before it is passed to the imaging engine and beam formers. RFI presents a special case in several ways. RFI sources may be stationary, or moving across the sky at a non-sidereal rate. A correlator can be used to locate and characterize RFI as a function of time, frequency, and polarization. The signal-to-noise ratio can be improved by pointing some of the antennas or beam formers at the RFI sources. Correlators allocated to measuring RFI may need to sample the signal at high data rates. For phased array telescopes, the station beam can form nulls at the position of (moving) RFI sources. Accurate calibration of the array antennas is required in real time (<xref ref-type="bibr" rid="bibr1-1094342012445626">Barott et al., 2011</xref>).</p>
</sec>
<sec id="section6-1094342012445626">
<title>6. Real-time imaging</title>
<p>The standard imaging algorithm is a FFT of the gridded <inline-formula id="inline-formula102-1094342012445626">
<mml:math id="mml-inline102-1094342012445626">
<mml:mi>u</mml:mi>
<mml:mi>v</mml:mi>
</mml:math>
</inline-formula> data for each field of view, polarization, and frequency channel. Here we review the basic math. For a more detailed description, see, e.g., <xref ref-type="bibr" rid="bibr27-1094342012445626">Thompson et al. (2001</xref>), and references therein. The brightness distribution is the Fourier transform of the sampled visibility data, <inline-formula id="inline-formula103-1094342012445626">
<mml:math id="mml-inline103-1094342012445626">
<mml:mi>V</mml:mi>
</mml:math>
</inline-formula>. Since we have only discrete samples of <inline-formula id="inline-formula104-1094342012445626">
<mml:math id="mml-inline104-1094342012445626">
<mml:mi>V</mml:mi>
</mml:math>
</inline-formula>, we define a weighting function <inline-formula id="inline-formula105-1094342012445626">
<mml:math id="mml-inline105-1094342012445626">
<mml:mi>W</mml:mi>
</mml:math>
</inline-formula>, and make an image <inline-formula id="inline-formula106-1094342012445626">
<mml:math id="mml-inline106-1094342012445626">
<mml:msup>
<mml:mi>I</mml:mi>
<mml:mo>′</mml:mo>
</mml:msup>
</mml:math>
</inline-formula> which is the Fourier transform of the product of <inline-formula id="inline-formula107-1094342012445626">
<mml:math id="mml-inline107-1094342012445626">
<mml:mi>V</mml:mi>
</mml:math>
</inline-formula> and <inline-formula id="inline-formula108-1094342012445626">
<mml:math id="mml-inline108-1094342012445626">
<mml:mi>W</mml:mi>
</mml:math>
</inline-formula>. The weighting function <inline-formula id="inline-formula109-1094342012445626">
<mml:math id="mml-inline109-1094342012445626">
<mml:mi>W</mml:mi>
</mml:math>
</inline-formula> is typically chosen to minimize the noise and make a more uniform weighting of the sampled <inline-formula id="inline-formula110-1094342012445626">
<mml:math id="mml-inline110-1094342012445626">
<mml:mi>u</mml:mi>
<mml:mi>v</mml:mi>
</mml:math>
</inline-formula> plane. <inline-formula id="inline-formula111-1094342012445626">
<mml:math id="mml-inline111-1094342012445626">
<mml:mi>W</mml:mi>
<mml:mo stretchy="false">=</mml:mo>
<mml:mn>0</mml:mn>
</mml:math>
</inline-formula> where <inline-formula id="inline-formula112-1094342012445626">
<mml:math id="mml-inline112-1094342012445626">
<mml:mi>V</mml:mi>
</mml:math>
</inline-formula> is not sampled. The image <inline-formula id="inline-formula113-1094342012445626">
<mml:math id="mml-inline113-1094342012445626">
<mml:msup>
<mml:mi>I</mml:mi>
<mml:mo>′</mml:mo>
</mml:msup>
</mml:math>
</inline-formula>, the Fourier transform of the product of <inline-formula id="inline-formula114-1094342012445626">
<mml:math id="mml-inline114-1094342012445626">
<mml:mi>V</mml:mi>
</mml:math>
</inline-formula> and <inline-formula id="inline-formula115-1094342012445626">
<mml:math id="mml-inline115-1094342012445626">
<mml:mi>W</mml:mi>
</mml:math>
</inline-formula>, is the convolution of the Fourier transforms of <inline-formula id="inline-formula116-1094342012445626">
<mml:math id="mml-inline116-1094342012445626">
<mml:mi>V</mml:mi>
</mml:math>
</inline-formula> and <inline-formula id="inline-formula117-1094342012445626">
<mml:math id="mml-inline117-1094342012445626">
<mml:mi>W</mml:mi>
</mml:math>
</inline-formula>. The observed brightness distribution is the sky brightness distribution, <inline-formula id="inline-formula118-1094342012445626">
<mml:math id="mml-inline118-1094342012445626">
<mml:mi>I</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mrow>
<mml:mi mathvariant="bold">s</mml:mi>
</mml:mrow>
<mml:mo stretchy="false">,</mml:mo>
<mml:mi>f</mml:mi>
<mml:mo stretchy="false">,</mml:mo>
<mml:mi>p</mml:mi>
<mml:mo stretchy="false">,</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:math>
</inline-formula>, illuminated by the primary beam pattern, <inline-formula id="inline-formula119-1094342012445626">
<mml:math id="mml-inline119-1094342012445626">
<mml:mi>A</mml:mi>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>s</mml:mi>
<mml:mo stretchy="false">,</mml:mo>
<mml:mi mathvariant="italic">ν</mml:mi>
<mml:mo stretchy="false">,</mml:mo>
<mml:mi>p</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
</mml:math>
</inline-formula>. Omitting the functional dependence for clarity, <inline-formula id="inline-formula120-1094342012445626">
<mml:math id="mml-inline120-1094342012445626">
<mml:msup>
<mml:mi>I</mml:mi>
<mml:mo>′</mml:mo>
</mml:msup>
<mml:mo stretchy="false">=</mml:mo>
<mml:mo stretchy="false">[</mml:mo>
<mml:mi>I</mml:mi>
<mml:mo stretchy="false">×</mml:mo>
<mml:mi>A</mml:mi>
<mml:mo stretchy="false">]</mml:mo>
<mml:mo stretchy="false">⋆</mml:mo>
<mml:mi>B</mml:mi>
</mml:math>
</inline-formula>, where <inline-formula id="inline-formula121-1094342012445626">
<mml:math id="mml-inline121-1094342012445626">
<mml:mi>B</mml:mi>
</mml:math>
</inline-formula> is the synthesized beam, the instrumental point-source response.</p>
<p>In order to use a FFT algorithm, we re-sample the <inline-formula id="inline-formula122-1094342012445626">
<mml:math id="mml-inline122-1094342012445626">
<mml:mi>u</mml:mi>
<mml:mi>v</mml:mi>
</mml:math>
</inline-formula> data onto a gridded <inline-formula id="inline-formula123-1094342012445626">
<mml:math id="mml-inline123-1094342012445626">
<mml:mi>u</mml:mi>
<mml:mi>v</mml:mi>
</mml:math>
</inline-formula> plane. The <inline-formula id="inline-formula124-1094342012445626">
<mml:math id="mml-inline124-1094342012445626">
<mml:mi>u</mml:mi>
<mml:mi>v</mml:mi>
</mml:math>
</inline-formula> data are multiplied by the weighting function <inline-formula id="inline-formula125-1094342012445626">
<mml:math id="mml-inline125-1094342012445626">
<mml:mi>W</mml:mi>
</mml:math>
</inline-formula>, convolved by a gridding function <inline-formula id="inline-formula126-1094342012445626">
<mml:math id="mml-inline126-1094342012445626">
<mml:mi>C</mml:mi>
</mml:math>
</inline-formula>, and re-sampled onto a regular grid by <inline-formula id="inline-formula127-1094342012445626">
<mml:math id="mml-inline127-1094342012445626">
<mml:mi mathvariant="normal">Π</mml:mi>
</mml:math>
</inline-formula>.<disp-formula id="disp-formula3-1094342012445626">
<mml:math id="mml-disp3-1094342012445626">
<mml:mo stretchy="false">[</mml:mo>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>V</mml:mi>
<mml:mo stretchy="false">×</mml:mo>
<mml:mi>W</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo stretchy="false">⋆</mml:mo>
<mml:mi>C</mml:mi>
<mml:mo stretchy="false">]</mml:mo>
<mml:mo stretchy="false">×</mml:mo>
<mml:mi mathvariant="normal">Π</mml:mi>
<mml:mo stretchy="false">⇔</mml:mo>
<mml:mrow>
<mml:mi mathvariant="normal">F</mml:mi>
<mml:mi mathvariant="normal">F</mml:mi>
<mml:mi mathvariant="normal">T</mml:mi>
</mml:mrow>
<mml:mo stretchy="false">⇔</mml:mo>
<mml:mo stretchy="false">[</mml:mo>
<mml:mo stretchy="false">(</mml:mo>
<mml:mo stretchy="false">(</mml:mo>
<mml:mi>I</mml:mi>
<mml:mo stretchy="false">×</mml:mo>
<mml:mi>A</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo stretchy="false">⋆</mml:mo>
<mml:mi>B</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo stretchy="false">×</mml:mo>
<mml:mi>c</mml:mi>
<mml:mo stretchy="false">]</mml:mo>
<mml:mo stretchy="false">⋆</mml:mo>
<mml:mo stretchy="false">∐</mml:mo>
<mml:mo>.</mml:mo>
</mml:math>
<graphic alternate-form-of="disp-formula3-1094342012445626" xlink:href="10.1177_1094342012445626-eq3.tif"/>
</disp-formula>Thus, the Fourier transform of the gridded <inline-formula id="inline-formula131-1094342012445626">
<mml:math id="mml-inline131-1094342012445626">
<mml:mi>u</mml:mi>
<mml:mi>v</mml:mi>
</mml:math>
</inline-formula> data is an image of the sky brightness distribution <inline-formula id="inline-formula132-1094342012445626">
<mml:math id="mml-inline132-1094342012445626">
<mml:mi>I</mml:mi>
</mml:math>
</inline-formula>, multiplied by the primary beam pattern, <inline-formula id="inline-formula133-1094342012445626">
<mml:math id="mml-inline133-1094342012445626">
<mml:mi>A</mml:mi>
</mml:math>
</inline-formula>, convolved the synthesized beam <inline-formula id="inline-formula134-1094342012445626">
<mml:math id="mml-inline134-1094342012445626">
<mml:mi>B</mml:mi>
</mml:math>
</inline-formula>, multiplied by <italic>c</italic>, and convolved by <inline-formula id="inline-formula135-1094342012445626">
<mml:math id="mml-inline135-1094342012445626">
<mml:mo stretchy="false">∐</mml:mo>
</mml:math>
</inline-formula>. The convolution by <inline-formula id="inline-formula136-1094342012445626">
<mml:math id="mml-inline136-1094342012445626">
<mml:mo stretchy="false">∐</mml:mo>
</mml:math>
</inline-formula> replicates the image at intervals <inline-formula id="inline-formula137-1094342012445626">
<mml:math id="mml-inline137-1094342012445626">
<mml:mn>1</mml:mn>
<mml:mrow>
<mml:mo>/</mml:mo>
</mml:mrow>
<mml:mi mathvariant="italic">δ</mml:mi>
<mml:mi>u</mml:mi>
<mml:mi>v</mml:mi>
</mml:math>
</inline-formula>, where <inline-formula id="inline-formula138-1094342012445626">
<mml:math id="mml-inline138-1094342012445626">
<mml:mi mathvariant="italic">δ</mml:mi>
<mml:mi>u</mml:mi>
<mml:mi>v</mml:mi>
</mml:math>
</inline-formula> is the sample interval of the gridded <inline-formula id="inline-formula139-1094342012445626">
<mml:math id="mml-inline139-1094342012445626">
<mml:mi>u</mml:mi>
<mml:mi>v</mml:mi>
</mml:math>
</inline-formula> data. Aliasing in the sky brightness image is minimized by choosing a function <inline-formula id="inline-formula140-1094342012445626">
<mml:math id="mml-inline140-1094342012445626">
<mml:mi>C</mml:mi>
</mml:math>
</inline-formula>, so that its Fourier transform <inline-formula id="inline-formula141-1094342012445626">
<mml:math id="mml-inline141-1094342012445626">
<mml:mi>c</mml:mi>
</mml:math>
</inline-formula> falls to a small value at the edge of the image.</p>
<p>The imaging step is usually followed by correction in the image plane for the gridding convolution, <italic>c</italic>, and deconvolution to remove the response to source structure in the sidelobes of the synthesized beam, <italic>B</italic>. Two different deconvolution algorithms are commonly used: an iterative point source subtraction algorithm, CLEAN, which is well matched for deconvolving compact source structures, and MAXIMUM ENTROPY, a gradient search algorithm, which maximizes the fit to an a priori image, in a least-squares fit the <inline-formula id="inline-formula142-1094342012445626">
<mml:math id="mml-inline142-1094342012445626">
<mml:mi>u</mml:mi>
<mml:mi>v</mml:mi>
</mml:math>
</inline-formula> data. Both algorithms operate in the image plane on the synthesized image and beam.</p>
<p>In <xref ref-type="fig" rid="fig2-1094342012445626">Figure 2</xref>, we plot the time for a gridded FFT in MIRIAD for a multi-channel image with 1280 <inline-formula id="inline-formula143-1094342012445626">
<mml:math id="mml-inline143-1094342012445626">
<mml:mo stretchy="false">×</mml:mo>
</mml:math>
</inline-formula> 1280 pixels and 100 frequency channels. The multi-channel data are gridded and imaged as a vector with a common pixel size, gridding convolution function, and synthesized beam. <xref ref-type="fig" rid="fig2-1094342012445626">Figure 2</xref> shows that the imaging time is proportional to the number of <inline-formula id="inline-formula144-1094342012445626">
<mml:math id="mml-inline144-1094342012445626">
<mml:mi>u</mml:mi>
<mml:mi>v</mml:mi>
</mml:math>
</inline-formula> data samples, at a rate 3.4 MB s<inline-formula id="inline-formula145-1094342012445626">
<mml:math id="mml-inline145-1094342012445626">
<mml:msup>
<mml:mi>
</mml:mi>
<mml:mrow>
<mml:mo stretchy="false">−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
</mml:math>
</inline-formula> using a single processor. Image deconvolution time scales with image size and complexity, and is CPU intensive. A direct deconvolution, dividing by the Fourier transform of the synthesized beam, cannot be used because the Fourier plane is not completely sampled. Both CLEAN and MAXIMUM ENTROPY are iterative algorithms, using FFTs of the image and synthesized beam. A 1280 <inline-formula id="inline-formula146-1094342012445626">
<mml:math id="mml-inline146-1094342012445626">
<mml:mo stretchy="false">×</mml:mo>
</mml:math>
</inline-formula> 1280 <inline-formula id="inline-formula147-1094342012445626">
<mml:math id="mml-inline147-1094342012445626">
<mml:mo stretchy="false">×</mml:mo>
</mml:math>
</inline-formula> 100 channel, real-valued image (4-bytes per pixel) <inline-formula id="inline-formula148-1094342012445626">
<mml:math id="mml-inline148-1094342012445626">
<mml:mo stretchy="false">~</mml:mo>
</mml:math>
</inline-formula>650 MB, with a common synthesized beam (6.5 MB), can be deconvolved in memory. The frequency channels can be deconvolved in parallel processes. Image deconvolution is relatively fast for compact image structures, but can exceed the imaging time for complex images.</p>
<p>In a real-time imaging pipeline, images in multiple frequency channels can be processed in parallel in a distributed architecture. The images are formed from the calibrated data stream from which the a priori sky model has been subtracted, and are therefore difference images from the sky model.</p>
<p>Subtracting the sky brightness model from the <inline-formula id="inline-formula149-1094342012445626">
<mml:math id="mml-inline149-1094342012445626">
<mml:mi>u</mml:mi>
<mml:mi>v</mml:mi>
</mml:math>
</inline-formula> data minimizes many of the problems in the gridded FFT, and in particular allows position dependent calibrations and time variable primary beam patterns to be handled (see, e.g., <xref ref-type="bibr" rid="bibr32-1094342012445626">Wright and Corder, 2008</xref>).</p>
<p>The difference images are used to update the sky model, including not only the regions of interest, but also improving the accuracy of sources whose sidelobes must be subtracted. As the observations proceed, both the model image and the calibration are improved. The process converges when the difference images approach the noise level and the model image is consistent with the data.</p>
<p>For a small field of view a 2D FFT can be used to image the region around each phase center. The maximum image size for a 2D FFT scales as <inline-formula id="inline-formula150-1094342012445626">
<mml:math id="mml-inline150-1094342012445626">
<mml:msub>
<mml:mi>D</mml:mi>
<mml:mrow>
<mml:mi>m</mml:mi>
<mml:mi>a</mml:mi>
<mml:mi>x</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo>/</mml:mo>
</mml:mrow>
<mml:mi mathvariant="italic">λ</mml:mi>
</mml:math>
</inline-formula>, <inline-formula id="inline-formula151-1094342012445626">
<mml:math id="mml-inline151-1094342012445626">
<mml:mo stretchy="false">~</mml:mo>
<mml:msup>
<mml:mn>10</mml:mn>
<mml:mn>8</mml:mn>
</mml:msup>
</mml:math>
</inline-formula> beam areas on a 1000 km baseline at <inline-formula id="inline-formula152-1094342012445626">
<mml:math id="mml-inline152-1094342012445626">
<mml:mi mathvariant="italic">λ</mml:mi>
<mml:mo stretchy="false">=</mml:mo>
<mml:mn>1</mml:mn>
</mml:math>
</inline-formula> cm. Deconvolution is minimized by obtaining good <inline-formula id="inline-formula153-1094342012445626">
<mml:math id="mml-inline153-1094342012445626">
<mml:mi>u</mml:mi>
<mml:mi>v</mml:mi>
</mml:math>
</inline-formula> sampling of the aperture plane, and low synthesized beam sidelobe levels for large <inline-formula id="inline-formula154-1094342012445626">
<mml:math id="mml-inline154-1094342012445626">
<mml:mi>N</mml:mi>
</mml:math>
</inline-formula> array designs, e.g., for the ALMA array with 60 antennas, the sidelobe levels are <inline-formula id="inline-formula155-1094342012445626">
<mml:math id="mml-inline155-1094342012445626">
<mml:mo stretchy="false">~</mml:mo>
<mml:mn>1</mml:mn>
</mml:math>
</inline-formula>%. In many cases, deconvolution in the image plane may not be needed, since the model image and sidelobes of confusing sources have been subtracted from the <inline-formula id="inline-formula156-1094342012445626">
<mml:math id="mml-inline156-1094342012445626">
<mml:mi>u</mml:mi>
<mml:mi>v</mml:mi>
</mml:math>
</inline-formula> data. In addition, images may be limited by atmospheric and instrumental errors which must be removed from the <inline-formula id="inline-formula157-1094342012445626">
<mml:math id="mml-inline157-1094342012445626">
<mml:mi>u</mml:mi>
<mml:mi>v</mml:mi>
</mml:math>
</inline-formula> data and can not be removed by deconvolving in the image plane.</p>
<p>The imaging engine can make images using all the frequency channels. Spectral line images can be made for multiple frequency channels, averaged into the desired frequency or velocity intervals. Wideband, MFS imaging treats the frequency channels as independent <inline-formula id="inline-formula158-1094342012445626">
<mml:math id="mml-inline158-1094342012445626">
<mml:mi>u</mml:mi>
<mml:mi>v</mml:mi>
</mml:math>
</inline-formula> samples. The a priori model used in the calibration can be updated at intervals, when the difference from the best current image is significant.</p>
<p>Variable sources are detected as intermittent sources which are inconsistent with the current model. We should also accumulate a <inline-formula id="inline-formula159-1094342012445626">
<mml:math id="mml-inline159-1094342012445626">
<mml:msup>
<mml:mi mathvariant="italic">χ</mml:mi>
<mml:mn>2</mml:mn>
</mml:msup>
</mml:math>
</inline-formula> image to help identify pixels where there are time variable sources or RFI sources. In some cases we may want to keep a time series of difference images and the model images used for the calibration.</p>
<p>We view imaging as a dynamic process which can be guided in real time by observers inspecting the convergence of the model image and the <inline-formula id="inline-formula160-1094342012445626">
<mml:math id="mml-inline160-1094342012445626">
<mml:msup>
<mml:mi mathvariant="italic">χ</mml:mi>
<mml:mn>2</mml:mn>
</mml:msup>
</mml:math>
</inline-formula> image. As the observations proceed, the observations can be moved to regions where more data are needed to define the science goals, either regions of interest, or sources whose sidelobes are confusing, or new sources which are discovered in the imaging process. Isoplanatic patches may vary during the observations, requiring different observation centers to adequately determine the calibration across the sky.</p>
<p>The data archive serves as the data base for the observations, calibrations, and instrument status during the observations. The data streams from each phase center are saved in the data archive along with the metadata. Data from the data archive can be replayed though the imaging system so that the best model of the sky and calibration data from the completed observations can be used to improve the calibration of the final image and extract time variable sources.</p>
</sec>
<sec id="section7-1094342012445626">
<title>7. Current developments</title>
<p>In this paper we propose to develop adaptive real-time imaging using correlators and beam formers with a high data bandwidth into computer clusters. The mismatch between the data rates in the on-line DSP and those supported by off-line processing will be resolved by integrating the calibration and imaging with the data acquisition process. Calibration and imaging will be handled with the real-time feedback of the antenna calibration needed for beam formers and RFI suppression.</p>
<p>Images can be made simultaneously for multiple regions within the field of view by integrating the output from the correlators on multiple targets of interest, calibration sources, and sources whose sidelobes confuse the regions of interest. The regions imaged are used to update and improve the a priori model, which becomes the final calibrated image by the time the observations are complete.</p>
<p>A number of current telescopes are developing these concepts. The Allen Telescope Array (<xref ref-type="bibr" rid="bibr28-1094342012445626">Welch et al., 2009</xref>) is a leading prototype for the SKA. Small (6.1 m) dishes give the ATA excellent survey speed for wide field imaging, with a frequency coverage from 0.5 to 11.2 GHz. The use of flexible DSP enables multiple simultaneous observing projects and automated data processing (<xref ref-type="bibr" rid="bibr11-1094342012445626">Keating et al., 2010</xref>). <xref ref-type="fig" rid="fig3-1094342012445626">Figure 3</xref> shows an example of the data processing required for transient sources.</p>
<fig id="fig3-1094342012445626" position="float">
<label>Figure 3.</label>
<caption>
<p>Left: Image Cyg X-3 region obtained with the Allen Telescope Array at 3.09 GHz. Right: Image of compact, time variable sources after subtracting the complex structure (Peter Williams, February 2011). Cyg X-3 is a high-mass X-ray binary system that can increase its brightness by a factor of <inline-formula id="inline-formula161-1094342012445626">
<mml:math id="mml-inline161-1094342012445626">
<mml:mo stretchy="false">~</mml:mo>
</mml:math>
</inline-formula>10 in an hour. Subtracting the large scale structure allows us to get high time-resolution light curves of time variable sources. The off-line data processing took several hours, and limits our ability to image time variable sources.</p>
</caption>
<graphic alternate-form-of="fig3-1094342012445626" xlink:href="10.1177_1094342012445626-fig3.tif"/>
</fig>
<p>The Precision Array for Probing the Epoch of Re-ionization (PAPER) is an array of precision dipoles to map the whole sky which uses a packetized correlator design (<xref ref-type="bibr" rid="bibr18-1094342012445626">Parsons et al., 2008</xref>). Calibration uses an all-sky model (<xref ref-type="bibr" rid="bibr19-1094342012445626">Parsons et al., 2010</xref>).</p>
<p>The MWA is a low-frequency radio telescope to search for the spectral signature of the epoch of reionization (EOR) and to probe the structure of the Solar Corona. The MWA will have 128 antenna arrays capable of imaging the sky from 80 to 300 MHz with an instantaneous field of view that is tens of degrees wide and a resolution of a few arcminutes (<xref ref-type="bibr" rid="bibr14-1094342012445626">Mitchell et al., 2008</xref>). A data rate <inline-formula id="inline-formula162-1094342012445626">
<mml:math id="mml-inline162-1094342012445626">
<mml:mo stretchy="false">~</mml:mo>
</mml:math>
</inline-formula>1 GB s<inline-formula id="inline-formula163-1094342012445626">
<mml:math id="mml-inline163-1094342012445626">
<mml:msup>
<mml:mi>
</mml:mi>
<mml:mrow>
<mml:mo stretchy="false">−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
</mml:math>
</inline-formula> with images every 8 s requires on-site, real-time processing and reduction in preference to archiving, transport, and off-line processing. Real time performance needs <inline-formula id="inline-formula164-1094342012445626">
<mml:math id="mml-inline164-1094342012445626">
<mml:mo stretchy="false">~</mml:mo>
</mml:math>
</inline-formula>2.5 TFLOP s<inline-formula id="inline-formula165-1094342012445626">
<mml:math id="mml-inline165-1094342012445626">
<mml:msup>
<mml:mi>
</mml:mi>
<mml:mrow>
<mml:mo stretchy="false">−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
</mml:math>
</inline-formula>. <xref ref-type="bibr" rid="bibr9-1094342012445626">Edgar et al. (2010</xref>) present a heterogeneous computing pipeline implementation, using GPUs which are a good fit for pipeline processing, but lack flexibility or feedback into the data acquisition, e.g., RFI detection and excision.</p>
<p>High-performance DSP enables us to handle high data rates from aperture synthesis arrays in parallel, and to make images in close to real time. Adaptive real-time data processing will revolutionize the science capabilities of existing and developing telescopes, and have a broad impact on the way that radio telescope arrays can be used.</p>
<p>The current situation for aperture synthesis arrays may be compared with a jet-liner. Both are extremely complicated and sophisticated systems. Both can be programmed to function automatically to deliver the expected results. However, the pilot of the jet-liner has the full power of the control systems to handle unexpected situations in real time. On the other hand, the astronomer has little real-time feedback, or ability to adapt the observations to new discoveries, and, even worse, the unexpected result may not be in the data because off-line data processing cannot handle the data rate or computational needs. High-performance computing with real-time feedback to observers will enable us to optimize the observations and calibrations needed to realize the science.</p>
</sec>
</body>
<back>
<ack>
<title>Acknowledgements</title>
<p>I thank the many colleagues and students who have contributed to this work, in particular, Dan Werthimer and the CASPER students and staff for hardware and software tools which enable us to build reconfigurable data processing for radio astronomy. Thanks to the anonymous referees for valuable comments which have improved the presentation of this work. This paper is dedicated to my colleague, the late Don Backer.</p>
</ack>
<fn-group>
<fn fn-type="financial-disclosure" id="fn2-1094342012445626">
<label>Funding</label>
<p>This work was supported by the National Science Foundation (grant number AST-0906040, ‘Collaborative Digital Instrumentation for the Radio Astronomy Community’).</p>
</fn>
</fn-group>
<ref-list>
<title>References</title>
<ref id="bibr1-1094342012445626">
<citation citation-type="journal">
<person-group person-group-type="author">
<name>
<surname>Barott</surname>
<given-names>WC</given-names>
</name>
<etal/>
</person-group> (<year>2011</year>) <article-title>Real-time beamforming using high-speed FPGAs at the Allen Telescope Array</article-title>. <source>Radio Science</source> <volume>46</volume>: <fpage>1016</fpage>.</citation>
</ref>
<ref id="bibr2-1094342012445626">
<citation citation-type="book">
<person-group person-group-type="author">
<name>
<surname>Born</surname>
<given-names>M</given-names>
</name>
<name>
<surname>Wolf</surname>
<given-names>E</given-names>
</name>
</person-group> (<year>1959</year>) <article-title>Principles of Optics</article-title>. <publisher-loc>London</publisher-loc>: <publisher-name>Pergamon Press</publisher-name>.</citation>
</ref>
<ref id="bibr3-1094342012445626">
<citation citation-type="web">
<person-group person-group-type="author">
<name>
<surname>Brodersen</surname>
<given-names>B</given-names>
</name>
<name>
<surname>Chang</surname>
<given-names>C</given-names>
</name>
<name>
<surname>Wawrznek</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Werthimer</surname>
<given-names>D</given-names>
</name>
<name>
<surname>Wright</surname>
<given-names>M</given-names>
</name>
</person-group> (<year>2004</year>) <article-title>BEE2: A multi-purpose computing platform for radio telescope signal processing applications</article-title>. <ext-link ext-link-type="uri" xlink:href="http://bwrc.eecs.berkeley.edu/Research/BEE/BEE2/presentations/BEE2_ska2004_poster.pdf">http://bwrc.eecs.berkeley.edu/Research/BEE/BEE2/presentations/BEE2_ska2004_poster.pdf</ext-link>.
</citation>
</ref>
<ref id="bibr4-1094342012445626">
<citation citation-type="journal">
<person-group person-group-type="author">
<name>
<surname>Carlson</surname>
<given-names>BR</given-names>
</name>
<name>
<surname>Dewdney</surname>
<given-names>PE</given-names>
</name>
</person-group> (<year>2000</year>) The WIDAR EVLA correlator. <source>Electronics Letters</source> <volume>36</volume>: <fpage>987</fpage>.</citation>
</ref>
<ref id="bibr5-1094342012445626">
<citation citation-type="journal">
<person-group person-group-type="author">
<name>
<surname>Clark</surname>
<given-names>MA</given-names>
</name>
<name>
<surname>LaPlante</surname>
<given-names>PC</given-names>
</name>
<name>
<surname>Greenhill</surname>
<given-names>LJ</given-names>
</name>
</person-group> (<year>2012</year>) <article-title>Accelerating radio astronomy cross-correlation with graphics processing units</article-title>. <source>International Journal of High Performance Computing Applications</source>, <comment>preprint arXiv:1107</comment>.<fpage>4264</fpage>.</citation>
</ref>
<ref id="bibr6-1094342012445626">
<citation citation-type="other">
<person-group person-group-type="author">
<name>
<surname>Cornwell</surname>
<given-names>TJ</given-names>
</name>
</person-group> (<year>2004</year>) <article-title>EVLA and SKA computing costs for wide field imaging (revised)</article-title>. <comment>EVLA memo 77</comment>.</citation>
</ref>
<ref id="bibr7-1094342012445626">
<citation citation-type="web">
<person-group person-group-type="author">
<name>
<surname>Cornwell</surname>
<given-names>TJ</given-names>
</name>
</person-group> (<year>2005</year>) <article-title>SKA computing costs for a generic telescope model</article-title>. <comment>SKA memo 64</comment>. <ext-link ext-link-type="uri" xlink:href="http://www.skatelescope.org">http://www.skatelescope.org</ext-link>.
</citation>
</ref>
<ref id="bibr8-1094342012445626">
<citation citation-type="journal">
<person-group person-group-type="author">
<name>
<surname>Cornwell</surname>
<given-names>TJ</given-names>
</name>
<name>
<surname>Perley</surname>
<given-names>RA</given-names>
</name>
</person-group> (<year>1992</year>) <article-title>Radio-interferometric imaging of very large fields</article-title>. <source>Astronomy and Astrophysics</source> <volume>261</volume>: <fpage>353</fpage>.</citation>
</ref>
<ref id="bibr9-1094342012445626">
<citation citation-type="journal">
<person-group person-group-type="author">
<name>
<surname>Edgar</surname>
<given-names>RG</given-names>
</name>
<name>
<surname>Clark</surname>
<given-names>MA</given-names>
</name>
<name>
<surname>Dale</surname>
<given-names>K</given-names>
</name>
<etal/>
</person-group> (<year>2010</year>) Enabling a High Throughput Real Time Data Pipeline for a Large Radio Telescope Array with GPUs. <source>Computer Physics Communications</source> <volume>181</volume>: <fpage>1707</fpage>.</citation>
</ref>
<ref id="bibr10-1094342012445626">
<citation citation-type="journal">
<person-group person-group-type="author">
<name>
<surname>Escoffier</surname>
<given-names>RP</given-names>
</name>
<name>
<surname>Comoretto</surname>
<given-names>G</given-names>
</name>
<name>
<surname>Webber</surname>
<given-names>JC</given-names>
</name>
<etal/>
</person-group> (<year>2007</year>) <article-title>The ALMA correlator</article-title>. <source>Astronomy and Astrophysics</source> <volume>462</volume>: <fpage>801</fpage>.</citation>
</ref>
<ref id="bibr11-1094342012445626">
<citation citation-type="journal">
<person-group person-group-type="author">
<name>
<surname>Keating</surname>
<given-names>GK</given-names>
</name>
<name>
<surname>Barott</surname>
<given-names>WC</given-names>
</name>
<name>
<surname>Wright</surname>
<given-names>M</given-names>
</name>
</person-group> (<year>2010</year>) Automated calibration and imaging with the Allen Telescope Array SPIE 7740: 39. <source>Proceedings of the SPIE</source> <comment>7740</comment>.</citation>
</ref>
<ref id="bibr12-1094342012445626">
<citation citation-type="web">
<person-group person-group-type="author">
<name>
<surname>Lonsdale</surname>
<given-names>CJ</given-names>
</name>
<name>
<surname>Doeleman</surname>
<given-names>SS</given-names>
</name>
<name>
<surname>Oberoi</surname>
<given-names>D</given-names>
</name>
</person-group> (<year>2004</year>) <article-title>Imaging strategies and post processing computing costs for large-<italic>N</italic> SKA designs</article-title>. <comment>SKA memo 54</comment>. <ext-link ext-link-type="uri" xlink:href="http://www.skatelescope.org">http://www.skatelescope.org</ext-link>.
</citation>
</ref>
<ref id="bibr13-1094342012445626">
<citation citation-type="journal">
<person-group person-group-type="author">
<name>
<surname>Lucas</surname>
<given-names>R</given-names>
</name>
<name>
<surname>Richer</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Shepherd</surname>
<given-names>D</given-names>
</name>
<etal/>
</person-group> (<year>2004</year>) <article-title>Estimation of ALMA Data Rate</article-title>. <comment>ALMA memo 501</comment>.</citation>
</ref>
<ref id="bibr14-1094342012445626">
<citation citation-type="journal">
<person-group person-group-type="author">
<name>
<surname>Mitchell</surname>
<given-names>DA</given-names>
</name>
<name>
<surname>Greenhill</surname>
<given-names>LJ</given-names>
</name>
<name>
<surname>Wayth</surname>
<given-names>RB</given-names>
</name>
<etal/>
</person-group> (<year>2008</year>) Real-Time Calibration of the Murchison Widefield Array. <source>IEEE Journal of Selected Topics in Signal Processing</source> <volume>2</volume>: <fpage>707</fpage>.</citation>
</ref>
<ref id="bibr15-1094342012445626">
<citation citation-type="journal">
<person-group person-group-type="author">
<name>
<surname>Nieuwpoort</surname>
<given-names>RVV</given-names>
</name>
<name>
<surname>Romein</surname>
<given-names>JW</given-names>
</name>
</person-group> (<year>2009</year>) <source>Using many-core hardware to correlate radio astronomy signals, in Proc. ACM Int. Conf. Supercomputing</source>, <publisher-loc>New York, NY</publisher-loc>, pp. <fpage>440</fpage>–<lpage>449</lpage>.</citation>
</ref>
<ref id="bibr16-1094342012445626">
<citation citation-type="journal">
<person-group person-group-type="author">
<name>
<surname>Nijboer</surname>
<given-names>RJ</given-names>
</name>
<name>
<surname>Noordam</surname>
<given-names>JE</given-names>
</name>
<name>
<surname>Yatawatta</surname>
<given-names>SB</given-names>
</name>
</person-group> (<year>2006</year>) LOFAR Self-Calibration using a Local Sky Model. <source>Astronomical Data Analysis Software and Systems XV</source> <volume>351</volume>: <fpage>291</fpage>.</citation>
</ref>
<ref id="bibr17-1094342012445626">
<citation citation-type="journal">
<person-group person-group-type="author">
<name>
<surname>Ord</surname>
<given-names>S</given-names>
</name>
<name>
<surname>Greenhill</surname>
<given-names>L</given-names>
</name>
<name>
<surname>Wayth</surname>
<given-names>R</given-names>
</name>
<etal/>
</person-group> (<year>2009</year>) <source>Astronomical Data Analysis Software and Systems XVIII</source> <volume>411</volume>: <fpage>127</fpage>.</citation>
</ref>
<ref id="bibr18-1094342012445626">
<citation citation-type="journal">
<person-group person-group-type="author">
<name>
<surname>Parsons</surname>
<given-names>A</given-names>
</name>
<name>
<surname>Backer</surname>
<given-names>D</given-names>
</name>
<name>
<surname>Siemion</surname>
<given-names>A</given-names>
</name>
<etal/>
</person-group> (<year>2008</year>) <article-title>A scalable correlator architecture based on modular FPGA hardware, reuseable gateware, and data packetization</article-title>. <volume>120</volume>: <fpage>1207</fpage>–<lpage>1221</lpage>.</citation>
</ref>
<ref id="bibr19-1094342012445626">
<citation citation-type="journal">
<person-group person-group-type="author">
<name>
<surname>Parsons</surname>
<given-names>AR</given-names>
</name>
</person-group>, <source>Astrophysical Journal</source> <volume>139</volume>: <fpage>1468</fpage>. et al. (<year>2010</year>).</citation>
</ref>
<ref id="bibr20-1094342012445626">
<citation citation-type="book">
<person-group person-group-type="author">
<name>
<surname>Perley</surname>
<given-names>R</given-names>
</name>
</person-group> (<year>2004</year>) <source>Wide-Field Imaging with the EVLA: WIDAR Correlator Modes and Output Data Rates</source>. <comment>EVLA memo 64</comment>. <ext-link ext-link-type="uri" xlink:href="http://www.aoc.nrao.edu/evla/geninfo/memoseries/evlamemo64.ps">http://www.aoc.nrao.edu/evla/geninfo/memoseries/evlamemo64.ps</ext-link>.
</citation>
</ref>
<ref id="bibr21-1094342012445626">
<citation citation-type="book">
<person-group person-group-type="author">
<name>
<surname>Perley</surname>
<given-names>R</given-names>
</name>
<name>
<surname>Clark</surname>
<given-names>B</given-names>
</name>
</person-group> (<year>2003</year>) <source>Scaling Relations for Interferometric Post-Processing</source>. <comment>EVLA memo 63</comment>.</citation>
</ref>
<ref id="bibr22-1094342012445626">
<citation citation-type="journal">
<person-group person-group-type="author">
<name>
<surname>Perley</surname>
<given-names>R</given-names>
</name>
<name>
<surname>Napier</surname>
<given-names>P</given-names>
</name>
<name>
<surname>Jackson</surname>
<given-names>J</given-names>
</name>
<etal/>
</person-group> (<year>2009</year>) <source>IEEE Proceedings</source> <volume>97</volume>: <fpage>1448</fpage>.</citation>
</ref>
<ref id="bibr23-1094342012445626">
<citation citation-type="journal">
<person-group person-group-type="author">
<name>
<surname>Perley</surname>
<given-names>RA</given-names>
</name>
<name>
<surname>Chandler</surname>
<given-names>CJ</given-names>
</name>
<name>
<surname>Butler</surname>
<given-names>BJ</given-names>
</name>
<name>
<surname>Wrobel</surname>
<given-names>JM</given-names>
</name>
</person-group> (<year>2011</year>) <source>Astrophysical Journal</source> <volume>739</volume>: <fpage>L1</fpage>.</citation>
</ref>
<ref id="bibr24-1094342012445626">
<citation citation-type="journal">
<person-group person-group-type="author">
<name>
<surname>Ryle</surname>
<given-names>M</given-names>
</name>
<name>
<surname>Neville</surname>
<given-names>AC</given-names>
</name>
</person-group> (<year>1962</year>) <source>Monthly Notices of the Royal Astronomical Society</source> <volume>125</volume>: <fpage>39</fpage>.</citation>
</ref>
<ref id="bibr25-1094342012445626">
<citation citation-type="book">
<person-group person-group-type="author">
<name>
<surname>Sault</surname>
<given-names>RJ</given-names>
</name>
<name>
<surname>Teuben</surname>
<given-names>PJ</given-names>
</name>
<name>
<surname>Wright</surname>
<given-names>MCH</given-names>
</name>
</person-group> (<year>1995</year>). In: <person-group person-group-type="editor">
<name>
<surname>Shaw</surname>
<given-names>R</given-names>
</name>
<name>
<surname>Payne</surname>
<given-names>HE</given-names>
</name>
<name>
<surname>Hayes</surname>
<given-names>ASP</given-names>
</name>
</person-group> (eds) <source>Astronomical Data Analysis Software and Systems IV</source> <volume>77</volume>: <fpage>433</fpage>.</citation>
</ref>
<ref id="bibr26-1094342012445626">
<citation citation-type="book">
<person-group person-group-type="author">
<name>
<surname>Schilizzi</surname>
<given-names>RT</given-names>
</name>
<etal/>
</person-group> (<year>2007</year>) <source>Preliminary Specifications for the Square Kilometre Array</source>. <comment>SKA memo 100.</comment> <ext-link ext-link-type="uri" xlink:href="http://www.skatelescope.org">http://www.skatelescope.org</ext-link>.</citation>
</ref>
<ref id="bibr27-1094342012445626">
<citation citation-type="book">
<person-group person-group-type="author">
<name>
<surname>Thompson</surname>
<given-names>AR</given-names>
</name>
<name>
<surname>Moran</surname>
<given-names>JM</given-names>
</name>
<name>
<surname>Swenson</surname>
<given-names>GW</given-names>
</name>
</person-group> (<year>2001</year>) <source>Interferometry and Synthesis in Radio Astronomy</source>. <edition>2nd ed</edition>. <publisher-loc>New York</publisher-loc>: <publisher-name>Wiley</publisher-name>.</citation>
</ref>
<ref id="bibr28-1094342012445626">
<citation citation-type="journal">
<person-group person-group-type="author">
<name>
<surname>Welch</surname>
<given-names>J</given-names>
</name>
<etal/>
</person-group> (<year>2009</year>) <source>IEEE Proceedings</source> <volume>97</volume>: <fpage>1438</fpage>.</citation>
</ref>
<ref id="bibr29-1094342012445626">
<citation citation-type="journal">
<person-group person-group-type="author">
<name>
<surname>Wootten</surname>
<given-names>A</given-names>
</name>
<name>
<surname>Thompson</surname>
<given-names>AR</given-names>
</name>
</person-group> (<year>2009</year>) <source>IEEE Proceedings</source> <volume>97</volume>: <fpage>1463</fpage>.</citation>
</ref>
<ref id="bibr30-1094342012445626">
<citation citation-type="book">
<person-group person-group-type="author">
<name>
<surname>Wright</surname>
<given-names>MCH</given-names>
</name>
</person-group> (<year>2005</year>) <source>Real Time Imaging</source>. <comment>SKA memo 60.</comment> <ext-link ext-link-type="uri" xlink:href="http://www.skatelescope.org">http://www.skatelescope.org</ext-link>.
</citation>
</ref>
<ref id="bibr31-1094342012445626">
<citation citation-type="book">
<person-group person-group-type="author">
<name>
<surname>Wright</surname>
<given-names>MCH</given-names>
</name>
<etal/>
</person-group> (<year>2006</year>) <source>SKA Survey Optimization</source>. <comment>SKA memo 81</comment>. <ext-link ext-link-type="uri" xlink:href="http://www.skatelescope.org">http://www.skatelescope.org</ext-link>.</citation>
</ref>
<ref id="bibr32-1094342012445626">
<citation citation-type="web">
<person-group person-group-type="author">
<name>
<surname>Wright</surname>
<given-names>MCH</given-names>
</name>
<name>
<surname>Corder</surname>
<given-names>S</given-names>
</name>
</person-group> (<year>2008</year>) <article-title>Deconvolving primary beam patterns from SKA images</article-title>. <comment>SKA memo 103</comment>. <ext-link ext-link-type="uri" xlink:href="http://www.skatelescope.org">http://www.skatelescope.org</ext-link>.
</citation>
</ref>
</ref-list>
</back>
</article>